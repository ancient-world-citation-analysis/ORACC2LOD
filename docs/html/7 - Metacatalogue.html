
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mount Google Drive folder + imports &#8212; ORACC2LoD</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '7 - Metacatalogue';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="welcome.html">
  
  
  
  
  
  
    <p class="title logo__title">ORACC2LoD</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="welcome.html">
                    Sumerian Networks JupyterBook
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1-ORACC_ZIPS.html">Download ORACC Directory ZIP Files (Google Colab version)</a></li>




<li class="toctree-l1"><a class="reference internal" href="2-DataFrame%20Extraction.html">Extract words_df and df_cat DataFrames from ZIP files</a></li>


<li class="toctree-l1"><a class="reference internal" href="3-Large%20DF%20of%20Unique%20Words.html">Large DataFrame of Unique Words</a></li>



<li class="toctree-l1"><a class="reference internal" href="4-Megacatalogue.html">Mount Google Drive folder + imports + steps</a></li>

<li class="toctree-l1"><a class="reference internal" href="4.1%20-%20Counts%20for%20Megacatalogue.html">Counts for Megacatalogue</a></li>


<li class="toctree-l1"><a class="reference internal" href="5-Translations%20Extraction.html">Mount Google Drive folder + imports + steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.1-Counts%20for%20Transliterations%20and%20Translations.html">Counts for Transliterations and Translations</a></li>

<li class="toctree-l1"><a class="reference internal" href="7.1%20-%20Metacatalogue.html">Mount Google Drive folder + imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.2%20-%20Fitting%20Headers.html">Mount Google Drive folder + imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.3%20-%20Factgrid%20Quickstatement%20Processing.html">Mount Google Drive folder + imports</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/austin-pereira/Oracc2LoD/blob/main/book/7 - Metacatalogue.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/7 - Metacatalogue.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mount Google Drive folder + imports</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Mount Google Drive folder + imports</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsets-based-on-object-type">Subsets based on Object Type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#language-language-p18-uncertainty-p155">1 Language = Language (P18) + uncertainty (P155)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id">1.1 Starting with the CDLI languages, we can match unique languages to their FG language id</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-languages-dataframes">1.3 Combining CDLI and ORACC Languages dataframes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-material-composition-p401">2 Material = Material Composition (P401)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id"><strong>2.1. We will only add the most basic material composition to a data frame, `material_df’, and then we match the first statement to the corresponding FactGrid Q-id.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.2. CDLI - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df">2.2.1 matched_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df">2.2.2 no_match_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-cdli-materials">2.2.3 Visualization of CDLI Materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-materials">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-finer-categories-within-matched-materials">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-materials">Distribution of unmatched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-materials-are-tablets-that-have-languages-on-them-made-of">What materials are tablets that have languages on them made of?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.3. ORACC - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df2">2.3.1 matched_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df2">2.3.2 no_match_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Distribution of unmatched materials</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-material-dataframes"><strong>2.4 Combining CDLI and ORACC Material dataframes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#museum-collection-present-holding-p329">3 <strong>museum/collection = present holding (P329)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df">3.1.2 collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df">3.1.3 matched_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df">3.1.4 no_match_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">3.1.5 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-collections">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries">Distribution of countries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-collections">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df2">3.2.1 collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df2">3.2.2 matched_collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df2">3.2.3 no_match_collection_df2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.2.4 Visualization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries-of-first-collections-that-matched">Distribution of countries of first collections that matched</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-collections-of-cdli-and-oracc">3.3 Merging collections of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#provenience-find-spot-p695">4 <strong>provenience = find spot (P695)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-two-columns-as-qualifiers">4.4 Add two columns as qualifiers:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#object-type-instance-of-p2">5 <strong>object_type = Instance of (P2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-objects">5.1 CDLI objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#n-b-for-double-entries">N.B. for double entries:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-objects">5.2 ORACC objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">N.B. for double entries:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-object-dfs-of-cdli-and-oracc">Merging object dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#genre-field-of-knowledge-p608">6 <strong>genre = Field of Knowledge (P608)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog">6.1 Use this CSV to obtain the FactGrid Q-ids for each object type in the CDLI catalog:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-genres">6.2 CDLI Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id">6.2.1 Match on the cdli label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df">6.2.2 matched_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-genre-df">6.2.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">6.2.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre-for-tablets-that-have-text-on-them">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-genre">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-genres">6.3 ORACC Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id">6.3.1 Match on the oracc label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df2">6.3.2 matched_genre_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">6.3.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">6.3.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-genre-dfs-of-cdli-and-oracc">Merging genre dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-period-p853">7 <strong>period = Period (P853)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog">7.1 Use this CSV to obtain the FactGrid Q-ids for each period of each texts in the CDLI catalog</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-periods">7.2 CDLI Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-period-df">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-period-df">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-periods">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-tablets-over-time">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-periods">Distribution of Unmatched Periods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-periods">7.3 ORACC Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Distribution of Unmatched Periods</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-period-dfs-of-cdli-and-oracc">Merging period dfs of CDLI and ORACC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-and-qualifier-is-oracc">CDLI and Qualifier is ORACC</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-for-factgrid-quickstatement-batch-processing">Prepare for <strong>FactGrid</strong> QuickStatement batch processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-fields-with-description">4.1 Initial fields with <strong>description</strong>:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#language-df-final-continued">4.2 <strong>language_df_final</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-df-continued">4.3 <strong>material_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#museum-df-continued">4.4 <strong>museum_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#provenience-df-continued">4.5 <strong>provenience_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#object-type-df-continued-to-be-added-in-batch-2">4.6 <strong>object_type_df</strong> (continued): to be added in batch 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#genre-df-continued">4.7 <strong>genre_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-df-continued">4.8 <strong>period_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-csv-with-examples">__Final CSV (with examples):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finalized-outcome-example-in-factgrid">Finalized outcome (example in FactGrid):</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>#Metacatalogue</p>
<p>Notebook by Melinee Her</p>
<p>Cleans the megacatalogue and harmonizes ORACC data with CDLI catalogue.</p>
<p>#Merging the cdli_cat and megacat_mini</p>
<ol class="arabic simple">
<li><p>Read in the <a class="reference external" href="https://docs.google.com/spreadsheets/d/1wiViebAL3xGGwV75cKIr41beRX-Lxuj4u8y1ET8I27Y/edit?usp=sharing">cdli_cat_short csv</a></p></li>
</ol>
<ul class="simple">
<li><p>This can be replaced by the workflow in this notebook: <a class="reference external" href="https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing">https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing</a></p></li>
<li><p>This notebook also provides the headers / format for LOD triples in FactGrid.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Match the CDLI <code class="docutils literal notranslate"><span class="pre">id_text</span></code> with the ORACC <code class="docutils literal notranslate"><span class="pre">id_text</span></code> in ORACC [Megacatalog_short](<a class="reference external" href="https://docs.google.com/spreadsheets/d/">https://docs.google.com/spreadsheets/d/</a>
1iyvVpt5DrkF22Cd_p_oWHZfHsd6NzcvUlowS2_7Cm2U/edit?usp=sharing)</p></li>
<li><p>After the preliminary matching of the fields, we will want to make a final subset of the columns we will add to our Wikibase in FactGrid. To do this we also need to see if the values are different for a given field.</p></li>
</ol>
<ul class="simple">
<li><p>Is there a way to highlight different values which we expect to be the same?</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Lastly, using this notebook, we will obtain the proper Wikibase formatting for FactGrid header fields: <a class="reference external" href="https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing">https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing</a></p></li>
</ol>
<ul class="simple">
<li><p>the subset of 8 fields we selected is only the beginning, but it is a good start.</p></li>
<li><p>If the values are identical we can use the Q-items and build the final CSV for a <a class="reference internal" href="#"><span class="xref myst">QuickStatements</span></a> import.</p></li>
</ul>
<section class="tex2jax_ignore mathjax_ignore" id="mount-google-drive-folder-imports">
<h1>Mount Google Drive folder + imports<a class="headerlink" href="#mount-google-drive-folder-imports" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#any necessary imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="c1">#Set folder for remote drive</span>
<span class="c1">#folder = &#39;/content/drive/My Drive/FactGrid Cuneiform (AWCA)/people/Melinee/&#39;</span>
<span class="n">folder</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Melinee/&#39;</span>

<span class="c1">#importing utils for the method which downloads the current text json files</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;network/utils/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">oracc_download</span>

<span class="c1"># This is a user defined module that searches through the texts to find the entities in the text that</span>
<span class="c1"># are people and places, to be imported as nodes into the network</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;network/&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">rank_parser4</span> <span class="k">as</span> <span class="nn">rp</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>#Shortening the ORACC Megacatalogue</p>
<p>In this section of the notebook, we will create a smaller version of the megacatalogue, selectin a subset of columns to compare to the CDLI data when forming the metacatalogue.</p>
<p>Retrieving the megacatalogue</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#path = &#39;/content/drive/MyDrive/FactGrid Cuneiform (AWCA)/people/Melinee/ORACC_DFS/megacatalogue.csv&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/megacatalogue.csv&#39;</span>
<span class="n">megacatalogue</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">megacatalogue</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9e608c01-a876-48e9-a04f-b018834c6c5b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>langs</th>
      <th>project</th>
      <th>id_text.1</th>
      <th>primary_publication</th>
      <th>provenience</th>
      <th>pleiades_id</th>
      <th>pleiades_coord</th>
      <th>excavation_no</th>
      <th>archive</th>
      <th>atae_attribution</th>
      <th>cite_as</th>
      <th>collection</th>
      <th>composite_witness</th>
      <th>credits</th>
      <th>date_of_origin</th>
      <th>designation</th>
      <th>dialect</th>
      <th>genre</th>
      <th>has_date</th>
      <th>language</th>
      <th>last_mod_by</th>
      <th>last_modified</th>
      <th>list_name</th>
      <th>material</th>
      <th>object_type</th>
      <th>period</th>
      <th>script</th>
      <th>script_remarks</th>
      <th>script_type</th>
      <th>sealed_marked</th>
      <th>subgenre</th>
      <th>date</th>
      <th>long_date</th>
      <th>ancient_creditor</th>
      <th>ancient_debtor</th>
      <th>date_gen</th>
      <th>day</th>
      <th>long_date_gen</th>
      <th>month</th>
      <th>year</th>
      <th>eponym</th>
      <th>regnal_dates</th>
      <th>ruler</th>
      <th>ancient_buyer</th>
      <th>ancient_seller</th>
      <th>seal_mark_type</th>
      <th>seal_owner</th>
      <th>ancient_author</th>
      <th>museum-nos</th>
      <th>copies</th>
      <th>photos</th>
      <th>editions</th>
      <th>translations</th>
      <th>secondary-literatures</th>
      <th>mus_no</th>
      <th>publication_history</th>
      <th>recipient</th>
      <th>title</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>uri</th>
      <th>public</th>
      <th>images</th>
      <th>trans</th>
      <th>q_number</th>
      <th>translations-moran-1992s</th>
      <th>copy</th>
      <th>photo</th>
      <th>museum_no</th>
      <th>text_comments</th>
      <th>accession_no</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>months_recorded</th>
      <th>tablet_comments</th>
      <th>date_comments</th>
      <th>bibilography</th>
      <th>author</th>
      <th>publication_date</th>
      <th>atae_lists</th>
      <th>cdli_id</th>
      <th>cdli_museum_no</th>
      <th>ch_name</th>
      <th>ch_no</th>
      <th>ch_num_name</th>
      <th>comp_wit</th>
      <th>display_name</th>
      <th>edited_twice</th>
      <th>lka_no</th>
      <th>oracc_header</th>
      <th>other_pub</th>
      <th>please_cite</th>
      <th>proposed_date</th>
      <th>rework</th>
      <th>saa_attribution</th>
      <th>saa_cdli_id</th>
      <th>saa_cdli_museum</th>
      <th>saao_lists</th>
      <th>secondary_record</th>
      <th>short_title</th>
      <th>vol_title</th>
      <th>volume</th>
      <th>pkt_no</th>
      <th>cdli_excavation_no</th>
      <th>editorial_comments</th>
      <th>kar_no</th>
      <th>saa_cdli_excavation</th>
      <th>kav_no</th>
      <th>eponym_title</th>
      <th>dossier_list</th>
      <th>kah_no</th>
      <th>nargd_no</th>
      <th>pkta_no</th>
      <th>findspot_square</th>
      <th>gpa_no</th>
      <th>external_id</th>
      <th>temp_id</th>
      <th>tim_11_no</th>
      <th>title_in_date</th>
      <th>abl_no</th>
      <th>ancient_recipient</th>
      <th>cdli_accession_no</th>
      <th>pleiades_sender_loc</th>
      <th>saa_cdli_accession</th>
      <th>sender_loc</th>
      <th>sender_loc_coordinates</th>
      <th>ct_54_no</th>
      <th>astron_date</th>
      <th>rma_no</th>
      <th>prt_no</th>
      <th>dossier</th>
      <th>ags_no</th>
      <th>add_no</th>
      <th>ct_53_no</th>
      <th>las_no</th>
      <th>adb_no</th>
      <th>ex1</th>
      <th>ex1id</th>
      <th>ex2</th>
      <th>ex2id</th>
      <th>ex3</th>
      <th>ex3id</th>
      <th>PRN</th>
      <th>BM_ID</th>
      <th>Reg_year</th>
      <th>Reg_collection</th>
      <th>Reg_no</th>
      <th>ACQ_method</th>
      <th>ACQ_name</th>
      <th>ACQ_year</th>
      <th>BibXref</th>
      <th>Combined_no</th>
      <th>DIM_H</th>
      <th>PROV_area</th>
      <th>PROV_site</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>DIM_W</th>
      <th>S_s_s_genre</th>
      <th>Library_colophon</th>
      <th>Bib_comment</th>
      <th>BibSpec</th>
      <th>PROV_building</th>
      <th>Ruler</th>
      <th>Composition</th>
      <th>Tablet_number</th>
      <th>Recension</th>
      <th>NonLibrary_colophon</th>
      <th>Reg_part</th>
      <th>DIM_T</th>
      <th>PROV_room</th>
      <th>Mus_no</th>
      <th>ACQ_comment</th>
      <th>Historical_ID</th>
      <th>Q_no</th>
      <th>Day</th>
      <th>Month</th>
      <th>Year</th>
      <th>Emesal</th>
      <th>Script_type_2</th>
      <th>unique_ID</th>
      <th>museum_number</th>
      <th>accession_number</th>
      <th>sort_order</th>
      <th>nme_chapter</th>
      <th>object</th>
      <th>findspot</th>
      <th>museum</th>
      <th>textname</th>
      <th>bibliography</th>
      <th>Original_collection</th>
      <th>DIM_D</th>
      <th>note</th>
      <th>Mus_no_part</th>
      <th>goal_year</th>
      <th>seals_number</th>
      <th>citation</th>
      <th>subgenre_remarks</th>
      <th>published_collation</th>
      <th>period_remarks</th>
      <th>fingernails_number</th>
      <th>ctn_no</th>
      <th>nl_no</th>
      <th>BAK</th>
      <th>id_composite</th>
      <th>person</th>
      <th>project name</th>
      <th>dynastic_seat</th>
      <th>popular_name</th>
      <th>text_manu</th>
      <th>related_comp_id</th>
      <th>manu_number</th>
      <th>related_manu</th>
      <th>text_equals_manu</th>
      <th>text_remarks</th>
      <th>has-sources</th>
      <th>atf_source</th>
      <th>date_entered</th>
      <th>date_updated</th>
      <th>db_source</th>
      <th>photo_up</th>
      <th>translation_source</th>
      <th>ark_number</th>
      <th>id</th>
      <th>id_text_int</th>
      <th>stt_no</th>
      <th>seal_id</th>
      <th>object_preservation</th>
      <th>object_remarks</th>
      <th>exemplars</th>
      <th>keywords</th>
      <th>last_modified_by</th>
      <th>place</th>
      <th>series</th>
      <th>status</th>
      <th>rime_no</th>
      <th>height</th>
      <th>width</th>
      <th>cdli_composite_id</th>
      <th>created_by</th>
      <th>created_on</th>
      <th>last_modified_on</th>
      <th>other_names</th>
      <th>series_section</th>
      <th>primary_edition</th>
      <th>session</th>
      <th>pleaides_id</th>
      <th>date_remarks</th>
      <th>editor</th>
      <th>findspot_remarks</th>
      <th>funder</th>
      <th>language_remarks</th>
      <th>lemmed</th>
      <th>owner</th>
      <th>principal</th>
      <th>record_id</th>
      <th>repository</th>
      <th>translit_ed</th>
      <th>uploaded</th>
      <th>user</th>
      <th>bibliography__id_biblio</th>
      <th>bibliography__journal_title</th>
      <th>bibliography__shortref</th>
      <th>bibliography__volume_number</th>
      <th>checked</th>
      <th>photographed</th>
      <th>photographer</th>
      <th>proof-read</th>
      <th>proof-reader</th>
      <th>thickness</th>
      <th>bibliography__book_title</th>
      <th>pr_joins__pages</th>
      <th>notes</th>
      <th>provenience_remarks</th>
      <th>stratigraphic_level</th>
      <th>join_information</th>
      <th>year_name_eponym</th>
      <th>distribution</th>
      <th>sources</th>
      <th>provdist</th>
      <th>CDLI_problems</th>
      <th>bibliography__unpublished_title</th>
      <th>ark</th>
      <th>atf_up</th>
      <th>dates_referenced</th>
      <th>surface_preservation</th>
      <th>composite</th>
      <th>lineart_up</th>
      <th>seal_information</th>
      <th>google_earth_collection</th>
      <th>collection_copyright</th>
      <th>author_remarks</th>
      <th>cdli_comments</th>
      <th>acquisition_history</th>
      <th>publication</th>
      <th>ancient_date</th>
      <th>has-score</th>
      <th>last_edited_by</th>
      <th>last_edited_on</th>
      <th>bdtns_id</th>
      <th>reference</th>
      <th>Non_Sign_List_Series</th>
      <th>series_2</th>
      <th>cdli_collation</th>
      <th>condition_description</th>
      <th>tablet_number_2</th>
      <th>number</th>
      <th>tradition</th>
      <th>corpus</th>
      <th>attested</th>
      <th>electronic_publication</th>
      <th>buy_book</th>
      <th>composition_designation</th>
      <th>object_ref</th>
      <th>lemcount</th>
      <th>lemcount_total</th>
      <th>lemcount_ave</th>
      <th>text_total</th>
      <th>lemount_sd</th>
      <th>group</th>
      <th>handcopy</th>
      <th>pq_joins__external_id</th>
      <th>qcat_2__id_composite</th>
      <th>qcat_2__other_names</th>
      <th>attribution</th>
      <th>new_subgenre</th>
      <th>primary_publication2</th>
      <th>catchline</th>
      <th>colophon_describing_source</th>
      <th>colophon_disclosing_author</th>
      <th>P_number_problems</th>
      <th>royal_colophon</th>
      <th>series_tablet_no</th>
      <th>textual_colophon</th>
      <th>Additional_P_numbers</th>
      <th>exemplar_info</th>
      <th>cdli_id_numbers</th>
      <th>composite_id</th>
      <th>measurements</th>
      <th>elevation</th>
      <th>Q_designation</th>
      <th>exemplar_number</th>
      <th>findspots</th>
      <th>btto_attribution</th>
      <th>century</th>
      <th>outline_sort_name</th>
      <th>subproject</th>
      <th>modern_converted_date</th>
      <th>category_oracc</th>
      <th>place_of_writing_oracc</th>
      <th>prosobab</th>
      <th>duplicates</th>
      <th>copy_period</th>
      <th>geers_no</th>
      <th>photo_no</th>
      <th>ta_photo_no</th>
      <th>c_name</th>
      <th>c_item</th>
      <th>c_both</th>
      <th>c_num_name</th>
      <th>c_group</th>
      <th>owner_remarks</th>
      <th>special_features</th>
      <th>hand</th>
      <th>columns</th>
      <th>headings</th>
      <th>orientation</th>
      <th>axes</th>
      <th>obta_no</th>
      <th>type</th>
      <th>Delnero_no</th>
      <th>Delnero_subgenre_no</th>
      <th>deity</th>
      <th>museum_URL</th>
      <th>Delnero_remarks</th>
      <th>Cohen_balag</th>
      <th>sub_genre</th>
      <th>external_URL_name</th>
      <th>external_URL</th>
      <th>additional_P_numbers</th>
      <th>ancient_day</th>
      <th>ancient_month</th>
      <th>google_earth_provenience</th>
      <th>alternative_years</th>
      <th>old_composition_id</th>
      <th>accounting_period</th>
      <th>Q_objects</th>
      <th>Q_places</th>
      <th>parallels</th>
      <th>new_q</th>
      <th>subseries</th>
      <th>subseries_section</th>
      <th>description</th>
      <th>oracc_id</th>
      <th>sec1</th>
      <th>chap</th>
      <th>sec2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P522592</td>
      <td>0x08000000</td>
      <td>tilbarsip</td>
      <td>P522592</td>
      <td>Til-Barsip 01</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>658410.0</td>
      <td>[38.1191944, 36.6749623]</td>
      <td>T 01</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>Adapted from Stephanie Dalley, “Neo-Assyrian T...</td>
      <td>Please cite this page as http://oracc.org/atae...</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>witness</td>
      <td>Adapted from Stephanie Dalley, “Neo-Assyrian T...</td>
      <td>00.000.00.00</td>
      <td>Til-Barsip 01</td>
      <td>Neo-Assyrian</td>
      <td>Administrative Record</td>
      <td>no</td>
      <td>Akkadian</td>
      <td>ARMEP</td>
      <td>27.01.2022</td>
      <td>atae/tilbarsip:P522592</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Neo-Assyrian</td>
      <td>inscribed</td>
      <td>Cuneiform</td>
      <td>no</td>
      <td>list (rations)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P522593</td>
      <td>0x08000000</td>
      <td>tilbarsip</td>
      <td>P522593</td>
      <td>Til-Barsip 02</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>658410.0</td>
      <td>[38.1191944, 36.6749623]</td>
      <td>T 02</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>Adapted from Stephanie Dalley, “Neo-Assyrian T...</td>
      <td>Please cite this page as http://oracc.org/atae...</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>witness</td>
      <td>Adapted from Stephanie Dalley, “Neo-Assyrian T...</td>
      <td>00.000.07.00</td>
      <td>Til-Barsip 02</td>
      <td>Neo-Assyrian</td>
      <td>Legal Transaction</td>
      <td>yes, but date partially preserved</td>
      <td>Akkadian</td>
      <td>ARMEP</td>
      <td>27.01.2022</td>
      <td>atae/tilbarsip:P522593</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Neo-Assyrian</td>
      <td>inscribed</td>
      <td>Cuneiform</td>
      <td>no</td>
      <td>debt note</td>
      <td>[...]-VII-[...]</td>
      <td>Tašrītu [...th], eponymy of Ašš[ur?-...]</td>
      <td>Hanni</td>
      <td>Nabû-kin-[...]</td>
      <td>[...]-VII-[...]</td>
      <td>[...]</td>
      <td>Tašrītu ...th, [eponymy of ...]</td>
      <td>VII</td>
      <td>[...]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P522594</td>
      <td>0x08000000</td>
      <td>tilbarsip</td>
      <td>P522594</td>
      <td>Til-Barsip 03</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>658410.0</td>
      <td>[38.1191944, 36.6749623]</td>
      <td>T 03</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>Adapted from Stephanie Dalley, “Neo-Assyrian T...</td>
      <td>Please cite this page as http://oracc.org/atae...</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>witness</td>
      <td>Adapted from Stephanie Dalley, “Neo-Assyrian T...</td>
      <td>Assurbanipal.limu Bel-Harran-shaddu’a.07.01</td>
      <td>Til-Barsip 03</td>
      <td>Neo-Assyrian</td>
      <td>Legal Transaction</td>
      <td>yes</td>
      <td>Akkadian</td>
      <td>ARMEP</td>
      <td>27.01.2022</td>
      <td>atae/tilbarsip:P522594</td>
      <td>clay</td>
      <td>envelope</td>
      <td>Neo-Assyrian</td>
      <td>Neo-Assyrian</td>
      <td>inscribed</td>
      <td>Cuneiform</td>
      <td>unknown</td>
      <td>NaN</td>
      <td>650-VII-01</td>
      <td>Tašrītu 1[st], eponymy of Bēl-Harrān-šadd[û’a]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>650-VII-01</td>
      <td>01</td>
      <td>Tašrītu 1st, eponymy of Bēl-Harrān-šaddû’a</td>
      <td>VII</td>
      <td>650</td>
      <td>Bēl-Harrān-šaddû’a</td>
      <td>668–ca. 631 BC</td>
      <td>Ashurbanipal</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e608c01-a876-48e9-a04f-b018834c6c5b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e608c01-a876-48e9-a04f-b018834c6c5b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e608c01-a876-48e9-a04f-b018834c6c5b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-78206b48-a0be-4d7f-9ee5-f3b21880d9d3">
  <button class="colab-df-quickchart" onclick="quickchart('df-78206b48-a0be-4d7f-9ee5-f3b21880d9d3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-78206b48-a0be-4d7f-9ee5-f3b21880d9d3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#list(megacatalogue.columns)</span>
</pre></div>
</div>
</div>
</div>
<p>Selecting for the columns listed above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">megacatalogue_short</span> <span class="o">=</span> <span class="n">megacatalogue</span><span class="p">[[</span>
    <span class="s1">&#39;composite_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span><span class="s1">&#39;provenience&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square&#39;</span><span class="p">,</span><span class="s1">&#39;dates_referenced&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;subgenre&#39;</span><span class="p">,</span> <span class="s1">&#39;translation_source&#39;</span><span class="p">,</span>
    <span class="s1">&#39;archive&#39;</span><span class="p">,</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span><span class="s1">&#39;museum-nos&#39;</span><span class="p">,</span><span class="s1">&#39;mus_no&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no&#39;</span><span class="p">,</span><span class="s1">&#39;cdli_museum_no&#39;</span><span class="p">,</span><span class="s1">&#39;saa_cdli_museum&#39;</span><span class="p">,</span><span class="s1">&#39;Mus_no&#39;</span><span class="p">,</span><span class="s1">&#39;museum_number&#39;</span><span class="p">,</span><span class="s1">&#39;museum&#39;</span><span class="p">,</span><span class="s1">&#39;museum_URL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date_of_origin&#39;</span><span class="p">,</span> <span class="s1">&#39;dialect&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;supergenre&#39;</span><span class="p">,</span> <span class="s1">&#39;xproject&#39;</span><span class="p">,</span><span class="s1">&#39;q_number&#39;</span><span class="p">,</span> <span class="s1">&#39;ancient_year&#39;</span><span class="p">,</span> <span class="s1">&#39;date_bce&#39;</span><span class="p">,</span> <span class="s1">&#39;cdli_id&#39;</span><span class="p">,</span> <span class="s1">&#39;OBJ_type&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Period_culture&#39;</span><span class="p">,</span> <span class="s1">&#39;Script_type_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Genre&#39;</span><span class="p">,</span> <span class="s1">&#39;Subgenre&#39;</span><span class="p">,</span> <span class="s1">&#39;S_s_genre&#39;</span><span class="p">,</span><span class="s1">&#39;Language&#39;</span><span class="p">,</span> <span class="s1">&#39;Full_no&#39;</span><span class="p">,</span> <span class="s1">&#39;Tablet_number&#39;</span><span class="p">,</span> <span class="s1">&#39;Q_no&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id_composite&#39;</span><span class="p">,</span> <span class="s1">&#39;project name&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text_int&#39;</span><span class="p">,</span> <span class="s1">&#39;seal_id&#39;</span><span class="p">,</span><span class="s1">&#39;cdli_composite_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ancient_date&#39;</span><span class="p">,</span> <span class="s1">&#39;bdtns_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">megacatalogue_short</span> <span class="o">=</span> <span class="n">megacatalogue_short</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_composite&#39;</span><span class="p">:</span><span class="s1">&#39;composite_id&#39;</span><span class="p">})</span>
<span class="n">megacatalogue_short</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c08c34af-72ac-48e4-ac30-82ca0d201fc6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>id_text</th>
      <th>language</th>
      <th>material</th>
      <th>object_type</th>
      <th>period</th>
      <th>provenience</th>
      <th>excavation_no</th>
      <th>findspot_square</th>
      <th>dates_referenced</th>
      <th>genre</th>
      <th>subgenre</th>
      <th>translation_source</th>
      <th>archive</th>
      <th>collection</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>P522592</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative Record</td>
      <td>list (rations)</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>00.000.00.00</td>
      <td>Neo-Assyrian</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>P522593</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Legal Transaction</td>
      <td>debt note</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>00.000.07.00</td>
      <td>Neo-Assyrian</td>
      <td>[...]-VII-[...]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>P522594</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>envelope</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Legal Transaction</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Assurbanipal.limu Bel-Harran-shaddu’a.07.01</td>
      <td>Neo-Assyrian</td>
      <td>650-VII-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>P522595</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Legal Transaction</td>
      <td>debt note (silver)</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Assurbanipal.limu Bel-Harran-shaddu’a.07.01</td>
      <td>Neo-Assyrian</td>
      <td>650-VII-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>P522596</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 05</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Legal Transaction</td>
      <td>sales document</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>00.000.00.00</td>
      <td>Neo-Assyrian</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>171140</th>
      <td>NaN</td>
      <td>P511531</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Old Babylonian</td>
      <td>Girsu</td>
      <td>T 1483</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical cylinder seal</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AO 16821</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>171141</th>
      <td>NaN</td>
      <td>X201001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>171142</th>
      <td>NaN</td>
      <td>X201002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>171143</th>
      <td>NaN</td>
      <td>X225104</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>171144</th>
      <td>NaN</td>
      <td>X423597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>171145 rows × 51 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c08c34af-72ac-48e4-ac30-82ca0d201fc6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c08c34af-72ac-48e4-ac30-82ca0d201fc6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c08c34af-72ac-48e4-ac30-82ca0d201fc6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b627449d-38ff-4c17-9277-ccae8b99a7c4">
  <button class="colab-df-quickchart" onclick="quickchart('df-b627449d-38ff-4c17-9277-ccae8b99a7c4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b627449d-38ff-4c17-9277-ccae8b99a7c4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Exports megacatalogue_short to the folder ORACC_DFS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">megacatalogue_short</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/megacatalogue_short.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>#Working with the CDLI catalogue</p>
<p>This section is loosely based off this <a class="reference external" href="https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing">notebook</a>.</p>
<p>In this section we will convert the <a class="reference external" href="https://media.githubusercontent.com/media/cdli-gh/data/master/cdli_cat.csv">cdli_cat.csv</a> into a smaller dataframe called cdli_cat_short that contains only the following useful columns:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* Language
* Material
* Museum
* Provenience
* Object type
* Genre
* Period
* Date
</pre></div>
</div>
<p>Using this limited version of the cdli catalogue, we can draw comparisons with the oracc data.</p>
<p>Reading in the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://media.githubusercontent.com/media/cdli-gh/data/master/cdli_cat.csv&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-44338022-f775-4ebe-850b-e638fefa7b60" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>accession_no</th>
      <th>accounting_period</th>
      <th>acquisition_history</th>
      <th>alternative_years</th>
      <th>ark_number</th>
      <th>atf_source</th>
      <th>atf_up</th>
      <th>author</th>
      <th>author_remarks</th>
      <th>cdli_collation</th>
      <th>cdli_comments</th>
      <th>citation</th>
      <th>collection</th>
      <th>composite_id</th>
      <th>condition_description</th>
      <th>date_entered</th>
      <th>date_of_origin</th>
      <th>date_remarks</th>
      <th>date_updated</th>
      <th>dates_referenced</th>
      <th>db_source</th>
      <th>designation</th>
      <th>dumb</th>
      <th>dumb2</th>
      <th>electronic_publication</th>
      <th>elevation</th>
      <th>excavation_no</th>
      <th>external_id</th>
      <th>findspot_remarks</th>
      <th>findspot_square</th>
      <th>genre</th>
      <th>google_earth_collection</th>
      <th>google_earth_provenience</th>
      <th>height</th>
      <th>id</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>join_information</th>
      <th>language</th>
      <th>lineart_up</th>
      <th>material</th>
      <th>museum_no</th>
      <th>object_preservation</th>
      <th>object_type</th>
      <th>period</th>
      <th>period_remarks</th>
      <th>photo_up</th>
      <th>primary_publication</th>
      <th>provenience</th>
      <th>provenience_remarks</th>
      <th>publication_date</th>
      <th>publication_history</th>
      <th>published_collation</th>
      <th>seal_id</th>
      <th>seal_information</th>
      <th>stratigraphic_level</th>
      <th>subgenre</th>
      <th>subgenre_remarks</th>
      <th>surface_preservation</th>
      <th>text_remarks</th>
      <th>thickness</th>
      <th>translation_source</th>
      <th>width</th>
      <th>object_remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21198/zz001q0dtm</td>
      <td>Englund, Robert K.</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>31x61x18; Lú A 14-16.30-32.48-50; M XVIII, auf...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q000002</td>
      <td>NaN</td>
      <td>12/4/2001</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>2020-03-14</td>
      <td>00.00.00.00</td>
      <td>20011204 protocuneiform_catalogue</td>
      <td>CDLI Lexical 000002, ex. 065</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>auf Hügeloberfläche in der Nähe des Südbaues</td>
      <td>M XVIII,?</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>150ppi 20160630</td>
      <td>clay</td>
      <td>VAT 01533</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI Lexical 000002, ex. 065</td>
      <td>Uruk (mod. Warka)</td>
      <td>NaN</td>
      <td>2015ff.</td>
      <td>Englund, Robert K. &amp; Nissen, Hans J., ATU 3 (1...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18</td>
      <td>no translation</td>
      <td>61</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21198/zz001q0dv4</td>
      <td>Englund, Robert K.</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>30x48x13; Lú A 13-15.23-25.?; Fundstelle wie W...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q000002</td>
      <td>NaN</td>
      <td>12/4/2001</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>2018-10-20</td>
      <td>00.00.00.00</td>
      <td>20011204 protocuneiform_catalogue</td>
      <td>CDLI Lexical 000002, ex. 066</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>auf der Hügeloberfläche in der Nähe des Südbaues</td>
      <td>M XVIII,?</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>150ppi 20160630</td>
      <td>clay</td>
      <td>VAT 15263</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI Lexical 000002, ex. 066</td>
      <td>Uruk (mod. Warka)</td>
      <td>NaN</td>
      <td>2015ff.</td>
      <td>Englund, Robert K. &amp; Nissen, Hans J., ATU 3 (1...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13</td>
      <td>no translation</td>
      <td>48</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21198/zz001q0dwn</td>
      <td>Englund, Robert K.</td>
      <td>NaN</td>
      <td>Englund, Robert K. &amp; Nissen, Hans J.</td>
      <td>42x53x19; Vocabulary 9; Qa XVI,2, unter der Ab...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12/4/2001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2020-01-26</td>
      <td>NaN</td>
      <td>20011204 protocuneiform_catalogue</td>
      <td>ATU 3, pl. 081, W 9123,d</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>unter der Abgleichung der Schicht III, 1,5 m ü...</td>
      <td>Qa XVI,2</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>42</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>150ppi 20160630</td>
      <td>clay</td>
      <td>VAT 15253</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ATU 3, pl. 081, W 9123,d</td>
      <td>Uruk (mod. Warka)</td>
      <td>NaN</td>
      <td>1993</td>
      <td>ATU 1, 539</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>Text category: 15-09; Foreign ID: LVO 9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19</td>
      <td>no translation</td>
      <td>53</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-44338022-f775-4ebe-850b-e638fefa7b60')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-44338022-f775-4ebe-850b-e638fefa7b60 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-44338022-f775-4ebe-850b-e638fefa7b60');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9e9a15e7-7507-4281-b023-c1acea462935">
  <button class="colab-df-quickchart" onclick="quickchart('df-9e9a15e7-7507-4281-b023-c1acea462935')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9e9a15e7-7507-4281-b023-c1acea462935 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Create a subset of the cdli catalogue named ‘data’ with the columns of interest</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#list(data.columns)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cdli_cat_short</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;composite_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text2&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="s1">&#39;museum_no&#39;</span><span class="p">,</span><span class="s1">&#39;provenience&#39;</span><span class="p">,</span> <span class="s1">&#39;excavation_no&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square&#39;</span><span class="p">,</span><span class="s1">&#39;date_of_origin&#39;</span><span class="p">,</span>
       <span class="s1">&#39;dates_referenced&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;subgenre&#39;</span><span class="p">,</span> <span class="s1">&#39;translation_source&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">cdli_cat_short</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f58dbaa3-e183-4543-88be-cebe9225a900" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language</th>
      <th>object_type</th>
      <th>period</th>
      <th>material</th>
      <th>collection</th>
      <th>museum_no</th>
      <th>provenience</th>
      <th>excavation_no</th>
      <th>findspot_square</th>
      <th>date_of_origin</th>
      <th>dates_referenced</th>
      <th>genre</th>
      <th>subgenre</th>
      <th>translation_source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0</td>
      <td>1</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0</td>
      <td>2</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>0</td>
      <td>3</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q000002</td>
      <td>0</td>
      <td>4</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15168</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09169,d</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q000002</td>
      <td>0</td>
      <td>5</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15153</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09206,k</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>353278</th>
      <td></td>
      <td>0</td>
      <td>532443</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>clay</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>IM —</td>
      <td>Marad (mod. Wanna-wa-Sadum)</td>
      <td>Marad 047</td>
      <td></td>
      <td></td>
      <td></td>
      <td>Legal</td>
      <td></td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>353279</th>
      <td></td>
      <td>0</td>
      <td>532444</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>clay</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>IM —</td>
      <td></td>
      <td>TA 2100</td>
      <td></td>
      <td></td>
      <td></td>
      <td>Administrative</td>
      <td></td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>353280</th>
      <td></td>
      <td>0</td>
      <td>532445</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>clay</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>IM —</td>
      <td></td>
      <td>TA 2101</td>
      <td></td>
      <td></td>
      <td></td>
      <td>Administrative</td>
      <td></td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>353281</th>
      <td></td>
      <td>0</td>
      <td>532446</td>
      <td>Akkadian</td>
      <td>tablet &amp; envelope</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>clay</td>
      <td>private: William T. Grant Jr., Pelham Manor, N...</td>
      <td>Grant 17</td>
      <td>Larsa (mod. Tell as-Senkereh)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Legal</td>
      <td></td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>353282</th>
      <td></td>
      <td>0</td>
      <td>532447</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Harvard Museum of the Ancient Near East, Harva...</td>
      <td>SM 1911.10.379</td>
      <td>Puzriš-Dagan (mod. Drehem)</td>
      <td></td>
      <td></td>
      <td>Amar-Suen.08.08.10</td>
      <td>Amar-Suen.08.08.10</td>
      <td>Administrative</td>
      <td></td>
      <td>no translation</td>
    </tr>
  </tbody>
</table>
<p>353283 rows × 17 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f58dbaa3-e183-4543-88be-cebe9225a900')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f58dbaa3-e183-4543-88be-cebe9225a900 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f58dbaa3-e183-4543-88be-cebe9225a900');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-35364d4f-36ec-462a-8080-45156b831c87">
  <button class="colab-df-quickchart" onclick="quickchart('df-35364d4f-36ec-462a-8080-45156b831c87')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-35364d4f-36ec-462a-8080-45156b831c87 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Exports cdli_cat_short to the folder ORACC_DFS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cdli_cat_short</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/cdli_cat_short.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>#Creating the Metacatalogue</p>
<p>Using the CDLI shortened catalogue and the ORACC shortened catalogue, we can create a Metacatalogue- a combination of both catalogues.</p>
<p>The following codecell allows for importing the megacatalogue short and cdli cat short to run the following cells independently of the first half of this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#cshortpath = &#39;/content/drive/MyDrive/FactGrid Cuneiform (AWCA)/people/Melinee/ORACC_DFS/cdli_cat_short.csv&#39;</span>
<span class="c1">#mshortpath = &#39;/content/drive/MyDrive/FactGrid Cuneiform (AWCA)/people/Melinee/ORACC_DFS/megacatalogue_short.csv&#39;</span>
<span class="n">cshortpath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/cdli_cat_short.csv&#39;</span>
<span class="n">mshortpath</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/megacatalogue_short.csv&#39;</span>
<span class="n">cdli_cat_short</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cshortpath</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">megacatalogue_short</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">mshortpath</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cdli_cat_short</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">cdli_cat_short</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(353283, 17)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-f1274c17-5a6d-4ec3-84c1-cee022819de7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language</th>
      <th>object_type</th>
      <th>period</th>
      <th>material</th>
      <th>collection</th>
      <th>museum_no</th>
      <th>provenience</th>
      <th>excavation_no</th>
      <th>findspot_square</th>
      <th>date_of_origin</th>
      <th>dates_referenced</th>
      <th>genre</th>
      <th>subgenre</th>
      <th>translation_source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0</td>
      <td>1</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0</td>
      <td>2</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0</td>
      <td>3</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f1274c17-5a6d-4ec3-84c1-cee022819de7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f1274c17-5a6d-4ec3-84c1-cee022819de7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f1274c17-5a6d-4ec3-84c1-cee022819de7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b7fab316-c7a1-4072-a9f7-49f17a809874">
  <button class="colab-df-quickchart" onclick="quickchart('df-b7fab316-c7a1-4072-a9f7-49f17a809874')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b7fab316-c7a1-4072-a9f7-49f17a809874 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Changing the column ‘id_text’ to be in the form P+6 numbers in order to match with the ORACC ids</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cdli_cat_short</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">cdli_cat_short</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>
<span class="n">cdli_cat_short</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c0284518-168e-4a35-98ff-db3c40804fde" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language</th>
      <th>object_type</th>
      <th>period</th>
      <th>material</th>
      <th>collection</th>
      <th>museum_no</th>
      <th>provenience</th>
      <th>excavation_no</th>
      <th>findspot_square</th>
      <th>date_of_origin</th>
      <th>dates_referenced</th>
      <th>genre</th>
      <th>subgenre</th>
      <th>translation_source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0</td>
      <td>P000001</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0</td>
      <td>P000002</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0</td>
      <td>P000003</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c0284518-168e-4a35-98ff-db3c40804fde')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c0284518-168e-4a35-98ff-db3c40804fde button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c0284518-168e-4a35-98ff-db3c40804fde');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6459f620-e0c0-4cb4-8444-4319cae0dc66">
  <button class="colab-df-quickchart" onclick="quickchart('df-6459f620-e0c0-4cb4-8444-4319cae0dc66')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6459f620-e0c0-4cb4-8444-4319cae0dc66 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">megacatalogue_short</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">megacatalogue_short</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(171145, 51)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-1886f09b-865b-412e-95b3-672a59d448f0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>id_text</th>
      <th>language</th>
      <th>material</th>
      <th>object_type</th>
      <th>period</th>
      <th>provenience</th>
      <th>excavation_no</th>
      <th>findspot_square</th>
      <th>dates_referenced</th>
      <th>genre</th>
      <th>subgenre</th>
      <th>translation_source</th>
      <th>archive</th>
      <th>collection</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>P522592</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative Record</td>
      <td>list (rations)</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>00.000.00.00</td>
      <td>Neo-Assyrian</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>P522593</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Legal Transaction</td>
      <td>debt note</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>00.000.07.00</td>
      <td>Neo-Assyrian</td>
      <td>[...]-VII-[...]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>P522594</td>
      <td>Akkadian</td>
      <td>clay</td>
      <td>envelope</td>
      <td>Neo-Assyrian</td>
      <td>Tell Ahmar (Til Barsip)</td>
      <td>T 03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Legal Transaction</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>001 -  Hanni Archive (House C1)</td>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Assurbanipal.limu Bel-Harran-shaddu’a.07.01</td>
      <td>Neo-Assyrian</td>
      <td>650-VII-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>adsd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1886f09b-865b-412e-95b3-672a59d448f0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1886f09b-865b-412e-95b3-672a59d448f0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1886f09b-865b-412e-95b3-672a59d448f0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-55a0af48-974d-43a0-bbda-9acb24115547">
  <button class="colab-df-quickchart" onclick="quickchart('df-55a0af48-974d-43a0-bbda-9acb24115547')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-55a0af48-974d-43a0-bbda-9acb24115547 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Creation of the Metacatalogue</p>
<p>This dataframe merges the cdli_cat_short and megacatalogue_short DFs based on the “id_text” column. It contains the rows where id_text matches and doesnt match. Any column marked as column_x belongs to the CDLI catalogue and any column marked as column_y belongs to the ORACC catalogue.</p>
<p>Note</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metacatalogue</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cdli_cat_short</span><span class="p">,</span> <span class="n">megacatalogue_short</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">metacatalogue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6b458bff-dbb6-4306-b8e4-cf44a8dcb456" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000001</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000002</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000003</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000004</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15168</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09169,d</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000005</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15153</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09206,k</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>X096677</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/earlylit</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>X201001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>X201002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>X225104</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>X423597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 67 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6b458bff-dbb6-4306-b8e4-cf44a8dcb456')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6b458bff-dbb6-4306-b8e4-cf44a8dcb456 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6b458bff-dbb6-4306-b8e4-cf44a8dcb456');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8713babf-3aa7-4654-ac8d-13c78ddf107f">
  <button class="colab-df-quickchart" onclick="quickchart('df-8713babf-3aa7-4654-ac8d-13c78ddf107f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8713babf-3aa7-4654-ac8d-13c78ddf107f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Export the metacatalogue</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metacatalogue</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/metacatalogue.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>##Comparisons between matching CDLI and ORACC headers</p>
<p>One thing we can do is to place like-columns from each dataframe side by side. By reformatting the metacatalogue in this way, it may make columns easier to compare at a glance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metacatalogue_sorted</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text2&#39;</span><span class="p">,</span><span class="s1">&#39;composite_id_x&#39;</span><span class="p">,</span> <span class="s1">&#39;composite_id_y&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">,</span> <span class="s1">&#39;language_y&#39;</span><span class="p">,</span> <span class="s1">&#39;material_x&#39;</span><span class="p">,</span> <span class="s1">&#39;material_y&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_x&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_y&#39;</span><span class="p">,</span>
    <span class="s1">&#39;period_x&#39;</span><span class="p">,</span> <span class="s1">&#39;period_y&#39;</span><span class="p">,</span> <span class="s1">&#39;dates_referenced_x&#39;</span><span class="p">,</span> <span class="s1">&#39;dates_referenced_y&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_x&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_y&#39;</span><span class="p">,</span> <span class="s1">&#39;subgenre_x&#39;</span><span class="p">,</span> <span class="s1">&#39;subgenre_y&#39;</span><span class="p">,</span> <span class="s1">&#39;translation_source_x&#39;</span><span class="p">,</span> <span class="s1">&#39;translation_source_y&#39;</span><span class="p">,</span> <span class="s1">&#39;provenience_x&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date_of_origin_x&#39;</span><span class="p">,</span> <span class="s1">&#39;date_of_origin_y&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no_x&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no_y&#39;</span><span class="p">,</span><span class="s1">&#39;collection_x&#39;</span><span class="p">,</span><span class="s1">&#39;collection_y&#39;</span><span class="p">,</span><span class="s1">&#39;dialect&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;supergenre&#39;</span><span class="p">,</span> <span class="s1">&#39;xproject&#39;</span><span class="p">,</span><span class="s1">&#39;q_number&#39;</span><span class="p">,</span> <span class="s1">&#39;ancient_year&#39;</span><span class="p">,</span> <span class="s1">&#39;date_bce&#39;</span><span class="p">,</span> <span class="s1">&#39;cdli_id&#39;</span><span class="p">,</span> <span class="s1">&#39;OBJ_type&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Period_culture&#39;</span><span class="p">,</span> <span class="s1">&#39;Script_type_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Genre&#39;</span><span class="p">,</span> <span class="s1">&#39;Subgenre&#39;</span><span class="p">,</span> <span class="s1">&#39;S_s_genre&#39;</span><span class="p">,</span><span class="s1">&#39;Language&#39;</span><span class="p">,</span> <span class="s1">&#39;Full_no&#39;</span><span class="p">,</span> <span class="s1">&#39;Tablet_number&#39;</span><span class="p">,</span> <span class="s1">&#39;Q_no&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;project name&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text_int&#39;</span><span class="p">,</span> <span class="s1">&#39;seal_id&#39;</span><span class="p">,</span><span class="s1">&#39;cdli_composite_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ancient_date&#39;</span><span class="p">,</span> <span class="s1">&#39;bdtns_id&#39;</span><span class="p">]]</span>

<span class="c1">#print(metacatalogue_sorted.shape)</span>
<span class="n">metacatalogue_sorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-16d5304a-9556-48e4-adec-b460bb71a2dc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>id_text2</th>
      <th>composite_id_x</th>
      <th>composite_id_y</th>
      <th>language_x</th>
      <th>language_y</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>object_type_x</th>
      <th>object_type_y</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>dates_referenced_x</th>
      <th>dates_referenced_y</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>subgenre_x</th>
      <th>subgenre_y</th>
      <th>translation_source_x</th>
      <th>translation_source_y</th>
      <th>provenience_x</th>
      <th>provenience_y</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>date_of_origin_x</th>
      <th>date_of_origin_y</th>
      <th>museum_no_x</th>
      <th>museum_no_y</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>0.0</td>
      <td>Q000002</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>clay</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>VAT 01533</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>0.0</td>
      <td>Q000002</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>clay</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>VAT 15263</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>clay</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>VAT 15253</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>0.0</td>
      <td>Q000002</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>clay</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>VAT 15168</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>0.0</td>
      <td>Q000002</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>clay</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>00.00.00.00</td>
      <td>NaN</td>
      <td>VAT 15153</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/earlylit</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>epsd2/admin/oldbab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 57 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-16d5304a-9556-48e4-adec-b460bb71a2dc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-16d5304a-9556-48e4-adec-b460bb71a2dc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-16d5304a-9556-48e4-adec-b460bb71a2dc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-45fd693d-88f0-4350-a13a-efbfbc2a7674">
  <button class="colab-df-quickchart" onclick="quickchart('df-45fd693d-88f0-4350-a13a-efbfbc2a7674')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-45fd693d-88f0-4350-a13a-efbfbc2a7674 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;composite_id&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span><span class="s1">&#39;dates_referenced&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;subgenre&#39;</span><span class="p">,</span> <span class="s1">&#39;translation_source&#39;</span><span class="p">,</span> <span class="s1">&#39;provenience&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square&#39;</span><span class="p">,</span><span class="s1">&#39;date_of_origin&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no&#39;</span><span class="p">,</span><span class="s1">&#39;collection&#39;</span><span class="p">]:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="s1">&#39; has &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">metacatalogue</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39; matches.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>composite_id has 0 matches.
language has 118158 matches.
material has 38616 matches.
object_type has 55576 matches.
period has 27 matches.
dates_referenced has 822 matches.
genre has 103568 matches.
subgenre has 13825 matches.
translation_source has 356 matches.
provenience has 1032 matches.
excavation_no has 8008 matches.
findspot_square has 651 matches.
date_of_origin has 8299 matches.
museum_no has 59600 matches.
collection has 38805 matches.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(metacatalogue[&#39;language_x&#39;].value_counts())</span>
<span class="c1">#print()</span>
<span class="c1">#print(metacatalogue[&#39;language_y&#39;].value_counts())</span>
</pre></div>
</div>
</div>
</div>
<p>As we can see, there are no perfectly overlapping columns for CDLI and ORACC.</p>
<section id="subsets-based-on-object-type">
<h2>Subsets based on Object Type<a class="headerlink" href="#subsets-based-on-object-type" title="Link to this heading">#</a></h2>
<p>This section will have a heavier emphasis on tablet, envelope and cone objects.</p>
<p>As a note, I think there are some incentives to keeping the CDLI and ORACC object type information separate from each other (object_type_x,object_type_y) so we can have a better idea of how each text was catalogued.</p>
<p><strong>Understanding the Code Below:</strong></p>
<p>Despite reasons to keep the object type columns separate, an alternate column (object_type_both) can be made by joining the string content of each column together to make quering through the metacatalogue easier. <em>This can be done for other columns with similar data information (e.g. period, language, …)</em></p>
<p>In order to get the subset of the DF, we can look at if the object type column contains partial strings like ‘ablet’, ‘nvelope’, and ‘one’. (This is shortcut way of not accounting for upper or lowercase starts to the words tablet, envelope, and cone.)</p>
<p>As we’ll see, the ORACC descriptions are either more descriptive (e.g. ‘Envelope - Closed’) or confusing (e.g. ‘brick, stone block, tablet, door socket, cone’).</p>
<p>One can query through to find just tables, just envelopes, and just cones as seen in a following code cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Run this cell to look at all types of objects presented from each catalogue in the metacatalogue</span>
<span class="c1">#print(metacatalogue[&#39;object_type_x&#39;].unique())</span>
<span class="c1">#print(metacatalogue[&#39;object_type_y&#39;].unique())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_both&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_both&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;ablet|nvelope|one&quot;</span><span class="p">)</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
<span class="n">subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-13c842d4-992e-4cc2-a1a8-6efa75b86c06" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
      <th>object_type_both</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000001</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000002</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000003</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000004</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15168</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09169,d</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000005</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15153</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09206,k</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>352907</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P532071</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>clay</td>
      <td>National Museum of Syria, Damascus, Syria ?</td>
      <td>NaN</td>
      <td>Kahat (mod. Tell Barri)</td>
      <td>K21.E.3386</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Middle Assyrian</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Middle Assyrian</td>
      <td>Kahat (Mod. Tell Barri)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Note</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>K21.E.3386</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tcma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>352908</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P532072</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>clay</td>
      <td>National Museum of Syria, Damascus, Syria ?</td>
      <td>NaN</td>
      <td>Kahat (mod. Tell Barri)</td>
      <td>K9.T1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Letter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Middle Assyrian</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Middle Assyrian</td>
      <td>Kahat (Mod. Tell Barri)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Letter order</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>K9.T1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tcma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>352909</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P532073</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>clay</td>
      <td>National Museum of Syria, Damascus, Syria ?</td>
      <td>NaN</td>
      <td>Kahat (mod. Tell Barri)</td>
      <td>K9.T2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Letter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Middle Assyrian</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Middle Assyrian</td>
      <td>Kahat (Mod. Tell Barri)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical List</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>K9.T2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tcma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>352910</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P532074</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>clay</td>
      <td>National Museum of Syria, Damascus, Syria ?</td>
      <td>NaN</td>
      <td>Kahat (mod. Tell Barri)</td>
      <td>K9.T3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Middle Assyrian</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Middle Assyrian</td>
      <td>Kahat (Mod. Tell Barri)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>List</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>K9.T3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tcma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
    <tr>
      <th>352911</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P532075</td>
      <td>Akkadian</td>
      <td>tablet</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>clay</td>
      <td>British Museum, London, UK</td>
      <td>BM 120122</td>
      <td>Assur (mod. Qalat Sherqat)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Scientific</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Middle Assyrian</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>Middle Assyrian</td>
      <td>Aššur (mod. Qalʿat Sherqat)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Hippology</td>
      <td>NaN</td>
      <td>M 02 Archive</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>BM 120122</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tcma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>tablet, tablet</td>
    </tr>
  </tbody>
</table>
<p>107753 rows × 68 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-13c842d4-992e-4cc2-a1a8-6efa75b86c06')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-13c842d4-992e-4cc2-a1a8-6efa75b86c06 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-13c842d4-992e-4cc2-a1a8-6efa75b86c06');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-984f7294-40ed-478c-9785-ce785ec446f9">
  <button class="colab-df-quickchart" onclick="quickchart('df-984f7294-40ed-478c-9785-ce785ec446f9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-984f7294-40ed-478c-9785-ce785ec446f9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_bcb04a16-a3d3-452f-a25b-fe23be605aa5">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('subset')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_bcb04a16-a3d3-452f-a25b-fe23be605aa5 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('subset');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<p>To query the metacatalogue for a specific object type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metacatalogue</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_both&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;object_of_interest&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
<p>For example here’s a subset of the metacatalogue for objects that are marked as a type of seal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">subset_seal</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_both&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;seal|Seal&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
<span class="n">subset_seal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0cabeb83-9470-4c13-9ce5-b051286d2f44" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
      <th>object_type_both</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9024</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P100295</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>private: Böllinger, Endorf, Germany</td>
      <td>Böllinger 6</td>
      <td>uncertain (mod. uncertain)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>--.--.00.00</td>
      <td>--.--.00.00</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Cylinder Seal</td>
      <td>Ur III</td>
      <td>unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Boellinger 6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0000 - 00 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18056.0</td>
      <td>tablet, Cylinder Seal</td>
    </tr>
    <tr>
      <th>24607</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P115924</td>
      <td>Sumerian</td>
      <td>sealing</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Bibliothèque de Versailles, Versailles, France</td>
      <td>BV 19</td>
      <td>Umma (mod. Tell Jokha)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Label</td>
      <td>Ur III</td>
      <td>Umma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>BV 19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0000 - 00 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23252.0</td>
      <td>sealing, Label</td>
    </tr>
    <tr>
      <th>32007</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P123204</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A—</td>
      <td>Ešnunna (mod. Tell Asmar)</td>
      <td>TA 1930 0277</td>
      <td>NaN</td>
      <td>Šulgi.--.00.00</td>
      <td>Šulgi.--.00.00</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Clay sealing</td>
      <td>Ur III</td>
      <td>Ešnunna</td>
      <td>TA 1930 0277</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0000 - 00 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12191.0</td>
      <td>tablet, Clay sealing</td>
    </tr>
    <tr>
      <th>32008</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P123205</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A—</td>
      <td>Ešnunna (mod. Tell Asmar)</td>
      <td>TA 1931 0320</td>
      <td>NaN</td>
      <td>Amar-Sin.--.00.00</td>
      <td>Amar-Sin.--.00.00</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Clay sealing</td>
      <td>Ur III</td>
      <td>Ešnunna</td>
      <td>TA 1931 0320</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal Inscription</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0000 - 00 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIT</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12192.0</td>
      <td>tablet, Clay sealing</td>
    </tr>
    <tr>
      <th>32010</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P123207</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A—</td>
      <td>Ešnunna (mod. Tell Asmar)</td>
      <td>TA 1931 0379</td>
      <td>NaN</td>
      <td>--.--.00.00</td>
      <td>--.--.00.00</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Clay sealing</td>
      <td>Ur III</td>
      <td>Ešnunna</td>
      <td>TA 1931 0379</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0000 - 00 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12194.0</td>
      <td>tablet, Clay sealing</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>343013</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P522007</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>stone ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Ur III</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>seal (not impression), seal (not impression)</td>
    </tr>
    <tr>
      <th>343014</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P522008</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>stone ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Ur III</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>seal (not impression), seal (not impression)</td>
    </tr>
    <tr>
      <th>343015</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P522009</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>stone ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Ur III</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>seal (not impression), seal (not impression)</td>
    </tr>
    <tr>
      <th>343016</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P522010</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>stone ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Umma (mod. Tell Jokha)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Ur III</td>
      <td>Umma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>seal (not impression), seal (not impression)</td>
    </tr>
    <tr>
      <th>343017</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P522011</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>stone ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Ur III</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>seal (not impression), seal (not impression)</td>
    </tr>
  </tbody>
</table>
<p>6472 rows × 68 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0cabeb83-9470-4c13-9ce5-b051286d2f44')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0cabeb83-9470-4c13-9ce5-b051286d2f44 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0cabeb83-9470-4c13-9ce5-b051286d2f44');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0253dcbb-71a8-4ceb-9ed0-5cf6c3d638ff">
  <button class="colab-df-quickchart" onclick="quickchart('df-0253dcbb-71a8-4ceb-9ed0-5cf6c3d638ff')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0253dcbb-71a8-4ceb-9ed0-5cf6c3d638ff button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_959e9c2e-3488-4fb2-9a40-3b2c5448b372">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('subset_seal')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_959e9c2e-3488-4fb2-9a40-3b2c5448b372 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('subset_seal');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<p>#Fitting Proper FactGrid Headers
Adapted from the <a class="reference external" href="https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing">cdli_cat.ipynb</a> notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#import metacatalogue</span>
<span class="n">metacatalogue</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/metacatalogue.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="language-language-p18-uncertainty-p155">
<h2>1 Language = Language (P18) + uncertainty (P155)<a class="headerlink" href="#language-language-p18-uncertainty-p155" title="Link to this heading">#</a></h2>
<p>For reference, let’s start with the languages listed in the CDLI catalog.
In order to avoid adding question marks to these language items, we use the statement ‘how sure is this’ <a class="reference external" href="https://database.factgrid.de/wiki/Property:P155">P155</a>, that logs the language item as ‘questionable, not settled, ?’ <a class="reference external" href="https://database.factgrid.de/wiki/Item:Q160240">Q160240</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lang_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Language%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">lang_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># drop the first row that is empty</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:]</span>
<span class="c1"># drop the sequence column</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sequence&#39;</span><span class="p">])</span>
<span class="c1"># fill na values with space</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span>
<span class="c1"># use only rows with a QID</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;FG_item&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">lang_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9ed88dce-6218-41ae-8a7d-c73d8feb8332" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Parent</th>
      <th>Language</th>
      <th>FG_item</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Elamite</td>
      <td>Elamite</td>
      <td>Q500430</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>Hurrian</td>
      <td>Hurrian</td>
      <td>Q512052</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>Hittite</td>
      <td>Hittite</td>
      <td>Q500429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14</td>
      <td>Hittite</td>
      <td>Hittite Logographic</td>
      <td>Q500429</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15</td>
      <td>Ugaritic</td>
      <td>Ugaritic</td>
      <td>Q500431</td>
    </tr>
    <tr>
      <th>5</th>
      <td>17</td>
      <td>Arabic</td>
      <td>Arabic</td>
      <td>Q389598</td>
    </tr>
    <tr>
      <th>6</th>
      <td>18</td>
      <td>Aramaic</td>
      <td>Aramaic</td>
      <td>Q393615</td>
    </tr>
    <tr>
      <th>7</th>
      <td>19</td>
      <td>Akkadian</td>
      <td>Eblaite</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>Greek</td>
      <td>Greek</td>
      <td>Q172951</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21</td>
      <td>Hebrew</td>
      <td>Hebrew</td>
      <td>Q389600</td>
    </tr>
    <tr>
      <th>10</th>
      <td>22</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>11</th>
      <td>23</td>
      <td>Akkadian</td>
      <td>Late Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>12</th>
      <td>24</td>
      <td>Akkadian</td>
      <td>Early Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25</td>
      <td>Akkadian</td>
      <td>Middle Assyrian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>Akkadian</td>
      <td>Middle Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>15</th>
      <td>27</td>
      <td>Akkadian</td>
      <td>Middle Babylonian peripheral</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>16</th>
      <td>28</td>
      <td>Akkadian</td>
      <td>Neo-Assyrian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>17</th>
      <td>29</td>
      <td>Akkadian</td>
      <td>Neo-Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>18</th>
      <td>30</td>
      <td>Akkadian</td>
      <td>Old Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>19</th>
      <td>31</td>
      <td>Akkadian</td>
      <td>Old Assyrian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>20</th>
      <td>32</td>
      <td>Akkadian</td>
      <td>Old Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>21</th>
      <td>33</td>
      <td>Akkadian</td>
      <td>Old Babylonian peripheral</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>22</th>
      <td>34</td>
      <td>Akkadian</td>
      <td>Ur III Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>23</th>
      <td>35</td>
      <td>Akkadian</td>
      <td>Standard Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>24</th>
      <td>36</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
    </tr>
    <tr>
      <th>25</th>
      <td>39</td>
      <td>Sumerian</td>
      <td>Udgalnun</td>
      <td>Q471149</td>
    </tr>
    <tr>
      <th>26</th>
      <td>40</td>
      <td>Sumerian</td>
      <td>Emesal</td>
      <td>Q471149</td>
    </tr>
    <tr>
      <th>27</th>
      <td>41</td>
      <td>Sumerian</td>
      <td>Syllabic</td>
      <td>Q471149</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9ed88dce-6218-41ae-8a7d-c73d8feb8332')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9ed88dce-6218-41ae-8a7d-c73d8feb8332 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9ed88dce-6218-41ae-8a7d-c73d8feb8332');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f8fe3d5b-cf98-449c-8299-f59f2aee64e4">
  <button class="colab-df-quickchart" onclick="quickchart('df-f8fe3d5b-cf98-449c-8299-f59f2aee64e4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f8fe3d5b-cf98-449c-8299-f59f2aee64e4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id">
<h3>1.1 Starting with the CDLI languages, we can match unique languages to their FG language id<a class="headerlink" href="#starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">language_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">]]</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c870fd9f-5262-4844-b232-f16f6df30edd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>language_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c870fd9f-5262-4844-b232-f16f6df30edd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c870fd9f-5262-4844-b232-f16f6df30edd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c870fd9f-5262-4844-b232-f16f6df30edd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-78a31662-022b-43e7-9690-67a8b5fe4232">
  <button class="colab-df-quickchart" onclick="quickchart('df-78a31662-022b-43e7-9690-67a8b5fe4232')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-78a31662-022b-43e7-9690-67a8b5fe4232 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">langx</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span>

<span class="c1">#drop clay from langx because that is not a language</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;clay&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># there are two different entries of NA, merge them into one</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># remove the &#39;\x0b&#39; patterns</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x0b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">langx</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">langx</span><span class="p">))])]</span>

<span class="n">langx</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;undetermined&#39;, &#39;Sumerian&#39;, &#39;Sumerian ?&#39;, &#39;Akkadian&#39;, nan,
       &#39;Sumerian; Akkadian&#39;, &#39;Elamite&#39;, &#39;Akkadian; Elamite&#39;, &#39;Hurrian&#39;,
       &#39;Akkadian ?&#39;, &#39;Eblaite&#39;, &#39;Akkadian; Elamite; Persian; Egyptian ?&#39;,
       &#39;\x0b&#39;, &#39;Ugaritic&#39;, &#39;undetermined (pseudo)&#39;, &#39;Aramaic&#39;,
       &#39;Sumerian; Akkadian (pseudo)&#39;, &#39;no linguistic content&#39;,
       &#39;Akkadian; Persian; Elamite; Egyptian &#39;, &#39;Hebrew&#39;, &#39;Aramaic ?&#39;,
       &#39;Akkadian; Aramaic&#39;, &#39;Hebrew ?&#39;, &#39;Greek&#39;, &#39;Phoenician&#39;, &#39;Sabaean&#39;,
       &#39;Hittite&#39;, &#39;Akkadian; Egyptian&#39;, &#39;Hurrian ?&#39;, &#39;Qatabanian&#39;,
       &#39;uncertain&#39;, &#39;Persian&#39;, &#39;Hittite ?&#39;, &#39;Hittite; Hattic&#39;, &#39;Syriac&#39;,
       &#39;Mandaic&#39;, &#39;Hittite; Hurrian&#39;, &#39;uninscribed&#39;, &#39;Akkadian\x0b&#39;,
       &#39;Akkadian\x0b\x0b&#39;, &#39;Sumerian; Akkadian ?&#39;, &#39;Egyptian ?&#39;,
       &#39;Akkadian; Elamite; Persian&#39;, &#39;Arabic&#39;, &#39;Akkadian; Greek&#39;,
       &#39;Urartian&#39;, &#39;Akkadian; Elamite; Persian; Egyptian&#39;,
       &#39;Akkadian; Persian&#39;, &#39;Egyptian&#39;, &#39;Luwian&#39;,
       &#39;Persian; Elamite; Akkadian&#39;, &#39;Akkadian; Persian; Elamite&#39;,
       &#39;Persian, &#39;, &#39;Persian; Elamite&#39;, &#39;Persian; Elamite &#39;,
       &#39;Akkadian; Persian, Elamite, Babylonian&#39;, &#39;Persian &#39;,
       &#39;Persian, Elamite&#39;, &#39;Persian, Babylonian&#39;,
       &#39;Akkadian; Persian; Elamite Egyptian&#39;, &#39;Akkadian, Aramaic&#39;,
       &#39;Akkadian, Aramaic?&#39;, &#39;unclear&#39;, &#39;Sumerian, Akkadian&#39;, &#39;clay&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_lang</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_parent</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_lang</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_lang</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple langauges</span>
<span class="n">no_match_indices_lang</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">])):</span>
  <span class="n">l</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">language_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="c1">#print(l)</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first language</span>
  <span class="n">first_l</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining languages (if exist) away</span>
  <span class="n">other_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertaint</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_l</span><span class="p">:</span>
    <span class="n">P155_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_l</span> <span class="o">=</span> <span class="n">first_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># add in qid and parent for the first_l</span>

  <span class="c1"># if the language has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_l</span> <span class="ow">in</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the language</span>
    <span class="n">first_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_l</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Parent</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_l</span><span class="p">)</span>
    <span class="n">first_lang_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;FG_item&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">first_lang_parent</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Parent&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the language does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_parent</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_qid</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang_parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_parent</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;P155_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_lang</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;other_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_lang</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">language_df</span> <span class="o">=</span> <span class="n">language_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;language_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_language_dump&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dump refers to an unnecessary column from original data&quot;</span><span class="p">)</span>
<span class="n">language_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dump refers to an unnecessary column from original data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-25-840c174fe2ce&gt;:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;first_lang&#39;] = first_lang
&lt;ipython-input-25-840c174fe2ce&gt;:47: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;first_lang_qid&#39;] = first_lang_qid
&lt;ipython-input-25-840c174fe2ce&gt;:48: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;first_lang_parent&#39;] = first_lang_parent
&lt;ipython-input-25-840c174fe2ce&gt;:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;P155_lang&#39;] = P155_lang
&lt;ipython-input-25-840c174fe2ce&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;other_lang&#39;] = other_lang
</pre></div>
</div>
<div class="output text_html">
  <div id="df-bd9564c8-ee94-434b-8e08-e2057b9a909c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bd9564c8-ee94-434b-8e08-e2057b9a909c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bd9564c8-ee94-434b-8e08-e2057b9a909c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bd9564c8-ee94-434b-8e08-e2057b9a909c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2bc538cf-c233-4281-9355-7f733809c259">
  <button class="colab-df-quickchart" onclick="quickchart('df-2bc538cf-c233-4281-9355-7f733809c259')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2bc538cf-c233-4281-9355-7f733809c259 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang_qid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q471149    143362
           112936
Q471146     92054
Q500429     14673
Q500430      2702
Q500431      1107
Q393615        58
Q172951         9
Q389600         8
Q512052         6
Q389598         1
Name: first_lang_qid, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Make a separate dataframe for all CDLI texts that have a first language that matches languaes that exist in FactGrid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_language_df</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="n">matched_language_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-88efa22e-d8f1-497f-b031-3ab29e4e2d79" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>353278</th>
      <td>P532443</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353279</th>
      <td>P532444</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
      <td>Akkadian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353280</th>
      <td>P532445</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
      <td>Akkadian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353281</th>
      <td>P532446</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
      <td>Akkadian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353282</th>
      <td>P532447</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>253980 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-88efa22e-d8f1-497f-b031-3ab29e4e2d79')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-88efa22e-d8f1-497f-b031-3ab29e4e2d79 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-88efa22e-d8f1-497f-b031-3ab29e4e2d79');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-83f8e68e-1094-4426-b0eb-925fa8abd61c">
  <button class="colab-df-quickchart" onclick="quickchart('df-83f8e68e-1094-4426-b0eb-925fa8abd61c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-83f8e68e-1094-4426-b0eb-925fa8abd61c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>###1.2 Repeating this process for the ORACC languages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">language_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;language_y&#39;</span><span class="p">]]</span>
<span class="n">language_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5c410b5f-e2a2-45ee-949e-ce8a49dcf928" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>language_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5c410b5f-e2a2-45ee-949e-ce8a49dcf928')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5c410b5f-e2a2-45ee-949e-ce8a49dcf928 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5c410b5f-e2a2-45ee-949e-ce8a49dcf928');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0a643906-f0ca-4d86-a423-6dd70e5429b6">
  <button class="colab-df-quickchart" onclick="quickchart('df-0a643906-f0ca-4d86-a423-6dd70e5429b6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0a643906-f0ca-4d86-a423-6dd70e5429b6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">langy</span> <span class="o">=</span> <span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;language_y&#39;</span><span class="p">]</span>
<span class="n">langy</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;undetermined&#39;, &#39;Sumerian ?&#39;, nan, &#39;Sumerian&#39;, &#39;Akkadian&#39;,
       &#39;Akkadian; Elamite&#39;, &#39;S-A bilingual&#39;, &#39;Akkadian; Sumerian&#39;,
       &#39;Akkadian (with Sumerian colophon); Akkadian&#39;,
       &#39;Akkadian (with Sumerian colophon)&#39;, &#39;Old Assyrian&#39;,
       &#39;Sumerian; Akkadian&#39;, &#39;Sumerian, Akkadian&#39;,
       &#39;Sumerian; Akkadian (with Sumerian colophon)&#39;,
       &#39;Akkadian; Sumerian; Sumerian, Akkadian&#39;,
       &#39;Sumerian; Akkadian (with Sumerian colophon); Akkadian&#39;,
       &#39;Akkadian ?&#39;, &#39;non-Sumerian (undetermined)&#39;, &#39;Eblaite&#39;,
       &#39;bilingual&#39;, &#39;non-Sumerian (Eblaite)&#39;, &#39;Syllabic Sumerian&#39;,
       &#39;Middle Assyrian&#39;, &#39;Middle Babylonian&#39;, &#39;Hurrian ?&#39;,
       &#39;Neo-Assyrian&#39;, &#39;Sumerian/Akkadian Bilingual&#39;,
       &#39;Middle Babylonian peripheral&#39;, &#39;akkadian&#39;,
       &#39;non-Sumerian (Hurrian)&#39;, &#39;Akkadan&#39;, &#39;Hittite&#39;,
       &#39;Akkadian, Aramaic&#39;, &#39;Aramaic&#39;, &#39;Bilingual&#39;, &#39;Akkadian, Aramaic?&#39;,
       &#39;Akkadian, with Aramaic epigraph&#39;, &#39;Mitanni Akkadian&#39;,
       &#39;Old Persian&#39;, &#39;Akkadian, Old Persian, Elamite&#39;,
       &#39;Old Persian, Elamite&#39;, &#39;Akkadian, Elamite, Persian&#39;, &#39;Elamite&#39;,
       &#39;Akkadian, Old Persian, Elamite,  Hieroglyphs&#39;,
       &#39;Akkadian, Old Persian&#39;,
       &#39;Akkadian, Old Persian, Elamite, Hieroglyphs&#39;,
       &#39;Akkadian, Elamite, Old Persian, Hieroglyphs&#39;,
       &#39;Akkadian, Elamite, Old Persian, Hieroglyphs?&#39;, &#39;unknown&#39;,
       &#39;Akkadian?&#39;, &#39;Akkadian, Aramaic, Luwian&#39;, &#39;Urartian&#39;,
       &#39;Urartian, Akkadian&#39;, &#39;Standard Babylonian&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_lang2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_parent2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_lang2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_lang2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple langauges</span>
<span class="n">no_match_indices_lang2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;language_y&#39;</span><span class="p">])):</span>
  <span class="n">l</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">language_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="c1">#print(l)</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first language</span>
  <span class="n">first_l</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining languages (if exist) away</span>
  <span class="n">other_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertaint</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_l</span><span class="p">:</span>
    <span class="n">P155_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_l</span> <span class="o">=</span> <span class="n">first_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># add in qid and parent for the first_l</span>

  <span class="c1"># if the language has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_l</span> <span class="ow">in</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the language</span>
    <span class="n">first_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_l</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Parent</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_l</span><span class="p">)</span>
    <span class="n">first_lang_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;FG_item&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">first_lang_parent2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Parent&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the language does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_parent2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;first_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;first_lang_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_qid2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;first_lang_parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_parent2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;P155_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_lang2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;other_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_lang2</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">language_df2</span> <span class="o">=</span> <span class="n">language_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;language_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_language_dump&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dump refers to an unnecessary column from original data&quot;</span><span class="p">)</span>
<span class="n">language_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dump refers to an unnecessary column from original data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-30-43082b19e8d2&gt;:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;first_lang&#39;] = first_lang2
&lt;ipython-input-30-43082b19e8d2&gt;:47: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;first_lang_qid&#39;] = first_lang_qid2
&lt;ipython-input-30-43082b19e8d2&gt;:48: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;first_lang_parent&#39;] = first_lang_parent2
&lt;ipython-input-30-43082b19e8d2&gt;:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;P155_lang&#39;] = P155_lang2
&lt;ipython-input-30-43082b19e8d2&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;other_lang&#39;] = other_lang2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-07eac67e-9649-4009-bd1c-7427bedac415" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-07eac67e-9649-4009-bd1c-7427bedac415')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-07eac67e-9649-4009-bd1c-7427bedac415 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-07eac67e-9649-4009-bd1c-7427bedac415');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-26f04c51-55ef-4bae-9ad1-a0e9cb5e1c1b">
  <button class="colab-df-quickchart" onclick="quickchart('df-26f04c51-55ef-4bae-9ad1-a0e9cb5e1c1b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-26f04c51-55ef-4bae-9ad1-a0e9cb5e1c1b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Make a separate dataframe for all ORACC texts that have a first language that matches languaes that exist in FactGrid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_language_df2</span> <span class="o">=</span> <span class="n">language_df2</span><span class="p">[</span><span class="o">~</span><span class="n">language_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang2</span><span class="p">)]</span>
<span class="n">matched_language_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d1fda87f-4c4f-4284-a4ac-0478ae9d3e46" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366883</th>
      <td>P512808</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366884</th>
      <td>P512821</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366885</th>
      <td>P512822</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366886</th>
      <td>P515099</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366887</th>
      <td>P521777</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>133460 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d1fda87f-4c4f-4284-a4ac-0478ae9d3e46')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d1fda87f-4c4f-4284-a4ac-0478ae9d3e46 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d1fda87f-4c4f-4284-a4ac-0478ae9d3e46');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-383ad634-84d6-4754-8443-d19a0950a52d">
  <button class="colab-df-quickchart" onclick="quickchart('df-383ad634-84d6-4754-8443-d19a0950a52d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-383ad634-84d6-4754-8443-d19a0950a52d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="combining-cdli-and-oracc-languages-dataframes">
<h3>1.3 Combining CDLI and ORACC Languages dataframes<a class="headerlink" href="#combining-cdli-and-oracc-languages-dataframes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">language_df</span><span class="p">,</span> <span class="n">language_df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_languages</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4aa7810b-f721-4756-8ed1-8cef41ab42c2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_language_dump</th>
      <th>first_lang_x</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_parent_x</th>
      <th>P155_lang_x</th>
      <th>other_lang_x</th>
      <th>oracc_language_dump</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_y</th>
      <th>other_lang_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4aa7810b-f721-4756-8ed1-8cef41ab42c2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4aa7810b-f721-4756-8ed1-8cef41ab42c2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4aa7810b-f721-4756-8ed1-8cef41ab42c2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0b3433f7-4e0e-423d-9500-cab0128caa48">
  <button class="colab-df-quickchart" onclick="quickchart('df-0b3433f7-4e0e-423d-9500-cab0128caa48')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0b3433f7-4e0e-423d-9500-cab0128caa48 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages_df</span> <span class="o">=</span> <span class="n">final_languages</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">,</span> <span class="s1">&#39;first_lang_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;first_lang_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;first_lang_parent_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_lang_parent_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;P155_lang_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_lang_y&#39;</span><span class="p">,</span> <span class="s1">&#39;other_lang_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_lang_y&#39;</span><span class="p">]]</span>
<span class="n">final_languages_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0fc8edc7-69fd-4580-96a4-97913cdf4604" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>first_lang_x</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_x</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_x</th>
      <th>P155_lang_y</th>
      <th>other_lang_x</th>
      <th>other_lang_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0fc8edc7-69fd-4580-96a4-97913cdf4604')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0fc8edc7-69fd-4580-96a4-97913cdf4604 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0fc8edc7-69fd-4580-96a4-97913cdf4604');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5f51a973-1164-4c5b-ad42-d6282377f244">
  <button class="colab-df-quickchart" onclick="quickchart('df-5f51a973-1164-4c5b-ad42-d6282377f244')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5f51a973-1164-4c5b-ad42-d6282377f244 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages_df</span><span class="p">[</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> <span class="n">final_languages_df</span><span class="p">[</span><span class="s1">&#39;first_lang_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Sumerian    143362
             112936
 Akkadian     85183
 Hittite      14673
 Eblaite       6871
 Elamite       2702
 Ugaritic      1107
 Aramaic         58
 Greek            9
 Hebrew           8
 Hurrian          6
 Arabic           1
 Name: first_lang_x, dtype: int64,
                 233456
 Sumerian        112642
 Akkadian         20540
 Eblaite            141
 Hittite             91
 Aramaic             31
 Neo-Assyrian         7
 Elamite              7
 Hurrian              1
 Name: first_lang_y, dtype: int64)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="material-material-composition-p401">
<h2>2 Material = Material Composition (P401)<a class="headerlink" href="#material-material-composition-p401" title="Link to this heading">#</a></h2>
<section id="we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id">
<h3><strong>2.1. We will only add the most basic material composition to a data frame, `material_df’, and then we match the first statement to the corresponding FactGrid Q-id.</strong><a class="headerlink" href="#we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id" title="Link to this heading">#</a></h3>
<p>We can use this CSV to obtain the corresponding FactGrid Q-id:</p>
<p><a class="reference external" href="https://drive.google.com/file/d/12FH9ao4B-U_xIwwjcSoBfOqYoBrgRaJc/view?usp=share_link">https://drive.google.com/file/d/12FH9ao4B-U_xIwwjcSoBfOqYoBrgRaJc/view?usp=share_link</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">material_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Material%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">material_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># fill na values with space</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">mat_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-58920191-cf53-4a93-94c2-e54cc7417853" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Material</th>
      <th>FactGrid_Label</th>
      <th>FactGrid_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>?</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>bitumen</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>bone: bone</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bone: ivory</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bone: ivory ?</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>102</th>
      <td>stone: soapstone</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>103</th>
      <td>stone: steatite</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>104</th>
      <td>stone: travertine</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>105</th>
      <td>stone: tuff</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>106</th>
      <td>stone: volcanic</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
  </tbody>
</table>
<p>107 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-58920191-cf53-4a93-94c2-e54cc7417853')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-58920191-cf53-4a93-94c2-e54cc7417853 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-58920191-cf53-4a93-94c2-e54cc7417853');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-61b2be08-4460-4754-aa49-4aafd8dba95b">
  <button class="colab-df-quickchart" onclick="quickchart('df-61b2be08-4460-4754-aa49-4aafd8dba95b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-61b2be08-4460-4754-aa49-4aafd8dba95b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Prepare the dictonary dataframe above for matching. Please note that the following adjustments are made based on the specific cases of this google sheet. For example, we were able to simply drop the rows with question marks because for each of those rows there is another row that provides the exact same information but for the question mark. Suppose a newer version of the google sheet does not satisfy that, the following codes need to be altered.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove entries without a FactGrid QID</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="p">[</span><span class="n">mat_reference</span><span class="p">[</span><span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># remove the entries with question marks because we will deal with uncertainty in the P155 column</span>
<span class="n">rows_to_be_removed_mat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mat_reference</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_no</span><span class="p">,</span> <span class="s1">&#39;Material&#39;</span><span class="p">]:</span>
    <span class="n">rows_to_be_removed_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row_no</span><span class="p">]</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">rows_to_be_removed_mat</span><span class="p">)</span>
<span class="c1"># make sure that no new columns are included</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="p">[[</span><span class="s1">&#39;Material&#39;</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span>

<span class="n">mat_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-25d3d97e-355e-4280-8e71-16cba7612c44" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Material</th>
      <th>FactGrid_Label</th>
      <th>FactGrid_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bone: bone</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bone: ivory</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bone: shell</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>4</th>
      <td>clay</td>
      <td>Clay</td>
      <td>Q471153</td>
    </tr>
    <tr>
      <th>5</th>
      <td>clay; metal: bronze; stone: steatite</td>
      <td>Clay</td>
      <td>Q471153</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>97</th>
      <td>stone: soapstone</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>98</th>
      <td>stone: steatite</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>99</th>
      <td>stone: travertine</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>100</th>
      <td>stone: tuff</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>101</th>
      <td>stone: volcanic</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-25d3d97e-355e-4280-8e71-16cba7612c44')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-25d3d97e-355e-4280-8e71-16cba7612c44 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-25d3d97e-355e-4280-8e71-16cba7612c44');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7c7015bc-83e5-46dc-bf7d-94a9a2ea1efd">
  <button class="colab-df-quickchart" onclick="quickchart('df-7c7015bc-83e5-46dc-bf7d-94a9a2ea1efd')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7c7015bc-83e5-46dc-bf7d-94a9a2ea1efd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="p">[[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># lower all materail label for future matching</span>
<span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We are going to move the row of metal to the very end of the dataframe. This is to ensure that brozne, copper, gold, iron, lead, and silver are searched first in the next step. FactGrid categorizes records with material e.g., <em>metal: silver</em> as silver and not metal. Hence, we want the smaller categories to come before the big category.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metal_info</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">short_mat_ref</span><span class="p">,</span> <span class="n">metal_info</span><span class="p">])</span>
<span class="c1"># reset index</span>
<span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">short_mat_ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-74326565-9c24-46a1-beea-8a75ba752846" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FactGrid_Label</th>
      <th>FactGrid_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>1</th>
      <td>clay</td>
      <td>Q471153</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gypsum</td>
      <td>Q146565</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bronze</td>
      <td>Q512050</td>
    </tr>
    <tr>
      <th>4</th>
      <td>copper</td>
      <td>Q102059</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gold</td>
      <td>Q102068</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iron</td>
      <td>Q512047</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lead</td>
      <td>Q512048</td>
    </tr>
    <tr>
      <th>8</th>
      <td>silver</td>
      <td>Q102025</td>
    </tr>
    <tr>
      <th>9</th>
      <td>shell</td>
      <td>Q512049</td>
    </tr>
    <tr>
      <th>10</th>
      <td>stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>11</th>
      <td>metal</td>
      <td>Q102057</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-74326565-9c24-46a1-beea-8a75ba752846')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-74326565-9c24-46a1-beea-8a75ba752846 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-74326565-9c24-46a1-beea-8a75ba752846');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c7b854a2-fae0-4f61-bd17-36163ac8d050">
  <button class="colab-df-quickchart" onclick="quickchart('df-c7b854a2-fae0-4f61-bd17-36163ac8d050')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c7b854a2-fae0-4f61-bd17-36163ac8d050 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id">
<h3><strong>2.2. CDLI - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong><a class="headerlink" href="#cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id" title="Link to this heading">#</a></h3>
<p>See the unique values of materials in the CDLI data dump below. There are many different entries and the data entry is not very consistent. Doing a detailed string matching using the <code class="docutils literal notranslate"><span class="pre">Material</span></code> column in the reference dataframe above would be rather troublesome. This is why we created the shorter reference dataframe with only <code class="docutils literal notranslate"><span class="pre">FactGrid_Label</span></code> and <code class="docutils literal notranslate"><span class="pre">FactGrid_Q</span></code>. We will simply see if the material entry in the CDLI data dump contain the less-than-20 big labels in the shorter reference dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mat_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;material_x&#39;</span><span class="p">]]</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material_x&#39;</span><span class="p">]</span>
<span class="n">mat</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, &#39;gypsum&#39;, &#39;stone: steatite&#39;, &#39;stone: limestone&#39;, &#39;stone&#39;,
       &#39;stone: onyx&#39;, &#39;stone: slate&#39;, &#39;stone: basalt&#39;, &#39;stone: alabaster&#39;,
       &#39;clay\x0b&#39;, &#39;stone: agate&#39;, &#39;metal: bronze&#39;, &#39;stone: granite&#39;,
       &#39;stone: agate ?&#39;, &#39;stone: diorite&#39;, &#39;stone: alabaster ?&#39;, nan,
       &#39;metal&#39;, &#39;stone: calcite&#39;, &#39;stone: marble&#39;, &#39;stone: rock crystal&#39;,
       &#39;stone: calcite ?&#39;, &#39;stone ?&#39;, &#39;bitumen&#39;, &#39;metal: copper&#39;,
       &#39;stone: dolomite&#39;, &#39;stone: haematite&#39;, &#39;bone: shell&#39;,
       &#39;stone: dolerite&#39;, &#39;metal: gold&#39;, &#39;stone: quartz&#39;,
       &#39;stone: carnelian&#39;, &#39;metal: bronze ?&#39;, &#39;clay: terracotta&#39;,
       &#39;stone: lapis lazuli&#39;, &#39;stone: serpentine&#39;, &#39;stone: hematite&#39;,
       &#39;stone: jasper&#39;, &#39;stone: greenstone&#39;, &#39;stone: schist&#39;,
       &#39;stone: crystal&#39;, &#39;stone: aragonite&#39;, &#39;stone: diorite ?&#39;,
       &#39;stone: gypsum&#39;, &#39;stone: shale&#39;, &#39;stone: limestone ?&#39;,
       &#39;stone: syenite&#39;, &#39;stone: gypsum ?&#39;, &#39;metal: silver&#39;,
       &#39;stone: hornfels&#39;, &#39;stone: porphyry&#39;, &#39;stone: lava&#39;,
       &#39;stone: chlorite&#39;, &#39;stone (newimages)&#39;, &#39;metal: copper alloy&#39;,
       &#39;stone: trachyte&#39;, &#39;stone: sandstone&#39;, &#39;stone: tuff&#39;,
       &#39;bone: shell; stone: gypsum; stone: lapis lazuli&#39;,
       &#39;metal: bronze; stone: steatite&#39;, &#39;stone: obsidian&#39;,
       &#39;stone: chalcedony ?&#39;, &#39;clay; metal: bronze; stone: steatite&#39;,
       &#39;clay; metal: bronze; stone&#39;, &#39;stone: chlorite, schist&#39;,
       &#39;metal: bronze; stone&#39;, &#39;bone: ivory&#39;, &#39;clay; metal: copper&#39;,
       &#39;stone: felsite&#39;, &#39;metal: copper; stone&#39;, &#39;stone : steatite&#39;,
       &#39;stone: slate ?&#39;, &#39;gypsum: plaster&#39;, &#39;stone: steatite ?&#39;,
       &#39;stone: dolerite, quartz &#39;, &#39;stone: limestone; metal: bronze&#39;,
       &#39;stone: diabase&#39;, &#39;Stone&#39;, &#39;stone: chalcedony&#39;, &#39;glass&#39;,
       &#39;bone: bone&#39;, &#39;stone: feldspar&#39;, &#39;stone: magnetite&#39;, &#39;clay ?&#39;,
       &#39;stone: menaccanite&#39;, &#39;shell&#39;, &#39;Glass&#39;, &#39;stone: red jasper&#39;,
       &#39;metal: silver ?&#39;, &#39;clay; gypsum: plaster&#39;, &#39;stone: gneiss&#39;,
       &#39;stone: bloodstone&#39;, &#39;clay: glazed pottery&#39;, &#39;stone: jade-like&#39;,
       &#39;stone: jade&#39;, &#39;stone: hematite ?&#39;, &#39;Stone: alabaster&#39;,
       &#39;stone: travertine&#39;, &#39;stone: flint ?&#39;, &#39;stone: jadeite&#39;,
       &#39;stone: limonite&#39;, &#39;stone: breccia&#39;, &#39;stone: quartz ?&#39;,
       &#39;stone: quartzite&#39;, &#39;stone: black&#39;, &#39;stone: marble ?&#39;,
       &#39;metal: iron&#39;, &#39;stone: white&#39;, &#39;stone: granite ?&#39;,
       &#39;clay: terra-cotta&#39;, &#39;metal: lead&#39;, &#39;stone: agate, banded &#39;,
       &#39;Metal&#39;, &#39;stone: aphrite&#39;, &#39;stone: clinochlore&#39;, &#39;bone: ivory ?&#39;,
       &#39;stone:marble&#39;, &#39;stone: nephrite&#39;, &#39;clay: ceramic&#39;,
       &#39;stone: carnelian ?&#39;, &#39;metal: copper ?&#39;, &#39;stone: sandstone ?&#39;,
       &#39;composite&#39;, &#39;stone: iron oxide&#39;,
       &#39;stone: crystal; metal: silver, gold&#39;, &#39;stone: amethyst&#39;,
       &#39;metal: electrum&#39;, &#39;stone: stalagmite&#39;, &#39;stone: ?&#39;,
       &#39;stone: sardonyx&#39;, &#39;stone ?)&#39;, &#39;stone: (black)&#39;,
       &#39;stone: chalcedony, jasper&#39;, &#39;stone: (brown)&#39;, &#39;Clay&#39;,
       &#39;metal: silver, electrum&#39;, &#39;stone: calcite/ dolomite&#39;,
       &#39;stone: lapis lazuli ?&#39;, &#39;stone: magnesite&#39;, &#39;clay: porcelain ?&#39;,
       &#39;metal: bronze or copper&#39;, &#39;stone: turquoise&#39;, &#39;stone: shell&#39;,
       &#39;stone; calcite&#39;, &#39;stone: basalt ?&#39;, &#39;stone: black serpentine&#39;,
       &#39;stone: onyx marble&#39;, &#39;stone: soapstone&#39;, &#39;stone: jasper-like&#39;,
       &#39;stone: volcanic&#39;, &#39;stone: geothite&#39;, &#39;stone:chlorite&#39;,
       &#39;stone: chlorite &#39;, &#39;stone: harmatite&#39;, &#39;stone: azurite&#39;,
       &#39;stone: jadeite ?&#39;, &#39;stone: black marble&#39;, &#39;stone: rock-crystal&#39;,
       &#39;petrified shell&#39;, &#39;stone: magnesite ?&#39;, &#39;stone: chalcedon&#39;,
       &#39;stone: chalcedon ?&#39;, &#39;stone: copper&#39;, &#39;wood; shell&#39;,
       &#39;stone: bronze&#39;, &#39;stone: sardonyx ?&#39;, &#39;ivory&#39;, &#39;stone: calcedony&#39;,
       &#39;stone: cornaline&#39;, &#39;clay: faéence ?&#39;, &#39;stone: stéatite&#39;,
       &#39;stone: hematite (?)&#39;, &#39;stone: polypier fossil&#39;, &#39;clay: faéence&#39;,
       &#39;bone&#39;, &#39;glass; blue&#39;, &#39;stone: serpentine or black steatite&#39;, &#39;?&#39;,
       &#39;stone: chakcedony&#39;, &#39;stone: dioirite&#39;, &#39;stone: hornblende&#39;,
       &#39;stone: &#39;, &#39;stone &#39;, &#39;ston&#39;, &#39;stone: jade?&#39;, &#39;stone: amazonite&#39;,
       &#39;stone: malachite&#39;, &#39;stone haematite&#39;, &#39;gold&#39;, &#39;silver&#39;,
       &#39;metal: copper; stone: lapis lazuli; shell: nacre&#39;,
       &#39;metal: copper &amp; silver&#39;, &#39;other&#39;, &#39;stone: chlorite ?&#39;,
       &#39;wood; shell; stone: red limestone: stone:  lapis lazuli; bitumen&#39;,
       &#39;stone:limestone&#39;, &#39;metal ?&#39;,
       &#39;shell: gastropod (Charonia tritonis?)&#39;, &#39;stone: green schist&#39;,
       &#39;stone: crystal quartz&#39;, &#39;composition&#39;, &#39;glass ?&#39;,
       &#39;shell: bivalve (Tridacna maxima?)&#39;, &#39;stone: glazed steatite&#39;,
       &#39;ivory ? &#39;, &#39;fossilised gastropod&#39;, &#39;stone: malachite: hematite&#39;,
       &#39;metal: copper?&#39;, &#39;shell: bivalve (tridacna maxima?)&#39;, &#39;faience&#39;,
       &#39;shell: bivalve (tridacna maxima?): lapis lazuli&#39;,
       &#39;shell: gastropod (Charonia Tritonis?)&#39;, &#39;stone: Agate&#39;,
       &#39;faience ? &#39;, &#39;diorite&#39;, &#39;faience; bronze&#39;, &#39;limestone&#39;,
       &#39;chalcedony&#39;, &#39;calcite&#39;, &#39;serpentine&#39;, &#39;soapstone&#39;, &#39;quartz&#39;,
       &#39;marble&#39;, &#39;stone; soapstone&#39;, &#39;terracotta&#39;, &#39;carnelian&#39;,
       &#39;stone; ceramic&#39;, &#39;stone; agate&#39;, &#39;stone; plaster&#39;, &#39;stone; onyx&#39;,
       &#39;stone; jasper&#39;, &#39;stone; chalcedony&#39;, &#39;stone; carnelian&#39;,
       &#39;soapstone; plaster&#39;, &#39;bone; ivory&#39;, &#39;talc&#39;, &#39;talc; schist&#39;,
       &#39;silver; plaster&#39;, &#39;sardonyx&#39;, &#39;sard&#39;, &#39;quartz crystal; gold&#39;,
       &#39;quartz crystal&#39;, &#39;jasper; chalcedony&#39;, &#39;ceramic&#39;, &#39;porphyry&#39;,
       &#39;plaster&#39;, &#39;agate&#39;, &#39;jasper&#39;, &#39;onyx&#39;, &#39;schist&#39;, &#39;obsidian&#39;,
       &#39;alabaster&#39;, &#39;lapis lazuli&#39;, &#39;iron&#39;, &#39;hematite&#39;, &#39;mica; schist&#39;,
       &#39;frit&#39;, &#39;glass; stone&#39;, &#39;garnet&#39;, &#39;faience; glass&#39;,
       &#39;faience; clay&#39;, &#39;Egyptian blue; frit&#39;, &#39;siderite&#39;,
       &#39;stone; soapstone &#39;, &#39;cuprous sulfide&#39;, &#39;crystal&#39;, &#39;copper alloy&#39;,
       &#39;serpentine; soapstone&#39;, &#39;chalcedony; plaster&#39;, &#39;plaster; stone&#39;,
       &#39;jasper; agate&#39;, &#39;chert&#39;, &#39;bronze&#39;, &#39;chalcedony; stone&#39;,
       &#39;limestone; plaster&#39;, &#39;shale&#39;, &#39;rock crystal&#39;, &#39;tuff&#39;, &#39;copper&#39;,
       &#39;hematite ?&#39;, &#39;agate ?&#39;, &#39;steatite&#39;, &#39;shell; stone ?&#39;, &#39;sandstone&#39;,
       &#39;bronze; copper&#39;, &#39;frit; glass&#39;, &#39;stone; bronze&#39;, &#39;basalt&#39;,
       &#39;chalcedony; gold&#39;, &#39;cornelian&#39;, &#39;shell; stone&#39;, &#39;lak&#39;,
       &#39;bruine stone&#39;, &#39;silver; cornelian&#39;, &#39;basanite&#39;, &#39;flint&#39;,
       &#39;hematite; metal&#39;, &#39;ophicalcite&#39;, &#39;bloodstone&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>But as usual, we need to first clean the material column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the `\x0b` pattern</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x0b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">))])</span>
<span class="c1"># there are different versions of NA, merge them into one</span>
<span class="n">mat</span><span class="p">[</span><span class="n">mat</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># lowercase all</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

<span class="c1"># update the language dataframe</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span>

<span class="c1"># check if the language dataframe has been properly cleaned</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">mat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-40-4fad14ef8bc1&gt;:9: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;material&#39;] = mat
</pre></div>
</div>
<div class="output text_html">
  <div id="df-9f410793-c9be-4aca-89f4-21099fa97ac6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>material_x</th>
      <th>material</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9f410793-c9be-4aca-89f4-21099fa97ac6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9f410793-c9be-4aca-89f4-21099fa97ac6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9f410793-c9be-4aca-89f4-21099fa97ac6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0f923756-c89b-4a93-bf8b-7cd040031812">
  <button class="colab-df-quickchart" onclick="quickchart('df-0f923756-c89b-4a93-bf8b-7cd040031812')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0f923756-c89b-4a93-bf8b-7cd040031812 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>add in the matched information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_label</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_mat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_mat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple materials</span>
<span class="n">no_match_indices_mat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="n">FG_existing_materials</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">])):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first material</span>
  <span class="n">first_m</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining materials (if exist) away</span>
  <span class="n">other_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
    <span class="n">P155_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_m</span> <span class="o">=</span> <span class="n">first_m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># store the original first_m for investigating finer categories later</span>
  <span class="n">first_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_m</span><span class="p">]</span>

  <span class="c1"># add in qid and label for the first_m</span>

  <span class="c1"># if the material has a QID in FactGrid</span>
  <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FG_existing_materials</span><span class="p">)):</span>
    <span class="n">material</span> <span class="o">=</span> <span class="n">FG_existing_materials</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">material</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
      <span class="n">first_mat_label</span> <span class="o">+=</span> <span class="p">[</span><span class="n">material</span><span class="p">]</span>
      <span class="n">first_mat_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">short_mat_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span>
      <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">break</span>

  <span class="c1"># if the material does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">if</span> <span class="n">matched</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">first_mat_label</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_mat_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_label</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_qid</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;P155_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_mat</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;other_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_mat</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">mat_df</span> <span class="o">=</span> <span class="n">mat_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;material_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_material_dump&#39;</span><span class="p">})</span>

<span class="n">mat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-41-e4148bf1cb13&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;first_mat&#39;] = first_mat
&lt;ipython-input-41-e4148bf1cb13&gt;:51: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;first_mat_label&#39;] = first_mat_label
&lt;ipython-input-41-e4148bf1cb13&gt;:52: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;first_mat_qid&#39;] = first_mat_qid
&lt;ipython-input-41-e4148bf1cb13&gt;:53: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;P155_mat&#39;] = P155_mat
&lt;ipython-input-41-e4148bf1cb13&gt;:54: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;other_mat&#39;] = other_mat
</pre></div>
</div>
<div class="output text_html">
  <div id="df-98344e4d-cc1f-475c-b616-db605cd7d91d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-98344e4d-cc1f-475c-b616-db605cd7d91d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-98344e4d-cc1f-475c-b616-db605cd7d91d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-98344e4d-cc1f-475c-b616-db605cd7d91d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-625de3cc-7ad1-40a4-860a-f4fe3d362372">
  <button class="colab-df-quickchart" onclick="quickchart('df-625de3cc-7ad1-40a4-860a-f4fe3d362372')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-625de3cc-7ad1-40a4-860a-f4fe3d362372 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="matched-mat-df">
<h4>2.2.1 matched_mat_df<a class="headerlink" href="#matched-mat-df" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="o">~</span><span class="n">mat_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_mat</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_mat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5e34ff45-7d09-44ee-9ff3-71d18112165c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>344220</th>
      <td>P532443</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344221</th>
      <td>P532444</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344222</th>
      <td>P532445</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344223</th>
      <td>P532446</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344224</th>
      <td>P532447</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>344225 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5e34ff45-7d09-44ee-9ff3-71d18112165c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5e34ff45-7d09-44ee-9ff3-71d18112165c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5e34ff45-7d09-44ee-9ff3-71d18112165c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-608e9a5e-fadc-434c-9f02-9deed54cbead">
  <button class="colab-df-quickchart" onclick="quickchart('df-608e9a5e-fadc-434c-9f02-9deed54cbead')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-608e9a5e-fadc-434c-9f02-9deed54cbead button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>a little sanity check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(344225, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, &#39;gypsum&#39;, &#39;stone&#39;, &#39;bronze&#39;, &#39;metal&#39;, &#39;copper&#39;, &#39;bone&#39;,
       &#39;gold&#39;, &#39;silver&#39;, &#39;shell&#39;, &#39;iron&#39;, &#39;lead&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>finer categories</p>
<p>Now, let’s see what finer categories are there under the big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat_finer_category</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">full_mat</span> <span class="o">=</span> <span class="n">matched_mat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;first_mat&#39;</span><span class="p">]</span>
  <span class="k">if</span> <span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">full_mat</span><span class="p">:</span>
    <span class="n">finer_mat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(?&lt;=: ).*&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">full_mat</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove the parenthesis</span>
    <span class="n">finer_mat</span> <span class="o">=</span> <span class="n">finer_mat</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># remove the space at the end of the string, if any</span>
    <span class="n">finer_mat</span> <span class="o">=</span> <span class="n">finer_mat</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># check if this is a big label</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">finer_mat</span> <span class="ow">in</span> <span class="n">FG_existing_materials</span><span class="p">:</span>
      <span class="n">first_mat_finer_category</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finer_mat</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">first_mat_finer_category</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_mat_finer_category</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

<span class="n">matched_mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_finer_category</span>

<span class="n">matched_mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;&#39;, &#39;steatite&#39;, &#39;limestone&#39;, &#39;onyx&#39;, &#39;slate&#39;, &#39;basalt&#39;,
       &#39;alabaster&#39;, &#39;agate&#39;, &#39;granite&#39;, &#39;diorite&#39;, &#39;calcite&#39;, &#39;marble&#39;,
       &#39;rock crystal&#39;, &#39;dolomite&#39;, &#39;haematite&#39;, &#39;dolerite&#39;, &#39;quartz&#39;,
       &#39;carnelian&#39;, &#39;terracotta&#39;, &#39;lapis lazuli&#39;, &#39;serpentine&#39;,
       &#39;hematite&#39;, &#39;jasper&#39;, &#39;greenstone&#39;, &#39;schist&#39;, &#39;crystal&#39;,
       &#39;aragonite&#39;, &#39;shale&#39;, &#39;syenite&#39;, &#39;hornfels&#39;, &#39;porphyry&#39;, &#39;lava&#39;,
       &#39;chlorite&#39;, &#39;copper alloy&#39;, &#39;trachyte&#39;, &#39;sandstone&#39;, &#39;tuff&#39;,
       &#39;obsidian&#39;, &#39;chalcedony&#39;, &#39;ivory&#39;, &#39;felsite&#39;, &#39;plaster&#39;, &#39;diabase&#39;,
       &#39;feldspar&#39;, &#39;magnetite&#39;, &#39;menaccanite&#39;, &#39;red jasper&#39;, &#39;gneiss&#39;,
       &#39;bloodstone&#39;, &#39;glazed pottery&#39;, &#39;jade-like&#39;, &#39;jade&#39;, &#39;travertine&#39;,
       &#39;flint&#39;, &#39;jadeite&#39;, &#39;limonite&#39;, &#39;breccia&#39;, &#39;quartzite&#39;, &#39;black&#39;,
       &#39;white&#39;, &#39;terra-cotta&#39;, &#39;aphrite&#39;, &#39;clinochlore&#39;, &#39;nephrite&#39;,
       &#39;ceramic&#39;, &#39;iron oxide&#39;, &#39;amethyst&#39;, &#39;electrum&#39;, &#39;stalagmite&#39;,
       &#39;sardonyx&#39;, &#39;brown&#39;, &#39;calcite/ dolomite&#39;, &#39;magnesite&#39;, &#39;porcelain&#39;,
       &#39;bronze or copper&#39;, &#39;turquoise&#39;, &#39;black serpentine&#39;, &#39;onyx marble&#39;,
       &#39;soapstone&#39;, &#39;jasper-like&#39;, &#39;volcanic&#39;, &#39;geothite&#39;, &#39;harmatite&#39;,
       &#39;azurite&#39;, &#39;black marble&#39;, &#39;rock-crystal&#39;, &#39;chalcedon&#39;,
       &#39;calcedony&#39;, &#39;cornaline&#39;, &#39;faéence&#39;, &#39;stéatite&#39;, &#39;polypier fossil&#39;,
       &#39;serpentine or black steatite&#39;, &#39;chakcedony&#39;, &#39;dioirite&#39;,
       &#39;hornblende&#39;, &#39;amazonite&#39;, &#39;malachite&#39;, &#39;copper &amp; silver&#39;,
       &#39;gastropod charonia tritonis&#39;, &#39;green schist&#39;, &#39;crystal quartz&#39;,
       &#39;bivalve tridacna maxima&#39;, &#39;glazed steatite&#39;,
       &#39;malachite: hematite&#39;, &#39;bivalve tridacna maxima: lapis lazuli&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-mat-df">
<h4>2.2.2 no_match_mat_df<a class="headerlink" href="#no-match-mat-df" title="Link to this heading">#</a></h4>
<p>Make a separate dataframe of the items not matched for export and supervision: <code class="docutils literal notranslate"><span class="pre">no_material_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat</span><span class="p">]</span>
<span class="n">no_match_mat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c8f007a0-1191-4adb-9575-d0fb75708389" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64452</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P213226</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>NaN</td>
      <td>unlocated</td>
      <td>unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical cylinder seal</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>66843</th>
      <td>needed</td>
      <td>0.0</td>
      <td>P215652</td>
      <td>NaN</td>
      <td>other (see object remarks)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>NaN</td>
      <td>Louvre Museum, Paris, France</td>
      <td>Sb 00055; AS 12801</td>
      <td>Susa (mod. Shush)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal/Monumental</td>
      <td>witness</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>66963</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P215773</td>
      <td>Sumerian</td>
      <td>other (see object remarks)</td>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>NaN</td>
      <td>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri,...</td>
      <td>Ist EŞEM 00501</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Private/Votive</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67555</th>
      <td>Q001445</td>
      <td>0.0</td>
      <td>P216380</td>
      <td>NaN</td>
      <td>other (see object remarks)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>bitumen</td>
      <td>Louvre Museum, Paris, France</td>
      <td>AO 04798</td>
      <td>Umma (mod. Tell Jokha)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Shurush-kin.00.00.00</td>
      <td>Shurush-kin.00.00.00</td>
      <td>Royal/Monumental</td>
      <td>witness</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>bitumen</td>
      <td>tenon</td>
      <td>Old Akkadian</td>
      <td>Tell Jokha (Umma)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal Inscription</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Louvre Museum, Paris, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIT</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P216380</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67624</th>
      <td>Q000837</td>
      <td>0.0</td>
      <td>P216458</td>
      <td>NaN</td>
      <td>other (see object remarks)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>NaN</td>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>CBS 08863a</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Rimush.00.00.00</td>
      <td>Rimush.00.00.00</td>
      <td>Royal/Monumental</td>
      <td>witness</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Akkadian</td>
      <td>stone</td>
      <td>vase</td>
      <td>Old Akkadian</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal Inscription</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIT</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P216458</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c8f007a0-1191-4adb-9575-d0fb75708389')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c8f007a0-1191-4adb-9575-d0fb75708389 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c8f007a0-1191-4adb-9575-d0fb75708389');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ed577d21-e387-4d0e-9cdf-4e7599df9ba3">
  <button class="colab-df-quickchart" onclick="quickchart('df-ed577d21-e387-4d0e-9cdf-4e7599df9ba3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ed577d21-e387-4d0e-9cdf-4e7599df9ba3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(22691, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization-of-cdli-materials">
<h4>2.2.3 Visualization of CDLI Materials<a class="headerlink" href="#visualization-of-cdli-materials" title="Link to this heading">#</a></h4>
</section>
<section id="distribution-of-matched-first-materials">
<h4>Distribution of matched first materials<a class="headerlink" href="#distribution-of-matched-first-materials" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_m_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_m_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_m_df</span> <span class="o">=</span> <span class="n">first_m_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_label&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_m_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ce83ffbf-e2e4-4394-ad17-b6c568dac9dd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>clay</td>
      <td>324611</td>
    </tr>
    <tr>
      <th>11</th>
      <td>stone</td>
      <td>18656</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bronze</td>
      <td>315</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bone</td>
      <td>217</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gypsum</td>
      <td>171</td>
    </tr>
    <tr>
      <th>9</th>
      <td>shell</td>
      <td>77</td>
    </tr>
    <tr>
      <th>3</th>
      <td>copper</td>
      <td>71</td>
    </tr>
    <tr>
      <th>10</th>
      <td>silver</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gold</td>
      <td>31</td>
    </tr>
    <tr>
      <th>8</th>
      <td>metal</td>
      <td>22</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lead</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iron</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ce83ffbf-e2e4-4394-ad17-b6c568dac9dd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ce83ffbf-e2e4-4394-ad17-b6c568dac9dd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ce83ffbf-e2e4-4394-ad17-b6c568dac9dd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cc7b9b3c-6651-4a49-8612-218cdfb006c6">
  <button class="colab-df-quickchart" onclick="quickchart('df-cc7b9b3c-6651-4a49-8612-218cdfb006c6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cc7b9b3c-6651-4a49-8612-218cdfb006c6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_m_df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;First Material Used in Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of First Materials on Tablets that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0bd67b929bcbacb7d3a3c1c810e3421c32045b6fed1c73e96cddb1540bf5bc98.png" src="_images/0bd67b929bcbacb7d3a3c1c810e3421c32045b6fed1c73e96cddb1540bf5bc98.png" />
</div>
</div>
</section>
<section id="distribution-of-finer-categories-within-matched-materials">
<h4>Distribution of finer categories within matched materials<a class="headerlink" href="#distribution-of-finer-categories-within-matched-materials" title="Link to this heading">#</a></h4>
<p>We have recorded the big material labels for the matched tablets. The graph below summarizes the finer categories within those big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">finer_cat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">finer_cat_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">finer_cat_df</span> <span class="o">=</span> <span class="n">finer_cat_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">finer_cat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finer_cat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">)</span>
<span class="n">finer_cat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4e737e94-003e-4e51-b780-171dd1591f1b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>undetermined</td>
      <td>340133</td>
    </tr>
    <tr>
      <th>65</th>
      <td>limestone</td>
      <td>1068</td>
    </tr>
    <tr>
      <th>63</th>
      <td>lapis lazuli</td>
      <td>270</td>
    </tr>
    <tr>
      <th>2</th>
      <td>alabaster</td>
      <td>257</td>
    </tr>
    <tr>
      <th>35</th>
      <td>diorite</td>
      <td>250</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>78</th>
      <td>polypier fossil</td>
      <td>1</td>
    </tr>
    <tr>
      <th>79</th>
      <td>porcelain</td>
      <td>1</td>
    </tr>
    <tr>
      <th>80</th>
      <td>porphyry</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>azurite</td>
      <td>1</td>
    </tr>
    <tr>
      <th>105</th>
      <td>white</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>106 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4e737e94-003e-4e51-b780-171dd1591f1b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4e737e94-003e-4e51-b780-171dd1591f1b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4e737e94-003e-4e51-b780-171dd1591f1b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dac1b496-dfcb-4359-b66b-2eade98b9afc">
  <button class="colab-df-quickchart" onclick="quickchart('df-dac1b496-dfcb-4359-b66b-2eade98b9afc')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dac1b496-dfcb-4359-b66b-2eade98b9afc button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Note that there are unproportionately the most records that have NA value for their material. Since the purpose of this plot is to determine which labels to add into FactGrid, we will exclude the undetermined ones when we plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">finer_cat_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1150</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Sub-Category of First Materials on Tablets that Matched FactGrid Records</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23c41b36583a2eed9aa02d719f593b0ca81cd7def4092346c5d05de453c67cbe.png" src="_images/23c41b36583a2eed9aa02d719f593b0ca81cd7def4092346c5d05de453c67cbe.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-materials">
<h4>Distribution of unmatched materials<a class="headerlink" href="#distribution-of-unmatched-materials" title="Link to this heading">#</a></h4>
<p>Select the top 10 of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_mats</span> <span class="o">=</span> <span class="n">mat_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat</span><span class="p">][</span><span class="s1">&#39;cdli_material_dump&#39;</span><span class="p">]</span>
<span class="n">unmatched_mats_clean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">unmatched_mats</span><span class="p">:</span>
  <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-language statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_mats_clean</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_mats_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_mats_clean</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_mats_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;nan&#39;, &#39;bitumen&#39;, &#39;glass&#39;, &#39;Glass&#39;, &#39;composite&#39;, &#39;wood&#39;, &#39;shell&#39;,
       &#39;ivory&#39;, &#39;blue&#39;, &#39;?&#39;, &#39;ston&#39;, &#39;other&#39;,
       &#39;stone: red limestone: stone:  lapis lazuli&#39;, &#39;composition&#39;,
       &#39;fossilised gastropod&#39;, &#39;faience&#39;, &#39;diorite&#39;, &#39;bronze&#39;,
       &#39;chalcedony&#39;, &#39;calcite&#39;, &#39;serpentine&#39;, &#39;quartz&#39;, &#39;marble&#39;,
       &#39;terracotta&#39;, &#39;carnelian&#39;, &#39;talc&#39;, &#39;schist&#39;, &#39;sardonyx&#39;, &#39;sard&#39;,
       &#39;quartz crystal&#39;, &#39;gold&#39;, &#39;jasper&#39;, &#39;ceramic&#39;, &#39;porphyry&#39;,
       &#39;plaster&#39;, &#39;agate&#39;, &#39;onyx&#39;, &#39;obsidian&#39;, &#39;alabaster&#39;,
       &#39;lapis lazuli&#39;, &#39;hematite&#39;, &#39;mica&#39;, &#39;frit&#39;, &#39;stone&#39;, &#39;garnet&#39;,
       &#39;clay&#39;, &#39;Egyptian blue&#39;, &#39;siderite&#39;, &#39;cuprous sulfide&#39;, &#39;crystal&#39;,
       &#39;soapstone&#39;, &#39;chert&#39;, &#39;shale&#39;, &#39;rock crystal&#39;, &#39;tuff&#39;, &#39;steatite&#39;,
       &#39;basalt&#39;, &#39;cornelian&#39;, &#39;lak&#39;, &#39;basanite&#39;, &#39;flint&#39;, &#39;metal&#39;,
       &#39;ophicalcite&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d_mat</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_mats_clean</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_mat_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d_mat</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">unmatched_mat_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b0caffb5-7efb-4bd3-be4b-a98543c77e3b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>18367</td>
    </tr>
    <tr>
      <th>1</th>
      <td>composite</td>
      <td>3598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>serpentine</td>
      <td>141</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chalcedony</td>
      <td>86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>hematite</td>
      <td>71</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58</th>
      <td>composition</td>
      <td>1</td>
    </tr>
    <tr>
      <th>59</th>
      <td>stone: red limestone: stone:  lapis lazuli</td>
      <td>1</td>
    </tr>
    <tr>
      <th>60</th>
      <td>other</td>
      <td>1</td>
    </tr>
    <tr>
      <th>61</th>
      <td>ston</td>
      <td>1</td>
    </tr>
    <tr>
      <th>62</th>
      <td>ophicalcite</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b0caffb5-7efb-4bd3-be4b-a98543c77e3b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b0caffb5-7efb-4bd3-be4b-a98543c77e3b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b0caffb5-7efb-4bd3-be4b-a98543c77e3b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6a70fc4c-ed8c-4753-827d-360eb9ffe789">
  <button class="colab-df-quickchart" onclick="quickchart('df-6a70fc4c-ed8c-4753-827d-360eb9ffe789')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6a70fc4c-ed8c-4753-827d-360eb9ffe789 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_mat_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3900</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Material Labels of the Tablets not in FactGrid</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9be8b9869e97849c75a0161341e1ff8cd11a79238d2107ab6137adb976e3beb.png" src="_images/b9be8b9869e97849c75a0161341e1ff8cd11a79238d2107ab6137adb976e3beb.png" />
</div>
</div>
</section>
<section id="what-materials-are-tablets-that-have-languages-on-them-made-of">
<h4>What materials are tablets that have languages on them made of?<a class="headerlink" href="#what-materials-are-tablets-that-have-languages-on-them-made-of" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># slice the matched_mat_df with no_match_indices_lang</span>
<span class="n">lang_mat_matched_df</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="c1"># count the materials and create a df for the material with corresponding count</span>
<span class="n">lang_mat_matched_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lang_mat_matched_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="c1"># rename the columns</span>
<span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_mat_matched_counts</span> <span class="o">=</span> <span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># sort the rows by count</span>
<span class="n">lang_mat_matched_counts</span> <span class="o">=</span> <span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">lang_mat_matched_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5f5b43fb-7d28-4257-8afd-ca5a102f3918" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_mat_label</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>clay</td>
      <td>239720</td>
    </tr>
    <tr>
      <th>12</th>
      <td>stone</td>
      <td>10375</td>
    </tr>
    <tr>
      <th>0</th>
      <td></td>
      <td>3473</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bronze</td>
      <td>228</td>
    </tr>
    <tr>
      <th>6</th>
      <td>gypsum</td>
      <td>63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>copper</td>
      <td>41</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gold</td>
      <td>26</td>
    </tr>
    <tr>
      <th>11</th>
      <td>silver</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bone</td>
      <td>12</td>
    </tr>
    <tr>
      <th>9</th>
      <td>metal</td>
      <td>11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lead</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>shell</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>iron</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5f5b43fb-7d28-4257-8afd-ca5a102f3918')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5f5b43fb-7d28-4257-8afd-ca5a102f3918 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5f5b43fb-7d28-4257-8afd-ca5a102f3918');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5038f688-18fa-4785-a8b7-5f382b0cd2ec">
  <button class="colab-df-quickchart" onclick="quickchart('df-5038f688-18fa-4785-a8b7-5f382b0cd2ec')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5038f688-18fa-4785-a8b7-5f382b0cd2ec button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">lang_mat_matched_counts</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_mat_label&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">262000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First Material Labels Tablets that Have Matched First Languages Are Made Of&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8dd271d2255d8174cec74bd72ee335a8f02d9d027180b961b95fe39a62b7e451.png" src="_images/8dd271d2255d8174cec74bd72ee335a8f02d9d027180b961b95fe39a62b7e451.png" />
</div>
</div>
</section>
</section>
<section id="oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id">
<h3><strong>2.3. ORACC - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong><a class="headerlink" href="#oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mat_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;material_y&#39;</span><span class="p">]]</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material_y&#39;</span><span class="p">]</span>
<span class="n">mat2</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, nan, &#39;stone: limestone&#39;, &#39;metal: bronze&#39;, &#39;stone&#39;,
       &#39;stone: granite&#39;, &#39;stone: calcite&#39;, &#39;stone: alabaster&#39;,
       &#39;stone: diorite&#39;, &#39;bitumen&#39;, &#39;stone: marble&#39;, &#39;metal&#39;,
       &#39;metal: copper&#39;, &#39;stone: dolomite&#39;, &#39;stone: steatite&#39;,
       &#39;stone: haematite&#39;, &#39;bone: shell&#39;, &#39;stone: dolerite&#39;,
       &#39;stone: slate&#39;, &#39;metal: gold&#39;, &#39;stone: carnelian&#39;,
       &#39;clay: terracotta&#39;, &#39;stone: onyx&#39;, &#39;stone: basalt&#39;,
       &#39;stone: schist&#39;, &#39;stone: aragonite&#39;, &#39;stone: gypsum&#39;,
       &#39;metal: silver&#39;, &#39;stone: hornfels&#39;, &#39;stone: porphyry&#39;,
       &#39;stone: lava&#39;, &#39;stone: chlorite&#39;, &#39;stone: lapis lazuli&#39;,
       &#39;stone: trachyte&#39;, &#39;stone: sandstone&#39;, &#39;stone: tuff&#39;,
       &#39;stone: agate&#39;, &#39;bone: shell; stone: gypsum, lapis lazuli&#39;,
       &#39;metal: bronze; stone: steatite&#39;, &#39;stone: obsidian&#39;,
       &#39;stone: chalcedony&#39;, &#39;clay; metal: bronze; stone: steatite&#39;,
       &#39;clay; metal: bronze; stone&#39;, &#39;stone: chlorite, schist&#39;,
       &#39;bone: ivory&#39;, &#39;clay; metal: copper&#39;, &#39;stone: felsite&#39;,
       &#39;metal: copper; stone&#39;, &#39;gypsum: plaster&#39;,
       &#39;stone: dolerite, quartz&#39;, &#39;stone: limestone; metal: bronze&#39;,
       &#39;stone: diabase&#39;, &#39;stone: serpentine&#39;, &#39;stone: hematite&#39;, &#39;Clay&#39;,
       &#39;glass&#39;, &#39;stone: feldspar&#39;, &#39;stone: magnetite&#39;, &#39;Stone&#39;,
       &#39;clay; gypsum: plaster&#39;, &#39;stone: travertine&#39;, &#39;stone:marble&#39;,
       &#39;stone: crystal; metal: silver, gold&#39;, &#39;composite&#39;,
       &#39;stone: amethyst&#39;, &#39;metal: electrum&#39;, &#39;stone: banded-agate&#39;,
       &#39;stone: agate or onyx&#39;, &#39;stone: stalagmite&#39;, &#39;metal: lead&#39;,
       &#39;stone: magnesite&#39;, &#39;stone: cornelian&#39;, &#39;stone: porcelain&#39;,
       &#39;metal: bronze or copper&#39;, &#39;stone: turquoise&#39;, &#39;stone: breccia&#39;,
       &#39;metal: iron&#39;, &#39;stone: jadeite&#39;, &#39;metal: bronze; stone&#39;,
       &#39;stone: copper&#39;, &#39;stone: greenstone&#39;, &#39;metal: copper, silver&#39;,
       &#39;stone: alabaster, clay&#39;, &#39;stone, clay&#39;, &#39;clay (original: stone)&#39;,
       &#39;clay, stone&#39;, &#39;stone: limestone, obsisian&#39;, &#39;clay; metal: bronze&#39;,
       &#39;stone: diorite, limestone&#39;, &#39;clay; stone: limestone, diorite&#39;,
       &#39;stone; stone: diorite, metal: bronze; clay&#39;,
       &#39;stone: limestone; clay&#39;, &#39;clay; stone: limestone&#39;,
       &#39;stone: marble, steatite&#39;, &#39;clay; stone; metal: bronze&#39;,
       &#39;metal: bronze; stone: steatite or basalt&#39;,
       &#39;stone; stone: limestone&#39;, &#39;metal: copper, stone: steatite&#39;,
       &#39;stone: steatite  or diorite; metal: bronze&#39;,
       &#39;metal: copper, stone&#39;,
       &#39;clay; metal: copper, bronze, iron; stone; wood&#39;,
       &#39;stone: diorite, basalt, granite&#39;,
       &#39;stone: diorite, granite, limestone&#39;, &#39;stone; metal: bronze&#39;,
       &#39;stone: lapis lazuli, schist, steatite; metal: bronze&#39;,
       &#39;stone: diorite, granite&#39;, &#39;stone: alabaster, steatite&#39;,
       &#39;stone: mother of pearl&#39;, &#39;stone: alabaster; metal: copper; clay&#39;,
       &#39;metal: copper or bronze&#39;, &#39;stone: syenite&#39;,
       &#39;clay; stone; metal: copper&#39;, &#39;stone: steatite or basalt&#39;,
       &#39;stone: pumice&#39;, &#39;metal: copper, gold&#39;,
       &#39;stone: marble; metal: copper&#39;, &#39;stone; stone: diorite&#39;,
       &#39;stone: calcite or aragonite&#39;, &#39;clay; stone; stone: limestone&#39;,
       &#39;stone: granite or diorite&#39;, &#39;stone: gmarble&#39;,
       &#39;stone: calcite stalagmite&#39;, &#39;stone: greenstone schist&#39;,
       &#39;bituminous substance&#39;, &#39;stone: shell&#39;, &#39;stone: marbe&#39;,
       &#39;stone: alabaster or paragonite&#39;, &#39;stone: diorite or gabbro&#39;,
       &#39;stone: uralite-quartz-dolerite&#39;, &#39;stone: soapstone&#39;,
       &#39;stone: basic hornfels&#39;, &#39;ivory&#39;, &#39;stone: jasper&#39;, &#39;stone: cacite&#39;,
       &#39;stone: chalcedon, agate&#39;, &#39;metal: copper; clay&#39;,
       &#39;metal: copper, stone: soapstone&#39;, &#39;clay; stone: steatite&#39;,
       &#39;metal: copper; stone; clay&#39;, &#39;stone: hornblende-diorite&#39;,
       &#39;stone: limestone; metal: bronze, copper&#39;, &#39;stone: diorite; clay&#39;,
       &#39;unknown&#39;, &#39;stone: stalagmitic calcite&#39;, &#39;stone; bone (ivory)&#39;,
       &#39;stone: slate or shale&#39;, &#39;stone: calcite, limestone&#39;,
       &#39;clay, stone, metal&#39;, &#39;clay, metal&#39;, &#39;stone, metal&#39;,
       &#39;glass; stone: alabaster, calcite, yellow calcite (or alabaster)&#39;,
       &#39;stone: &quot;marble&quot;&#39;, &#39;stone: calcite, onyx&#39;, &#39;bone&#39;, &#39;rock&#39;,
       &#39;stone ?&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>But as usual, we need to first clean the material column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the `\x0b` pattern</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x0b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mat2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat2</span><span class="p">))])</span>
<span class="c1"># there are different versions of NA, merge them into one</span>
<span class="n">mat2</span><span class="p">[</span><span class="n">mat2</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># lowercase all</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">mat2</span><span class="p">)</span>

<span class="c1"># update the language dataframe</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat2</span>

<span class="c1"># check if the language dataframe has been properly cleaned</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-59-164a5d10a9fc&gt;:9: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;material&#39;] = mat2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-6898006b-058a-47dc-981b-8d1d64544f37" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>material_y</th>
      <th>material</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6898006b-058a-47dc-981b-8d1d64544f37')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6898006b-058a-47dc-981b-8d1d64544f37 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6898006b-058a-47dc-981b-8d1d64544f37');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-070efbce-2488-4408-ba4d-f334c4af89f8">
  <button class="colab-df-quickchart" onclick="quickchart('df-070efbce-2488-4408-ba4d-f334c4af89f8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-070efbce-2488-4408-ba4d-f334c4af89f8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>add in the matched information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_label2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_mat2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_mat2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple materials</span>
<span class="n">no_match_indices_mat2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="n">FG_existing_materials</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">])):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first material</span>
  <span class="n">first_m</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining materials (if exist) away</span>
  <span class="n">other_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
    <span class="n">P155_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_m</span> <span class="o">=</span> <span class="n">first_m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># store the original first_m for investigating finer categories later</span>
  <span class="n">first_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_m</span><span class="p">]</span>

  <span class="c1"># add in qid and label for the first_m</span>

  <span class="c1"># if the material has a QID in FactGrid</span>
  <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FG_existing_materials</span><span class="p">)):</span>
    <span class="n">material</span> <span class="o">=</span> <span class="n">FG_existing_materials</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">material</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
      <span class="n">first_mat_label2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">material</span><span class="p">]</span>
      <span class="n">first_mat_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">short_mat_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span>
      <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">break</span>

  <span class="c1"># if the material does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">if</span> <span class="n">matched</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">first_mat_label2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_mat_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_label2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_qid2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;P155_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_mat2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;other_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_mat2</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">mat_df2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;material_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_material_dump&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dump refers to an unnecessary column from original data&quot;</span><span class="p">)</span>
<span class="n">mat_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dump refers to an unnecessary column from original data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-60-0bdd50b0964a&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;first_mat&#39;] = first_mat2
&lt;ipython-input-60-0bdd50b0964a&gt;:51: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;first_mat_label&#39;] = first_mat_label2
&lt;ipython-input-60-0bdd50b0964a&gt;:52: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;first_mat_qid&#39;] = first_mat_qid2
&lt;ipython-input-60-0bdd50b0964a&gt;:53: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;P155_mat&#39;] = P155_mat2
&lt;ipython-input-60-0bdd50b0964a&gt;:54: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;other_mat&#39;] = other_mat2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-a66bcc60-9ea1-48e1-8169-cf2924e8e4b8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a66bcc60-9ea1-48e1-8169-cf2924e8e4b8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a66bcc60-9ea1-48e1-8169-cf2924e8e4b8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a66bcc60-9ea1-48e1-8169-cf2924e8e4b8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-26323b35-e488-49b1-a263-dd2c6311cb1f">
  <button class="colab-df-quickchart" onclick="quickchart('df-26323b35-e488-49b1-a263-dd2c6311cb1f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-26323b35-e488-49b1-a263-dd2c6311cb1f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="matched-mat-df2">
<h4>2.3.1 matched_mat_df2<a class="headerlink" href="#matched-mat-df2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="p">[</span><span class="o">~</span><span class="n">mat_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_mat2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e17e2686-8026-4c48-b0b2-7c243769f708" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e17e2686-8026-4c48-b0b2-7c243769f708')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e17e2686-8026-4c48-b0b2-7c243769f708 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e17e2686-8026-4c48-b0b2-7c243769f708');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7f35254b-d244-4a14-91f1-d6672a1560f9">
  <button class="colab-df-quickchart" onclick="quickchart('df-7f35254b-d244-4a14-91f1-d6672a1560f9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7f35254b-d244-4a14-91f1-d6672a1560f9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>a little sanity check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(47260, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, &#39;stone&#39;, &#39;bronze&#39;, &#39;metal&#39;, &#39;copper&#39;, &#39;bone&#39;, &#39;gold&#39;,
       &#39;gypsum&#39;, &#39;silver&#39;, &#39;lead&#39;, &#39;iron&#39;, &#39;shell&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>finer categories</p>
<p>Now, let’s see what finer categories are there under the big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat_finer_category2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">full_mat2</span> <span class="o">=</span> <span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;first_mat&#39;</span><span class="p">]</span>
  <span class="k">if</span> <span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">full_mat2</span><span class="p">:</span>
    <span class="n">finer_mat2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(?&lt;=: ).*&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">full_mat2</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove the parenthesis</span>
    <span class="n">finer_mat2</span> <span class="o">=</span> <span class="n">finer_mat2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># remove the space at the end of the string, if any</span>
    <span class="n">finer_mat2</span> <span class="o">=</span> <span class="n">finer_mat2</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># check if this is a big label</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">finer_mat2</span> <span class="ow">in</span> <span class="n">FG_existing_materials</span><span class="p">:</span>
      <span class="n">first_mat_finer_category2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finer_mat2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">first_mat_finer_category2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_mat_finer_category2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

<span class="n">matched_mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_finer_category2</span>

<span class="n">matched_mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;&#39;, &#39;limestone&#39;, &#39;granite&#39;, &#39;calcite&#39;, &#39;alabaster&#39;, &#39;diorite&#39;,
       &#39;marble&#39;, &#39;dolomite&#39;, &#39;steatite&#39;, &#39;haematite&#39;, &#39;dolerite&#39;, &#39;slate&#39;,
       &#39;carnelian&#39;, &#39;terracotta&#39;, &#39;onyx&#39;, &#39;basalt&#39;, &#39;schist&#39;, &#39;aragonite&#39;,
       &#39;hornfels&#39;, &#39;porphyry&#39;, &#39;lava&#39;, &#39;chlorite&#39;, &#39;lapis lazuli&#39;,
       &#39;trachyte&#39;, &#39;sandstone&#39;, &#39;tuff&#39;, &#39;agate&#39;, &#39;obsidian&#39;, &#39;chalcedony&#39;,
       &#39;ivory&#39;, &#39;felsite&#39;, &#39;plaster&#39;, &#39;diabase&#39;, &#39;serpentine&#39;, &#39;hematite&#39;,
       &#39;feldspar&#39;, &#39;magnetite&#39;, &#39;travertine&#39;, &#39;crystal&#39;, &#39;amethyst&#39;,
       &#39;electrum&#39;, &#39;banded-agate&#39;, &#39;agate or onyx&#39;, &#39;stalagmite&#39;,
       &#39;magnesite&#39;, &#39;cornelian&#39;, &#39;porcelain&#39;, &#39;bronze or copper&#39;,
       &#39;turquoise&#39;, &#39;breccia&#39;, &#39;jadeite&#39;, &#39;greenstone&#39;,
       &#39;steatite  or diorite&#39;, &#39;mother of pearl&#39;, &#39;copper or bronze&#39;,
       &#39;syenite&#39;, &#39;steatite or basalt&#39;, &#39;pumice&#39;, &#39;calcite or aragonite&#39;,
       &#39;granite or diorite&#39;, &#39;gmarble&#39;, &#39;calcite stalagmite&#39;,
       &#39;greenstone schist&#39;, &#39;marbe&#39;, &#39;alabaster or paragonite&#39;,
       &#39;diorite or gabbro&#39;, &#39;uralite-quartz-dolerite&#39;, &#39;soapstone&#39;,
       &#39;basic hornfels&#39;, &#39;jasper&#39;, &#39;cacite&#39;, &#39;chalcedon&#39;,
       &#39;hornblende-diorite&#39;, &#39;stalagmitic calcite&#39;, &#39;slate or shale&#39;,
       &#39;&quot;marble&quot;&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-mat-df2">
<h4>2.3.2 no_match_mat_df2<a class="headerlink" href="#no-match-mat-df2" title="Link to this heading">#</a></h4>
<p>Make a separate dataframe of the items not matched for export and supervision: <code class="docutils literal notranslate"><span class="pre">no_material_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat2</span><span class="p">]</span>
<span class="n">no_match_mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-deb481bd-0866-43fc-8daa-b0c9bf1abfd8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>669</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000730</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15316</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,1</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>670</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000731</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15315</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,2</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>671</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000732</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15345</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02134</td>
      <td>?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>672</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000733</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15289</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02352</td>
      <td>Oc XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>673</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000734</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15245</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 05233,a</td>
      <td>Pd XVI,4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-deb481bd-0866-43fc-8daa-b0c9bf1abfd8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-deb481bd-0866-43fc-8daa-b0c9bf1abfd8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-deb481bd-0866-43fc-8daa-b0c9bf1abfd8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8cf71a05-5895-411d-977f-ac9273cc0421">
  <button class="colab-df-quickchart" onclick="quickchart('df-8cf71a05-5895-411d-977f-ac9273cc0421')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8cf71a05-5895-411d-977f-ac9273cc0421 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(319656, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>#####2.3.3 Visualization of ORACC Materials</p>
</section>
<section id="id1">
<h4>Distribution of matched first materials<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_m_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_m_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_m_df2</span> <span class="o">=</span> <span class="n">first_m_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_label&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_m_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-57924c66-df43-481c-a7ce-cd57d01f23b0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>clay</td>
      <td>40954</td>
    </tr>
    <tr>
      <th>11</th>
      <td>stone</td>
      <td>5591</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bronze</td>
      <td>422</td>
    </tr>
    <tr>
      <th>8</th>
      <td>metal</td>
      <td>95</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gypsum</td>
      <td>63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>copper</td>
      <td>61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gold</td>
      <td>33</td>
    </tr>
    <tr>
      <th>10</th>
      <td>silver</td>
      <td>16</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bone</td>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lead</td>
      <td>10</td>
    </tr>
    <tr>
      <th>9</th>
      <td>shell</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iron</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-57924c66-df43-481c-a7ce-cd57d01f23b0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-57924c66-df43-481c-a7ce-cd57d01f23b0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-57924c66-df43-481c-a7ce-cd57d01f23b0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f807671b-0471-4491-b86f-975292a775ad">
  <button class="colab-df-quickchart" onclick="quickchart('df-f807671b-0471-4491-b86f-975292a775ad')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f807671b-0471-4491-b86f-975292a775ad button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_m_df2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;First Material Used in Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of First Materials on Tablets that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1aeae0febb9c61ab71e136717565f69d7eafb95b837e0f379e68794dedac45ab.png" src="_images/1aeae0febb9c61ab71e136717565f69d7eafb95b837e0f379e68794dedac45ab.png" />
</div>
</div>
</section>
<section id="id2">
<h4>Distribution of finer categories within matched materials<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>We have recorded the big material labels for the matched tablets. The graph below summarizes the finer categories within those big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">finer_cat_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">finer_cat_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">finer_cat_df2</span> <span class="o">=</span> <span class="n">finer_cat_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">finer_cat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finer_cat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">)</span>
<span class="n">finer_cat_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c60fc7cf-26df-4d24-b743-f025f6ab0963" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>undetermined</td>
      <td>45187</td>
    </tr>
    <tr>
      <th>46</th>
      <td>limestone</td>
      <td>945</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alabaster</td>
      <td>249</td>
    </tr>
    <tr>
      <th>25</th>
      <td>diorite</td>
      <td>166</td>
    </tr>
    <tr>
      <th>14</th>
      <td>calcite</td>
      <td>143</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>cornelian</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>copper or bronze</td>
      <td>1</td>
    </tr>
    <tr>
      <th>55</th>
      <td>porcelain</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>chalcedon</td>
      <td>1</td>
    </tr>
    <tr>
      <th>75</th>
      <td>uralite-quartz-dolerite</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>76 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c60fc7cf-26df-4d24-b743-f025f6ab0963')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c60fc7cf-26df-4d24-b743-f025f6ab0963 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c60fc7cf-26df-4d24-b743-f025f6ab0963');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1e957b2c-0309-495d-81ec-6b92ac8e7f77">
  <button class="colab-df-quickchart" onclick="quickchart('df-1e957b2c-0309-495d-81ec-6b92ac8e7f77')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1e957b2c-0309-495d-81ec-6b92ac8e7f77 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Note that there are unproportionately the most records that have NA value for their material. Since the purpose of this plot is to determine which labels to add into FactGrid, we will exclude the undetermined ones when we plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">finer_cat_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1150</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Sub-Category of First Materials on Tablets that Matched FactGrid Records</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d43316cd6ff74847ddb7759904fddf43767d8b01667e799f6320af9c132aa858.png" src="_images/d43316cd6ff74847ddb7759904fddf43767d8b01667e799f6320af9c132aa858.png" />
</div>
</div>
</section>
<section id="id3">
<h4>Distribution of unmatched materials<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Select the top 10 of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_mats2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat2</span><span class="p">][</span><span class="s1">&#39;oracc_material_dump&#39;</span><span class="p">]</span>
<span class="n">unmatched_mats_clean2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">nancount</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">unmatched_mats2</span><span class="p">:</span>
  <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
    <span class="n">nancount</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">elif</span> <span class="n">m</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-language statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_mats_clean2</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_mats_clean2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_mats_clean2</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nancount</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; nans in the ORACC materials&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_mats_clean2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 319626 nans in the ORACC materials
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;bitumen&#39;, &#39;glass&#39;, &#39;composite&#39;, &#39;bituminous substance&#39;, &#39;ivory&#39;,
       &#39;unknown&#39;, &#39;stone: alabaster&#39;, &#39;calcite&#39;,
       &#39;yellow calcite (or alabaster)&#39;, &#39;rock&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d_mat2</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_mats_clean2</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_mat_counts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d_mat2</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nancount</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; nans in the ORACC materials&#39;</span><span class="p">)</span>
<span class="n">unmatched_mat_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 319626 nans in the ORACC materials
</pre></div>
</div>
<div class="output text_html">
  <div id="df-59672087-ae86-4375-adc2-b351b499b27b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bitumen</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>unknown</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>glass</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ivory</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>composite</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bituminous substance</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>stone: alabaster</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>calcite</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>yellow calcite (or alabaster)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>rock</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-59672087-ae86-4375-adc2-b351b499b27b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-59672087-ae86-4375-adc2-b351b499b27b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-59672087-ae86-4375-adc2-b351b499b27b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9b51323b-8a54-461c-b251-474f29543be2">
  <button class="colab-df-quickchart" onclick="quickchart('df-9b51323b-8a54-461c-b251-474f29543be2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9b51323b-8a54-461c-b251-474f29543be2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_mat_counts2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Material Labels of the Tablets not in FactGrid</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a4f9d4b3e51a80ce35e25c6a9e33037412c261b8621582effb27648720fed53.png" src="_images/7a4f9d4b3e51a80ce35e25c6a9e33037412c261b8621582effb27648720fed53.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">matched_mat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(344225, 9)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-3c1dc544-0e9e-4b08-8f27-d80b3a6c057a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
      <th>first_mat_finer_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3c1dc544-0e9e-4b08-8f27-d80b3a6c057a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3c1dc544-0e9e-4b08-8f27-d80b3a6c057a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3c1dc544-0e9e-4b08-8f27-d80b3a6c057a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cb8f6df2-db9f-4cf0-b80d-025e135f5932">
  <button class="colab-df-quickchart" onclick="quickchart('df-cb8f6df2-db9f-4cf0-b80d-025e135f5932')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cb8f6df2-db9f-4cf0-b80d-025e135f5932 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(47260, 9)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-c585a9c0-9471-43a9-b944-cac6fee45e51" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
      <th>first_mat_finer_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c585a9c0-9471-43a9-b944-cac6fee45e51')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c585a9c0-9471-43a9-b944-cac6fee45e51 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c585a9c0-9471-43a9-b944-cac6fee45e51');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3d54ad0a-3c92-4666-86c2-3cc4c5b83219">
  <button class="colab-df-quickchart" onclick="quickchart('df-3d54ad0a-3c92-4666-86c2-3cc4c5b83219')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3d54ad0a-3c92-4666-86c2-3cc4c5b83219 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="combining-cdli-and-oracc-material-dataframes">
<h3><strong>2.4 Combining CDLI and ORACC Material dataframes</strong><a class="headerlink" href="#combining-cdli-and-oracc-material-dataframes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">materials_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mat_df</span><span class="p">,</span> <span class="n">mat_df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_materials_df</span> <span class="o">=</span> <span class="n">materials_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;material_x&#39;</span><span class="p">,</span> <span class="s1">&#39;material_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;first_mat_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_mat_y&#39;</span><span class="p">,</span> <span class="s1">&#39;first_mat_label_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_mat_label_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_mat_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;P155_mat_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_mat_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;other_mat_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_mat_y&#39;</span><span class="p">]]</span>
<span class="n">final_materials_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-580fbcdc-6ede-4ced-8d11-df4a9acd3bbd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>first_mat_x</th>
      <th>first_mat_y</th>
      <th>first_mat_label_x</th>
      <th>first_mat_label_y</th>
      <th>first_mat_qid_x</th>
      <th>first_mat_qid_y</th>
      <th>P155_mat_x</th>
      <th>P155_mat_y</th>
      <th>other_mat_x</th>
      <th>other_mat_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-580fbcdc-6ede-4ced-8d11-df4a9acd3bbd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-580fbcdc-6ede-4ced-8d11-df4a9acd3bbd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-580fbcdc-6ede-4ced-8d11-df4a9acd3bbd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f3967c0a-6a55-4fbd-b594-28105e2ea7d1">
  <button class="colab-df-quickchart" onclick="quickchart('df-f3967c0a-6a55-4fbd-b594-28105e2ea7d1')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f3967c0a-6a55-4fbd-b594-28105e2ea7d1 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="museum-collection-present-holding-p329">
<h2>3 <strong>museum/collection = present holding <a class="reference external" href="https://database.factgrid.de/wiki/Property:P329">(P329)</a></strong><a class="headerlink" href="#museum-collection-present-holding-p329" title="Link to this heading">#</a></h2>
<p>####3.1 CDLI collection</p>
<p>Next we list all the unique statements in the ‘collection’ field in a data frame, <code class="docutils literal notranslate"><span class="pre">museum_df</span></code> and match them with the FactGrid Q-ids.</p>
<p>We can use this dataset, which has the corresponding FactGrid Q-ids for some, but perhaps not all (after we see how many FG items are needed to match, Adam will finish making the necessary Q-ids in FactGrid): <a class="reference external" href="https://docs.google.com/spreadsheets/d/1BdRndVP3JFGWAtv1WTlXiYsGBuCADHnblYeoihfQcLI/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1BdRndVP3JFGWAtv1WTlXiYsGBuCADHnblYeoihfQcLI/edit?usp=sharing</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Museum%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">collection_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># only use a certain collection of columns</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[[</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="s1">&#39;factgrid_id&#39;</span><span class="p">,</span> <span class="s1">&#39;wikidata_id&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_native&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_url&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">,</span> <span class="s1">&#39;wiki_url_native&#39;</span><span class="p">]]</span>
<span class="c1"># fill na values with space</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># remove entries without a FactGrid QID</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;factgrid_id&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="n">collection_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9a583fa5-2029-4903-9b26-7995e8acc3f6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection</th>
      <th>factgrid_id</th>
      <th>wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Louvre Museum, Paris, France</td>
      <td>Q511925</td>
      <td>Q19675</td>
      <td>Louvre</td>
      <td>Louvre</td>
      <td>https://www.louvre.fr</td>
      <td>https://en.wikipedia.org/wiki/Louvre</td>
      <td>https://ar.wikipedia.org/wiki/متحف_اللوفر</td>
    </tr>
    <tr>
      <th>2</th>
      <td>British Museum, London, UK</td>
      <td>Q102010</td>
      <td>Q6373</td>
      <td>British Museum</td>
      <td>British Museum</td>
      <td>https://www.britishmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Q511934</td>
      <td>Q636400</td>
      <td>Ashmolean Museum</td>
      <td>Ashmolean Museum</td>
      <td>https://www.ashmolean.org</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>Q512004</td>
      <td>Q160236</td>
      <td>Metropolitan Museum of Art</td>
      <td>Metropolitan Museum of Art</td>
      <td>https://www.metmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Rubenstein Rare Book &amp; Manuscript Library, Duk...</td>
      <td>Q511884</td>
      <td>Q74061200</td>
      <td>David M. Rubenstein Rare Book &amp; Manuscript Lib...</td>
      <td>David M. Rubenstein Rare Book &amp; Manuscript Lib...</td>
      <td>https://library.duke.edu/rubenstein/about/library</td>
      <td>https://en.wikipedia.org/wiki/Duke_University_...</td>
      <td>https://en.wikipedia.org/wiki/Duke_University_...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Università Cattolica del S. Cuore, Milan, Italy</td>
      <td>Q511917</td>
      <td>Q229022</td>
      <td>Università Cattolica del Sacro Cuore</td>
      <td>Università Cattolica del Sacro Cuore</td>
      <td>https://www.unicatt.it</td>
      <td>https://en.wikipedia.org/wiki/Università_Catto...</td>
      <td>https://it.wikipedia.org/wiki/Università_Catto...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>University of Liège, Liège, Belgium</td>
      <td>Q173222</td>
      <td>Q1334582</td>
      <td>University of Liège</td>
      <td>Université de Liège</td>
      <td>https://www.uliege.be</td>
      <td>https://en.wikipedia.org/wiki/University_of_Liège</td>
      <td>https://fr.wikipedia.org/wiki/Université_de_Liège</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Oriental Institute Museum</td>
      <td>Q511904</td>
      <td>Q1276053</td>
      <td>Oriental Institute Museum</td>
      <td>Oriental Institute Museum</td>
      <td>https://oi.uchicago.edu/museum-exhibits</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
    </tr>
    <tr>
      <th>73</th>
      <td>University of Southern California</td>
      <td>Q511879</td>
      <td>Q4614</td>
      <td>University of Southern California</td>
      <td>University of Southern California</td>
      <td>https://www.usc.edu</td>
      <td>https://en.wikipedia.org/wiki/University_of_So...</td>
      <td>https://en.wikipedia.org/wiki/University_of_So...</td>
    </tr>
  </tbody>
</table>
<p>74 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9a583fa5-2029-4903-9b26-7995e8acc3f6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9a583fa5-2029-4903-9b26-7995e8acc3f6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9a583fa5-2029-4903-9b26-7995e8acc3f6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c65a1b26-0adf-432d-b21a-0ba5f60dee81">
  <button class="colab-df-quickchart" onclick="quickchart('df-c65a1b26-0adf-432d-b21a-0ba5f60dee81')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c65a1b26-0adf-432d-b21a-0ba5f60dee81 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="collection-df">
<h3>3.1.2 collection_df<a class="headerlink" href="#collection-df" title="Link to this heading">#</a></h3>
<p>Match on cdli label to obtain the corresponding FactGrid Q-id for ‘collection’ field and add matching data to <code class="docutils literal notranslate"><span class="pre">museum_df</span></code>.</p>
<p>From the cdil_cat.csv include a column / field for the corresponding <strong>‘museum_no’ = ‘inventory position’ <a class="reference external" href="https://database.factgrid.de/wiki/Property:P10">(P10)</a></strong>.</p>
<p>Format of the result: <a class="reference external" href="https://cdli.mpiwg-berlin.mpg.de/search?simple-value%5B%5D=P215773&amp;amp;simple-field%5B%5D=keyword">Example</a></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>collection</p></th>
<th class="head"><p>museum_no</p></th>
<th class="head"><p>factgrid_id</p></th>
<th class="head"><p>wikidata_id</p></th>
<th class="head"><p>P155</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>P215773</p></td>
<td><p>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey</p></td>
<td><p>Ist EŞEM 00501</p></td>
<td><p>Q511898</p></td>
<td><p>Q636978</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>If there are any question marks, we can use the P155 field and fill the cell with <a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a></p></li>
<li><p>There are of course more fields in the dataset linked above which we will want to get once the matching stage is finalized (i.e. those fields highlighted in green)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_x&#39;</span><span class="p">]]</span>
<span class="n">collection_df</span> <span class="o">=</span> <span class="n">collection_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;collection_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">})</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Vorderasiatisches Museum, Berlin, Germany&#39;,
       ..., &#39;Mardin Museum, Mardin, Turkey&#39;, &#39;Oylum Höyük, Oylum, Turkey&#39;,
       &#39;private: William T. Grant Jr., Pelham Manor, New York, USA&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_wikidata_id</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name_native</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_url</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_eng</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_native</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_collection</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_collection</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple collections</span>
<span class="n">no_match_indices_collection</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">])):</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_c</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_c</span><span class="p">:</span>
    <span class="n">P155_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_c</span> <span class="o">=</span> <span class="n">first_c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_c</span>

  <span class="c1"># if the collection has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_c</span> <span class="ow">in</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">collection</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_c</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_c</span><span class="p">)</span>
    <span class="n">collection_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;factgrid_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_wikidata_id</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wikidata_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name_native</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_url</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_eng</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_native</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_wikidata_id</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name_native</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_url</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_eng</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_native</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_qid</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_wikidata_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_wikidata_id</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name_native</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_url</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_eng</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_native</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;P155_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_collection</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;other_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_collection</span>

<span class="n">collection_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-645c7f44-77c7-47e6-bfcd-dadaa38f68bb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-645c7f44-77c7-47e6-bfcd-dadaa38f68bb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-645c7f44-77c7-47e6-bfcd-dadaa38f68bb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-645c7f44-77c7-47e6-bfcd-dadaa38f68bb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f0803383-2ef9-48b2-8ec1-d8138141ec86">
  <button class="colab-df-quickchart" onclick="quickchart('df-f0803383-2ef9-48b2-8ec1-d8138141ec86')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f0803383-2ef9-48b2-8ec1-d8138141ec86 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-collection-df">
<h3>3.1.3 matched_collection_df<a class="headerlink" href="#matched-collection-df" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df</span> <span class="o">=</span> <span class="n">collection_df</span><span class="p">[</span><span class="o">~</span><span class="n">collection_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_collection</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_collection_df</span> <span class="o">=</span> <span class="n">matched_collection_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_collection_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-80e67c03-0c5a-4a87-84bd-ba813bfc4e7f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdli_dump_id</th>
      <th>cdli_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>237386</th>
      <td>P532441</td>
      <td>National Museum of Syria, Damascus, Syria ?</td>
      <td>National Museum of Syria, Damascus, Syria</td>
      <td>Q511875</td>
      <td>Q617254</td>
      <td>Damascus National Museum</td>
      <td>المتحف الوطني دمشق</td>
      <td>http://dgam.gov.sy/المتاحف-الوطنية/المتحف-الوطني/</td>
      <td>https://en.wikipedia.org/wiki/National_Museum_...</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_الوطني_بدمشق</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>237387</th>
      <td>P532442</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>237388</th>
      <td>P532443</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>237389</th>
      <td>P532444</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>237390</th>
      <td>P532445</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>237391 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-80e67c03-0c5a-4a87-84bd-ba813bfc4e7f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-80e67c03-0c5a-4a87-84bd-ba813bfc4e7f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-80e67c03-0c5a-4a87-84bd-ba813bfc4e7f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-26e3e2b7-48d6-4a5f-a2d4-4655e269021c">
  <button class="colab-df-quickchart" onclick="quickchart('df-26e3e2b7-48d6-4a5f-a2d4-4655e269021c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-26e3e2b7-48d6-4a5f-a2d4-4655e269021c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(237391, 12)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-collection-df">
<h3>3.1.4 no_match_collection_df<a class="headerlink" href="#no-match-collection-df" title="Link to this heading">#</a></h3>
<p>Make a separate data frame for the texts when there is no match / museum / collection: <code class="docutils literal notranslate"><span class="pre">no_collection_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection</span><span class="p">]</span>
<span class="n">no_match_collection_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-677c4d23-bf62-4bd5-8b87-08e92f9ec820" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000166</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19412,8</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19412,08</td>
      <td>Nb XVI,3/4</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000166</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>152</th>
      <td>Q000026</td>
      <td>0.0</td>
      <td>P000171</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19667,e</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19667,e</td>
      <td>Nc XVI,5</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Metal (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000171</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Q000023</td>
      <td>0.0</td>
      <td>P000173</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19724</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19724</td>
      <td>Nb XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Vessels and Garments (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000173</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000174</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,b</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,b</td>
      <td>Na XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000174</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Q000013</td>
      <td>0.0</td>
      <td>P000175</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,c</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,c</td>
      <td>Na XVI,3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Fish (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000175</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>S013836</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-677c4d23-bf62-4bd5-8b87-08e92f9ec820')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-677c4d23-bf62-4bd5-8b87-08e92f9ec820 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-677c4d23-bf62-4bd5-8b87-08e92f9ec820');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5b96b87d-bd28-41b2-b447-40c7ed1bbcd3">
  <button class="colab-df-quickchart" onclick="quickchart('df-5b96b87d-bd28-41b2-b447-40c7ed1bbcd3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5b96b87d-bd28-41b2-b447-40c7ed1bbcd3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(129525, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_collection_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h3>3.1.5 Visualization<a class="headerlink" href="#visualization" title="Link to this heading">#</a></h3>
<section id="distribution-of-matched-first-collections">
<h4>Distribution of matched first collections<a class="headerlink" href="#distribution-of-matched-first-collections" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_collection_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">)[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_c_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_c_df</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span>
               <span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_c_df</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_c_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-2966831f-4537-46db-a355-e2d1138430e6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>74943</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>26377</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>19207</td>
    </tr>
    <tr>
      <th>3</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>19072</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>15823</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Rubenstein Rare Book &amp; Manuscript Library, Duk...</td>
      <td>9</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>9</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Boston Public Library, Boston, Massachusetts, USA</td>
      <td>8</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Museon, The Hague, Holland</td>
      <td>7</td>
    </tr>
    <tr>
      <th>61</th>
      <td>National Geographic Society, Washington, DC, USA</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2966831f-4537-46db-a355-e2d1138430e6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2966831f-4537-46db-a355-e2d1138430e6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2966831f-4537-46db-a355-e2d1138430e6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a7acef5c-c966-46b7-b754-865b820ba7e7">
  <button class="colab-df-quickchart" onclick="quickchart('df-a7acef5c-c966-46b7-b754-865b820ba7e7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a7acef5c-c966-46b7-b754-865b820ba7e7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collection&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b661d58c00461e655d7e183c3161609c44cab4ed16f0ac6f3e7c89e9bad854ae.png" src="_images/b661d58c00461e655d7e183c3161609c44cab4ed16f0ac6f3e7c89e9bad854ae.png" />
</div>
</div>
</section>
<section id="distribution-of-countries">
<h4>Distribution of countries<a class="headerlink" href="#distribution-of-countries" title="Link to this heading">#</a></h4>
<p>of first collections that matched</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_country</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_c_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_country</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="n">collection_country</span> <span class="o">+=</span> <span class="p">[</span><span class="n">current_country</span><span class="p">]</span>

<span class="n">first_c_df</span><span class="p">[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_country</span>

<span class="n">first_c_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4420397f-adcd-4928-930c-7969e0e9db7e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
      <th>collection_country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>74943</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>26377</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>19207</td>
      <td>Turkey</td>
    </tr>
    <tr>
      <th>3</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>19072</td>
      <td>Iraq</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>15823</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Rubenstein Rare Book &amp; Manuscript Library, Duk...</td>
      <td>9</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>9</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Boston Public Library, Boston, Massachusetts, USA</td>
      <td>8</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Museon, The Hague, Holland</td>
      <td>7</td>
      <td>Holland</td>
    </tr>
    <tr>
      <th>61</th>
      <td>National Geographic Society, Washington, DC, USA</td>
      <td>4</td>
      <td>USA</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4420397f-adcd-4928-930c-7969e0e9db7e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4420397f-adcd-4928-930c-7969e0e9db7e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4420397f-adcd-4928-930c-7969e0e9db7e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fb2c0fdc-81f8-4ff5-a51e-a51d32372fb5">
  <button class="colab-df-quickchart" onclick="quickchart('df-fb2c0fdc-81f8-4ff5-a51e-a51d32372fb5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fb2c0fdc-81f8-4ff5-a51e-a51d32372fb5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_country_count</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;collection_country&#39;</span><span class="p">])[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">first_c_country_count</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-89-a59efc2431c5&gt;:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  first_c_country_count = first_c_df.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
&lt;ipython-input-89-a59efc2431c5&gt;:1: FutureWarning: The operation &lt;built-in function sum&gt; failed on a column. If any error is raised, this will raise an exception in a future version of pandas. Drop these columns to avoid this warning.
  first_c_country_count = first_c_df.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
</pre></div>
</div>
<div class="output text_html">
  <div id="df-72417868-9ff8-48f9-9dc8-b3887b487c9b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection_country</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>UK</td>
      <td>83258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USA</td>
      <td>73783</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Turkey</td>
      <td>20558</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Iraq</td>
      <td>19072</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Germany</td>
      <td>15023</td>
    </tr>
    <tr>
      <th>5</th>
      <td>France</td>
      <td>12973</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Syria</td>
      <td>5106</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RussianFederation</td>
      <td>2187</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Canada</td>
      <td>1367</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Italy</td>
      <td>1366</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Spain</td>
      <td>1161</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Belgium</td>
      <td>705</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Jerusalem</td>
      <td>271</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Denmark</td>
      <td>218</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Japan</td>
      <td>199</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Lebanon</td>
      <td>67</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Switzerland</td>
      <td>26</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Hungary</td>
      <td>20</td>
    </tr>
    <tr>
      <th>18</th>
      <td>CzechRepublic</td>
      <td>13</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Ireland</td>
      <td>11</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Holland</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-72417868-9ff8-48f9-9dc8-b3887b487c9b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-72417868-9ff8-48f9-9dc8-b3887b487c9b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-72417868-9ff8-48f9-9dc8-b3887b487c9b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f0dad434-2b14-4fd3-b7e3-cdc0a32bf663">
  <button class="colab-df-quickchart" onclick="quickchart('df-f0dad434-2b14-4fd3-b7e3-cdc0a32bf663')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f0dad434-2b14-4fd3-b7e3-cdc0a32bf663 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_country_count</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Countries of First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70792925c1c6b7a91634219b36f3c9e6d16458930061a988923d44e7a81c3a5e.png" src="_images/70792925c1c6b7a91634219b36f3c9e6d16458930061a988923d44e7a81c3a5e.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-collections">
<h4>Distribution of unmatched collections<a class="headerlink" href="#distribution-of-unmatched-collections" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">)[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cdli_dump_collection
 Institute of Archaeology, University of Turin, Turin, Italy                               1
A&#39;ali, Bahrain                                                                             7
A. M. Chisholm Museum, Duluth, Minnesota, USA                                              1
A. V. Lane Museum, Bridwell Library, Southern Methodist University, Dallas, Texas, USA    11
Abbaye de Maredsous, Denée, Belgium                                                        1
                                                                                          ..
Übersee-Museum, Bremen, Germany                                                            2
Übersee-Museum, Bremen, Germany; École Pratique des Hautes Études, Paris, France           1
Şanlıurfa Archaeological Museum, Şanlıurfa, Turkey                                         2
Şanlıurfa Arkeoloji Müzesi, Şanlıurfa, Turkey                                              1
Šiauliai Aušros Museum, Šiauliai, Lithuania                                                3
Name: cdli_dump_collection, Length: 1400, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_collections</span> <span class="o">=</span> <span class="n">collection_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection</span><span class="p">][</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">]</span>
<span class="n">unmatched_collections_clean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unmatched_collections</span><span class="p">:</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># split a multi statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_collections_clean</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_collections_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_collections_clean</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_collections_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;German Archaeological Institute, Berlin, Germany (on loan, University of Heidelberg)&#39;,
       &#39;unlocated&#39;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada (cast)&#39;,
       ..., &#39;Mardin Museum, Mardin, Turkey&#39;, &#39;Oylum Höyük, Oylum, Turkey&#39;,
       &#39;private: William T. Grant Jr., Pelham Manor, New York, USA&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_collections_clean</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_c_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">unmatched_c_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-623000a8-7250-49d6-ba4d-2162aa3d7aa2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>26060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anadolu Medeniyetleri Müzesi, Ankara, Turkey</td>
      <td>15950</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Department of Near Eastern Studies, Cornell Un...</td>
      <td>10445</td>
    </tr>
    <tr>
      <th>3</th>
      <td>National Museum of Syria, Der-ez-Zor, Syria</td>
      <td>9506</td>
    </tr>
    <tr>
      <th>4</th>
      <td>National Museum of Syria, Idlib, Syria</td>
      <td>6852</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1382</th>
      <td>Palace Museum, Beijing, PRC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1383</th>
      <td>Meissner Collection</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1384</th>
      <td>West Point Museum, West Point, New York USA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1385</th>
      <td>Garrett-Evangelical Theological Seminary, Evan...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1386</th>
      <td>private: William T. Grant Jr., Pelham Manor, N...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1387 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-623000a8-7250-49d6-ba4d-2162aa3d7aa2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-623000a8-7250-49d6-ba4d-2162aa3d7aa2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-623000a8-7250-49d6-ba4d-2162aa3d7aa2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e7127daa-557a-4dd4-b7e0-a91e168ce835">
  <button class="colab-df-quickchart" onclick="quickchart('df-e7127daa-557a-4dd4-b7e0-a91e168ce835')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e7127daa-557a-4dd4-b7e0-a91e168ce835 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_c_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/unmatched_cdli_collections_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_c_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">17500</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collections&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Top 10 Collections of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/140ea6bd072f19a4abd10e0d10bc4932675a930be5447d0319cd173a6778b7b0.png" src="_images/140ea6bd072f19a4abd10e0d10bc4932675a930be5447d0319cd173a6778b7b0.png" />
</div>
</div>
<p>####3.2 ORACC collection
Repeating the process on the CDLI collection above for ORACC.</p>
</section>
</section>
<section id="collection-df2">
<h3>3.2.1 collection_df2<a class="headerlink" href="#collection-df2" title="Link to this heading">#</a></h3>
<p>Match on oracc label to obtain the corresponding FactGrid Q-id for ‘collection’ field and add matching data to <code class="docutils literal notranslate"><span class="pre">museum_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_y&#39;</span><span class="p">]]</span>
<span class="n">collection_df2</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;collection_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">})</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;German Archaeological Institute, Berlin, Germany (on loan, University of Heidelberg)&#39;,
       &#39;Ashmolean Museum, Oxford, UK&#39;, &#39;British Museum, London, UK&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;unlocated&#39;, nan, &#39;private: anonymous, unlocated&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium&#39;,
       &#39;private: Michail, Louise, Milan, Italy&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Mead Art Gallery, Amherst College, Amherst, Massacusetts, USA&#39;,
       &#39;Nies Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Bible Lands Museum, Pittsburgh Theological Seminary, Pittsburgh, Pennsylvania, USA&#39;,
       &#39;Kyoto University, Kyoto, Japan&#39;,
       &#39;Free Library of Philadelphia, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Manchester Museum, University of Manchester, Manchester, UK&#39;,
       &#39;Crozer Theological Seminary, Rochester, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Hilprecht Collection, University of Jena, Germany&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &quot;Musées royaux d&#39;Art et d&#39;Histoire, Brussels, Belgium&quot;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Montserrat Museum, Barcelona, Spain&#39;,
       &#39;Louvre Museum, Paris, France&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria ?&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Louvre Museum, Paris, France ?&#39;,
       &#39;National Museum, Tehran, Iran ?&#39;,
       &#39;Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;National Museum, Tehran, Iran&#39;,
       &#39;private: de Serres, J. Mariaud, Paris, France&#39;,
       &#39;private: Foroughi, Mohsen, Tehran, Iran ?&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;J. Pierpont Morgan Library Collection, New York, New York, USA&#39;,
       &#39;Bible Lands Museum, Jerusalem&#39;,
       &#39;private: Frauenberger, K., Germany ?&#39;,
       &#39;Kalamazoo Valley Museum, Kalamazoo, Michigan, USA&#39;,
       &#39;The Israel Museum, Jerusalem&#39;, &#39;private: Foroughi, Teheran, Iran&#39;,
       &#39;Musée d’Art et d’Histoire, Geneva, Switzerland&#39;,
       &#39;Institute of Archaeology, London, UK&#39;,
       &#39;New York Public Library, New York, New York, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA ?&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey ?&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;Gallery of Fine Arts, Yale University, New Haven, Connecticut, USA&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany&#39;,
       &#39;Allard Pierson Museum, University of Amsterdam, Amsterdam, Holland&#39;,
       &#39;Archäologisches Museum, Universität Halle-Wittenberg, Germany&#39;,
       &#39;private: Hoza, Camberg, Germany&#39;,
       &#39;National Museum of Syria, Raqqa, Syria ?&#39;,
       &#39;British Museum, London, UK ?&#39;, &#39;private: Baldacci, Milan, Italy&#39;,
       &#39;École Pratique des Hautes Études, Paris, France&#39;,
       &#39;private: Hideo Mihira, Chiba, Japan&#39;,
       &#39;Ancient Orient Museum, Tokyo, Japan&#39;,
       &#39;Osaka Prefectural Chikatsu-Asuka Museum, Osaka, Japan&#39;,
       &#39;Takahashi Collection, Municipal Museum, Fujisawa, Japan&#39;,
       &#39;private: Namio Egami, Tokyo, Japan&#39;,
       &#39;Tokyo National Museum, Tokyo, Japan&#39;,
       &#39;National Museum of Ethnology, Osaka, Japan&#39;,
       &#39;Kelsey Museum of Archaeology, University of Michigan, Ann Arbor, Michigan, USA&#39;,
       &#39;Harvard Museum of the Ancient Near East, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Louvre Museum, Paris, France; Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;British Museum, London, UK; Louvre Museum, Paris, France&#39;,
       &#39;private: Cros, unlocated&#39;, &#39;Munich, Germany?&#39;,
       &#39;Bodmer Museum, Cologny, Switzerland&#39;,
       &#39;private: Erlenmeyer, Basel, Switzerland (dispersed)&#39;,
       &#39;private: anonymous, Baghdad, Iraq&#39;, &#39;private: Banks, unlocated&#39;,
       &#39;private: Samhery, unlocated&#39;, &#39;private: Greene, unlocated&#39;,
       &#39;private: Tournay, unlocated&#39;,
       &#39;Medelhavsmuseet, Stockholm, Sweden&#39;,
       &#39;private: Haldar, Alfred O., Uppsala, Sweden&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany ?&#39;,
       &#39;Milwaukee Public Museum, Milwaukee, Wisconsin, USA&#39;,
       &#39;New Brunswick Museum, St. John, New Brunswick, Canada&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq ?&#39;,
       &#39;Hearst Museum of Anthropology, University of California at Berkeley, Berkeley, California, USA&#39;,
       &#39;Rosicrucian Egyptian Museum, San Jose, California, USA&#39;,
       &#39;J. Pierpont Morgan Library Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Chester Beatty Library, Dublin, Ireland&#39;,
       &#39;Birmingham Museums and Art Gallery, Birmingham, UK&#39;,
       &#39;private: anonymous, Göttingen, Germany&#39;,
       &#39;Liebighaus, Frankfurt, Germany&#39;,
       &#39;private: Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Reber Collection, Lausanne, Switzerland&#39;,
       &#39;private: Schimmel, Norbert, unlocated&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;National Museum of Syria, Idlib, Syria&#39;,
       &#39;British Museum, London, UK; National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (on loan, British Museum, London, UK ?)&#39;,
       &#39;British Museum, London, UK; National Museum of Iraq, Baghdad, Iraq ?&#39;,
       &#39;National Museum of Syria, Aleppo, Syria&#39;,
       &#39;Robert Hull Fleming Museum, University of Vermont, Burlington, Vermont, USA&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK&#39;,
       &#39;Field Museum of Natural History, Chicago, Illinois, USA&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel; Hilprecht Collection, University of Jena, Jena, Germany&#39;,
       &#39;Louvre Museum, Paris, France; Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkeyurkey&#39;,
       &#39;Studium Biblicum Franciscanum Archaeological Museum, Jerusalem&#39;,
       &#39;Cabinet des Médailles, Musée d’Histoire et d’Art, Musées de l’Etat, Luxemburg&#39;,
       &#39;Ethnological Collections, Redpath Museum, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: David, E.S., New York, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;private: Hechich, Rome, Italy&#39;, &#39;Museo Barracco, Rome, Italy&#39;,
       &#39;Bibliothèque Nationale et Universitaire de Strasbourg, Strasbourg, France&#39;,
       &#39;private: Galling, Kurt, Tübingen, Germany&#39;,
       &#39;Museum of Anthropology, University of British Columbia, Vancouver, British Columbia, Canada&#39;,
       &#39;private: Ligabue, Giancarlo, Venice, Italy&#39;,
       &#39;private: Southesk collection&#39;,
       &#39;World Museum Liverpool, Liverpool, UK&#39;,
       &#39;Couvent Saint-Etienne, Jerusalem&#39;,
       &#39;National Museum of Iraq, Baghdad,Iraq&#39;,
       &#39;Spurlock Museum, University of Illinois, Urbana-Champaign, Illinois, USA&#39;,
       &#39;private: anonmymous, unlocated ?&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel&#39;,
       &#39;Hilprecht Collection, University of Jena, Germany; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Hilprecht Collection, University of Jena, Germany&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Rare Book and Manuscript Library, Columbia University, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq: University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;private: Hoffman, E. A., unlocated&#39;,
       &#39;private: Barton, G. A., unlocated&#39;,
       &#39;Rijksmuseum van Oudheden, Leiden, Holland&#39;,
       &#39;Katholieke Universiteit, Nijmegen, Holland&#39;,
       &#39;Detroit Institute of Arts, Detroit, Michigan, USA&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation ?&#39;,
       &#39;private: Hechler&#39;, &#39;private: Cugnin, L., unlocated&#39;,
       &#39;Deutsches Museum, Munich, Germany&#39;,
       &#39;Musée des Antiquités à Rouen, France&#39;, &#39;private,: Hechler&#39;,
       &#39;private: Chandon de Briailles, unlocated&#39;,
       &#39;Museum Haaretz, Tel Aviv, Israel&#39;,
       &#39;private: Mercer, S.A.B., Toronto, Ontario, Canada&#39;,
       &#39;Museo Archeologico Nazionale di Firenze, Florence, Italy&#39;,
       &#39;Institute of Semitics, University of Groningen, Groningen, Holland&#39;,
       &#39;University of Pretoria, Pretoria, South Africa&#39;,
       &#39;Cracow National Museum, Cracow, Poland&#39;,
       &#39;Bryn Mawr College, Bryn Mawr, Pennsylvania, USA&#39;,
       &#39;private: Jager, H. J. de , unlocated&#39;, &#39;Japan ?&#39;,
       &#39;Ziegelei-Museum, Meienberg, Germany&#39;,
       &#39;Musée St. Remi, Reims, France&#39;,
       &#39;private: Béghin, Versailles, France&#39;,
       &#39;Landesmuseum Joanneum, Graz, Austria&#39;,
       &#39;Kestner Museum, Hannover, Germany&#39;,
       &#39;Musée Royal de Mariemont, Morlanwelz, Belgium&#39;,
       &#39;Museo Barraco, Rome, Italy&#39;, &#39;Musée de Cinquantenaire Brussels&#39;,
       &#39;private: de Clercq, unlocated&#39;,
       &#39;private: Seidl-Geuthner, F., unlocated&#39;,
       &#39;private: Clark, Cumberland (probably dispersed)&#39;,
       &#39;Newell Bequest Collection, Wheaton College, Wheaton, Illinois, USA&#39;,
       &#39;private: Collection de Clercq, Paris, France&#39;,
       &#39;Louvre Museum, Paris, France; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;private: Golenishev, unlocated&#39;,
       &#39;Gutenberg Museum, Mainz,Germany&#39;,
       &#39;Archaeological Research Collection, University of Southern California, Los Angeles, California, USA&#39;,
       &#39;California Museum of Ancient Art, Los Angeles, California, USA&#39;,
       &#39;Department of Near Eastern Studies, Cornell University, Ithaca, New York, USA&#39;,
       &#39;private: Jensen, William, Austin, Texas, USA&#39;,
       &#39;private: LaForme, William, USA&#39;,
       &#39;California Museum of Ancient Art, Los Angeles, California, USA ?&#39;,
       &#39;private: Kuhs, R., Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA&#39;,
       &#39;Schøyen Collection, Oslo, Norway&#39;,
       &#39;Princeton Theological Seminary, Princeton, New Jersey, USA&#39;,
       &#39;Kelsey Museum&#39;,
       &#39;Kelsey Museum, University of Michigan, Ann Arbor, Michigan, USA&#39;,
       &#39;Archeological Museum, Antakya, Hatay, Turkey&#39;,
       &#39;Kelsey Museum of Archaeology, University of Michigan, Ann Arbor, Michigan, USA; National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;private: Stefanik,Deborah, Las Vegas, Nevada, USA&#39;,
       &#39;Library of Congress, Washington, DC, USA&#39;,
       &#39;Siegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK&#39;,
       &#39;Couvent Saint-Étienne, Jerusalem&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey&#39;,
       &#39;École Biblique et Archéologique Française, Jerusalem&#39;,
       &#39;Oakland Museum of California, Oakland, California, USA&#39;,
       &#39;iSegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;Newell Collections of Babylonian Tablets, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Museum fur Volkerkunde, Freiburg, Germany&#39;,
       &#39;Ruhrlandmuseum, Essen, Germany&#39;, &#39;Schøyen collection, Oslo&#39;,
       &#39;private: anonymous, Europe&#39;,
       &#39;Oriental Museum, University of Durham, Durham, UK&#39;,
       &#39;private: Homsy, E., Beirut, Lebanon ?&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Louvre Museum, Paris, France&#39;,
       &#39;Oriental Institute, University of Chicago, Illinois, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Hilprecht Collection, University of Jena, Germany&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;University Museum, University of Pennsylvania, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Center for Advanced Judaic Studies, University of Pennsylvania, Philadephia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA: Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Hilprecht Collection, University of Jena, Germany; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Rare Manuscript Collections, Cornell University Library, Ithaca, New York, USA&#39;,
       &#39;National Museum of Syria, Aleppo, Syria ?&#39;,
       &#39;Near Eastern Studies, UC Berkeley (Dales Collection), Berkeley, California, USA&#39;,
       &#39;private: anonymous, Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA (a)&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA (a); Nimrud, Iraq (b)&#39;,
       &#39;British Museum, London, UK; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Site museum, Boghazkoi, Turkey&#39;,
       &#39;Israel Antiquities Authority, Jerusalem&#39;,
       &#39;Science Museum of Minnesota, St. Paul, Minnesota, USA&#39;,
       &#39;private: Hebenstreit, Laurent, Paris, France&#39;,
       &#39;Museo di Antichità di Torino, Turin, Italy&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;private: Cotsen, Los Angeles, California, USA&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, USA&#39;,
       &#39;Hesburgh Library, University of Notre Dame, Notre Dame, Indiana, USA&#39;,
       &#39;Special Collections and Archives, John T. Richardson Library, DePaul University, Chicago, Illinois, USA; Louvre Museum, Paris, France&#39;,
       &#39;Special Collections and Archives, John T. Richardson Library, DePaul University, Chicago, Illinois, USA&#39;,
       &#39;Collection Beghin, Versailles&#39;,
       &#39;Vorderasiatisches Museum, Berlin&#39;,
       &#39;Andersen Library, University of Minnesota, Minneapolis-St. Paul, Minnesota, USA&#39;,
       &#39;Staley Library, Millikin University, Decatur, Illinois, USA&#39;,
       &#39;British Museum, London, UK; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria&#39;,
       &#39;Michael C. Carlos Museum, Emory University, Atlanta, Georgia, USA&#39;,
       &#39;The Ashmolean Museum, Oxford&#39;,
       &#39;Rosen Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Goucher College Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Yale Babylonian Collection, New Haven&#39;,
       &#39;Nies Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Nies Babylonian Collection, Yale Babilonian Collection, New Haven&#39;,
       &#39;private: anonmymous, unlocated&#39;,
       &#39;Archäologisches Museum, Universität Halle, Halle, Germany&#39;,
       &#39;National Museum of Syria, Damascus, Syria&#39;,
       &#39;private: Totten, Norman, Bentley College, Waltham, Massachusetts, USA&#39;,
       &#39;Louvre Museum, Paris, France; National Museum of Syria, Aleppo, Syria&#39;,
       &#39;Utah State University Museum of Anthropology, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Institute of Religion, Utah State University, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Museum of Church History and Art, Salt Lake City, Utah, USA&#39;,
       &#39;Department of Jordanian Antiquities, Amman, Jordan&#39;,
       &#39;Johns Hopkins University, Baltimore, MD, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turke&#39;, &#39;private: annonymous&#39;,
       &#39;Bibliothèque Nationale, Paris, France&#39;,
       &#39;Topkapı Sarayı Müzesi, Istanbul, Turkey&#39;,
       &#39;Mosul Museum, Mosul, Iraq&#39;,
       &#39;German Archaeological Institute, Berlin, Germany&#39;,
       &#39;Heidelberger Orientalisches Seminar, Heidelberg, Germany&#39;,
       &#39;Semitic Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Hilprecht-Sammlung, University of Jena, Germany&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Hilprecht Collection, University of Jena, Germany; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;British Museum, London, UK; Hirayama collection, Hirayama, Japan&#39;,
       &#39;Couvent Saint-Étienne, Jerusalem; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;National Museum of Syria, Raqqa, Syria&#39;,
       &#39;private: anonymous, Tel Aviv, Israel&#39;,
       &#39;École Pratique des Hautes Études, Paris, France; Vorderasiatisches Museum, Berlin, Germany ?&#39;,
       &#39;Musée de Beyrouth, Beirut, Libanon&#39;, &#39;private: anonymous, Canada&#39;,
       &#39;Museum of Corum, Corum, Turkey&#39;,
       &#39;John Rylands University Library, Manchester, UK&#39;,
       &#39;National Museum, Beirut, Lebanon&#39;, &#39;Iraq Museum, Baghdad&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;private: anonymous, Victoria, Australia&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Louvre Museum, Paris, France; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Louvre Museum, Paris, France; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Department of Geology, Union College, Schenectady, New York, USA&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Institute of Oriental Culture, University of Tokyo, Tokyo, Japan&#39;,
       &#39;Albertson College of Idaho, Caldwell, Idaho, USA&#39;,
       &#39;School of Archaeology and Oriental Studies, Liverpool University, Liverpool, UK&#39;,
       &#39;Columbia University Library, New York, New York, USA&#39;,
       &#39;Cincinnati Art Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Clinton Historical Society, Clinton, Massachusetts, USA&#39;,
       &#39;Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;Erzabtei St. Martin zu Beuron, Beuron, Germany&#39;,
       &#39;Special Collections, Robert Manning Strozier Library, Florida State University, Tallahassee, Florida, USA&#39;,
       &#39;American University of Beirut Archaeological Museum, Beirut, Lebanon&#39;,
       &#39;private: Moussaieff, Shlomo, London, UK&#39;,
       &#39;MacKenzie Art Gallery, University of Regina Collection&#39;,
       &#39;Knox College, Galesburg, IL, USA&#39;,
       &#39;private: anonymous, New York, New York, USA ?&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collection, UCLA, Los Angeles, USA&#39;,
       &#39;John Rylands Library, University of Manchester, Manchester, UK&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, The Netherlands&#39;,
       &#39;The Oriental Institute, Chicago&#39;,
       &#39;Los Angeles Unified School District, Los Angeles, California, USA&#39;,
       &#39;Diyarbakır Archaeological Museum, Diyarbakır, Turkey&#39;,
       &#39;Harvard Art Museum / Arthur M. Sackler Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Denver Museum of Natural Science, Denver, Colorado, USA&#39;,
       &#39;Badè Museum of Biblical Archaeology, Pacific School of Religion, Berkeley, California, USA&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;private: anonymous, New Jersey, USA&#39;,
       &#39;University of Pécs, Pécs, Hungary&#39;,
       &#39;Museum of Fine Arts, Budapest, Hungary&#39;,
       &#39;Department of Assyriology and Hebrew Studies, Eötvös L. University, Budapest&#39;,
       &#39;Arizona State Museum, Tucson, Arizona, USA&#39;,
       &#39;Morgan Library, Colorado State University, Fort Collins, Colorado, USA&#39;,
       &#39;Toppan Rare Books Library, University of Wyoming, Laramie, Wyoming, USA&#39;,
       &#39;Museum Forum der Völker (Völkerkundemuseum der Franziskaner), Werl, Germany&#39;,
       &#39;private: Owen, E. L., Lake Hopatcong, New Jersey, USA&#39;,
       &#39;Peabody Essex Museum, Salem, Massachusetts, USA&#39;,
       &#39;Penrose Library, Whitman College, Walla Walla, Washington, USA&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA&#39;,
       &#39;Lilly Library, Indiana University, Bloomington, Indiana, USA&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA (permanent loan from Missouri School of Religion [formerly “Bible College of Missouri”], Jefferson City, Missouri)&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA&#39;,
       &#39;Saint Louis Art Museum, St. Louis, Missouri, USA&#39;,
       &#39;private: anonymous, New York, New York, USA&#39;,
       &#39;Semitics/ICOR Collections, Catholic University of America, Washington, DC, USA&#39;,
       &#39;Nicholson Museum, University of Sydney, Sydney, Australia&#39;,
       &#39;Ethniko Archaiologiko Museo, Athens, Greece&#39;,
       &#39;Eugene Fuller Memorial Collection,  Seattle Art Museum, Seattle, Washington, USA&#39;,
       &#39;Chancellor University Collection, Cleveland, Ohio, USA&#39;,
       &#39;American Museum of Natural History, New York, New York, USA&#39;,
       &#39;Couvent Sainte-Anne, Jerusalem&#39;,
       &#39;New Brunswick Theological Seminary, New Brunswick, New Jersey, USA&#39;,
       &#39;Rush Rhees Library, University of Rochester, Rochester, New York, USA&#39;,
       &#39;Nimrud, Iraq (a) &amp; (d); Musei Vaticani, Vatican CIty, Rome, Italy (b); Memorial Art Gallery, University of Rochester, Rochester, New York, USA (c); unlocated (e)&#39;,
       &#39;Memorial Art Gallery, University of Rochester, Rochester, New York, USA&#39;,
       &#39;Australian Institute of Archaeology, Melbourne,Victoria, Australia&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a)&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;David Alderfer Collection, Downers Grove, Illinois, USA&#39;,
       &#39;Burrell Collection. Art Gallery and Museum, Glasgow  (a); Metropolitan Museum of Art, New York, New York, USA (b); Nimrud Collection, Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a); Nimrud, Iraq (b); Metropolitan Museum of Art, New York, New York, USA (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a) &amp; (d); Metropolitan Museum of Art, New York, New York, USA (b); State Hermitage Museum, St. Petersburg, Russian Federation (c); Muzeum Narodowe w Warszawie, Warsaw (e); State Hermitage Museum, St. Petersburg, Russian Federation (f); unloc&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a); Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (b)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a-b); Nimrud, Iraq (c)&#39;,
       &#39;Nimrud, Iraq (a) &amp; (c); Metropolitan Museum of Art, New York, New York, USA (b); unlocated (d)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a); Nimrud, Iraq (b)&#39;,
       &#39;Mayo, Ireland (Gwyn)&#39;, &#39;Kyoto, Japan&#39;,
       &#39;private: anonymous, Venice, Italy&#39;,
       &quot;Mabee-Gerrer Museum, St. Gergory&#39;s University, Shawnee, Oklahoma, USA&quot;,
       &#39;Museum for Art and History, Geneva&#39;,
       &#39;Williams College Museum of Art, Williamstown, Massachusetts, USA&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA&#39;,
       &#39;British Museum, London, UK (a)&#39;,
       &#39;Nimrud, Iraq (a); unlocated (b)&#39;,
       &#39;British Museum, London, UK (a-b); unlocated (c)&#39;,
       &#39;British Museum, London, UK (a-c); unlocated (d)&#39;,
       &#39;British Museum, London, UK (a); Museo Civico di Archeologia Ligure, Genua, Italy (b); Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (c); British Museum, London, UK (d); Nimrud, Iraq (e); Collection Fred Elghanayan, New York, New York, USA (f); unlo&#39;,
       &#39;British Museum, London, UK (a-b); National Museum of Iraq, Baghdad, Iraq (c); unlocated (d)&#39;,
       &#39;British Museum, London, UK (a-b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a); Fitzwilliam Museum, University of Cambridge, Cambridge, UK (b); private: anonymous, unlocated (c); unlocated (d)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a); Bowdoin College, Brunswick, Maine, USA (b); unlocated (c)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); British Museum, London, UK (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Skulpturensammlung, Dresden, Germany (a)&#39;,
       &#39;Nimrud, Iraq (a-c); unlocated (d)&#39;,
       &#39;Fogg Art Museum, Harvard University, Cambridge, Massachusetts, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;British Museum, London, UK (a); unlocated (b)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a); British Museum, London, UK (b)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (a)&#39;,
       &#39;British Museum, London, UK (a); National Museum of Iraq, Baghdad, Iraq (b); British Museum, London, UK (c)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 381ff. (description) (a)&#39;,
       &#39;unlocated: reconstructed analog to C-12; Meuszynski, BaF 2, p. 26. 28 (a)&#39;,
       &#39;Louvre Museum, Paris, France (a); unlocated (b)&#39;,
       &#39;Miho Museum, Kyoto, Japan (a); unlocated (b)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (a); Nimrud, Iraq (b-e); unlocated (f)&#39;,
       &#39;Virginia Museum of Fine Arts, Richmond, Virginia, USA (a); National Museum of Iraq, Baghdad, Iraq (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a); unlocated (b)&#39;,
       &#39;unlocated: reconstructed according to position mirrored by C-02 (a)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 384f. (description) (a)&#39;,
       &#39;Nimrud, Iraq (a)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a); unlocated (b)&#39;,
       &#39;Nimrud, Iraq (a-c); Williams College Museum of Art, Williamstown, Massachusetts, USA (d);  unlocated (e)&#39;,
       &#39;Brooklyn Museum, Brooklyn, New York, USA (a)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s description of the room (unlocated: Layard, Monuments of Nineveh I, p. 385f. (a)&quot;,
       &#39;Mosul Museum, Mosul, Iraq (a)&#39;,
       &#39;unlocated: reconstructed according to the placement of slabs in this room; cp. Paley/Sobolewski, BaF 10, p. 85 and pl. 6, 33 (a)&#39;,
       &#39;Museum and Art Gallery, Bristol, UK (a)&#39;,
       &#39;Nimrud, Iraq (a); Vorderasiatisches Museum, Berlin, Germany (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a-h); unlocated (i)&#39;,
       &#39;Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (a)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA (a); British Museum, London, UK (b); Nimrud, Iraq (c)&#39;,
       &#39;private: anonymous, New York, New York, USA (a); National Museum of Iraq, Baghdad, Iraq (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a-b, d); Musées royaux d’Art et d’Histoire, Brussels, Belgium (c); unlocated (e)&#39;,
       &#39;British Museum, London, UK (a); Nimrud, Iraq (b-d); Kalamazoo Valley Museum, Kalamazoo, Michigan, USA (e); unlocated (f)&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK (a)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. XXXIX (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 385f. (description) (a)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 386f. (description) (a)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Louvre Museum, Paris, France (a)&#39;,
       &#39;unlocated: reconstructed according to analog slabs H-11 and H-24 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. LXII (a)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a)&#39;,
       &#39;Museum Calouste Gulbenkian, Lisbon, Portugal (a)&#39;,
       &#39;Christ Church College, Oxford, UK (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;M.H. De Young Museum, San Francisco, California, USA (a); unlocated (b)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s general description (Monuments of Nineveh I, 145. 386) of the room and analog to the opposite wall (a)&quot;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (now Dresden) (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA&#39;,
       &#39;Wadsworth Atheneum, Hartford, Connecticut, USA (a); Montreal Museum of Fine Arts, Montreal, Canada (b)&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA (a); Amherst College, Amherst, Masssachusetts, USA (b)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a); National Museum of Iraq, Baghdad, Iraq (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a-d); unlocated (e)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (a); Nimrud, Iraq (b)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Nimrud, Iraq (b); Fitzwilliam Museum, University of Cambridge, Cambridge, UK (c); unlocated (d)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland (a); British Museum, London, UK (b); British Museum, London, UK (c); unlocated (d)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Museo Barracco, Rome, Italy (b); Nimrud, Iraq (c); Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (d); unlocated (e)&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a); Nimrud, Iraq (b) &amp; (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a-b); unlocated (c)&#39;,
       &#39;private: anonymous (a); Nimrud, Iraq (b); Idemitsu Museum of Arts, Tokyo, Japan (c); unlocated (d)&#39;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada (a); British Museum, London, UK (b); unlocated (c)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (a); British Museum, London, UK (b); unlocated (c)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Nationalmuseet, Copenhagen, Denmark (b); Ashmolean Museum, Oxford, UK (c); Nimrud, Iraq (d); unlocated (e)&#39;,
       &#39;Louvre Museum, Paris, France (a); Bhau Daji Lad Museum, Mumbai, India (formerly Victoria and Albert Museum) (b); unlocated (c)&#39;,
       &quot;Arts &amp; Culture Centre, Memorial Univ., St. John&#39;s, Newfoundland, Canada (a); Nimrud, Iraq (b-c); Paisley Art Gallery and Museum, Renfrewshire, UK (d)&quot;,
       &#39;British Museum, London, UK (a); Nimrud, Iraq (b); Museum of Fine Arts, Houston, Texas, USA (c); unlocated (d)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a); private: Collection Samuel Josefowitz, Lausanne, Switzerland (b); Nimrud, Iraq (c); British Museum, London, UK (d); unloca&#39;,
       &#39;Nimrud, Iraq (a); British Museum, London, UK (b); Louvre Museum, Paris, France (c); Nimrud, Iraq (d); Detroit Institute of Arts, Detroit, Michigan, USA (e); British Museum, London, UK; Louvre Museum, Paris, France (f); unlocated (g)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a-b, e); Magdalen College, Oxford, UK (c); Nimrud, Iraq (d); Amherst College, Amherst, Masssachusetts, USA (f); unlocated (g)&#39;,
       &#39;Nimrud, Iraq (a); Arkeoloji Müzeleri, Istanbul, Turkey (b); Glencairn Museum, Bryn Athyn, Pennsylvania, USA (c); Nimrud, Iraq (d); British Museum, London, UK (e); unlocated (f)&#39;,
       &#39;Nimrud, Iraq (a); Ashmolean Museum, Oxford, UK (b); Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (c); unlocated (d)&#39;,
       &#39;unlocated: reconstructed based on composition of neighboring reliefs only; cp. Paley/Sobolewski, BaF 10, p. 33 (a)&#39;,
       &#39;Chrysler Museum of Art, Norfolk, Virginia, USA (a); unlocated (b)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA ? (a; =? L-14 (b)); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a); unlocated (b)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Middlebury College, Middlebury, Vermont, USA&#39;,
       &#39;Nimrud, Iraq (a); Cincinnati Art Museum, Cincinnati, Ohio, USA (b); unlocated (c)&#39;,
       &#39;Nelson-Atkins Museum of Art, Kansas City, Missouri, USA (a)&#39;,
       &#39;Nimrud, Iraq (a); Kimbell Art Museum, Fort Worth, Texas, USA (b)&#39;,
       &#39;Nimrud, Iraq (a); Glencairn Museum, Bryn Athyn, Pennsylvania, USA ? (b; =? L-03 (a)); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a); British Museum, London, UK (b)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (a); unlocated (b)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (a); Saint Louis Art Museum, St. Louis, Missouri, USA (b); unlocated (c)&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a); Nimrud, Iraq (b-c); unlocated (d)&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a); Nimrud, Iraq (b)&#39;,
       &#39;British Museum, London, UK (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA (a)&#39;,
       &#39;Fleming Museum, University of Vermont, Burlington, Vermont, USA (a)&#39;,
       &#39;Nimrud, Iraq (a); British Museum, London, UK (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a); Abegg Foundation, Bern, Switzerland (b)&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA (a)&#39;,
       &#39;unlocated: reconstructed based on symmetrical relief N-08; Meuszynski, BaF 2, p. 75 (a)&#39;,
       &#39;Swedish National Museum, Stockholm, Sweden (a)&#39;,
       &#39;Worcester Art Museum, Worcester, Massachusetts, USA (a)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a); Ny Carlsberg Glyptotek, Copenhagen, Denmark (b)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a)&#39;,
       &#39;Museum of Art, Cleveland, Ohio, USA (a); unlocated (b)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (a)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a. c-e); The Art Institute of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;private: anonymous, unlocated (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (a)&#39;,
       &#39;Nimrud, Iraq (a); private: anonymous, unlocated (b); Nimrud, Iraq (c, e); Museum für Kunst und Gewerbe, Hamburg, Germany (d);&#39;,
       &#39;Nimrud, Iraq (a-b, d-g); private: Collection Merrin, New York, New York, USA ? (c); unlocated (h)&#39;,
       &#39;Nimrud, Iraq (a); Manchester University, Museum, Manchester, UK (b)&#39;,
       &#39;Nimrud, Iraq (a, c-h); Musées royaux d’Art et d’Histoire, Brussels, Belgium (b)&#39;,
       &#39;Nimrud, Iraq (a), d-f; Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (b); unlocated (g)&#39;,
       &#39;Tigris, Iraq&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a); Skulpturensammlung, Dresden, Germany (b); Nimrud, Iraq (c)&#39;,
       &quot;unlocated: reconstructed according to Layard&#39;s description (Layard, Monuments of Nineveh I, p.389) and the arrangement of neighboring reliefs (a)&quot;,
       &#39;unlocated: reconstructed according to the available space and arrangement of reliefs in this entrance (a); unlocated (b)&#39;,
       &#39;Nimrud, Iraq (a-c)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 32; Original Drawings III, S.W. IV (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (a); unlocated (c)&#39;,
       &#39;unlocated: Layard, Original Drawings IV, Misc. I (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 28 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, S.W. X (a)&#39;,
       &#39;Mosul Museum, Mosul, Iraq (a); unlocated (b)&#39;,
       &quot;Arts &amp; Culture Centre, Memorial Univ., St. John&#39;s, Newfoundland, Canada (a); unlocated (b)&quot;,
       &#39;British Museum, London, UK (a); Oriental Institute, University of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;British Museum, London, UK (a); British Museum, London, UK (b)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a)&#39;,
       &#39;Nimrud, Iraq (a); unlocated: reconstructed as counterpart to Z-09 (b)&#39;,
       &#39;Louvre Museum, Paris, France (a); Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (b)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a); National Museum of Iraq, Baghdad, Iraq (b-d); British Museum, London, UK (e); Nimrud, Iraq (f); unlocated (g)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 35, possibly lost in the Tigris (a)&#39;,
       &#39;unlocated: reconstructed parallel to Zb-02 (a)&#39;,
       &#39;unlocated: reconstructed analog to other entrances (a)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland&#39;,
       &#39;Canadian Museum of Civilization, Ottawa, Ontario, Canada&#39;,
       &#39;Irvin Department of Rare Books and Special Collections, Ernest F. Hollings Special Collections Library, University of South Carolina Libraries, Columbia, South Carolina, USA&#39;,
       &#39;Tufts University, Bendetson Hall, Medford, Massachusetts, USA&#39;,
       &#39;The British Museum, London&#39;, &#39;Tell Muqayyar, Iraq&#39;,
       &#39;Museo Arqueológico Nacional, Madrid, Spain&#39;,
       &#39;private: anonymous, uncertain&#39;,
       &#39;Institute of Archaeology, Hebrew University, Jerusalem&#39;,
       &#39;private: Mr. Arieh Ben Eli, Haifa, Israel&#39;,
       &#39;The Israel Museum, Jerusalem; private: Mahboubian, H.&#39;,
       &quot;St. Andrew&#39;s Memorial Church, Church of Scotland, Jerusalem&quot;,
       &#39;Niedersächsische Landesmuseum Hannover, Germany&#39;,
       &#39;Library of Centenary College, Shreveport, Louisiana, USA&#39;,
       &#39;Allen Memorial Arl Museum, Oberlin, Ohio, USA&#39;,
       &#39;McLennan Library, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: Pabst, J. B, unlocated&#39;,
       &#39;Department of Classics, University of Cincinnati, Cincinnati, Ohio, USA&#39;,
       &#39;Hebrew Union College Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Historical Society, Suffield, Connecticut, USA&#39;,
       &#39;Drew University, Madison, New Jersey, USA&#39;,
       &#39;New Brunswick Museum, Saint John, New Brunswick, Canada&#39;,
       &#39;Stovall Museum of Science and History, University of Oklahoma, Norman, Oklahoma, USA&#39;,
       &#39;private: anonymous, France&#39;,
       &#39;Public Library of Cincinnati and Hamilton County, Cincinnati, Ohio, USA&#39;,
       &#39;Royal Albert Memorial Museum and Art Gallery, Exeter, Devon, UK&#39;,
       &#39;private: Strauss, unlocated&#39;,
       &#39;private: Gîatzer, V., Wiesbaden, Germany&#39;,
       &#39;Museum of Fine Arts, Boston, Massachusetts, USA&#39;,
       &#39;Walker Art Center, Minneapolis, Minnesota, USA (diszpersed)&#39;,
       &#39;Musée de Picardie. Amiens, France&#39;,
       &#39;George Ortiz Collection, Geneva, Switzerland&#39;,
       &#39;National Museum of Syria, Damascus, Syria ?&#39;,
       &#39;private: Armas Salonen (?), Helsinki, Finland&#39;, &#39;unclear&#39;,
       &#39;private: anonymous, UK&#39;, &#39;private: anonymous, Jerusalem&#39;,
       &#39;Finnish National Museum, Helsinki, Finland&#39;,
       &#39;Altorientalisches Seminar, Free University of Berlin, Berlin, Germany&#39;,
       &#39;private: Likhochev&#39;,
       &#39;Smith College, Northampton, Massachusetts, USA&#39;,
       &#39;Manitoba Museum of Man and Nature, Winnipeg, Manitoba, Canada&#39;,
       &#39;Museum of the Buffalo Society of Natural Sciences, Buffalo, New York, USA&#39;,
       &#39;private: Mercer, S., unlocated&#39;,
       &#39;Crocker Art Museum, Sacramento, California, USA&#39;,
       &#39;private: Cherkasy&#39;, &#39;Newbury District Museum, Newbury, UK&#39;,
       &#39;private: F. Seidl-Geuthner, Paris, France&#39;,
       &#39;Claremont School of Theology, Claremont, California, USA&#39;,
       &#39;Übersee-Museum, Bremen, Germany&#39;,
       &#39;Toledo Museum of Art, Toledo, Ohio, USA&#39;,
       &#39;Institute of Egyptian Studies, University of Cambridge, Cambridge, UK&#39;,
       &#39;Private Arnold Spaer, FM 44 E.000-5, Jerusalem&#39;,
       &#39;Crocker Art Museum, Sacramento, CA, USA&#39;,
       &#39;Brooklyn Museum of Art, Brooklyn, New York, USA&#39;,
       &#39;St. Paul Public Library Collection, St. Paul, Minnesota, USA (dispersed)&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey; British Museum, London, UK&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey; Ashmolean Museum, Oxford, UK ?&#39;,
       &#39;Karpeles Collection, Santa Barbara, California, USA&#39;,
       &#39;private: Sivan, Raanan, Jerusalem&#39;,
       &quot;Musée d&#39;art de Joliette, Québec, Canada&quot;,
       &#39;private: anonymous, Pasadena, California, USA&#39;,
       &#39;Mount Holyoke College Art Museum, South Hadley, Massachusetts, USA&#39;,
       &#39;private: Harari, Moshe, Tel Aviv, Israel&#39;,
       &#39;Smithsonian Institution, Washington, DC, USA&#39;,
       &#39;Museum and Art Gallery, Bristol, UK&#39;,
       &#39;Institute of Archaeology, University of Copenhagen, Denmark&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA ?&#39;,
       &#39;private: Feuardent, M., London, UK ?&#39;,
       &#39;Département des Monnaies, Médailles et Antiques, Bibliothèque Nationale, Paris, France&#39;,
       &#39;Institute of Egyptian Studies, Cambridge, UK&#39;,
       &#39;Tyndale House, University of Cambridge, Cambridge, UK&#39;,
       &#39;Kunsthistorisches Museum, Vienna, Austria&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland&#39;,
       &#39;British Museum, London, UK; Detroit Institute of Arts, Detroit, Michigan, USA&#39;,
       &#39;Collection de Clerq&#39;,
       &#39;National Museum of Syria, Aleppo, Syria; National Museum of Syria, Raqqa, Syria&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian&#39;,
       &#39;private: anonymous, Sweden&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy&#39;,
       &#39;private: Seelye, L.H., New York, New York, USA&#39;,
       &#39;Wiener Museum für Völkerkunde, Vienna, Austria&#39;,
       &#39;private: Hares, D., unlocated, UK&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Philadelphia Museum of Art, Philadelphia, Pennsylvania, USA&#39;,
       &#39;private: anonymous, Berlin, Germany&#39;,
       &#39;private: anonymous, Russia&#39;, &#39;private: Rosen, J., USA&#39;,
       &#39;private: Garret, R., Baltimore, Maryland, USA&#39;,
       &#39;Museum of Ancient Cultures, Macquarie University, Sydney, Australia&#39;,
       &#39;The Hunterian Museum and Art Gallery, Glasgow, UK&#39;,
       &#39;University of Leuven, Leuven, Belgium&#39;,
       &#39;Davidson College Library, Davidson, NC, USA&#39;,
       &#39;Università Pontificia Salesiana, Rome, Italy&#39;,
       &#39;Pickler Memorial Library, Truman State University, Kirksville, Missouri, USA&#39;,
       &#39;Center for Advanced Judaic Studies, University of Pennsylvania, Philadephia, Pennsylvania, USA&#39;,
       &#39;Private: anonymous, Sweden&#39;, &#39;Patterson Museum, New Jersey, USA&#39;,
       &#39;Princeton University Library, Princeton, New Jersey, USA&#39;,
       &#39;Brooklyn Museum, Brooklyn, New York, USA&#39;, &#39;Tello, Iraq&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, California, USA; de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &#39;private: Jacobsen collection ?&#39;, &#39;private: Cugnin, France&#39;,
       &#39;Trinity College, Dublin, Ireland&#39;,
       &#39;private: Binning, Mellerstain, Berwickshire, UK&#39;,
       &#39;private: Smit, Amsterdam, Holland&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian Federation&#39;,
       &#39;Charlotte M. Smith Collection of Miniature Books, University Libraries, University of Iowa, Iowa City, Iowa, USA&#39;,
       &#39;private: anonymous, Barcelona, Spain&#39;,
       &#39;Kenneth Spencer Research Library, University of Kansas, Lawrence, Kansas, USA&#39;,
       &#39;University of King’s College, Halifax, Nova Scotia, Canada&#39;,
       &#39;Musée de la Castre, Cannes, France&#39;,
       &#39;British Museum, London, UK; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;Mustansiriyah, Baghdad, Iraq&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA&#39;,
       &#39;Allegheny College, Meadville, Pennsylvania, USA&#39;,
       &#39;Buffalo and Erie County Public Library, Buffalo, New York, USA&#39;,
       &#39;St Louis, Missouri, USA&#39;, &#39;Leiden&#39;,
       &#39;private: Brenner, Ori, Rehovot, Israel&#39;,
       &#39;Kahramanmaraş Museum, Turkey&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria ?unlocated&#39;,
       &#39;Muséum Peronne, France&#39;, &#39;Joanneum Museum, Graz, Austria&#39;,
       &#39;University of Leeds, Leeds, UK&#39;, &#39;University of Lwów, Poland&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey ?&#39;,
       &#39;private: Dorsky, Morris (on loan to J. Pierpont Morgan Library Collection, New York, New York, USA)&#39;,
       &#39;Abbey Museum, Queensland, Australia&#39;,
       &#39;Kestner Museum, Hannover, UK&#39;,
       &#39;private: anonymous, Vienna, Austria&#39;,
       &#39;Real Academia de la Historia, Madrid, Spain&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;private, Perk, H., Turkey&#39;,
       &#39;Mount Holyoke College, South Hadley, Massachusetts, USA&#39;,
       &#39;Erebuni Historico-Archaeological Museum- Reserve,&#39;,
       &#39;private: Foroughi collecllon&#39;, &#39;Iran Bastan Museum, Tehran, Iran&#39;,
       &#39;Eski Sark Museum, Istanbul, Turkey&#39;,
       &#39;private: Chappée collecllon&#39;, &#39;private: Mazda, A., Tehran, Iran&#39;,
       &#39;private: R.F. Harper collection&#39;, &#39;private: Foroughi collection&#39;,
       &#39;Oesterle Library, North Central College, Naperville, Illinois, USA&#39;,
       &#39;Russell Library, Maynooth University &amp; St. Patrick’s College, Maynooth, Co. Kildare, Ireland&#39;,
       &#39;Northwestern University Library, Evanston, Illinois, USA&#39;,
       &#39;National Car Museum of Iran, Tehran, Iran&#39;,
       &#39;Erie Historical Museum, Erie, Pennsylvania, USA&#39;,
       &#39;San Diego Museum of Man, San Diego, California, USA&#39;,
       &#39;Museum of Peoples and Cultures, Brigham Young University, Provo, Utah, USA&#39;,
       &#39;Missouri History Museum, St. Louis, Missouri, USA&#39;,
       &#39;Erebuni Museum, Yerevan, Armenia&#39;, &#39;private: Estonia&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a); unlocated (b)&#39;,
       &#39;Private collection: F.S. Clark, Mayfield, UK&#39;,
       &#39;Department of Classics, University of Texas at Austin, Texas, USA&#39;,
       &#39;Archäologische Staatssammlung, Museum für Vor- und Frühgeschichte, Munich, Germany&#39;,
       &#39;Association Bible &amp; Civilisations, Jerusalem&#39;,
       &#39;Leipziger Altorientalischen Institut, Leipzig, Germany&#39;,
       &#39;Saint Louis Public Library, St. Louis, Missouri, USA&#39;,
       &#39;Sulaymaniyah Museum, Sulaymaniyah, Iraq&#39;,
       &#39;private: Lichatschew, N. P., Istanbul, Turkey&#39;, &#39;missing&#39;,
       &#39;Sächsische Landesbibliothek, Staats- und Universitätsbibliothek Dresden, Germany&#39;,
       &#39;private: Vora&#39;, &#39;IM&#39;,
       &#39;Oneida County Historical Society, Utica, New York, USA&#39;,
       &#39;Abu Shahrain, Iraq&#39;, &#39;El-Hiba, Iraq&#39;, &#39;Nuffar, Iraq&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA&#39;, &#39;left in situ&#39;,
       &#39;private: anonymous, Vienna, Austria ?&#39;,
       &#39;Creighton University, Omaha, Nebraska, USA&#39;,
       &#39;Brighton Museum and Art Gallery, Brighton, UK&#39;,
       &#39;Aichi Prefectural University, Aichi, Japan&#39;,
       &#39;Quayle Bible Collection, Baker University, Baldwin City, Kansas, USA&#39;,
       &#39;private: Jerusalem&#39;, &#39;private: unlocated&#39;,
       &#39;Tsurumi University Library, Yokohama, Japan&#39;,
       &quot;Kobe Women&#39;s University Library, Kobe, Japan&quot;,
       &#39;Meiji University Library, Tokyo, Japan&#39;,
       &#39;Kansai University Library, Osaka, Japan&#39;,
       &#39;private: Ponsar, Jean-François, Brussels, Belgium&#39;,
       &quot;A&#39;ali, Bahrain&quot;, &#39;Musée des Confluences, Lyon, France&#39;,
       &#39;Dover Museum, Dover, UK&#39;,
       &#39;private: Foxvog, Daniel A., Rio Nido, CA, USA&#39;,
       &#39;private: anonymous&#39;, &#39;private: unknown, unlocated&#39;,
       &#39;Department of Middle Eastern Studies, University of West Bohemia, Pilsen, Czech Republic&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA&#39;,
       &#39;Private Collection&#39;,
       &#39;Istanbul Arkeoloki Museum, Istanbul, Turkey&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; Istanbul Arkeoloki Museum, Istanbul, Turkey&#39;,
       &#39;Garstang Museum of Archaeology, University of Liverpool, Liverpool, UK&#39;,
       &#39;Civico Museo Archeologico Paolo Giovio, Como, Italy&#39;,
       &#39;Louvre Museum, Paris, France; British Museum, London, UK&#39;,
       &#39;Diözesanmuseum, Breslau, Poland&#39;, &#39;Mosul, Iraq ?&#39;,
       &#39;Eşki Şark Eserleri Müzesi, Istanbul, Turkey ?&#39;,
       &#39;Babylon, Iraq (in situ) ?&#39;,
       &#39;Private collection: anonymous, Berlin, Germany&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; British Museum, London, UK&#39;,
       &#39;Institute of Archaeology, University of Turin, Turin, Italy&#39;,
       &#39;Urfa Museum, Urfa, Turkey&#39;, &#39;Private collection: anonymous&#39;,
       &#39;Sela, Jordan&#39;, &#39;Tayma, Saudi Arabia&#39;,
       &#39;Archaeological Museum, Anakara, Turkey&#39;, &#39;private collection&#39;,
       &#39;private: Lizana, Joaquín, Huesca, Spain&#39;,
       &#39;private: Saaedi, London&#39;, &#39;Sammlung H. Grimme, Cologne, Germany&#39;,
       &#39;Erimtan Museum of Archaeology and Art, Ankara, Turkey&#39;,
       &#39;Gaziantep Archaeological Museum, Gaziantep, Turkey&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium; Kayseri Archaeological Museum, Kayseri, Turkey&#39;,
       &#39;private: Peter Franke, Saarbrücken, Germany&#39;,
       &#39;Lands of the Bible Archaeology Foundation&#39;,
       &#39;Hatay Archaeological Museum, Antakya, Turkey&#39;,
       &#39;Altorientalischen Seminar der Universität Tübingen, Germany&#39;,
       &#39;H.I.H. Prince Takahito Mikasa&#39;, &#39;Private collection&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (unlocated (formerly in theTell Halaf Museum); British Museum, London, UK&#39;,
       &#39;unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, USA&#39;,
       &#39;Merseyside Museum, Liverpool, UK&#39;, &#39;Louvre, Paris&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; British Museum, London, UK; Département des Monnaies, Médailles et Antiques, Bibliothèque Nationale, Paris, France; Nebuchadnezzar Museum, Babylon, Iraq; Iraq Museum, Baghdad, Iraq&#39;,
       &#39;Arkeoloji Müzerleri, Istanbul, Turkey&#39;,
       &#39;British Museum, London, UK; Vorderasiatisches Museum, Berlin, Germany; Arkeoloji Müzerleri, Istanbul, Turkey&#39;,
       &#39;Private Collection: de Clercq, Paris, France&#39;,
       &#39;Arkeoloji Müzerleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Philadelphia Museum of Art, Philadelphia, Pennsylvania, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;British Museum, London, UK; Ashmolean Museum, Oxford, UK; City of Bristol Museum and Art Gallery, Bristol, UK; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Arkeoloji Müzerleri, Istanbul, Turkey; Yale Collection, New Haven, Connecticut, USA; Private Collection: Harper, Unknown, USA; Hilprecht-Sammlung, Fr. Schiller University, Jena, Germany; McGill University Ethnological Collections, Montreal, Quebec Province, Canada&#39;,
       &#39;Seminar für Assyriologie, Universität Heidelberg, Heidelberg, Germany; Yale Collection, New Haven, Connecticut, USA; Hearst Museum of Anthropology, University of California at Berkeley, Berkeley, California, USA&#39;,
       &#39;stele today lost photo of squeeze in the Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Georgian National Museum, Tbilisi, Georgia&#39;,
       &#39;British Museum, London, Great Britain&#39;, &#39;in situ&#39;,
       &#39;Sulaymaniyah Museum,&#39;, &#39;British Museum&#39;, &#39;University of Leeds&#39;,
       &#39;VAM&#39;, &#39;IAM&#39;, &#39;MMA&#39;, &#39;VAM and IAM&#39;,
       &#39;in situ, but never seen/found again&#39;, &#39;Van Museum, Van, Turkey&#39;,
       &#39;moulds of the three fragments (a-c) preserved in the Georgian National Museum, Tbilisi, Armenia (fragment a): found again in a private garden fragment c): lost)&#39;,
       &#39;lost&#39;,
       &#39;in situ, immured in the ruins of the church well preserved cast&#39;,
       &#39;History Museum of Armenia, Erevan, Armenia&#39;,
       &#39;ragment a): Van Museum, Van, Turkey fragment b): Istanbul Archaeology Museums, Istanbul, Turkey&#39;,
       &#39;Iraq Museum, Baghdad, Iraq&#39;,
       &#39;Tell Halaf museum collection, Berlin (destroyed)&#39;,
       &#39;Syro-Chaldean seminary of Mosul&#39;,
       &#39;Private collection of Prof. Peter Franke, Saarbrücken&#39;,
       &#39;Private collection of Shlomo Moussaieff, on long-term loan in the Bible Lands Museum, Jerusalem, Israel&#39;,
       &#39;Private: H. V. Hilprecht&#39;,
       &#39;John F. Lewis collection, Philadelphia Free Library, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Brisith Museum, London, UK&#39;, &#39;Private: H.V. Hilprecht&#39;,
       &#39;Metropolitan Museum of Art, New York, USA&#39;,
       &#39;private: Amherst, unlocated (dispersed)&#39;,
       &#39;private: Ifergan Gallery (antiquarian), Málaga, Spain&#39;,
       &#39;University of Utah, J. Willard Marriott Library, Salt Lake City, USA&#39;,
       &#39;private: Green, Oklahoma City, USA&#39;, &#39;unknown, unlocated&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_wikidata_id2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name_native2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_url2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_eng2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_native2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_collection2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_collection2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple collections</span>
<span class="n">no_match_indices_collection2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">])):</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_c</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_c</span><span class="p">:</span>
    <span class="n">P155_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_c</span> <span class="o">=</span> <span class="n">first_c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_c</span>

  <span class="c1"># if the collection has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_c</span> <span class="ow">in</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_c</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_c</span><span class="p">)</span>
    <span class="n">collection_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;factgrid_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_wikidata_id2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wikidata_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_url2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_eng2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_wikidata_id2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_url2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_eng2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_qid2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_wikidata_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_wikidata_id2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name_native2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_url2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_eng2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_native2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;P155_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_collection2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;other_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_collection2</span>

<span class="n">collection_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b794e136-1e7d-4590-abfb-6667db0dc15d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b794e136-1e7d-4590-abfb-6667db0dc15d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b794e136-1e7d-4590-abfb-6667db0dc15d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b794e136-1e7d-4590-abfb-6667db0dc15d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-518c0dd6-71ec-4076-afcc-75665c5af322">
  <button class="colab-df-quickchart" onclick="quickchart('df-518c0dd6-71ec-4076-afcc-75665c5af322')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-518c0dd6-71ec-4076-afcc-75665c5af322 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-collection-df2">
<h3>3.2.2 matched_collection_df2<a class="headerlink" href="#matched-collection-df2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df2</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="p">[</span><span class="o">~</span><span class="n">collection_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_collection2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_collection_df2</span> <span class="o">=</span> <span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_collection_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-05ae0c8b-b91e-4d60-9c12-80f36e223051" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>oracc_dump_id</th>
      <th>oracc_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32452</th>
      <td>Q008369</td>
      <td>British Museum, London, UK</td>
      <td>British Museum, London, UK</td>
      <td>Q102010</td>
      <td>Q6373</td>
      <td>British Museum</td>
      <td>British Museum</td>
      <td>https://www.britishmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32453</th>
      <td>P101902</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Q511934</td>
      <td>Q636400</td>
      <td>Ashmolean Museum</td>
      <td>Ashmolean Museum</td>
      <td>https://www.ashmolean.org</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32454</th>
      <td>P330624</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Q511934</td>
      <td>Q636400</td>
      <td>Ashmolean Museum</td>
      <td>Ashmolean Museum</td>
      <td>https://www.ashmolean.org</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32455</th>
      <td>P374078</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>Q511904</td>
      <td>Q1276053</td>
      <td>Oriental Institute, University of Chicago</td>
      <td>Oriental Institute, University of Chicago</td>
      <td>https://oi.uchicago.edu</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>32456</th>
      <td>P500761</td>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>Q512004</td>
      <td>Q160236</td>
      <td>Metropolitan Museum of Art</td>
      <td>Metropolitan Museum of Art</td>
      <td>https://www.metmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>32457 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-05ae0c8b-b91e-4d60-9c12-80f36e223051')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-05ae0c8b-b91e-4d60-9c12-80f36e223051 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-05ae0c8b-b91e-4d60-9c12-80f36e223051');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-590771da-67fc-48f1-a4e3-274d19dd0797">
  <button class="colab-df-quickchart" onclick="quickchart('df-590771da-67fc-48f1-a4e3-274d19dd0797')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-590771da-67fc-48f1-a4e3-274d19dd0797 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32457, 12)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-collection-df2">
<h3>3.2.3 no_match_collection_df2<a class="headerlink" href="#no-match-collection-df2" title="Link to this heading">#</a></h3>
<p>Make a separate data frame for the texts when there is no match / museum / collection: <code class="docutils literal notranslate"><span class="pre">no_collection_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection2</span><span class="p">]</span>
<span class="n">no_match_collection_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9f065519-3346-450c-a989-278bd34f62fd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000166</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19412,8</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19412,08</td>
      <td>Nb XVI,3/4</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000166</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>152</th>
      <td>Q000026</td>
      <td>0.0</td>
      <td>P000171</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19667,e</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19667,e</td>
      <td>Nc XVI,5</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Metal (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000171</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Q000023</td>
      <td>0.0</td>
      <td>P000173</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19724</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19724</td>
      <td>Nb XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Vessels and Garments (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000173</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000174</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,b</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,b</td>
      <td>Na XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000174</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Q000013</td>
      <td>0.0</td>
      <td>P000175</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,c</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,c</td>
      <td>Na XVI,3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Fish (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000175</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>S013836</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9f065519-3346-450c-a989-278bd34f62fd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9f065519-3346-450c-a989-278bd34f62fd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9f065519-3346-450c-a989-278bd34f62fd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f0be5ff4-0742-49d5-ab64-83fc679f8640">
  <button class="colab-df-quickchart" onclick="quickchart('df-f0be5ff4-0742-49d5-ab64-83fc679f8640')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f0be5ff4-0742-49d5-ab64-83fc679f8640 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(334459, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_collection_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h4>3.2.4 Visualization<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
</section>
<section id="id5">
<h4>Distribution of matched first collections<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">)[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_c_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_c_df2</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span>
               <span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_c_df2</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_c_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-23141600-4fcd-47a2-9072-2abb0c9fc0d9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>9464</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>6171</td>
    </tr>
    <tr>
      <th>2</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>4654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>2649</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>2232</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Louvre Museum, Paris, France</td>
      <td>1812</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri,...</td>
      <td>1322</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>957</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>947</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hilprecht Collection, University of Jena, Germany</td>
      <td>369</td>
    </tr>
    <tr>
      <th>10</th>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>354</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>318</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Free Library of Philadelphia, Philadelphia, Pe...</td>
      <td>223</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Montserrat Museum, Barcelona, Spain</td>
      <td>132</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Nies Babylonian Collection, Yale Babylonian Co...</td>
      <td>129</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Musées royaux d’Art et d’Histoire, Brussels, B...</td>
      <td>121</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>68</td>
    </tr>
    <tr>
      <th>17</th>
      <td>State Hermitage Museum, St. Petersburg, Russia...</td>
      <td>65</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Royal Ontario Museum of Archaeology, Toronto, ...</td>
      <td>64</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Newell Collections of Babylonian Tablets, Yale...</td>
      <td>51</td>
    </tr>
    <tr>
      <th>20</th>
      <td>National Museum of Syria, Damascus, Syria</td>
      <td>48</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Hearst Museum of Anthropology, University of C...</td>
      <td>42</td>
    </tr>
    <tr>
      <th>22</th>
      <td>New York Public Library, New York, New York, USA</td>
      <td>38</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Spurlock Museum, University of Illinois, Urban...</td>
      <td>25</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Israel Museum, Jerusalem</td>
      <td>19</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Museo Archeologico Nazionale di Firenze, Flore...</td>
      <td>16</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Kelsey Museum of Archaeology, University of Mi...</td>
      <td>15</td>
    </tr>
    <tr>
      <th>27</th>
      <td>World Museum Liverpool, Liverpool, UK</td>
      <td>15</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Fitzwilliam Museum, University of Cambridge, C...</td>
      <td>14</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Nationalmuseet, Copenhagen, Denmark</td>
      <td>13</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Princeton Theological Seminary, Princeton, New...</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Museo di Antichità di Torino, Turin, Italy</td>
      <td>9</td>
    </tr>
    <tr>
      <th>32</th>
      <td>John Rylands Library, University of Manchester...</td>
      <td>9</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Museum Forum der Völker (Völkerkundemuseum der...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Archaeological Research Collection, University...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Bible Lands Museum, Jerusalem</td>
      <td>8</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Manchester Museum, University of Manchester, M...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Los Angeles County Museum of Art (LACMA), Los ...</td>
      <td>6</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Bibliothèque Nationale et Universitaire de Str...</td>
      <td>6</td>
    </tr>
    <tr>
      <th>39</th>
      <td>American University of Beirut Archaeological M...</td>
      <td>5</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Bodmer Museum, Cologny, Switzerland</td>
      <td>5</td>
    </tr>
    <tr>
      <th>41</th>
      <td>National Museum of Ethnology, Osaka, Japan</td>
      <td>4</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Peabody Essex Museum, Salem, Massachusetts, USA</td>
      <td>4</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Memorial Art Gallery, University of Rochester,...</td>
      <td>4</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Rosicrucian Egyptian Museum, San Jose, Califor...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Deutsches Museum, Munich, Germany</td>
      <td>3</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>2</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Glencairn Museum, Bryn Athyn, Pennsylvania, USA</td>
      <td>2</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Museum of Fine Arts, Budapest, Hungary</td>
      <td>1</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trinity College, Dublin, Ireland</td>
      <td>1</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Università Pontificia Salesiana, Rome, Italy</td>
      <td>1</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Ancient Orient Museum, Tokyo, Japan</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-23141600-4fcd-47a2-9072-2abb0c9fc0d9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-23141600-4fcd-47a2-9072-2abb0c9fc0d9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-23141600-4fcd-47a2-9072-2abb0c9fc0d9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4c189964-16ae-4006-bc73-1f66f7815421">
  <button class="colab-df-quickchart" onclick="quickchart('df-4c189964-16ae-4006-bc73-1f66f7815421')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4c189964-16ae-4006-bc73-1f66f7815421 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collection&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ORACC: Top 10 First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/414058e4146215fa9c7cd0460b1958ff50cfc66e059d967700649050854cbf59.png" src="_images/414058e4146215fa9c7cd0460b1958ff50cfc66e059d967700649050854cbf59.png" />
</div>
</div>
</section>
<section id="distribution-of-countries-of-first-collections-that-matched">
<h4>Distribution of countries of first collections that matched<a class="headerlink" href="#distribution-of-countries-of-first-collections-that-matched" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_country2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_c_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_country</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="n">collection_country2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">current_country</span><span class="p">]</span>

<span class="n">first_c_df2</span><span class="p">[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_country2</span>

<span class="n">first_c_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-415172ae-d7fe-449b-9f3c-ccd12c993220" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
      <th>collection_country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>9464</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>6171</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>4654</td>
      <td>Iraq</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>2649</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>2232</td>
      <td>Turkey</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Louvre Museum, Paris, France</td>
      <td>1812</td>
      <td>France</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri,...</td>
      <td>1322</td>
      <td>Turkey</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>957</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>947</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hilprecht Collection, University of Jena, Germany</td>
      <td>369</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>10</th>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>354</td>
      <td>Syria</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>318</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Free Library of Philadelphia, Philadelphia, Pe...</td>
      <td>223</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Montserrat Museum, Barcelona, Spain</td>
      <td>132</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Nies Babylonian Collection, Yale Babylonian Co...</td>
      <td>129</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Musées royaux d’Art et d’Histoire, Brussels, B...</td>
      <td>121</td>
      <td>Belgium</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>68</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>17</th>
      <td>State Hermitage Museum, St. Petersburg, Russia...</td>
      <td>65</td>
      <td>RussianFederation</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Royal Ontario Museum of Archaeology, Toronto, ...</td>
      <td>64</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Newell Collections of Babylonian Tablets, Yale...</td>
      <td>51</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>20</th>
      <td>National Museum of Syria, Damascus, Syria</td>
      <td>48</td>
      <td>Syria</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Hearst Museum of Anthropology, University of C...</td>
      <td>42</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>22</th>
      <td>New York Public Library, New York, New York, USA</td>
      <td>38</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Spurlock Museum, University of Illinois, Urban...</td>
      <td>25</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Israel Museum, Jerusalem</td>
      <td>19</td>
      <td>Jerusalem</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Museo Archeologico Nazionale di Firenze, Flore...</td>
      <td>16</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Kelsey Museum of Archaeology, University of Mi...</td>
      <td>15</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>27</th>
      <td>World Museum Liverpool, Liverpool, UK</td>
      <td>15</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Fitzwilliam Museum, University of Cambridge, C...</td>
      <td>14</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Nationalmuseet, Copenhagen, Denmark</td>
      <td>13</td>
      <td>Denmark</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Princeton Theological Seminary, Princeton, New...</td>
      <td>12</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Museo di Antichità di Torino, Turin, Italy</td>
      <td>9</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>32</th>
      <td>John Rylands Library, University of Manchester...</td>
      <td>9</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Museum Forum der Völker (Völkerkundemuseum der...</td>
      <td>8</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Archaeological Research Collection, University...</td>
      <td>8</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Bible Lands Museum, Jerusalem</td>
      <td>8</td>
      <td>Jerusalem</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Manchester Museum, University of Manchester, M...</td>
      <td>8</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Los Angeles County Museum of Art (LACMA), Los ...</td>
      <td>6</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Bibliothèque Nationale et Universitaire de Str...</td>
      <td>6</td>
      <td>France</td>
    </tr>
    <tr>
      <th>39</th>
      <td>American University of Beirut Archaeological M...</td>
      <td>5</td>
      <td>Lebanon</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Bodmer Museum, Cologny, Switzerland</td>
      <td>5</td>
      <td>Switzerland</td>
    </tr>
    <tr>
      <th>41</th>
      <td>National Museum of Ethnology, Osaka, Japan</td>
      <td>4</td>
      <td>Japan</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Peabody Essex Museum, Salem, Massachusetts, USA</td>
      <td>4</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Memorial Art Gallery, University of Rochester,...</td>
      <td>4</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Rosicrucian Egyptian Museum, San Jose, Califor...</td>
      <td>3</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Deutsches Museum, Munich, Germany</td>
      <td>3</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>2</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Glencairn Museum, Bryn Athyn, Pennsylvania, USA</td>
      <td>2</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Museum of Fine Arts, Budapest, Hungary</td>
      <td>1</td>
      <td>Hungary</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trinity College, Dublin, Ireland</td>
      <td>1</td>
      <td>Ireland</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Università Pontificia Salesiana, Rome, Italy</td>
      <td>1</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Ancient Orient Museum, Tokyo, Japan</td>
      <td>1</td>
      <td>Japan</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-415172ae-d7fe-449b-9f3c-ccd12c993220')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-415172ae-d7fe-449b-9f3c-ccd12c993220 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-415172ae-d7fe-449b-9f3c-ccd12c993220');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9aad4240-a2c8-43ef-8a12-2e6d54651b7e">
  <button class="colab-df-quickchart" onclick="quickchart('df-9aad4240-a2c8-43ef-8a12-2e6d54651b7e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9aad4240-a2c8-43ef-8a12-2e6d54651b7e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_country_count2</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;collection_country&#39;</span><span class="p">])[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">first_c_country_count2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-106-1a8b76927ae6&gt;:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  first_c_country_count2 = first_c_df2.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
&lt;ipython-input-106-1a8b76927ae6&gt;:1: FutureWarning: The operation &lt;built-in function sum&gt; failed on a column. If any error is raised, this will raise an exception in a future version of pandas. Drop these columns to avoid this warning.
  first_c_country_count2 = first_c_df2.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
</pre></div>
</div>
<div class="output text_html">
  <div id="df-fd2e84d2-f4a5-4285-a4d5-18337c45e61e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection_country</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>UK</td>
      <td>10469</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USA</td>
      <td>8066</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Iraq</td>
      <td>4654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Turkey</td>
      <td>3554</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Germany</td>
      <td>3029</td>
    </tr>
    <tr>
      <th>5</th>
      <td>France</td>
      <td>1818</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Syria</td>
      <td>402</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Spain</td>
      <td>132</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Belgium</td>
      <td>121</td>
    </tr>
    <tr>
      <th>9</th>
      <td>RussianFederation</td>
      <td>65</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Canada</td>
      <td>64</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Jerusalem</td>
      <td>27</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Italy</td>
      <td>26</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Denmark</td>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Lebanon</td>
      <td>5</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Switzerland</td>
      <td>5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Japan</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Ireland</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Hungary</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fd2e84d2-f4a5-4285-a4d5-18337c45e61e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fd2e84d2-f4a5-4285-a4d5-18337c45e61e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fd2e84d2-f4a5-4285-a4d5-18337c45e61e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-afaed59c-d367-40a6-b96a-ad734ca1df21">
  <button class="colab-df-quickchart" onclick="quickchart('df-afaed59c-d367-40a6-b96a-ad734ca1df21')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-afaed59c-d367-40a6-b96a-ad734ca1df21 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_country_count2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ORACC: Countries of First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c56803e925d27457e54ae1746ba9f5a03362a05f389a52f0ce348985028453fb.png" src="_images/c56803e925d27457e54ae1746ba9f5a03362a05f389a52f0ce348985028453fb.png" />
</div>
</div>
</section>
<section id="id6">
<h4>Distribution of unmatched collections<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">)[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oracc_dump_collection
A&#39;ali, Bahrain                                                                                   6
Abbey Museum, Queensland, Australia                                                              1
Abu Shahrain, Iraq                                                                               4
Aichi Prefectural University, Aichi, Japan                                                       2
Albertson College of Idaho, Caldwell, Idaho, USA                                                 1
                                                                                                ..
unlocated: reconstructed parallel to Zb-02 (a)                                                   1
École Biblique et Archéologique Française, Jerusalem                                             2
École Pratique des Hautes Études, Paris, France                                                 10
École Pratique des Hautes Études, Paris, France; Vorderasiatisches Museum, Berlin, Germany ?     1
Übersee-Museum, Bremen, Germany                                                                  1
Name: oracc_dump_collection, Length: 660, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_collections2</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection2</span><span class="p">][</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">]</span>
<span class="n">unmatched_collections_clean2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unmatched_collections2</span><span class="p">:</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># split a multi statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_collections_clean2</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_collections_clean2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_collections_clean2</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_collections_clean2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;German Archaeological Institute, Berlin, Germany (on loan, University of Heidelberg)&#39;,
       &#39;unlocated&#39;, &#39;nan&#39;, &#39;private: anonymous, unlocated&#39;,
       &#39;private: Michail, Louise, Milan, Italy&#39;,
       &#39;Mead Art Gallery, Amherst College, Amherst, Massacusetts, USA&#39;,
       &#39;Bible Lands Museum, Pittsburgh Theological Seminary, Pittsburgh, Pennsylvania, USA&#39;,
       &#39;Kyoto University, Kyoto, Japan&#39;,
       &#39;Crozer Theological Seminary, Rochester, New York, USA&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &quot;Musées royaux d&#39;Art et d&#39;Histoire, Brussels, Belgium&quot;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria&#39;,
       &#39;National Museum, Tehran, Iran&#39;,
       &#39;private: de Serres, J. Mariaud, Paris, France&#39;,
       &#39;private: Foroughi, Mohsen, Tehran, Iran&#39;,
       &#39;J. Pierpont Morgan Library Collection, New York, New York, USA&#39;,
       &#39;private: Frauenberger, K., Germany&#39;,
       &#39;Kalamazoo Valley Museum, Kalamazoo, Michigan, USA&#39;,
       &#39;private: Foroughi, Teheran, Iran&#39;,
       &#39;Musée d’Art et d’Histoire, Geneva, Switzerland&#39;,
       &#39;Institute of Archaeology, London, UK&#39;,
       &#39;Gallery of Fine Arts, Yale University, New Haven, Connecticut, USA&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany&#39;,
       &#39;Allard Pierson Museum, University of Amsterdam, Amsterdam, Holland&#39;,
       &#39;Archäologisches Museum, Universität Halle-Wittenberg, Germany&#39;,
       &#39;private: Hoza, Camberg, Germany&#39;,
       &#39;National Museum of Syria, Raqqa, Syria&#39;,
       &#39;private: Baldacci, Milan, Italy&#39;,
       &#39;École Pratique des Hautes Études, Paris, France&#39;,
       &#39;private: Hideo Mihira, Chiba, Japan&#39;,
       &#39;Osaka Prefectural Chikatsu-Asuka Museum, Osaka, Japan&#39;,
       &#39;Takahashi Collection, Municipal Museum, Fujisawa, Japan&#39;,
       &#39;private: Namio Egami, Tokyo, Japan&#39;,
       &#39;Tokyo National Museum, Tokyo, Japan&#39;,
       &#39;Harvard Museum of the Ancient Near East, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;private: Cros, unlocated&#39;, &#39;Munich, Germany&#39;,
       &#39;private: Erlenmeyer, Basel, Switzerland (dispersed)&#39;,
       &#39;private: anonymous, Baghdad, Iraq&#39;, &#39;private: Banks, unlocated&#39;,
       &#39;private: Samhery, unlocated&#39;, &#39;private: Greene, unlocated&#39;,
       &#39;private: Tournay, unlocated&#39;,
       &#39;Medelhavsmuseet, Stockholm, Sweden&#39;,
       &#39;private: Haldar, Alfred O., Uppsala, Sweden&#39;,
       &#39;Milwaukee Public Museum, Milwaukee, Wisconsin, USA&#39;,
       &#39;New Brunswick Museum, St. John, New Brunswick, Canada&#39;,
       &#39;J. Pierpont Morgan Library Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Chester Beatty Library, Dublin, Ireland&#39;,
       &#39;Birmingham Museums and Art Gallery, Birmingham, UK&#39;,
       &#39;private: anonymous, Göttingen, Germany&#39;,
       &#39;Liebighaus, Frankfurt, Germany&#39;,
       &#39;private: Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Reber Collection, Lausanne, Switzerland&#39;,
       &#39;private: Schimmel, Norbert, unlocated&#39;,
       &#39;National Museum of Syria, Idlib, Syria&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (on loan, British Museum, London, UK )&#39;,
       &#39;Robert Hull Fleming Museum, University of Vermont, Burlington, Vermont, USA&#39;,
       &#39;Field Museum of Natural History, Chicago, Illinois, USA&#39;,
       &#39;Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel&#39;,
       &#39;Hilprecht Collection, University of Jena, Jena, Germany&#39;,
       &#39;Studium Biblicum Franciscanum Archaeological Museum, Jerusalem&#39;,
       &#39;Cabinet des Médailles, Musée d’Histoire et d’Art, Musées de l’Etat, Luxemburg&#39;,
       &#39;Ethnological Collections, Redpath Museum, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: David, E.S., New York, New York, USA&#39;,
       &#39;private: Hechich, Rome, Italy&#39;, &#39;Museo Barracco, Rome, Italy&#39;,
       &#39;private: Galling, Kurt, Tübingen, Germany&#39;,
       &#39;Museum of Anthropology, University of British Columbia, Vancouver, British Columbia, Canada&#39;,
       &#39;private: Ligabue, Giancarlo, Venice, Italy&#39;,
       &#39;private: Southesk collection&#39;, &#39;Couvent Saint-Etienne, Jerusalem&#39;,
       &#39;National Museum of Iraq, Baghdad,Iraq&#39;,
       &#39;private: anonmymous, unlocated&#39;,
       &#39;Rare Book and Manuscript Library, Columbia University, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq: University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;private: Hoffman, E. A., unlocated&#39;,
       &#39;private: Barton, G. A., unlocated&#39;,
       &#39;Rijksmuseum van Oudheden, Leiden, Holland&#39;,
       &#39;Katholieke Universiteit, Nijmegen, Holland&#39;,
       &#39;Detroit Institute of Arts, Detroit, Michigan, USA&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark&#39;, &#39;private: Hechler&#39;,
       &#39;private: Cugnin, L., unlocated&#39;,
       &#39;Musée des Antiquités à Rouen, France&#39;, &#39;private,: Hechler&#39;,
       &#39;private: Chandon de Briailles, unlocated&#39;,
       &#39;Museum Haaretz, Tel Aviv, Israel&#39;,
       &#39;private: Mercer, S.A.B., Toronto, Ontario, Canada&#39;,
       &#39;Institute of Semitics, University of Groningen, Groningen, Holland&#39;,
       &#39;University of Pretoria, Pretoria, South Africa&#39;,
       &#39;Cracow National Museum, Cracow, Poland&#39;,
       &#39;Bryn Mawr College, Bryn Mawr, Pennsylvania, USA&#39;,
       &#39;private: Jager, H. J. de , unlocated&#39;, &#39;Japan&#39;,
       &#39;Ziegelei-Museum, Meienberg, Germany&#39;,
       &#39;Musée St. Remi, Reims, France&#39;,
       &#39;private: Béghin, Versailles, France&#39;,
       &#39;Landesmuseum Joanneum, Graz, Austria&#39;,
       &#39;Kestner Museum, Hannover, Germany&#39;,
       &#39;Musée Royal de Mariemont, Morlanwelz, Belgium&#39;,
       &#39;Museo Barraco, Rome, Italy&#39;, &#39;Musée de Cinquantenaire Brussels&#39;,
       &#39;private: de Clercq, unlocated&#39;,
       &#39;private: Seidl-Geuthner, F., unlocated&#39;,
       &#39;private: Clark, Cumberland (probably dispersed)&#39;,
       &#39;Newell Bequest Collection, Wheaton College, Wheaton, Illinois, USA&#39;,
       &#39;private: Collection de Clercq, Paris, France&#39;,
       &#39;private: Golenishev, unlocated&#39;,
       &#39;Gutenberg Museum, Mainz,Germany&#39;,
       &#39;California Museum of Ancient Art, Los Angeles, California, USA&#39;,
       &#39;Department of Near Eastern Studies, Cornell University, Ithaca, New York, USA&#39;,
       &#39;private: Jensen, William, Austin, Texas, USA&#39;,
       &#39;private: LaForme, William, USA&#39;, &#39;private: Kuhs, R., Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA&#39;,
       &#39;Schøyen Collection, Oslo, Norway&#39;, &#39;Kelsey Museum&#39;,
       &#39;Kelsey Museum, University of Michigan, Ann Arbor, Michigan, USA&#39;,
       &#39;Archeological Museum, Antakya, Hatay, Turkey&#39;,
       &#39;private: Stefanik,Deborah, Las Vegas, Nevada, USA&#39;,
       &#39;Library of Congress, Washington, DC, USA&#39;,
       &#39;Siegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK&#39;,
       &#39;Couvent Saint-Étienne, Jerusalem&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey&#39;,
       &#39;École Biblique et Archéologique Française, Jerusalem&#39;,
       &#39;Oakland Museum of California, Oakland, California, USA&#39;,
       &#39;iSegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;Museum fur Volkerkunde, Freiburg, Germany&#39;,
       &#39;Ruhrlandmuseum, Essen, Germany&#39;, &#39;Schøyen collection, Oslo&#39;,
       &#39;private: anonymous, Europe&#39;,
       &#39;Oriental Museum, University of Durham, Durham, UK&#39;,
       &#39;private: Homsy, E., Beirut, Lebanon&#39;,
       &#39;Oriental Institute, University of Chicago, Illinois, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology&#39;,
       &#39;University Museum, University of Pennsylvania, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA: Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Rare Manuscript Collections, Cornell University Library, Ithaca, New York, USA&#39;,
       &#39;Near Eastern Studies, UC Berkeley (Dales Collection), Berkeley, California, USA&#39;,
       &#39;private: anonymous, Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA (a)&#39;,
       &#39;Nimrud, Iraq (b)&#39;, &#39;Site museum, Boghazkoi, Turkey&#39;,
       &#39;Israel Antiquities Authority, Jerusalem&#39;,
       &#39;Science Museum of Minnesota, St. Paul, Minnesota, USA&#39;,
       &#39;private: Hebenstreit, Laurent, Paris, France&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;private: Cotsen, Los Angeles, California, USA&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, USA&#39;,
       &#39;Hesburgh Library, University of Notre Dame, Notre Dame, Indiana, USA&#39;,
       &#39;Special Collections and Archives, John T. Richardson Library, DePaul University, Chicago, Illinois, USA&#39;,
       &#39;Louvre Museum, Paris, France&#39;, &#39;Collection Beghin, Versailles&#39;,
       &#39;Vorderasiatisches Museum, Berlin&#39;,
       &#39;Andersen Library, University of Minnesota, Minneapolis-St. Paul, Minnesota, USA&#39;,
       &#39;Staley Library, Millikin University, Decatur, Illinois, USA&#39;,
       &#39;Michael C. Carlos Museum, Emory University, Atlanta, Georgia, USA&#39;,
       &#39;The Ashmolean Museum, Oxford&#39;,
       &#39;Rosen Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Goucher College Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Yale Babylonian Collection, New Haven&#39;,
       &#39;Nies Babylonian Collection, Yale Babilonian Collection, New Haven&#39;,
       &#39;Archäologisches Museum, Universität Halle, Halle, Germany&#39;,
       &#39;private: Totten, Norman, Bentley College, Waltham, Massachusetts, USA&#39;,
       &#39;Utah State University Museum of Anthropology, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Institute of Religion, Utah State University, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Museum of Church History and Art, Salt Lake City, Utah, USA&#39;,
       &#39;Department of Jordanian Antiquities, Amman, Jordan&#39;,
       &#39;Johns Hopkins University, Baltimore, MD, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turke&#39;, &#39;private: annonymous&#39;,
       &#39;Bibliothèque Nationale, Paris, France&#39;,
       &#39;Topkapı Sarayı Müzesi, Istanbul, Turkey&#39;,
       &#39;Mosul Museum, Mosul, Iraq&#39;,
       &#39;German Archaeological Institute, Berlin, Germany&#39;,
       &#39;Heidelberger Orientalisches Seminar, Heidelberg, Germany&#39;,
       &#39;Semitic Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Hilprecht-Sammlung, University of Jena, Germany&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;private: anonymous, Tel Aviv, Israel&#39;,
       &#39;Musée de Beyrouth, Beirut, Libanon&#39;, &#39;private: anonymous, Canada&#39;,
       &#39;Museum of Corum, Corum, Turkey&#39;,
       &#39;John Rylands University Library, Manchester, UK&#39;,
       &#39;National Museum, Beirut, Lebanon&#39;, &#39;Iraq Museum, Baghdad&#39;,
       &#39;private: anonymous, Victoria, Australia&#39;,
       &#39;Department of Geology, Union College, Schenectady, New York, USA&#39;,
       &#39;Institute of Oriental Culture, University of Tokyo, Tokyo, Japan&#39;,
       &#39;Albertson College of Idaho, Caldwell, Idaho, USA&#39;,
       &#39;School of Archaeology and Oriental Studies, Liverpool University, Liverpool, UK&#39;,
       &#39;Columbia University Library, New York, New York, USA&#39;,
       &#39;Cincinnati Art Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Clinton Historical Society, Clinton, Massachusetts, USA&#39;,
       &#39;Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;Erzabtei St. Martin zu Beuron, Beuron, Germany&#39;,
       &#39;Special Collections, Robert Manning Strozier Library, Florida State University, Tallahassee, Florida, USA&#39;,
       &#39;private: Moussaieff, Shlomo, London, UK&#39;,
       &#39;MacKenzie Art Gallery, University of Regina Collection&#39;,
       &#39;Knox College, Galesburg, IL, USA&#39;,
       &#39;private: anonymous, New York, New York, USA&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collection, UCLA, Los Angeles, USA&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, The Netherlands&#39;,
       &#39;The Oriental Institute, Chicago&#39;,
       &#39;Los Angeles Unified School District, Los Angeles, California, USA&#39;,
       &#39;Diyarbakır Archaeological Museum, Diyarbakır, Turkey&#39;,
       &#39;Harvard Art Museum / Arthur M. Sackler Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Denver Museum of Natural Science, Denver, Colorado, USA&#39;,
       &#39;Badè Museum of Biblical Archaeology, Pacific School of Religion, Berkeley, California, USA&#39;,
       &#39;private: anonymous, New Jersey, USA&#39;,
       &#39;University of Pécs, Pécs, Hungary&#39;,
       &#39;Department of Assyriology and Hebrew Studies, Eötvös L. University, Budapest&#39;,
       &#39;Arizona State Museum, Tucson, Arizona, USA&#39;,
       &#39;Morgan Library, Colorado State University, Fort Collins, Colorado, USA&#39;,
       &#39;Toppan Rare Books Library, University of Wyoming, Laramie, Wyoming, USA&#39;,
       &#39;private: Owen, E. L., Lake Hopatcong, New Jersey, USA&#39;,
       &#39;Penrose Library, Whitman College, Walla Walla, Washington, USA&#39;,
       &#39;Lilly Library, Indiana University, Bloomington, Indiana, USA&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA (permanent loan from Missouri School of Religion [formerly “Bible College of Missouri”], Jefferson City, Missouri)&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA&#39;,
       &#39;Saint Louis Art Museum, St. Louis, Missouri, USA&#39;,
       &#39;Semitics/ICOR Collections, Catholic University of America, Washington, DC, USA&#39;,
       &#39;Nicholson Museum, University of Sydney, Sydney, Australia&#39;,
       &#39;Ethniko Archaiologiko Museo, Athens, Greece&#39;,
       &#39;Eugene Fuller Memorial Collection,  Seattle Art Museum, Seattle, Washington, USA&#39;,
       &#39;Chancellor University Collection, Cleveland, Ohio, USA&#39;,
       &#39;American Museum of Natural History, New York, New York, USA&#39;,
       &#39;Couvent Sainte-Anne, Jerusalem&#39;,
       &#39;New Brunswick Theological Seminary, New Brunswick, New Jersey, USA&#39;,
       &#39;Rush Rhees Library, University of Rochester, Rochester, New York, USA&#39;,
       &#39;Nimrud, Iraq (a) &amp; (d)&#39;,
       &#39;Musei Vaticani, Vatican CIty, Rome, Italy (b)&#39;,
       &#39;Memorial Art Gallery, University of Rochester, Rochester, New York, USA (c)&#39;,
       &#39;unlocated (e)&#39;,
       &#39;Australian Institute of Archaeology, Melbourne,Victoria, Australia&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a)&#39;,
       &#39;unlocated (c)&#39;,
       &#39;David Alderfer Collection, Downers Grove, Illinois, USA&#39;,
       &#39;Burrell Collection. Art Gallery and Museum, Glasgow  (a)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (b)&#39;,
       &#39;Nimrud Collection, Nimrud, Iraq (c)&#39;, &#39;unlocated (d)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (c)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (c)&#39;,
       &#39;Muzeum Narodowe w Warszawie, Warsaw (e)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (f)&#39;,
       &#39;unloc&#39;,
       &#39;Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (b)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a-b)&#39;,
       &#39;Nimrud, Iraq (c)&#39;, &#39;Nimrud, Iraq (a) &amp; (c)&#39;,
       &#39;Mayo, Ireland (Gwyn)&#39;, &#39;Kyoto, Japan&#39;,
       &#39;private: anonymous, Venice, Italy&#39;,
       &quot;Mabee-Gerrer Museum, St. Gergory&#39;s University, Shawnee, Oklahoma, USA&quot;,
       &#39;Museum for Art and History, Geneva&#39;,
       &#39;Williams College Museum of Art, Williamstown, Massachusetts, USA&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA&#39;,
       &#39;British Museum, London, UK (a)&#39;, &#39;Nimrud, Iraq (a)&#39;,
       &#39;unlocated (b)&#39;, &#39;British Museum, London, UK (a-b)&#39;,
       &#39;British Museum, London, UK (a-c)&#39;,
       &#39;Museo Civico di Archeologia Ligure, Genua, Italy (b)&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (c)&#39;,
       &#39;British Museum, London, UK (d)&#39;, &#39;Nimrud, Iraq (e)&#39;,
       &#39;Collection Fred Elghanayan, New York, New York, USA (f)&#39;, &#39;unlo&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (c)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (b)&#39;,
       &#39;private: anonymous, unlocated (c)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (b)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a)&#39;,
       &#39;British Museum, London, UK (b)&#39;,
       &#39;Skulpturensammlung, Dresden, Germany (a)&#39;, &#39;Nimrud, Iraq (a-c)&#39;,
       &#39;Fogg Art Museum, Harvard University, Cambridge, Massachusetts, USA (a)&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA (a)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (a)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (b)&#39;,
       &#39;British Museum, London, UK (c)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 381ff. (description) (a)&#39;,
       &#39;unlocated: reconstructed analog to C-12&#39;,
       &#39;Meuszynski, BaF 2, p. 26. 28 (a)&#39;,
       &#39;Louvre Museum, Paris, France (a)&#39;,
       &#39;Miho Museum, Kyoto, Japan (a)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (a)&#39;,
       &#39;Nimrud, Iraq (b-e)&#39;, &#39;unlocated (f)&#39;,
       &#39;Virginia Museum of Fine Arts, Richmond, Virginia, USA (a)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a)&#39;,
       &#39;unlocated: reconstructed according to position mirrored by C-02 (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 384f. (description) (a)&#39;,
       &#39;Nimrud, Iraq&#39;,
       &#39;Williams College Museum of Art, Williamstown, Massachusetts, USA (d)&#39;,
       &#39; unlocated (e)&#39;, &#39;Brooklyn Museum, Brooklyn, New York, USA (a)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s description of the room (unlocated: Layard, Monuments of Nineveh I, p. 385f. (a)&quot;,
       &#39;Mosul Museum, Mosul, Iraq (a)&#39;,
       &#39;unlocated: reconstructed according to the placement of slabs in this room&#39;,
       &#39;cp. Paley/Sobolewski, BaF 10, p. 85 and pl. 6, 33 (a)&#39;,
       &#39;Museum and Art Gallery, Bristol, UK (a)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (b)&#39;,
       &#39;Nimrud, Iraq (a-h)&#39;, &#39;unlocated (i)&#39;,
       &#39;Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (a)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA (a)&#39;,
       &#39;private: anonymous, New York, New York, USA (a)&#39;,
       &#39;Nimrud, Iraq (a-b, d)&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium (c)&#39;,
       &#39;Nimrud, Iraq (b-d)&#39;,
       &#39;Kalamazoo Valley Museum, Kalamazoo, Michigan, USA (e)&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK (a)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. XXXIX (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 385f. (description) (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 386f. (description) (a)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a)&#39;,
       &#39;unlocated: reconstructed according to analog slabs H-11 and H-24 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. LXII (a)&#39;,
       &#39;Museum Calouste Gulbenkian, Lisbon, Portugal (a)&#39;,
       &#39;Christ Church College, Oxford, UK (a)&#39;,
       &#39;M.H. De Young Museum, San Francisco, California, USA (a)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s general description (Monuments of Nineveh I, 145. 386) of the room and analog to the opposite wall (a)&quot;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (now Dresden) (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA&#39;,
       &#39;Wadsworth Atheneum, Hartford, Connecticut, USA (a)&#39;,
       &#39;Montreal Museum of Fine Arts, Montreal, Canada (b)&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA (a)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (b)&#39;,
       &#39;Nimrud, Iraq (a-d)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (c)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland (a)&#39;,
       &#39;Museo Barracco, Rome, Italy (b)&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (d)&#39;,
       &#39;Nimrud, Iraq (b) &amp; (c)&#39;, &#39;Nimrud, Iraq (a-b)&#39;,
       &#39;private: anonymous (a)&#39;,
       &#39;Idemitsu Museum of Arts, Tokyo, Japan (c)&#39;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada (a)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (a)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (b)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (c)&#39;, &#39;Nimrud, Iraq (d)&#39;,
       &#39;Bhau Daji Lad Museum, Mumbai, India (formerly Victoria and Albert Museum) (b)&#39;,
       &quot;Arts &amp; Culture Centre, Memorial Univ., St. John&#39;s, Newfoundland, Canada (a)&quot;,
       &#39;Nimrud, Iraq (b-c)&#39;,
       &#39;Paisley Art Gallery and Museum, Renfrewshire, UK (d)&#39;,
       &#39;Museum of Fine Arts, Houston, Texas, USA (c)&#39;,
       &#39;private: Collection Samuel Josefowitz, Lausanne, Switzerland (b)&#39;,
       &#39;unloca&#39;, &#39;Louvre Museum, Paris, France (c)&#39;,
       &#39;Detroit Institute of Arts, Detroit, Michigan, USA (e)&#39;,
       &#39;British Museum, London, UK&#39;, &#39;Louvre Museum, Paris, France (f)&#39;,
       &#39;unlocated (g)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a-b, e)&#39;,
       &#39;Magdalen College, Oxford, UK (c)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (f)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (b)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA (c)&#39;,
       &#39;British Museum, London, UK (e)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (b)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (c)&#39;,
       &#39;unlocated: reconstructed based on composition of neighboring reliefs only&#39;,
       &#39;cp. Paley/Sobolewski, BaF 10, p. 33 (a)&#39;,
       &#39;Chrysler Museum of Art, Norfolk, Virginia, USA (a)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA  (a&#39;,
       &#39;= L-14 (b))&#39;, &#39;Middlebury College, Middlebury, Vermont, USA&#39;,
       &#39;Cincinnati Art Museum, Cincinnati, Ohio, USA (b)&#39;,
       &#39;Nelson-Atkins Museum of Art, Kansas City, Missouri, USA (a)&#39;,
       &#39;Kimbell Art Museum, Fort Worth, Texas, USA (b)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA  (b&#39;,
       &#39;= L-03 (a))&#39;, &#39;Amherst College, Amherst, Masssachusetts, USA (a)&#39;,
       &#39;Saint Louis Art Museum, St. Louis, Missouri, USA (b)&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a)&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA (a)&#39;,
       &#39;Fleming Museum, University of Vermont, Burlington, Vermont, USA (a)&#39;,
       &#39;Abegg Foundation, Bern, Switzerland (b)&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA (a)&#39;,
       &#39;unlocated: reconstructed based on symmetrical relief N-08&#39;,
       &#39;Meuszynski, BaF 2, p. 75 (a)&#39;,
       &#39;Swedish National Museum, Stockholm, Sweden (a)&#39;,
       &#39;Worcester Art Museum, Worcester, Massachusetts, USA (a)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (b)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a)&#39;,
       &#39;Museum of Art, Cleveland, Ohio, USA (a)&#39;, &#39;Nimrud, Iraq (a. c-e)&#39;,
       &#39;The Art Institute of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;private: anonymous, unlocated (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (a)&#39;,
       &#39;private: anonymous, unlocated (b)&#39;, &#39;Nimrud, Iraq (c, e)&#39;,
       &#39;Museum für Kunst und Gewerbe, Hamburg, Germany (d);&#39;,
       &#39;Nimrud, Iraq (a-b, d-g)&#39;,
       &#39;private: Collection Merrin, New York, New York, USA  (c)&#39;,
       &#39;unlocated (h)&#39;,
       &#39;Manchester University, Museum, Manchester, UK (b)&#39;,
       &#39;Nimrud, Iraq (a, c-h)&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium (b)&#39;,
       &#39;Nimrud, Iraq (a), d-f&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (b)&#39;,
       &#39;Tigris, Iraq&#39;, &#39;Skulpturensammlung, Dresden, Germany (b)&#39;,
       &quot;unlocated: reconstructed according to Layard&#39;s description (Layard, Monuments of Nineveh I, p.389) and the arrangement of neighboring reliefs (a)&quot;,
       &#39;unlocated: reconstructed according to the available space and arrangement of reliefs in this entrance (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 32&#39;,
       &#39;Original Drawings III, S.W. IV (a)&#39;,
       &#39;unlocated: Layard, Original Drawings IV, Misc. I (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 28 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, S.W. X (a)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;unlocated: reconstructed as counterpart to Z-09 (b)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (b-d)&#39;, &#39;Nimrud, Iraq (f)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 35, possibly lost in the Tigris (a)&#39;,
       &#39;unlocated: reconstructed parallel to Zb-02 (a)&#39;,
       &#39;unlocated: reconstructed analog to other entrances (a)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland&#39;,
       &#39;Canadian Museum of Civilization, Ottawa, Ontario, Canada&#39;,
       &#39;Irvin Department of Rare Books and Special Collections, Ernest F. Hollings Special Collections Library, University of South Carolina Libraries, Columbia, South Carolina, USA&#39;,
       &#39;Tufts University, Bendetson Hall, Medford, Massachusetts, USA&#39;,
       &#39;The British Museum, London&#39;, &#39;Tell Muqayyar, Iraq&#39;,
       &#39;Museo Arqueológico Nacional, Madrid, Spain&#39;,
       &#39;private: anonymous, uncertain&#39;,
       &#39;Institute of Archaeology, Hebrew University, Jerusalem&#39;,
       &#39;private: Mr. Arieh Ben Eli, Haifa, Israel&#39;,
       &quot;St. Andrew&#39;s Memorial Church, Church of Scotland, Jerusalem&quot;,
       &#39;Niedersächsische Landesmuseum Hannover, Germany&#39;,
       &#39;Library of Centenary College, Shreveport, Louisiana, USA&#39;,
       &#39;Allen Memorial Arl Museum, Oberlin, Ohio, USA&#39;,
       &#39;McLennan Library, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: Pabst, J. B, unlocated&#39;,
       &#39;Department of Classics, University of Cincinnati, Cincinnati, Ohio, USA&#39;,
       &#39;Hebrew Union College Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Historical Society, Suffield, Connecticut, USA&#39;,
       &#39;Drew University, Madison, New Jersey, USA&#39;,
       &#39;New Brunswick Museum, Saint John, New Brunswick, Canada&#39;,
       &#39;Stovall Museum of Science and History, University of Oklahoma, Norman, Oklahoma, USA&#39;,
       &#39;private: anonymous, France&#39;,
       &#39;Public Library of Cincinnati and Hamilton County, Cincinnati, Ohio, USA&#39;,
       &#39;Royal Albert Memorial Museum and Art Gallery, Exeter, Devon, UK&#39;,
       &#39;private: Strauss, unlocated&#39;,
       &#39;private: Gîatzer, V., Wiesbaden, Germany&#39;,
       &#39;Museum of Fine Arts, Boston, Massachusetts, USA&#39;,
       &#39;Walker Art Center, Minneapolis, Minnesota, USA (diszpersed)&#39;,
       &#39;Musée de Picardie. Amiens, France&#39;,
       &#39;George Ortiz Collection, Geneva, Switzerland&#39;,
       &#39;private: Armas Salonen (), Helsinki, Finland&#39;, &#39;unclear&#39;,
       &#39;private: anonymous, UK&#39;, &#39;private: anonymous, Jerusalem&#39;,
       &#39;Finnish National Museum, Helsinki, Finland&#39;,
       &#39;Altorientalisches Seminar, Free University of Berlin, Berlin, Germany&#39;,
       &#39;private: Likhochev&#39;,
       &#39;Smith College, Northampton, Massachusetts, USA&#39;,
       &#39;Manitoba Museum of Man and Nature, Winnipeg, Manitoba, Canada&#39;,
       &#39;Museum of the Buffalo Society of Natural Sciences, Buffalo, New York, USA&#39;,
       &#39;private: Mercer, S., unlocated&#39;,
       &#39;Crocker Art Museum, Sacramento, California, USA&#39;,
       &#39;private: Cherkasy&#39;, &#39;Newbury District Museum, Newbury, UK&#39;,
       &#39;private: F. Seidl-Geuthner, Paris, France&#39;,
       &#39;Claremont School of Theology, Claremont, California, USA&#39;,
       &#39;Übersee-Museum, Bremen, Germany&#39;,
       &#39;Toledo Museum of Art, Toledo, Ohio, USA&#39;,
       &#39;Institute of Egyptian Studies, University of Cambridge, Cambridge, UK&#39;,
       &#39;Private Arnold Spaer, FM 44 E.000-5, Jerusalem&#39;,
       &#39;Crocker Art Museum, Sacramento, CA, USA&#39;,
       &#39;Brooklyn Museum of Art, Brooklyn, New York, USA&#39;,
       &#39;St. Paul Public Library Collection, St. Paul, Minnesota, USA (dispersed)&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara&#39;,
       &#39;Ashmolean Museum, Oxford, UK&#39;,
       &#39;Karpeles Collection, Santa Barbara, California, USA&#39;,
       &#39;private: Sivan, Raanan, Jerusalem&#39;,
       &quot;Musée d&#39;art de Joliette, Québec, Canada&quot;,
       &#39;private: anonymous, Pasadena, California, USA&#39;,
       &#39;Mount Holyoke College Art Museum, South Hadley, Massachusetts, USA&#39;,
       &#39;private: Harari, Moshe, Tel Aviv, Israel&#39;,
       &#39;Smithsonian Institution, Washington, DC, USA&#39;,
       &#39;Institute of Archaeology, University of Copenhagen, Denmark&#39;,
       &#39;private: Feuardent, M., London, UK&#39;,
       &#39;Département des Monnaies, Médailles et Antiques, Bibliothèque Nationale, Paris, France&#39;,
       &#39;Institute of Egyptian Studies, Cambridge, UK&#39;,
       &#39;Tyndale House, University of Cambridge, Cambridge, UK&#39;,
       &#39;Kunsthistorisches Museum, Vienna, Austria&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland&#39;,
       &#39;Collection de Clerq&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian&#39;,
       &#39;private: anonymous, Sweden&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy&#39;,
       &#39;private: Seelye, L.H., New York, New York, USA&#39;,
       &#39;Wiener Museum für Völkerkunde, Vienna, Austria&#39;,
       &#39;private: Hares, D., unlocated, UK&#39;,
       &#39;private: anonymous, Berlin, Germany&#39;,
       &#39;private: anonymous, Russia&#39;, &#39;private: Rosen, J., USA&#39;,
       &#39;private: Garret, R., Baltimore, Maryland, USA&#39;,
       &#39;Museum of Ancient Cultures, Macquarie University, Sydney, Australia&#39;,
       &#39;The Hunterian Museum and Art Gallery, Glasgow, UK&#39;,
       &#39;University of Leuven, Leuven, Belgium&#39;,
       &#39;Davidson College Library, Davidson, NC, USA&#39;,
       &#39;Pickler Memorial Library, Truman State University, Kirksville, Missouri, USA&#39;,
       &#39;Center for Advanced Judaic Studies, University of Pennsylvania, Philadephia, Pennsylvania, USA&#39;,
       &#39;Private: anonymous, Sweden&#39;, &#39;Patterson Museum, New Jersey, USA&#39;,
       &#39;Princeton University Library, Princeton, New Jersey, USA&#39;,
       &#39;Brooklyn Museum, Brooklyn, New York, USA&#39;, &#39;Tello, Iraq&#39;,
       &#39;private: Jacobsen collection&#39;, &#39;private: Cugnin, France&#39;,
       &#39;private: Binning, Mellerstain, Berwickshire, UK&#39;,
       &#39;private: Smit, Amsterdam, Holland&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian Federation&#39;,
       &#39;Charlotte M. Smith Collection of Miniature Books, University Libraries, University of Iowa, Iowa City, Iowa, USA&#39;,
       &#39;private: anonymous, Barcelona, Spain&#39;,
       &#39;Kenneth Spencer Research Library, University of Kansas, Lawrence, Kansas, USA&#39;,
       &#39;University of King’s College, Halifax, Nova Scotia, Canada&#39;,
       &#39;Musée de la Castre, Cannes, France&#39;,
       &#39;Mustansiriyah, Baghdad, Iraq&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA&#39;,
       &#39;Allegheny College, Meadville, Pennsylvania, USA&#39;,
       &#39;Buffalo and Erie County Public Library, Buffalo, New York, USA&#39;,
       &#39;St Louis, Missouri, USA&#39;, &#39;Leiden&#39;,
       &#39;private: Brenner, Ori, Rehovot, Israel&#39;,
       &#39;Kahramanmaraş Museum, Turkey&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria unlocated&#39;,
       &#39;Muséum Peronne, France&#39;, &#39;Joanneum Museum, Graz, Austria&#39;,
       &#39;University of Leeds, Leeds, UK&#39;, &#39;University of Lwów, Poland&#39;,
       &#39;private: Dorsky, Morris (on loan to J. Pierpont Morgan Library Collection, New York, New York, USA)&#39;,
       &#39;Abbey Museum, Queensland, Australia&#39;,
       &#39;Kestner Museum, Hannover, UK&#39;,
       &#39;private: anonymous, Vienna, Austria&#39;,
       &#39;Real Academia de la Historia, Madrid, Spain&#39;,
       &#39;private, Perk, H., Turkey&#39;,
       &#39;Mount Holyoke College, South Hadley, Massachusetts, USA&#39;,
       &#39;Erebuni Historico-Archaeological Museum- Reserve,&#39;,
       &#39;private: Foroughi collecllon&#39;, &#39;Iran Bastan Museum, Tehran, Iran&#39;,
       &#39;Eski Sark Museum, Istanbul, Turkey&#39;,
       &#39;private: Chappée collecllon&#39;, &#39;private: Mazda, A., Tehran, Iran&#39;,
       &#39;private: R.F. Harper collection&#39;, &#39;private: Foroughi collection&#39;,
       &#39;Oesterle Library, North Central College, Naperville, Illinois, USA&#39;,
       &#39;Russell Library, Maynooth University &amp; St. Patrick’s College, Maynooth, Co. Kildare, Ireland&#39;,
       &#39;Northwestern University Library, Evanston, Illinois, USA&#39;,
       &#39;National Car Museum of Iran, Tehran, Iran&#39;,
       &#39;Erie Historical Museum, Erie, Pennsylvania, USA&#39;,
       &#39;San Diego Museum of Man, San Diego, California, USA&#39;,
       &#39;Museum of Peoples and Cultures, Brigham Young University, Provo, Utah, USA&#39;,
       &#39;Missouri History Museum, St. Louis, Missouri, USA&#39;,
       &#39;Erebuni Museum, Yerevan, Armenia&#39;, &#39;private: Estonia&#39;,
       &#39;Private collection: F.S. Clark, Mayfield, UK&#39;,
       &#39;Department of Classics, University of Texas at Austin, Texas, USA&#39;,
       &#39;Archäologische Staatssammlung, Museum für Vor- und Frühgeschichte, Munich, Germany&#39;,
       &#39;Association Bible &amp; Civilisations, Jerusalem&#39;,
       &#39;Leipziger Altorientalischen Institut, Leipzig, Germany&#39;,
       &#39;Saint Louis Public Library, St. Louis, Missouri, USA&#39;,
       &#39;Sulaymaniyah Museum, Sulaymaniyah, Iraq&#39;,
       &#39;private: Lichatschew, N. P., Istanbul, Turkey&#39;, &#39;missing&#39;,
       &#39;Sächsische Landesbibliothek, Staats- und Universitätsbibliothek Dresden, Germany&#39;,
       &#39;private: Vora&#39;, &#39;IM&#39;,
       &#39;Oneida County Historical Society, Utica, New York, USA&#39;,
       &#39;Abu Shahrain, Iraq&#39;, &#39;El-Hiba, Iraq&#39;, &#39;Nuffar, Iraq&#39;,
       &#39;left in situ&#39;, &#39;Creighton University, Omaha, Nebraska, USA&#39;,
       &#39;Brighton Museum and Art Gallery, Brighton, UK&#39;,
       &#39;Aichi Prefectural University, Aichi, Japan&#39;,
       &#39;Quayle Bible Collection, Baker University, Baldwin City, Kansas, USA&#39;,
       &#39;private: Jerusalem&#39;, &#39;private: unlocated&#39;,
       &#39;Tsurumi University Library, Yokohama, Japan&#39;,
       &quot;Kobe Women&#39;s University Library, Kobe, Japan&quot;,
       &#39;Meiji University Library, Tokyo, Japan&#39;,
       &#39;Kansai University Library, Osaka, Japan&#39;,
       &#39;private: Ponsar, Jean-François, Brussels, Belgium&#39;,
       &quot;A&#39;ali, Bahrain&quot;, &#39;Musée des Confluences, Lyon, France&#39;,
       &#39;Dover Museum, Dover, UK&#39;,
       &#39;private: Foxvog, Daniel A., Rio Nido, CA, USA&#39;,
       &#39;private: anonymous&#39;, &#39;private: unknown, unlocated&#39;,
       &#39;Department of Middle Eastern Studies, University of West Bohemia, Pilsen, Czech Republic&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA&#39;,
       &#39;Private Collection&#39;,
       &#39;Istanbul Arkeoloki Museum, Istanbul, Turkey&#39;,
       &#39;Garstang Museum of Archaeology, University of Liverpool, Liverpool, UK&#39;,
       &#39;Civico Museo Archeologico Paolo Giovio, Como, Italy&#39;,
       &#39;Diözesanmuseum, Breslau, Poland&#39;, &#39;Mosul, Iraq&#39;,
       &#39;Eşki Şark Eserleri Müzesi, Istanbul, Turkey&#39;,
       &#39;Babylon, Iraq (in situ)&#39;,
       &#39;Private collection: anonymous, Berlin, Germany&#39;,
       &#39;Institute of Archaeology, University of Turin, Turin, Italy&#39;,
       &#39;Urfa Museum, Urfa, Turkey&#39;, &#39;Private collection: anonymous&#39;,
       &#39;Sela, Jordan&#39;, &#39;Tayma, Saudi Arabia&#39;,
       &#39;Archaeological Museum, Anakara, Turkey&#39;, &#39;private collection&#39;,
       &#39;private: Lizana, Joaquín, Huesca, Spain&#39;,
       &#39;private: Saaedi, London&#39;, &#39;Sammlung H. Grimme, Cologne, Germany&#39;,
       &#39;Erimtan Museum of Archaeology and Art, Ankara, Turkey&#39;,
       &#39;Gaziantep Archaeological Museum, Gaziantep, Turkey&#39;,
       &#39;private: Peter Franke, Saarbrücken, Germany&#39;,
       &#39;Lands of the Bible Archaeology Foundation&#39;,
       &#39;Hatay Archaeological Museum, Antakya, Turkey&#39;,
       &#39;Altorientalischen Seminar der Universität Tübingen, Germany&#39;,
       &#39;H.I.H. Prince Takahito Mikasa&#39;, &#39;Private collection&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, USA&#39;,
       &#39;Merseyside Museum, Liverpool, UK&#39;, &#39;Louvre, Paris&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul&#39;,
       &#39;Arkeoloji Müzerleri, Istanbul, Turkey&#39;,
       &#39;Private Collection: de Clercq, Paris, France&#39;,
       &#39;Philadelphia Museum of Art, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Seminar für Assyriologie, Universität Heidelberg, Heidelberg, Germany&#39;,
       &#39;Yale Collection, New Haven, Connecticut, USA&#39;,
       &#39;Hearst Museum of Anthropology, University of California at Berkeley, Berkeley, California, USA&#39;,
       &#39;stele today lost photo of squeeze in the Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Georgian National Museum, Tbilisi, Georgia&#39;,
       &#39;British Museum, London, Great Britain&#39;, &#39;in situ&#39;,
       &#39;Sulaymaniyah Museum,&#39;, &#39;British Museum&#39;, &#39;University of Leeds&#39;,
       &#39;VAM&#39;, &#39;IAM&#39;, &#39;MMA&#39;, &#39;VAM and IAM&#39;,
       &#39;in situ, but never seen/found again&#39;, &#39;Van Museum, Van, Turkey&#39;,
       &#39;moulds of the three fragments (a-c) preserved in the Georgian National Museum, Tbilisi, Armenia (fragment a): found again in a private garden fragment c): lost)&#39;,
       &#39;lost&#39;,
       &#39;in situ, immured in the ruins of the church well preserved cast&#39;,
       &#39;History Museum of Armenia, Erevan, Armenia&#39;,
       &#39;ragment a): Van Museum, Van, Turkey fragment b): Istanbul Archaeology Museums, Istanbul, Turkey&#39;,
       &#39;Iraq Museum, Baghdad, Iraq&#39;,
       &#39;Tell Halaf museum collection, Berlin (destroyed)&#39;,
       &#39;Syro-Chaldean seminary of Mosul&#39;,
       &#39;Private collection of Prof. Peter Franke, Saarbrücken&#39;,
       &#39;Private collection of Shlomo Moussaieff, on long-term loan in the Bible Lands Museum, Jerusalem, Israel&#39;,
       &#39;Private: H. V. Hilprecht&#39;,
       &#39;John F. Lewis collection, Philadelphia Free Library, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Brisith Museum, London, UK&#39;, &#39;Private: H.V. Hilprecht&#39;,
       &#39;Metropolitan Museum of Art, New York, USA&#39;,
       &#39;private: Amherst, unlocated (dispersed)&#39;,
       &#39;private: Ifergan Gallery (antiquarian), Málaga, Spain&#39;,
       &#39;University of Utah, J. Willard Marriott Library, Salt Lake City, USA&#39;,
       &#39;private: Green, Oklahoma City, USA&#39;, &#39;unknown, unlocated&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_collections_clean2</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_c_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">unmatched_c_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-281826ff-db05-4fbd-8388-6275295f9fec" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>327408</td>
    </tr>
    <tr>
      <th>1</th>
      <td>unlocated</td>
      <td>1606</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Department of Near Eastern Studies, Cornell Un...</td>
      <td>698</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Anadolu Medeniyetleri Müzesi, Ankara, Turkey</td>
      <td>511</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Schøyen Collection, Oslo, Norway</td>
      <td>453</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>672</th>
      <td>unlocated: reconstructed according to unlocate...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>673</th>
      <td>M.H. De Young Museum, San Francisco, Californi...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>674</th>
      <td>Christ Church College, Oxford, UK (a)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>675</th>
      <td>Museum Calouste Gulbenkian, Lisbon, Portugal (a)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>676</th>
      <td>unknown, unlocated</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>677 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-281826ff-db05-4fbd-8388-6275295f9fec')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-281826ff-db05-4fbd-8388-6275295f9fec button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-281826ff-db05-4fbd-8388-6275295f9fec');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-caaa07fe-703f-44c5-baf5-69bb46214df8">
  <button class="colab-df-quickchart" onclick="quickchart('df-caaa07fe-703f-44c5-baf5-69bb46214df8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-caaa07fe-703f-44c5-baf5-69bb46214df8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_c_df2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/unmatched_oracc_collections_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_c_df2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collections&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Top 10 Collections of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bc3a2688b8e9b7392ef749b90cb7718e781907280a4509bc766e6f5d0f13d83f.png" src="_images/bc3a2688b8e9b7392ef749b90cb7718e781907280a4509bc766e6f5d0f13d83f.png" />
</div>
</div>
</section>
</section>
<section id="merging-collections-of-cdli-and-oracc">
<h3>3.3 Merging collections of CDLI and ORACC<a class="headerlink" href="#merging-collections-of-cdli-and-oracc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">collection_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">collection_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(366916, 12)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-730812ba-abbe-4e8d-a65b-4eddd2544e44" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-730812ba-abbe-4e8d-a65b-4eddd2544e44')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-730812ba-abbe-4e8d-a65b-4eddd2544e44 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-730812ba-abbe-4e8d-a65b-4eddd2544e44');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4e127ba8-5bf8-4d3f-9917-f42585e01dbc">
  <button class="colab-df-quickchart" onclick="quickchart('df-4e127ba8-5bf8-4d3f-9917-f42585e01dbc')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4e127ba8-5bf8-4d3f-9917-f42585e01dbc button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">collection_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">collection_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(366916, 12)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-302e6194-fa3b-4c9c-a103-d6f4802d8bd7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-302e6194-fa3b-4c9c-a103-d6f4802d8bd7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-302e6194-fa3b-4c9c-a103-d6f4802d8bd7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-302e6194-fa3b-4c9c-a103-d6f4802d8bd7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8548b0e2-432f-4978-877b-06244a38ee3c">
  <button class="colab-df-quickchart" onclick="quickchart('df-8548b0e2-432f-4978-877b-06244a38ee3c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8548b0e2-432f-4978-877b-06244a38ee3c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id_text&#39;, &#39;cdli_dump_collection&#39;, &#39;collection&#39;, &#39;collection_qid&#39;,
       &#39;collection_wikidata_id&#39;, &#39;collection_name&#39;, &#39;collection_name_native&#39;,
       &#39;collection_url&#39;, &#39;wiki_url_eng&#39;, &#39;wiki_url_native&#39;, &#39;P155_collection&#39;,
       &#39;other_collection&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">collection_df</span><span class="p">,</span> <span class="n">collection_df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_collections_df</span> <span class="o">=</span> <span class="n">collections_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_y&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_qid_y&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;collection_wikidata_id_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_wikidata_id_y&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_y&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_native_x&#39;</span><span class="p">,</span><span class="s1">&#39;collection_name_native_y&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;collection_url_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_url_y&#39;</span><span class="p">,</span> <span class="s1">&#39;wiki_url_eng_x&#39;</span><span class="p">,</span><span class="s1">&#39;wiki_url_eng_y&#39;</span><span class="p">,</span> <span class="s1">&#39;wiki_url_native_x&#39;</span><span class="p">,</span><span class="s1">&#39;wiki_url_native_y&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_collection_y&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;other_collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;other_collection_y&#39;</span><span class="p">]]</span>

<span class="n">final_collections_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b9c43c7c-a928-4ebc-8bb8-699d5144439b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>collection_qid_x</th>
      <th>collection_qid_y</th>
      <th>collection_wikidata_id_x</th>
      <th>collection_wikidata_id_y</th>
      <th>collection_name_x</th>
      <th>collection_name_y</th>
      <th>collection_name_native_x</th>
      <th>collection_name_native_y</th>
      <th>collection_url_x</th>
      <th>collection_url_y</th>
      <th>wiki_url_eng_x</th>
      <th>wiki_url_eng_y</th>
      <th>wiki_url_native_x</th>
      <th>wiki_url_native_y</th>
      <th>P155_collection_x</th>
      <th>P155_collection_y</th>
      <th>other_collection_x</th>
      <th>other_collection_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b9c43c7c-a928-4ebc-8bb8-699d5144439b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b9c43c7c-a928-4ebc-8bb8-699d5144439b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b9c43c7c-a928-4ebc-8bb8-699d5144439b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9ce537b7-4a8c-4d54-ac76-954d07481d29">
  <button class="colab-df-quickchart" onclick="quickchart('df-9ce537b7-4a8c-4d54-ac76-954d07481d29')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9ce537b7-4a8c-4d54-ac76-954d07481d29 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="provenience-find-spot-p695">
<h2>4 <strong>provenience = find spot <a class="reference external" href="https://database.factgrid.de/wiki/Property:P695">(P695)</a></strong><a class="headerlink" href="#provenience-find-spot-p695" title="Link to this heading">#</a></h2>
<p>####4.1. Use this CSV to obtain the FactGrid Q-ids for each provenience location in the CDLI catalog:</p>
<p><a class="reference external" href="https://drive.google.com/file/d/1C8hj2nVC8_qzFb8HbArbMpsx41OAV9-m/view?usp=share_link">https://drive.google.com/file/d/1C8hj2nVC8_qzFb8HbArbMpsx41OAV9-m/view?usp=share_link</a></p>
<p>####4.2. Matching can be done either on the cdli ‘provenience’ label, or on the ‘cdli_id2’ number <a class="reference external" href="https://database.factgrid.de/entity/P694">(P694)</a>, but we will need to add the <code class="docutils literal notranslate"><span class="pre">id_text2</span></code> from the original cdli_cat.csv</p>
<p>####4.3. make a data frame, called <code class="docutils literal notranslate"><span class="pre">provenience_df</span></code>, for all matches of the text’s ‘provenience’ to  FactGrid Q-id for ‘find spot’.</p>
<section id="add-two-columns-as-qualifiers">
<h3>4.4 Add two columns as qualifiers:<a class="headerlink" href="#add-two-columns-as-qualifiers" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>‘excavation_no’ = <a class="reference external" href="https://database.factgrid.de/entity/P804">P804</a> Inventory number</p></li>
<li><p>‘findspot_square’ = <a class="reference external" href="https://database.factgrid.de/entity/P425">P425</a> Precision of localisation</p></li>
<li><p>Example text <a class="reference external" href="https://cdli.mpiwg-berlin.mpg.de/artifacts/285665">P285665</a></p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>P695</p></th>
<th class="head"><p>provenience</p></th>
<th class="head"><p>excavation_no</p></th>
<th class="head"><p>findspot_square</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>285665</p></td>
<td><p>Q390001</p></td>
<td><p>Assur (mod. Qalat Sherqat)</p></td>
<td><p>Ass 17861,d + Ass 17861,b + Ass 17861,g + Ass 17861,a</p></td>
<td><p>hD81 (house of the exorcist), excavation trench</p></td>
</tr>
</tbody>
</table>
<p>####4.5. make a separate data frame of all texts which were not matched (or no location identified): <code class="docutils literal notranslate"><span class="pre">no_provenience_df</span></code>.
#####4.5.1. export a CSV of all the unique values (done 7/11/23)
#####4.5.2. Resolve the non-matched labels for the occurance of ‘?’ in the label, or ‘:’ as a separator of joined labels.</p>
<ul class="simple">
<li><p>If there are any question marks, we can use the P155 field in a new column and fill the cell with <a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a>, then remove the question mark from the label</p></li>
<li><p>For labels with double entries, seaprated by a colon ‘:’ we can add these to a new column named: find_spot_2, find_spot_3, etc.
#####4.5.3. Optional: when a provenience label consists of multiple labels joined by ‘:’, we can add the separated labels to a new dataframe, which we can use for matching purposes. This will be useful for making a lookup table for future tasks as well, i.e. when matching with the toponyms for provenience from the ocr-output, where the spellings of these toponyms change depending on the langauge.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">otest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/LOD Tablet Dictionary (FG Cuneiform) - FG_CIGS.csv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#otest_ref = otest.fillna(, inplace = True)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;id_text2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">otest_ref</span><span class="p">[</span><span class="s2">&quot;id_text2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">cat_df1</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">:</span><span class="s1">&#39;provenience&#39;</span><span class="p">})</span>
<span class="n">cat_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">:</span><span class="s1">&#39;provenience&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">otest_ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-132783bc-4770-4720-b984-e91d9107ca37" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FG_qid</th>
      <th>provenience</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>id_text2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q390152</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390152</td>
      <td>Muradiye</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q389888</td>
      <td>Garšana (mod. uncertain)</td>
      <td>https://database.factgrid.de/entity/Q389888</td>
      <td>Garshana</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q389722</td>
      <td>uncertain (mod. Shahr-i Sokhta)</td>
      <td>https://database.factgrid.de/entity/Q389722</td>
      <td>Shahr-i Sūkhta</td>
      <td>309.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q390040</td>
      <td>Samal (mod. Zinčirli)</td>
      <td>https://database.factgrid.de/entity/Q390040</td>
      <td>Zinčirli</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q389604</td>
      <td>Kourion (mod. Cyprus)</td>
      <td>https://database.factgrid.de/entity/Q389604</td>
      <td>Kourion</td>
      <td>375.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>602</th>
      <td>Q390049</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390049</td>
      <td>Kenk Boǧazı</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>603</th>
      <td>Q390089</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390089</td>
      <td>Kotanlı</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>604</th>
      <td>Q390008</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390008</td>
      <td>Kāmid al-Lūz</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>605</th>
      <td>Q390009</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390009</td>
      <td>Kānī Shāyah</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>606</th>
      <td>Q390019</td>
      <td>uncertain (mod. Negub tunnel)</td>
      <td>https://database.factgrid.de/entity/Q390019</td>
      <td>Nigūb</td>
      <td>273.0</td>
    </tr>
  </tbody>
</table>
<p>580 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-132783bc-4770-4720-b984-e91d9107ca37')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-132783bc-4770-4720-b984-e91d9107ca37 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-132783bc-4770-4720-b984-e91d9107ca37');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5df95a33-40b1-4e62-9b7e-91a21a9f4af2">
  <button class="colab-df-quickchart" onclick="quickchart('df-5df95a33-40b1-4e62-9b7e-91a21a9f4af2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5df95a33-40b1-4e62-9b7e-91a21a9f4af2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cat_df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-41ea9cd7-ccc8-472e-a113-a6043cd67618" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>provenience</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk (mod. Warka)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk (mod. Warka)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk (mod. Warka)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk (mod. Warka)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk (mod. Warka)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-41ea9cd7-ccc8-472e-a113-a6043cd67618')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-41ea9cd7-ccc8-472e-a113-a6043cd67618 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-41ea9cd7-ccc8-472e-a113-a6043cd67618');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e1c74753-4bda-422a-bf64-6ba3ec6ad144">
  <button class="colab-df-quickchart" onclick="quickchart('df-e1c74753-4bda-422a-bf64-6ba3ec6ad144')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e1c74753-4bda-422a-bf64-6ba3ec6ad144 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cdli_proveniences_df</span> <span class="o">=</span> <span class="n">cat_df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">otest_ref</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;provenience&quot;</span><span class="p">)</span>
<span class="n">cdli_proveniences_df</span> <span class="o">=</span> <span class="n">cdli_proveniences_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cdli_proveniences_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-281dea34-2962-444a-92ae-6372d93d0a20" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>provenience</th>
      <th>FG_qid</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>id_text2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk (mod. Warka)</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk (mod. Warka)</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk (mod. Warka)</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk (mod. Warka)</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk (mod. Warka)</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>Q390152</td>
      <td>https://database.factgrid.de/entity/Q390152</td>
      <td>Muradiye</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>Q390152</td>
      <td>https://database.factgrid.de/entity/Q390152</td>
      <td>Muradiye</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>Q390152</td>
      <td>https://database.factgrid.de/entity/Q390152</td>
      <td>Muradiye</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>Q390152</td>
      <td>https://database.factgrid.de/entity/Q390152</td>
      <td>Muradiye</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>Q390152</td>
      <td>https://database.factgrid.de/entity/Q390152</td>
      <td>Muradiye</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 6 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-281dea34-2962-444a-92ae-6372d93d0a20')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-281dea34-2962-444a-92ae-6372d93d0a20 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-281dea34-2962-444a-92ae-6372d93d0a20');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-764ab805-0eb7-4ae4-8573-9d4a7a59c85b">
  <button class="colab-df-quickchart" onclick="quickchart('df-764ab805-0eb7-4ae4-8573-9d4a7a59c85b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-764ab805-0eb7-4ae4-8573-9d4a7a59c85b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">oracc_proveniences_df</span> <span class="o">=</span> <span class="n">cat_df2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">otest_ref</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;provenience&quot;</span><span class="p">)</span>
<span class="n">oracc_proveniences_df</span> <span class="o">=</span> <span class="n">oracc_proveniences_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[[</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span><span class="s2">&quot;provenience&quot;</span><span class="p">]]</span>

<span class="n">oracc_proveniences_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-119dc80f-34cd-49ba-a92a-360ef67417f8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>provenience</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Warka (Uruk)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Warka (Uruk)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Warka (Uruk)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Warka (Uruk)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Warka (Uruk)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>Unknown</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-119dc80f-34cd-49ba-a92a-360ef67417f8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-119dc80f-34cd-49ba-a92a-360ef67417f8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-119dc80f-34cd-49ba-a92a-360ef67417f8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d63fae99-15fd-4a40-8c13-fff118cc5763">
  <button class="colab-df-quickchart" onclick="quickchart('df-d63fae99-15fd-4a40-8c13-fff118cc5763')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d63fae99-15fd-4a40-8c13-fff118cc5763 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_proveniences_df</span> <span class="o">=</span> <span class="n">cdli_proveniences_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">oracc_proveniences_df</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">)</span>
<span class="n">final_proveniences_df</span> <span class="o">=</span> <span class="n">final_proveniences_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">,</span><span class="s1">&#39;ancientplace&#39;</span><span class="p">,</span><span class="s1">&#39;Len&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="object-type-instance-of-p2">
<h2>5 <strong>object_type = Instance of <a class="reference external" href="https://database.factgrid.de/wiki/Property:P2">(P2)</a></strong><a class="headerlink" href="#object-type-instance-of-p2" title="Link to this heading">#</a></h2>
<p>####5.1 Use this CSV to obtain the FactGrid Q-ids for each object type in the CDLI catalog:
<a class="reference external" href="https://drive.google.com/file/d/12yQ8rI-_WRSOQIcwV3TBs5xyPRHliFeK/view?usp=share_link">https://drive.google.com/file/d/12yQ8rI-_WRSOQIcwV3TBs5xyPRHliFeK/view?usp=share_link</a></p>
<p>####5.2. Match on the cdli label for ‘object_type’ to obtain the FactGrid Q-id</p>
<p>####5.3. Make a data frame, called <code class="docutils literal notranslate"><span class="pre">object_type_df</span></code>, for all matches.</p>
<p>####5.4. Make a separate data frame of the texts / artifacts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_object_type_df</span></code>.</p>
<p>note: dont have objects that overlap live as a separate class</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">object_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/ancient-world-citation-analysis/CDLI2LoD/main/data/Object%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">otest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">object_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="n">otest_ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-72cb4b27-7623-4c20-820d-ce8b3cfc90a6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>object_type</th>
      <th>FG_qid</th>
      <th>FG_Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>1</th>
      <td>block</td>
      <td>Q512055</td>
      <td>Clay block</td>
    </tr>
    <tr>
      <th>2</th>
      <td>brick</td>
      <td>Q512056</td>
      <td>Clay brick</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bulla</td>
      <td>Q512057</td>
      <td>Clay bulla</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cone</td>
      <td>Q512058</td>
      <td>Clay cone</td>
    </tr>
    <tr>
      <th>5</th>
      <td>cylinder</td>
      <td>Q512059</td>
      <td>Clay cylinder</td>
    </tr>
    <tr>
      <th>6</th>
      <td>docket</td>
      <td>Q512060</td>
      <td>Clay docket</td>
    </tr>
    <tr>
      <th>7</th>
      <td>envelope</td>
      <td>Q512061</td>
      <td>Clay envelope</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lentil</td>
      <td>Q512062</td>
      <td>Clay lentil tablet</td>
    </tr>
    <tr>
      <th>9</th>
      <td>prism</td>
      <td>Q512063</td>
      <td>Clay prism</td>
    </tr>
    <tr>
      <th>10</th>
      <td>prismatic cylinder</td>
      <td>Q512064</td>
      <td>Clay prismatic cylinder</td>
    </tr>
    <tr>
      <th>11</th>
      <td>seal</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>12</th>
      <td>sealing</td>
      <td>Q512066</td>
      <td>Clay sealing</td>
    </tr>
    <tr>
      <th>13</th>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>14</th>
      <td>tag</td>
      <td>Q512067</td>
      <td>Clay tag</td>
    </tr>
    <tr>
      <th>15</th>
      <td>vase</td>
      <td>Q512068</td>
      <td>Clay vase</td>
    </tr>
    <tr>
      <th>16</th>
      <td>vessel</td>
      <td>Q512069</td>
      <td>Clay vessel</td>
    </tr>
    <tr>
      <th>17</th>
      <td>other</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>other (see object remarks)</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>20</th>
      <td>stamp seal</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-72cb4b27-7623-4c20-820d-ce8b3cfc90a6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-72cb4b27-7623-4c20-820d-ce8b3cfc90a6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-72cb4b27-7623-4c20-820d-ce8b3cfc90a6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1700c8a5-32f6-46ab-ac2b-41b2bf4a6c83">
  <button class="colab-df-quickchart" onclick="quickchart('df-1700c8a5-32f6-46ab-ac2b-41b2bf4a6c83')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1700c8a5-32f6-46ab-ac2b-41b2bf4a6c83 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="cdli-objects">
<h3>5.1 CDLI objects<a class="headerlink" href="#cdli-objects" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_x&#39;</span><span class="p">]</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object_type_x&#39;</span><span class="p">:</span> <span class="s1">&#39;object_type&#39;</span><span class="p">})</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">object_type</span><span class="o">=</span><span class="n">cat</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="p">))</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;object_type&#39;</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">object_type</span><span class="o">=</span><span class="n">cat</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; in &#39;</span><span class="p">))</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;object_type&#39;</span><span class="p">)</span>
<span class="n">cat</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;tablet &quot;</span><span class="p">,</span> <span class="s2">&quot;tablet&quot;</span><span class="p">)</span>
<span class="n">cat</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;stamp seal&quot;</span><span class="p">,</span> <span class="s2">&quot;seal&quot;</span><span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">otest_ref</span><span class="p">,</span> <span class="n">cat</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">merged_df</span>
<span class="n">non_merged_rows</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;_merge&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">non_merged_rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-51068ac1-5de0-4927-9dd2-3e9791b6a414" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>object_type</th>
      <th>FG_qid</th>
      <th>FG_Label</th>
      <th>id_text</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>357625</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P290089</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>357626</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P298619</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>357627</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P298627</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>357628</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P303687</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>357629</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P312678</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>375143</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X096677</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>375144</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X201001</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>375145</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X201002</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>375146</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X225104</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>375147</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X423597</td>
      <td>right_only</td>
    </tr>
  </tbody>
</table>
<p>17523 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-51068ac1-5de0-4927-9dd2-3e9791b6a414')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-51068ac1-5de0-4927-9dd2-3e9791b6a414 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-51068ac1-5de0-4927-9dd2-3e9791b6a414');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1c3c0b5f-1a68-409e-b6b7-65a215cdb874">
  <button class="colab-df-quickchart" onclick="quickchart('df-1c3c0b5f-1a68-409e-b6b7-65a215cdb874')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1c3c0b5f-1a68-409e-b6b7-65a215cdb874 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="n-b-for-double-entries">
<h4>N.B. for double entries:<a class="headerlink" href="#n-b-for-double-entries" title="Link to this heading">#</a></h4>
<p>When an item has two object types, we will add an additional column for each id_text and fill the double / triple entires in these additional columns.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>object_type_1</p></th>
<th class="head"><p>object_type_2</p></th>
<th class="head"><p>object_type_3</p></th>
</tr>
</thead>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e89ac283-654a-4c2f-8d6b-28ebf5fc3536" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>object_type</th>
      <th>FG_qid</th>
      <th>FG_Label</th>
      <th>id_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225433</td>
    </tr>
    <tr>
      <th>1</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225458</td>
    </tr>
    <tr>
      <th>2</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225594</td>
    </tr>
    <tr>
      <th>3</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225700</td>
    </tr>
    <tr>
      <th>4</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225779</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>357620</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>P530789</td>
    </tr>
    <tr>
      <th>357621</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>P530790</td>
    </tr>
    <tr>
      <th>357622</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>P530791</td>
    </tr>
    <tr>
      <th>357623</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>P530792</td>
    </tr>
    <tr>
      <th>357624</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>P532420</td>
    </tr>
  </tbody>
</table>
<p>357625 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e89ac283-654a-4c2f-8d6b-28ebf5fc3536')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e89ac283-654a-4c2f-8d6b-28ebf5fc3536 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e89ac283-654a-4c2f-8d6b-28ebf5fc3536');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-489a3d38-d217-4317-b239-f39dd8ab1bf0">
  <button class="colab-df-quickchart" onclick="quickchart('df-489a3d38-d217-4317-b239-f39dd8ab1bf0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-489a3d38-d217-4317-b239-f39dd8ab1bf0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="oracc-objects">
<h3>5.2 ORACC objects<a class="headerlink" href="#oracc-objects" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_y&#39;</span><span class="p">]</span>
<span class="n">cat2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object_type_y&#39;</span><span class="p">:</span> <span class="s1">&#39;object_type&#39;</span><span class="p">})</span>
<span class="n">cat2</span> <span class="o">=</span> <span class="n">cat2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">object_type</span><span class="o">=</span><span class="n">cat2</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="p">))</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;object_type&#39;</span><span class="p">)</span>
<span class="n">cat2</span> <span class="o">=</span> <span class="n">cat2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">object_type</span><span class="o">=</span><span class="n">cat2</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; in &#39;</span><span class="p">))</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;object_type&#39;</span><span class="p">)</span>
<span class="n">cat2</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat2</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;tablet &quot;</span><span class="p">,</span> <span class="s2">&quot;tablet&quot;</span><span class="p">)</span>
<span class="n">cat2</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat2</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;stamp seal&quot;</span><span class="p">,</span> <span class="s2">&quot;seal&quot;</span><span class="p">)</span>

<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">otest_ref</span><span class="p">,</span> <span class="n">cat2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">merged_df2</span>
<span class="n">non_merged_rows2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="p">[</span><span class="n">merged_df2</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span>
<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="p">[</span><span class="n">merged_df2</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span>
<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;_merge&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>

<span class="n">non_merged_rows2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fac38d38-8b06-49ed-aef1-cfd416904b32" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>object_type</th>
      <th>FG_qid</th>
      <th>FG_Label</th>
      <th>id_text</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11349</th>
      <td>seal</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
    <tr>
      <th>11350</th>
      <td>seal</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
    <tr>
      <th>122262</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000730</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>122263</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000731</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>122264</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000732</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>367127</th>
      <td>rock inscription</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X003038</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>367128</th>
      <td>tablet &amp;amp; envelope</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X000507</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>367129</th>
      <td>bowl (with sculpture)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q008358</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>367130</th>
      <td>beaker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q008359</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>367131</th>
      <td>bronze cross</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X000972</td>
      <td>right_only</td>
    </tr>
  </tbody>
</table>
<p>244872 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fac38d38-8b06-49ed-aef1-cfd416904b32')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fac38d38-8b06-49ed-aef1-cfd416904b32 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fac38d38-8b06-49ed-aef1-cfd416904b32');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-32f06165-b114-4250-8641-423cac322c04">
  <button class="colab-df-quickchart" onclick="quickchart('df-32f06165-b114-4250-8641-423cac322c04')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-32f06165-b114-4250-8641-423cac322c04 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="id7">
<h4>N.B. for double entries:<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>When an item has two object types, we will add an additional column for each id_text and fill the double / triple entires in these additional columns.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>object_type_1</p></th>
<th class="head"><p>object_type_2</p></th>
<th class="head"><p>object_type_3</p></th>
</tr>
</thead>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-57ffa703-44a4-4c81-816b-757699c927ce" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>object_type</th>
      <th>FG_qid</th>
      <th>FG_Label</th>
      <th>id_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225433</td>
    </tr>
    <tr>
      <th>1</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225458</td>
    </tr>
    <tr>
      <th>2</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225594</td>
    </tr>
    <tr>
      <th>3</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225700</td>
    </tr>
    <tr>
      <th>4</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>P225779</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>122257</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>Q008907</td>
    </tr>
    <tr>
      <th>122258</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>Q008908</td>
    </tr>
    <tr>
      <th>122259</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>Q009185</td>
    </tr>
    <tr>
      <th>122260</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>Q009353</td>
    </tr>
    <tr>
      <th>122261</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
      <td>P457023</td>
    </tr>
  </tbody>
</table>
<p>122260 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-57ffa703-44a4-4c81-816b-757699c927ce')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-57ffa703-44a4-4c81-816b-757699c927ce button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-57ffa703-44a4-4c81-816b-757699c927ce');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c2328d8c-5035-4191-93f9-0abfb174c8db">
  <button class="colab-df-quickchart" onclick="quickchart('df-c2328d8c-5035-4191-93f9-0abfb174c8db')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c2328d8c-5035-4191-93f9-0abfb174c8db button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="merging-object-dfs-of-cdli-and-oracc">
<h3>Merging object dfs of CDLI and ORACC<a class="headerlink" href="#merging-object-dfs-of-cdli-and-oracc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">objects_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_df</span><span class="p">,</span> <span class="n">merged_df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_objects_df</span> <span class="o">=</span> <span class="n">objects_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_x&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_y&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_y&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_Label_x&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_Label_y&#39;</span><span class="p">]]</span>
<span class="n">final_objects_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f37d32b5-607f-4439-ba1b-4a02664b5bed" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>object_type_x</th>
      <th>object_type_y</th>
      <th>FG_qid_x</th>
      <th>FG_qid_y</th>
      <th>FG_Label_x</th>
      <th>FG_Label_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P225433</td>
      <td>barrel</td>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P225458</td>
      <td>barrel</td>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P225594</td>
      <td>barrel</td>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P225700</td>
      <td>barrel</td>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P225779</td>
      <td>barrel</td>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>364784</th>
      <td>Q008907</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Q512065</td>
      <td>NaN</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>364785</th>
      <td>Q008908</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Q512065</td>
      <td>NaN</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>364786</th>
      <td>Q009185</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Q512065</td>
      <td>NaN</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>364787</th>
      <td>Q009353</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Q512065</td>
      <td>NaN</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>364788</th>
      <td>P457023</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Q512065</td>
      <td>NaN</td>
      <td>seal</td>
    </tr>
  </tbody>
</table>
<p>364789 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f37d32b5-607f-4439-ba1b-4a02664b5bed')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f37d32b5-607f-4439-ba1b-4a02664b5bed button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f37d32b5-607f-4439-ba1b-4a02664b5bed');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b54e7ca7-915c-447d-a350-016df9ec48bf">
  <button class="colab-df-quickchart" onclick="quickchart('df-b54e7ca7-915c-447d-a350-016df9ec48bf')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b54e7ca7-915c-447d-a350-016df9ec48bf button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="genre-field-of-knowledge-p608">
<h2>6 <strong>genre = Field of Knowledge <a class="reference external" href="https://database.factgrid.de/wiki/Property:P608">(P608)</a></strong><a class="headerlink" href="#genre-field-of-knowledge-p608" title="Link to this heading">#</a></h2>
<section id="use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog">
<h3>6.1 Use this <a class="reference external" href="https://drive.google.com/file/d/1Xo-Wh0JCRDMRTpYEm5GYz_tOljUtiyLo/view?usp=drive_link">CSV</a> to obtain the FactGrid Q-ids for each object type in the CDLI catalog:<a class="headerlink" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog" title="Link to this heading">#</a></h3>
<p>N.B. some items have double entries, e.g. ‘prayer/incantation’ or ‘lexical; literary’. We can either separate these before performing the match and duplicate the item’s <code class="docutils literal notranslate"><span class="pre">id_text</span></code> or we can use the additional columns for matches with multiple entries. Either way we will need to resolve the double entries in batches when using QuickStatements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Genre%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">genre_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># use the second row as column name</span>

<span class="c1"># fill na values with space</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># rename the columns</span>
<span class="n">genre_reference</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Typeofwork&#39;</span><span class="p">:</span> <span class="s1">&#39;FG_qid&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># remove entries without a FactGrid QID</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># remove the question marks as we will deal with it later</span>
<span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;cdli_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">])</span>
<span class="c1"># drop P155 and cdli_genre and reorder the dataframe</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[[</span><span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_2&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_3&#39;</span><span class="p">,</span> <span class="s1">&#39;current_count&#39;</span><span class="p">]]</span>


<span class="c1"># for now, we will not consider the ones with multiple entires</span>
<span class="c1"># so remove the ones with ; or , in the record</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[[(</span><span class="s1">&#39;;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">i</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]]]</span>
<span class="c1"># drop FG_qid_2 and 3</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_qid_2&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_3&#39;</span><span class="p">])</span>
<span class="c1"># reset_index</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># standardize format to prepare for the match</span>
<span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]]</span>
<span class="c1"># drop rows with typo</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="c1"># reset_index</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">genre_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-58ea8740-35f5-46af-b342-cc13832c98cb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>FG_qid</th>
      <th>current_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Astronomical</td>
      <td>Q390194</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Historical</td>
      <td>Q39130</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Letter</td>
      <td>Q10510</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Literary</td>
      <td>Q245823</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mathematical</td>
      <td>Q146582</td>
      <td>2098</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Medical</td>
      <td>Q76112</td>
      <td>1054</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Monumental</td>
      <td>Q537039</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Omen</td>
      <td>Q246074</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Prayer/incantation</td>
      <td>Q10315</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Prayer</td>
      <td>Q10315</td>
      <td>1194</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Incantation</td>
      <td>Q246184</td>
      <td>281</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Ritual</td>
      <td>Q77545</td>
      <td>1578</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Royal</td>
      <td>Q537039</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>School</td>
      <td>Q246098</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Scientific</td>
      <td>Q245824</td>
      <td>8538</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Votive</td>
      <td>Q537055</td>
      <td>17</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Omens</td>
      <td>Q246074</td>
      <td></td>
    </tr>
    <tr>
      <th>20</th>
      <td>Pottery (seal)</td>
      <td>Q512065</td>
      <td></td>
    </tr>
    <tr>
      <th>21</th>
      <td>Private/votive</td>
      <td>Q537055</td>
      <td></td>
    </tr>
    <tr>
      <th>22</th>
      <td>Royal/monumental</td>
      <td>Q537039</td>
      <td></td>
    </tr>
    <tr>
      <th>23</th>
      <td>Royal/votive</td>
      <td>Q537039</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-58ea8740-35f5-46af-b342-cc13832c98cb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-58ea8740-35f5-46af-b342-cc13832c98cb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-58ea8740-35f5-46af-b342-cc13832c98cb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c4882627-073a-487e-89ce-5d3942176776">
  <button class="colab-df-quickchart" onclick="quickchart('df-c4882627-073a-487e-89ce-5d3942176776')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c4882627-073a-487e-89ce-5d3942176776 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="cdli-genres">
<h3>6.2 CDLI Genres<a class="headerlink" href="#cdli-genres" title="Link to this heading">#</a></h3>
<section id="match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id">
<h4>6.2.1 Match on the cdli label ‘genre’ to obtain the FactGrid Q-id.<a class="headerlink" href="#match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_x&#39;</span><span class="p">]]</span>
<span class="n">genre_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;genre_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">})</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Lexical&#39;, &#39;Administrative&#39;, &#39;School&#39;, &#39;uncertain&#39;, &#39;Legal&#39;,
       &#39;Royal/Monumental&#39;, &#39;Literary&#39;, &#39;Administrative ?&#39;, &#39;Mathematical&#39;,
       &#39;Prayer/Incantation&#39;, &#39;Mathematical ?&#39;, &#39;Letter&#39;, &#39;School ?&#39;,
       &#39;fake (modern)&#39;, &#39;Literary ?&#39;, &#39;Ritual&#39;, &#39;Private/Votive&#39;,
       &#39;Other (see subgenre)&#39;, &#39;Scientific&#39;, nan, &#39;Royal/Monumental ?&#39;,
       &#39;Legal ?&#39;, &#39;Omen&#39;, &#39;Uncertain&#39;, &#39;Literary; Mathematical&#39;,
       &#39;Lexical; Literary&#39;, &#39;Lexical; Mathematical&#39;, &#39;Lexical; School&#39;,
       &#39;Lexical; Literary; Mathematical&#39;, &#39;Literary; Lexical&#39;,
       &#39;Literary; Letter&#39;, &#39;Lexical ?&#39;, &#39;Ritual ?&#39;, &#39;Royal/Votive&#39;,
       &#39;Letter ?&#39;, &#39;fake (modern) ?&#39;, &#39;Astronomical&#39;,
       &#39;Literary; Administrative&#39;, &#39;Scientific ?&#39;,
       &#39;Royal/Monumental; Literary&#39;, &#39;Historical&#39;, &#39;Legal\x0b&#39;,
       &#39;Private/Votive ?&#39;, &#39;School; Literary&#39;, &#39;literary&#39;, &#39;Omen ?&#39;,
       &#39;Prayer/Incantation ?&#39;, &#39;letter&#39;, &#39;lexical&#39;, &#39;Astronomical ?&#39;,
       &#39;Astronomical, Omen&#39;, &#39;Pottery (seal)&#39;, &#39;administrative&#39;, &#39;Votive&#39;,
       &#39;Legal?&#39;, &#39;Letter?&#39;, &#39;School?&#39;, &#39;Administrative?&#39;, &#39;scientific&#39;,
       &#39;legal&#39;, &#39;administative&#39;, &#39;school&#39;, &#39;Administrative &#39;, &#39;Medical&#39;,
       &#39;Omens&#39;, &#39;Administrative Record&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_count</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_genre</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_genre</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple genres</span>
<span class="n">no_match_indices_genre</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">])):</span>
  <span class="n">g</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># make sure the first letter is capitalized</span>
  <span class="n">g</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_g</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_g</span><span class="p">:</span>
    <span class="n">P155_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="n">first_g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_g</span>

  <span class="c1"># account for typos</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administative&#39;</span> <span class="ow">or</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administrative record&#39;</span><span class="p">:</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="s1">&#39;Administrative&#39;</span>

  <span class="c1"># if the genre has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the genre</span>
    <span class="n">genre</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_g</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_g</span><span class="p">)</span>
    <span class="n">genre_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">genre_count</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;current_count&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_count</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;genre_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_qid</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;genre_current_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_count</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;P155_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_genre</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;other_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_genre</span>

<span class="n">genre_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c51ccfe1-c04b-4131-8fd0-04c75f1c0c6e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c51ccfe1-c04b-4131-8fd0-04c75f1c0c6e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c51ccfe1-c04b-4131-8fd0-04c75f1c0c6e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c51ccfe1-c04b-4131-8fd0-04c75f1c0c6e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ca747b28-adb6-460f-b543-d954fe44e225">
  <button class="colab-df-quickchart" onclick="quickchart('df-ca747b28-adb6-460f-b543-d954fe44e225')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ca747b28-adb6-460f-b543-d954fe44e225 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-genre-df">
<h4>6.2.2 matched_genre_df<a class="headerlink" href="#matched-genre-df" title="Link to this heading">#</a></h4>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">matched_genre_df</span></code>, for all matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="o">~</span><span class="n">genre_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_genre</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_genre_df</span> <span class="o">=</span> <span class="n">matched_genre_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_genre_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-98bd6421-0d17-4127-897e-b65ffe358f6f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdli_dump_id</th>
      <th>cdli_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>285670</th>
      <td>P532443</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285671</th>
      <td>P532444</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285672</th>
      <td>P532445</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285673</th>
      <td>P532446</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285674</th>
      <td>P532447</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>285675 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-98bd6421-0d17-4127-897e-b65ffe358f6f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-98bd6421-0d17-4127-897e-b65ffe358f6f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-98bd6421-0d17-4127-897e-b65ffe358f6f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c3c56e70-3a9b-4aef-adff-1ed7bc4eb2f2">
  <button class="colab-df-quickchart" onclick="quickchart('df-c3c56e70-3a9b-4aef-adff-1ed7bc4eb2f2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c3c56e70-3a9b-4aef-adff-1ed7bc4eb2f2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(285675, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-genre-df">
<h4>6.2.3 no_match_genre_df<a class="headerlink" href="#no-match-genre-df" title="Link to this heading">#</a></h4>
<p>Make a separate data frame of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_match_genre_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre</span><span class="p">]</span>
<span class="n">no_match_genre_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-058633e9-4bf4-4b8b-a62a-7ad411b22830" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3943</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P004142</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 20938</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 20938</td>
      <td>Nc XV,1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>unclear if proto-cuneiform, other (in cartouch...</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8091</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P010072</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VA 10004</td>
      <td>Šuruppak (mod. Fara)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8092</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P010073</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VA 10005</td>
      <td>Šuruppak (mod. Fara)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11524</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P102634</td>
      <td>Sumerian</td>
      <td>bulla</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Oakland Museum of California, Oakland, Califor...</td>
      <td>OPM 28-225</td>
      <td>Puzriš-Dagan (mod. Drehem)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Amar-Suen.03.07.00</td>
      <td>Amar-Suen.03.07.00</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Bulla</td>
      <td>Ur III</td>
      <td>Puzriš-Dagan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>OPM 28-255</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AS03 - 07 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38784.0</td>
    </tr>
    <tr>
      <th>11547</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P102657</td>
      <td>Sumerian</td>
      <td>tablet &amp; envelope</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Hearst Museum of Anthropology, University of C...</td>
      <td>HMA 9-00069a &amp; HMA 9-00069b</td>
      <td>Nippur (mod. Nuffar)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Šū-Suen.08.05.13</td>
      <td>Šū-Suen.08.05.13</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Envelope - Closed</td>
      <td>Ur III</td>
      <td>Nippur</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>HMA 9-69AB</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SS08 - 05 - 13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38807.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-058633e9-4bf4-4b8b-a62a-7ad411b22830')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-058633e9-4bf4-4b8b-a62a-7ad411b22830 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-058633e9-4bf4-4b8b-a62a-7ad411b22830');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-59b7bf39-6b33-492a-8aae-887ec8f52d45">
  <button class="colab-df-quickchart" onclick="quickchart('df-59b7bf39-6b33-492a-8aae-887ec8f52d45')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-59b7bf39-6b33-492a-8aae-887ec8f52d45 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(81241, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_genre_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h4>6.2.4 Visualization<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<section id="distribution-of-matched-genre">
<h5>Distribution of matched genre<a class="headerlink" href="#distribution-of-matched-genre" title="Link to this heading">#</a></h5>
<p>Please note that we are calling it “genre” instead of “first genre” here because, unlike most other columns in this dump of data, there is no multi-entry of genre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_g_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_genre_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_g_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_g_df</span> <span class="o">=</span> <span class="n">first_g_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span>
               <span class="s1">&#39;genre&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_g_df</span> <span class="o">=</span> <span class="n">first_g_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_g_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-df325dfb-7b0b-4dc2-a72c-4d1933d8a209" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>199275</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Royal/monumental</td>
      <td>22315</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Legal</td>
      <td>16757</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Letter</td>
      <td>15983</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Literary</td>
      <td>9816</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lexical</td>
      <td>8597</td>
    </tr>
    <tr>
      <th>6</th>
      <td>School</td>
      <td>3966</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Omen</td>
      <td>3043</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Mathematical</td>
      <td>1983</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Astronomical</td>
      <td>1631</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Prayer/incantation</td>
      <td>973</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Scientific</td>
      <td>766</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Ritual</td>
      <td>432</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>55</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Private/votive</td>
      <td>55</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Royal/votive</td>
      <td>14</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Votive</td>
      <td>11</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Pottery (seal)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Medical</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Omens</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-df325dfb-7b0b-4dc2-a72c-4d1933d8a209')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-df325dfb-7b0b-4dc2-a72c-4d1933d8a209 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-df325dfb-7b0b-4dc2-a72c-4d1933d8a209');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8b3f9c0b-d134-435c-80a1-0ac863ea139e">
  <button class="colab-df-quickchart" onclick="quickchart('df-8b3f9c0b-d134-435c-80a1-0ac863ea139e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8b3f9c0b-d134-435c-80a1-0ac863ea139e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_g_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">220000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genre that Matched FactGrid Records, CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4782b17fc7a6104ad55f523b61ded9db94734b2453a1594d07f1c152a23790fc.png" src="_images/4782b17fc7a6104ad55f523b61ded9db94734b2453a1594d07f1c152a23790fc.png" />
</div>
</div>
</section>
<section id="distribution-of-matched-genre-for-tablets-that-have-text-on-them">
<h5>Distribution of matched genre for tablets that have text on them<a class="headerlink" href="#distribution-of-matched-genre-for-tablets-that-have-text-on-them" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lang_genre_matched_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="n">lang_genre_matched_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-8ab6116e-0e07-4608-8bf0-46ab840bab4a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>353278</th>
      <td>P532443</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353279</th>
      <td>P532444</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353280</th>
      <td>P532445</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353281</th>
      <td>P532446</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353282</th>
      <td>P532447</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>253980 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8ab6116e-0e07-4608-8bf0-46ab840bab4a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8ab6116e-0e07-4608-8bf0-46ab840bab4a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8ab6116e-0e07-4608-8bf0-46ab840bab4a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-77f28ada-21d8-4310-91a2-1b8b9e3a7455">
  <button class="colab-df-quickchart" onclick="quickchart('df-77f28ada-21d8-4310-91a2-1b8b9e3a7455')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-77f28ada-21d8-4310-91a2-1b8b9e3a7455 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># slice the matched_mat_df with no_match_indices_lang</span>
<span class="n">lang_genre_matched_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="c1"># count the materials and create a df for the material with corresponding count</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lang_genre_matched_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="c1"># rename the columns</span>
<span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># sort the rows by count</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># drop the empty one</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fce32aaa-100a-45f3-ae32-38d0eb240d1a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>161871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Royal/monumental</td>
      <td>18989</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Letter</td>
      <td>13848</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>9520</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Literary</td>
      <td>7721</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lexical</td>
      <td>4171</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Omen</td>
      <td>2743</td>
    </tr>
    <tr>
      <th>7</th>
      <td>School</td>
      <td>1130</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Prayer/incantation</td>
      <td>793</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ritual</td>
      <td>302</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Scientific</td>
      <td>242</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mathematical</td>
      <td>126</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Astronomical</td>
      <td>62</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>54</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Private/votive</td>
      <td>36</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Royal/votive</td>
      <td>13</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Votive</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Medical</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Omens</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fce32aaa-100a-45f3-ae32-38d0eb240d1a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fce32aaa-100a-45f3-ae32-38d0eb240d1a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fce32aaa-100a-45f3-ae32-38d0eb240d1a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-06d67370-8ac3-4731-aca6-1470db1dd1f8">
  <button class="colab-df-quickchart" onclick="quickchart('df-06d67370-8ac3-4731-aca6-1470db1dd1f8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-06d67370-8ac3-4731-aca6-1470db1dd1f8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genres that Have Languages on the Tablet, CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5c0150fb971fc92601bfa0b39a0e33aeefe7031b942fb3a363831d483de579e4.png" src="_images/5c0150fb971fc92601bfa0b39a0e33aeefe7031b942fb3a363831d483de579e4.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-genre">
<h5>Distribution of unmatched genre<a class="headerlink" href="#distribution-of-unmatched-genre" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">)[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cdli_dump_genre
Other (see subgenre)      39
Uncertain                 10
fake (modern)            230
fake (modern) ?           16
uncertain               2793
Name: cdli_dump_genre, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>we can see that the matching of genre is actually done really well.</p>
</section>
</section>
</section>
<section id="oracc-genres">
<h3>6.3 ORACC Genres<a class="headerlink" href="#oracc-genres" title="Link to this heading">#</a></h3>
<section id="match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id">
<h4>6.3.1 Match on the oracc label ‘genre’ to obtain the FactGrid Q-id.<a class="headerlink" href="#match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_y&#39;</span><span class="p">]]</span>
<span class="n">genre_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;genre_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">})</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Lexical&#39;, nan, &#39;mathematical&#39;, &#39;Administrative&#39;,
       &#39;Royal Inscription&#39;, &#39;Literary&#39;, &#39;Legal&#39;, &#39;School&#39;, &#39;Letter&#39;,
       &#39;uncertain&#39;, &#39;Royal/Monumental&#39;, &#39;lexical&#39;, &#39;fake (modern)&#39;,
       &#39;Mathematical&#39;, &#39;Prayer/Incantation&#39;, &#39;Signlists&#39;, &#39;Scientific&#39;,
       &#39;Literary Work&#39;, &#39;Ritual&#39;, &#39;Liturgy&#39;, &#39;Royal lnscription&#39;,
       &#39;school&#39;, &#39;Administrative Letter&#39;, &#39;Legal Transaction&#39;,
       &#39;Administrative Record&#39;, &#39;Uncertain&#39;, &#39;Ritual Text&#39;,
       &#39;Lexical Text&#39;, &#39;Literary Text&#39;, &#39;Incantation&#39;,
       &#39;Literary; Mathematical&#39;, &#39;Astrological Report&#39;, &#39;Extispicy Query&#39;,
       &#39;Scholarly Letter&#39;, &#39;Priestly Letter&#39;, &#39;Extispicy Report&#39;,
       &#39;Treaty&#39;, &#39;Divination&#39;, &#39;Medical&#39;, &#39;Miscellanea&#39;, &#39;Omen&#39;,
       &#39;Lexical; Mathematical&#39;, &#39;Literary; Administrative&#39;,
       &#39;Divination (astrological)&#39;, &#39;letter&#39;, &#39;scholarly&#39;,
       &#39;administrative&#39;, &#39;Lexical; Literary&#39;, &#39;Royal Ritual&#39;,
       &#39;technical procedure&#39;, &#39;Eponym List&#39;, &#39;Votive Donation&#39;, &#39;Decree&#39;,
       &#39;Grant&#39;, &#39;Magic&#39;, &#39;Incantation-Ritual&#39;, &#39;Hymn-Prayer&#39;, &#39;Scholarly&#39;,
       &#39;Prophecy&#39;, &#39;Gift&#39;, &#39;Appointment&#39;, &#39;literary work&#39;, &#39;Blessings&#39;,
       &#39;School Text&#39;, &#39;Historical&#39;, &#39;Eponym Chronicle&#39;, &#39;Hemerological&#39;,
       &#39;Astronomical&#39;, &#39;unknown&#39;, &#39;Astrological&#39;, &#39;Lexical (signlist)&#39;,
       &#39;School; Literary&#39;, &#39;Metrological&#39;, &#39;plan&#39;, &#39;Lexical; School&#39;,
       &#39;Prayer&#39;, &#39;Historical Text&#39;, &#39;Miscellanea (literary, divination)&#39;,
       &#39;Miscellanea (astrological or literary)&#39;,
       &#39;Miscellanea (ritual/qualifications of the diviner)&#39;, &#39;Other&#39;,
       &#39;healing&#39;, &#39;Astronomical Diary&#39;, &#39;Goal-year text&#39;, &#39;lunar text&#39;,
       &#39;planetary text&#39;, &#39;Building Inscription&#39;, &#39;Prayer-Incantation&#39;,
       &#39;incantation-Ritual&#39;, &#39;Divine Seal&#39;, &#39;Lexical (Ura)&#39;, &#39;Contract&#39;,
       &#39;Royal stone inscription&#39;, &#39;Lexical (ED Plants)&#39;, &#39;School (Ura)&#39;,
       &#39;Lexical (OB Aa)&#39;, &#39;School (OB Ura)&#39;, &#39;School (OB Lu)&#39;,
       &#39;School (SAa)&#39;, &#39;School (List of Names)&#39;, &#39;Lexical (God List)&#39;,
       &#39;extispicy query&#39;, &#39;Royal Seal&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_count2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_genre2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_genre2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple genres</span>
<span class="n">no_match_indices_genre2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">])):</span>
  <span class="n">g</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># make sure the first letter is capitalized</span>
  <span class="n">g</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_g</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_g</span><span class="p">:</span>
    <span class="n">P155_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="n">first_g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_g</span>

  <span class="c1"># account for typos</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administative&#39;</span> <span class="ow">or</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administrative record&#39;</span><span class="p">:</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="s1">&#39;Administrative&#39;</span>

  <span class="c1"># if the genre has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the genre</span>
    <span class="n">genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_g</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_g</span><span class="p">)</span>
    <span class="n">genre_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">genre_count2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;current_count&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_count2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;genre_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_qid2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;genre_current_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_count2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;P155_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_genre2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;other_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_genre2</span>

<span class="n">genre_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-954dcd39-24db-4b14-ae31-312b5e9d174f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-954dcd39-24db-4b14-ae31-312b5e9d174f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-954dcd39-24db-4b14-ae31-312b5e9d174f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-954dcd39-24db-4b14-ae31-312b5e9d174f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-796d088d-4dc3-436b-a86d-bc85d13946ad">
  <button class="colab-df-quickchart" onclick="quickchart('df-796d088d-4dc3-436b-a86d-bc85d13946ad')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-796d088d-4dc3-436b-a86d-bc85d13946ad button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-genre-df2">
<h4>6.3.2 matched_genre_df2<a class="headerlink" href="#matched-genre-df2" title="Link to this heading">#</a></h4>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">matched_genre_df2</span></code>, for all matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="o">~</span><span class="n">genre_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_genre2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_genre_df2</span> <span class="o">=</span> <span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_genre_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d0cba779-dbf4-441c-a967-d57cb98b1ca9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>oracc_dump_id</th>
      <th>oracc_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>112655</th>
      <td>P512808</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112656</th>
      <td>P512821</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112657</th>
      <td>P512822</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112658</th>
      <td>P515099</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112659</th>
      <td>P521777</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>112660 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d0cba779-dbf4-441c-a967-d57cb98b1ca9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d0cba779-dbf4-441c-a967-d57cb98b1ca9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d0cba779-dbf4-441c-a967-d57cb98b1ca9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bf63720d-8844-4a3d-b99f-921d6e8a5c3b">
  <button class="colab-df-quickchart" onclick="quickchart('df-bf63720d-8844-4a3d-b99f-921d6e8a5c3b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bf63720d-8844-4a3d-b99f-921d6e8a5c3b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(112660, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h4>6.3.3 no_match_genre_df<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>Make a separate data frame of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_match_genre_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre2</span><span class="p">]</span>
<span class="n">no_match_genre_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ab2a2975-876f-42c4-80a5-f037fd0703be" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>669</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000730</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15316</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,1</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>670</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000731</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15315</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,2</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>671</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000732</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15345</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02134</td>
      <td>?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>672</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000733</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15289</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02352</td>
      <td>Oc XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>673</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000734</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15245</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 05233,a</td>
      <td>Pd XVI,4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ab2a2975-876f-42c4-80a5-f037fd0703be')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ab2a2975-876f-42c4-80a5-f037fd0703be button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ab2a2975-876f-42c4-80a5-f037fd0703be');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0cb5e926-231c-4dca-ac93-710693b99aa7">
  <button class="colab-df-quickchart" onclick="quickchart('df-0cb5e926-231c-4dca-ac93-710693b99aa7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0cb5e926-231c-4dca-ac93-710693b99aa7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(254256, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_genre_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h4>6.3.4 Visualization<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<section id="id11">
<h5>Distribution of matched genre<a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<p>Please note that we are calling it “genre” instead of “first genre” here because, unlike most other columns in this dump of data, there is no multi-entry of genre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_g_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_g_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_g_df2</span> <span class="o">=</span> <span class="n">first_g_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span>
               <span class="s1">&#39;genre&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_g_df2</span> <span class="o">=</span> <span class="n">first_g_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_g_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-26206fb9-8888-44bd-9f8c-66e10e95a95d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>91116</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lexical</td>
      <td>7583</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Literary</td>
      <td>6107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>2640</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mathematical</td>
      <td>1193</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Letter</td>
      <td>1187</td>
    </tr>
    <tr>
      <th>6</th>
      <td>School</td>
      <td>870</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Prayer/incantation</td>
      <td>846</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Omen</td>
      <td>554</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Medical</td>
      <td>265</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Astronomical</td>
      <td>175</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Ritual</td>
      <td>95</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Royal/monumental</td>
      <td>13</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Scientific</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Prayer</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Incantation</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-26206fb9-8888-44bd-9f8c-66e10e95a95d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-26206fb9-8888-44bd-9f8c-66e10e95a95d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-26206fb9-8888-44bd-9f8c-66e10e95a95d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6868af20-32d5-4e08-8d8f-013f75ac5097">
  <button class="colab-df-quickchart" onclick="quickchart('df-6868af20-32d5-4e08-8d8f-013f75ac5097')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6868af20-32d5-4e08-8d8f-013f75ac5097 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_g_df2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genre that Matched FactGrid Records, ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de3e35de41cc664a96e523d32d50a33ae1f609b794110810924cbf3a4ed1c308.png" src="_images/de3e35de41cc664a96e523d32d50a33ae1f609b794110810924cbf3a4ed1c308.png" />
</div>
</div>
</section>
<section id="id12">
<h5>Distribution of matched genre for tablets that have text on them<a class="headerlink" href="#id12" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lang_genre_matched_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang2</span><span class="p">)]</span>
<span class="n">lang_genre_matched_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a966ff37-da6b-46dc-8774-ddd2bc2384cb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366883</th>
      <td>P512808</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366884</th>
      <td>P512821</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366885</th>
      <td>P512822</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366886</th>
      <td>P515099</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366887</th>
      <td>P521777</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>133460 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a966ff37-da6b-46dc-8774-ddd2bc2384cb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a966ff37-da6b-46dc-8774-ddd2bc2384cb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a966ff37-da6b-46dc-8774-ddd2bc2384cb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4ea4a4a1-b624-4e71-bd15-b8feeab65923">
  <button class="colab-df-quickchart" onclick="quickchart('df-4ea4a4a1-b624-4e71-bd15-b8feeab65923')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4ea4a4a1-b624-4e71-bd15-b8feeab65923 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># slice the matched_mat_df with no_match_indices_lang</span>
<span class="n">lang_genre_matched_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang2</span><span class="p">)]</span>
<span class="c1"># count the materials and create a df for the material with corresponding count</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lang_genre_matched_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="c1"># rename the columns</span>
<span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># sort the rows by count</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># drop the empty one</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a1cc117a-2cbc-4f10-9e54-c9505dde48bc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>90783</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Literary</td>
      <td>5751</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lexical</td>
      <td>3495</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>2553</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Prayer/incantation</td>
      <td>844</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Letter</td>
      <td>838</td>
    </tr>
    <tr>
      <th>6</th>
      <td>School</td>
      <td>268</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Omen</td>
      <td>173</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Astronomical</td>
      <td>140</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ritual</td>
      <td>91</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Medical</td>
      <td>86</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mathematical</td>
      <td>23</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Royal/monumental</td>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Scientific</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Prayer</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Incantation</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a1cc117a-2cbc-4f10-9e54-c9505dde48bc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a1cc117a-2cbc-4f10-9e54-c9505dde48bc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a1cc117a-2cbc-4f10-9e54-c9505dde48bc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-787c1f0d-7ab6-4b81-8b0b-060a4f33abdb">
  <button class="colab-df-quickchart" onclick="quickchart('df-787c1f0d-7ab6-4b81-8b0b-060a4f33abdb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-787c1f0d-7ab6-4b81-8b0b-060a4f33abdb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genres that Have Languages on the Tablet, ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2c927ce96e14b90633adcb89d0590097cbf19ec5cf235e34b64b6f3e963962aa.png" src="_images/2c927ce96e14b90633adcb89d0590097cbf19ec5cf235e34b64b6f3e963962aa.png" />
</div>
</div>
</section>
<section id="id13">
<h5>Distribution of unmatched genre<a class="headerlink" href="#id13" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">)[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oracc_dump_genre
Administrative Letter    2099
Appointment                 4
Astrological               20
Astrological Report       567
Astronomical Diary        417
                         ... 
planetary text             55
scholarly                  34
technical procedure         1
uncertain                  64
unknown                   135
Name: oracc_dump_genre, Length: 73, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>we can see that the matching of genre is actually done really well.</p>
</section>
</section>
</section>
<section id="merging-genre-dfs-of-cdli-and-oracc">
<h3>Merging genre dfs of CDLI and ORACC<a class="headerlink" href="#merging-genre-dfs-of-cdli-and-oracc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genres_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">genre_df</span><span class="p">,</span> <span class="n">genre_df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_genres_df</span> <span class="o">=</span> <span class="n">genres_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;genre_x&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_y&#39;</span><span class="p">,</span><span class="s1">&#39;genre_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;genre_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;genre_current_count_x&#39;</span><span class="p">,</span><span class="s1">&#39;genre_current_count_y&#39;</span><span class="p">,</span><span class="s1">&#39;P155_genre_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_genre_y&#39;</span><span class="p">,</span><span class="s1">&#39;other_genre_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_genre_y&#39;</span><span class="p">]]</span>
<span class="n">final_genres_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-53c2056a-407b-4215-909a-0b4d46563e99" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>genre_qid_x</th>
      <th>genre_qid_y</th>
      <th>genre_current_count_x</th>
      <th>genre_current_count_y</th>
      <th>P155_genre_x</th>
      <th>P155_genre_y</th>
      <th>other_genre_x</th>
      <th>other_genre_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-53c2056a-407b-4215-909a-0b4d46563e99')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-53c2056a-407b-4215-909a-0b4d46563e99 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-53c2056a-407b-4215-909a-0b4d46563e99');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7ed933ef-9fe1-4dd5-b1a4-0b55cce3ea6c">
  <button class="colab-df-quickchart" onclick="quickchart('df-7ed933ef-9fe1-4dd5-b1a4-0b55cce3ea6c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7ed933ef-9fe1-4dd5-b1a4-0b55cce3ea6c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="period-period-p853">
<h2>7 <strong>period = Period <a class="reference external" href="https://database.factgrid.de/wiki/Property:P853">(P853)</a></strong><a class="headerlink" href="#period-period-p853" title="Link to this heading">#</a></h2>
<section id="use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog">
<h3>7.1 Use this CSV to obtain the FactGrid Q-ids for each period of each texts in the CDLI catalog<a class="headerlink" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://drive.google.com/file/d/1GCYneZi-SVA49iRfVMP_mH-0LFLRpIaQ/view?usp=share_link">https://drive.google.com/file/d/1GCYneZi-SVA49iRfVMP_mH-0LFLRpIaQ/view?usp=share_link</a></p>
<ul class="simple">
<li><p>note that this CSV contains Wikidata Q-ids, along with the begin / end of the other chronologies (high, low, middle, etc.)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Period%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="c1"># read in the data</span>
<span class="c1"># note that we fill.na with 99999999 here so that we can edit the data type of years later</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">period_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># select only the columns we want</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[[</span><span class="s1">&#39;Factgrid-Q&#39;</span><span class="p">,</span> <span class="s1">&#39;cdli_period&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Wikidata_URI&#39;</span><span class="p">]]</span>
<span class="c1"># clean the column names</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Factgrid-Q&#39;</span><span class="p">:</span> <span class="s1">&#39;FG_qid&#39;</span><span class="p">})</span>
<span class="c1"># drop the first row that is empty</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:]</span>
<span class="c1"># use only rows with a QID</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">period_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0f6ec259-d02b-4962-aa3d-a0697e41a7f0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FG_qid</th>
      <th>cdli_period</th>
      <th>Wikidata_URI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q512118</td>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>Q114877825</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q512131</td>
      <td>Uruk V (ca. 3500-3350 BC)</td>
      <td>Q114877817</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q512132</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q114877809</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q512133</td>
      <td>Egyptian 0 (ca. 3300-3000 BC)</td>
      <td>Q187979</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q512134</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q114877803</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Q512135</td>
      <td>Proto-Elamite (ca. 3100-2900 BC)</td>
      <td>Q1196237</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Q512136</td>
      <td>Early Dynastic Period</td>
      <td>Q716742</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Q512137</td>
      <td>ED I</td>
      <td>Q99299898</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Q512137</td>
      <td>ED I-II (ca. 2900-2700 BC)</td>
      <td>Q99299898</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Q512139</td>
      <td>ED II</td>
      <td>Q99299906</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Q512140</td>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>Q110209550</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Q512141</td>
      <td>Old Elamite (c. 2600–1500 BC)</td>
      <td>Q29297301</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Q512142</td>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>Q110209565</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Q512143</td>
      <td>Ebla (ca. 2350-2250 BC)</td>
      <td>Q114867907</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Q512144</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>Q419594</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Q512145</td>
      <td>Linear Elamite (ca. 2200 BC)</td>
      <td>Q114868885</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Q512146</td>
      <td>Lagash II (ca. 2200-2100 BC)</td>
      <td>Q114868851</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Q512147</td>
      <td>Harappan (ca. 2200-1900 BC)</td>
      <td>Q114866998</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Q512148</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>Q109384761</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Q512149</td>
      <td>Isin-Larsa period</td>
      <td>Q13577667</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Q512150</td>
      <td>Early Old Babylonian (ca. 2000-1900 BC)</td>
      <td>Q114867465</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Q512151</td>
      <td>Old Assyrian (ca. 1950-1850 BC)</td>
      <td>Q15782728</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Q512152</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q114877765</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Q512153</td>
      <td>Middle Hittite (ca. 1500-1100 BC)</td>
      <td>Q114869008</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Q512154</td>
      <td>Middle Babylonian (ca. 1400-1100 BC)</td>
      <td>Q16530848</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Q512155</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>Q114868919</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Q512156</td>
      <td>Middle Elamite (ca. 1300-1000 BC)</td>
      <td>Q29297151</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Q512157</td>
      <td>Early Neo-Babylonian (ca. 1150-730 BC)</td>
      <td>Q114867342</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Q512158</td>
      <td>Neo-Assyrian (ca. 911-612 BC)</td>
      <td>Q114869081</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Q512159</td>
      <td>Late Babylonian</td>
      <td>Q22809362</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Q512160</td>
      <td>Neo-Elamite (ca. 770-539 BC)</td>
      <td>Q29297050</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Q512161</td>
      <td>Neo-Babylonian (ca. 626-539 BC)</td>
      <td>Q114869307</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Q512162</td>
      <td>Persian</td>
      <td>Q115667399</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Q512163</td>
      <td>Achaemenid (547-331 BC)</td>
      <td>Q114867307</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Q512164</td>
      <td>Hellenistic (323-63 BC)</td>
      <td>Q428995</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Q512165</td>
      <td>Selucid</td>
      <td>Q115664693</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Q512169</td>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>Q114877775</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Q512171</td>
      <td>Roman</td>
      <td>Q2277</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Q512170</td>
      <td>Sassanian (224-641 AD)</td>
      <td>Q114877788</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0f6ec259-d02b-4962-aa3d-a0697e41a7f0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0f6ec259-d02b-4962-aa3d-a0697e41a7f0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0f6ec259-d02b-4962-aa3d-a0697e41a7f0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dcc7a31a-d9b0-4d32-960b-b53833addcd4">
  <button class="colab-df-quickchart" onclick="quickchart('df-dcc7a31a-d9b0-4d32-960b-b53833addcd4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dcc7a31a-d9b0-4d32-960b-b53833addcd4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="cdli-periods">
<h3>7.2 CDLI Periods<a class="headerlink" href="#cdli-periods" title="Link to this heading">#</a></h3>
<p>####7.2.1 Match on the CDLI ‘period’ label to obtain the FactGrid Q-id.</p>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">period_df</span></code>, for all matches.</p>
<ul class="simple">
<li><p>if there’s a question mark in the CDLI for period, you can use the same method as the <code class="docutils literal notranslate"><span class="pre">language_df</span></code> above, by adding the following column:</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>period</p></th>
<th class="head"><p><a class="reference external" href="https://database.factgrid.de/wiki/Property:P155">(P155)</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘id_text’ in cdli_cat.csv</p></td>
<td><p>‘period’ in cdli_cat.csv</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a></p></td>
</tr>
</tbody>
</table>
<p>Make a separate data from of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_period_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;period_x&#39;</span><span class="p">]]</span>
<span class="n">period_df</span> <span class="o">=</span> <span class="n">period_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;period_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">})</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Uruk III (ca. 3200-3000 BC)&#39;, &#39;Uruk IV (ca. 3350-3200 BC)&#39;,
       &#39;ED I-II (ca. 2900-2700 BC)&#39;, &#39;Uruk V (ca. 3500-3350 BC)&#39;,
       &#39;Uruk V (ca. 3500-3350 BC) ?&#39;, &#39;ED IIIa (ca. 2600-2500 BC)&#39;,
       &#39;Proto-Elamite (ca. 3100-2900 BC)&#39;, &#39;uncertain&#39;,
       &#39;Pre-Uruk V (ca. 8500-3500 BC)&#39;,
       &#39;Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;ED I-II (ca. 2900-2700 BC) ?&#39;, &#39;ED IIIb (ca. 2500-2340 BC)&#39;,
       &#39;Ur III (ca. 2100-2000 BC)&#39;, &#39;Old Akkadian (ca. 2340-2200 BC)&#39;,
       &#39;Lagash II (ca. 2200-2100 BC)&#39;, &#39;Lagash II (ca. 2200-2100 BC) ?&#39;,
       &#39;Old Babylonian (ca. 1900-1600 BC) ?&#39;,
       &#39;Ur III (ca. 2100-2000 BC) ?&#39;,
       &#39;Early Old Babylonian (ca. 2000-1900 BC)&#39;,
       &#39;Old Akkadian (ca. 2340-2200 BC) ?&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC)&#39;,
       &#39;Early Old Babylonian (ca. 2000-1900 BC) ?&#39;,
       &#39;Old Assyrian (ca. 1950-1850 BC)&#39;, &#39;Achaemenid (547-331 BC)&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC) ?&#39;, &#39;Neo-Assyrian (ca. 911-612 BC)&#39;,
       &#39;Old Akkadian (ca. 2340-2200 BC); Middle Elamite (ca. 1300-1000 BC)&#39;,
       &#39;Middle Babylonian (ca. 1400-1100 BC) ?&#39;,
       &#39;Middle Babylonian (ca. 1400-1100 BC)&#39;,
       &#39;Old Akkadian (ca. 2340-2200 BC); Ur III (ca. 2100-2000 BC)&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC); Old Akkadian (ca. 2340-2200 BC)&#39;,
       &#39;ED IIIa (ca. 2600-2500 BC) ?&#39;, &#39;Ebla (ca. 2350-2250 BC)&#39;, nan,
       &#39;Neo-Assyrian (ca. 911-612 BC) ?&#39;,
       &#39;Early Neo-Babylonian (ca. 1150-730 BC)&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC) ?&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC); Ur III (ca. 2100-2000 BC)&#39;,
       &#39;Middle Assyrian (ca. 1400-1000 BC)&#39;, &#39;fake (modern) ?&#39;,
       &#39;Uruk III (ca. 3200-3000 BC) ?&#39;, &#39;Uruk IV (ca. 3350-3200 BC) ?&#39;,
       &#39;Neo-Babylonian (626-539 BC)&#39;, &#39;Hellenistic (323-63 BC)&#39;,
       &#39;Hellenistic (323-63 BC) ?&#39;, &#39;Linear Elamite (ca. 2200 BC)&#39;,
       &#39;Linear Elamite (ca. 2200 BC) ?&#39;,
       &#39;Middle Elamite (ca. 1300-1000 BC)&#39;,
       &#39;Neo-Elamite (ca. 770-539 BC)&#39;,
       &#39;Old Assyrian (ca. 1950-1850 BC) ?&#39;, &#39;Sassanian (224-641 AD)&#39;,
       &#39;Parthian (247 BC-224 AD)&#39;, &#39;Achaemenid (547-331 BC) ?&#39;,
       &#39;Middle Hittite (ca. 1500-1100 BC)&#39;, &#39;fake (modern)&#39;,
       &#39;Middle Assyrian (ca. 1400-1000 BC) ?&#39;, &#39;Achaemenid (547–331 BC)&#39;,
       &#39;Harappan (ca. 2200-1900 BC)&#39;, &#39;Parthian (247 BC - 224 AD)&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC) ? &#39;, &#39;fake (ancient) ?&#39;,
       &#39;Egyptian 0 (ca. 3300-3000 BC)&#39;,
       &#39;Ur III (ca. 2100-2000 BC); Early Old Babylonian (ca. 2000-1900 BC)&#39;,
       &#39;Middle Elamite (ca. 1300-1000 BC) ?&#39;, &#39;copy (modern)&#39;,
       &#39;Old Elamite (ca. 2700-1500 BC)&#39;,
       &#39;ED I-II (ca. 2900-2700 BC), Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;ED IIIa (ca. 2600-2500 BC); Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Ebla (ca. 2350-2250 BC) ?&#39;, &#39;Harappan (ca. 2200-1900 BC) ?&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC) or Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Achaemenid?&#39;, &#39;Old Babylonian&#39;,
       &#39;Early Old Babylonian (ca. 1900-1600 BC)&#39;, &#39;modern? &#39;, &#39;modern?&#39;,
       &#39;modern&#39;, &#39;Early Dynastic IIIA (c. 2700-2500 BC)&#39;,
       &#39;Middle Assyrian (ca. 1400-1000 BC) &#39;,
       &#39;Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)&#39;,
       &#39;1200-700 BC&#39;, &#39;Middle Babylonian (ca. 1400-1100 BC))&#39;,
       &#39;Ur III (ca. 2100-2000 BC)?&#39;, &#39;Neo-Babylonian (ca. 626-539 BC).&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC) or Achaemenid (547–331 BC)&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Typically, we need to clean this first, but the period data looks pretty neat after manual inspection so we will skip for now. We dealt with some special cases according to this csv file: <a class="reference external" href="https://docs.google.com/spreadsheets/d/1ttueqlFrtNE4eaZDdDq80Ksc4Wg8pwxXeS8eCiiHjmQ/edit#gid=714968975">link</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_wikidata_URI</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_period</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_possible_period</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple estimations of period</span>
<span class="n">no_match_indices_period</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">])):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first estimated period</span>
  <span class="n">first_p</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining estimations (if exist) away</span>
  <span class="n">other_possible_period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">P155_period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="n">first_p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and label for the first_p</span>

  <span class="c1"># deal with some typo first</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (626-539 BC)&#39;</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC).&#39;</span><span class="p">):</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Achaemenid (547–331 BC)&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Achaemenid (547-331 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Old Babylonian&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Old Babylonian (ca. 1900-1600 BC)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Parthian&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Parthian (247 BC - 224 AD)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Pre-Uruk V&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Pre-Writing (ca. 8500-3500 BC)&#39;</span>
    <span class="n">other_possible_period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Uruk V (ca. 3500-3350 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Uruk IV (ca. 3350-3200 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Early Dynastic Period of Egypt&#39;</span><span class="p">]</span>

  <span class="c1"># if the period has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_p</span> <span class="ow">in</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">period</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_p</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_p</span><span class="p">)</span>
    <span class="n">period_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">period_wikidata_URI</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;Wikidata_URI&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_wikidata_URI</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_period</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;period_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_qid</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;period_wikidata_URI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_wikidata_URI</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;P155_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_period</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;other_possible_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_possible_period</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">period_df</span> <span class="o">=</span> <span class="n">period_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">})</span>

<span class="n">period_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a2cb4e55-b949-46b6-b9f2-71a78bf35299" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a2cb4e55-b949-46b6-b9f2-71a78bf35299')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a2cb4e55-b949-46b6-b9f2-71a78bf35299 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a2cb4e55-b949-46b6-b9f2-71a78bf35299');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c5ba1771-1581-4d46-9071-3883ef84e1e8">
  <button class="colab-df-quickchart" onclick="quickchart('df-c5ba1771-1581-4d46-9071-3883ef84e1e8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c5ba1771-1581-4d46-9071-3883ef84e1e8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="matched-period-df">
<h4>7.2.2 matched_period_df<a class="headerlink" href="#matched-period-df" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df</span> <span class="o">=</span> <span class="n">period_df</span><span class="p">[</span><span class="o">~</span><span class="n">period_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_period</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_df</span> <span class="o">=</span> <span class="n">matched_period_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_period_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-982e23d9-9276-45b1-b704-dbddbf4dcc8d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdli_dump_id</th>
      <th>cdli_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>330118</th>
      <td>P532443</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330119</th>
      <td>P532444</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330120</th>
      <td>P532445</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330121</th>
      <td>P532446</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330122</th>
      <td>P532447</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>Q512148</td>
      <td>Q109384761</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>330123 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-982e23d9-9276-45b1-b704-dbddbf4dcc8d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-982e23d9-9276-45b1-b704-dbddbf4dcc8d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-982e23d9-9276-45b1-b704-dbddbf4dcc8d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d4932f79-fe2a-4726-a1af-b3c2b370828d">
  <button class="colab-df-quickchart" onclick="quickchart('df-d4932f79-fe2a-4726-a1af-b3c2b370828d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d4932f79-fe2a-4726-a1af-b3c2b370828d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(330123, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-period-df">
<h4>7.2.3 no_match_period_df<a class="headerlink" href="#no-match-period-df" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period</span><span class="p">]</span>
<span class="n">no_match_period_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-cf5598f0-4df2-4cc6-b611-a1914b188da6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6917</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P009167</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>National Museum, Tehran, Iran</td>
      <td>NMI BK 03533</td>
      <td>Susa (mod. Shush)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7182</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P009446</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>unlocated</td>
      <td>unknown</td>
      <td>uncertain (mod. Hissar)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>68793</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P217673</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A05443</td>
      <td>Uruk (mod. Warka) ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mathematical</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Old Akkadian</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>mathematical</td>
      <td>word-problem</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A 05443</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>68794</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P217674</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A05446</td>
      <td>uncertain (mod. uncertain)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mathematical</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Old Akkadian</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>mathematical</td>
      <td>word-problem</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A 05446</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>70955</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P222233</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>stone</td>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>Ist —</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical seal</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical seal</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Ist —</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cf5598f0-4df2-4cc6-b611-a1914b188da6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cf5598f0-4df2-4cc6-b611-a1914b188da6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cf5598f0-4df2-4cc6-b611-a1914b188da6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1aface0b-ea64-4e29-8c49-e9b6ff5c536e">
  <button class="colab-df-quickchart" onclick="quickchart('df-1aface0b-ea64-4e29-8c49-e9b6ff5c536e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1aface0b-ea64-4e29-8c49-e9b6ff5c536e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(36793, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_period_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h4>Visualization<a class="headerlink" href="#id14" title="Link to this heading">#</a></h4>
<section id="distribution-of-matched-periods">
<h5>Distribution of matched periods<a class="headerlink" href="#distribution-of-matched-periods" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_period_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">matched_period_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">matched_period_counts</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span>
               <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9b6870a6-92d1-4964-b414-09bc7920e7a5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>111285</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>66833</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Neo-Assyrian (ca. 911-612 BC)</td>
      <td>35661</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Neo-Babylonian (ca. 626-539 BC)</td>
      <td>17775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Middle Hittite (ca. 1500-1100 BC)</td>
      <td>14692</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Middle Babylonian (ca. 1400-1100 BC)</td>
      <td>12915</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>10200</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Early Old Babylonian (ca. 2000-1900 BC)</td>
      <td>8630</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ebla (ca. 2350-2250 BC)</td>
      <td>7112</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Old Assyrian (ca. 1950-1850 BC)</td>
      <td>6620</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Achaemenid (547-331 BC)</td>
      <td>6013</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>5090</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>4957</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Lagash II (ca. 2200-2100 BC)</td>
      <td>4664</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>4572</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Hellenistic (323-63 BC)</td>
      <td>3359</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>1900</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>1861</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Proto-Elamite (ca. 3100-2900 BC)</td>
      <td>1729</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ED I-II (ca. 2900-2700 BC)</td>
      <td>1201</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Neo-Elamite (ca. 770-539 BC)</td>
      <td>1033</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Middle Elamite (ca. 1300-1000 BC)</td>
      <td>841</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Uruk V (ca. 3500-3350 BC)</td>
      <td>418</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Early Neo-Babylonian (ca. 1150-730 BC)</td>
      <td>231</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>219</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Egyptian 0 (ca. 3300-3000 BC)</td>
      <td>186</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sassanian (224-641 AD)</td>
      <td>61</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Linear Elamite (ca. 2200 BC)</td>
      <td>41</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>21</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Harappan (ca. 2200-1900 BC)</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9b6870a6-92d1-4964-b414-09bc7920e7a5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9b6870a6-92d1-4964-b414-09bc7920e7a5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9b6870a6-92d1-4964-b414-09bc7920e7a5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a4fa423b-c988-46b8-8a86-9c010f24104e">
  <button class="colab-df-quickchart" onclick="quickchart('df-a4fa423b-c988-46b8-8a86-9c010f24104e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a4fa423b-c988-46b8-8a86-9c010f24104e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Periods that Matched FactGrid Records, CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5241c78f6133e89f49bc2aeb98ae0e0e224f029d25606da184ece0da4fd51dd6.png" src="_images/5241c78f6133e89f49bc2aeb98ae0e0e224f029d25606da184ece0da4fd51dd6.png" />
</div>
</div>
</section>
<section id="distribution-of-matched-tablets-over-time">
<h5>Distribution of matched tablets over time<a class="headerlink" href="#distribution-of-matched-tablets-over-time" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_year_of_period</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_period_counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_period</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">]</span>
  <span class="c1"># only take what&#39;s between ()</span>
  <span class="n">year_range</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;\(([^\)]+)\)&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">current_period</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># remove &#39;ca.&#39; and space to prepare for string manipulation</span>
  <span class="n">year_range</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ca. &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

  <span class="k">if</span> <span class="s1">&#39;BC&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;AD&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this range crosses AD and BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#i.e., this is a normal range within BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># since this is a BC year, make it negative</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">))</span>

  <span class="k">else</span><span class="p">:</span> <span class="c1">#&#39;AD&#39; only years</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;AD&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span>

  <span class="n">start_year_of_period</span> <span class="o">+=</span> <span class="p">[</span><span class="n">start_year</span><span class="p">]</span>

<span class="n">matched_period_counts</span><span class="p">[</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_year_of_period</span>
<span class="c1"># order the df by start_year_of_period</span>
<span class="n">matched_period_counts</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">matched_period_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-07bce1a8-c85f-4690-9e05-4d50a6217aeb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
      <th>start_year_of_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>219</td>
      <td>-8500</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Uruk V (ca. 3500-3350 BC)</td>
      <td>418</td>
      <td>-3500</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>1861</td>
      <td>-3350</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Egyptian 0 (ca. 3300-3000 BC)</td>
      <td>186</td>
      <td>-3300</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>4957</td>
      <td>-3200</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Proto-Elamite (ca. 3100-2900 BC)</td>
      <td>1729</td>
      <td>-3100</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ED I-II (ca. 2900-2700 BC)</td>
      <td>1201</td>
      <td>-2900</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>1900</td>
      <td>-2600</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>5090</td>
      <td>-2500</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ebla (ca. 2350-2250 BC)</td>
      <td>7112</td>
      <td>-2350</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>10200</td>
      <td>-2340</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Harappan (ca. 2200-1900 BC)</td>
      <td>3</td>
      <td>-2200</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Linear Elamite (ca. 2200 BC)</td>
      <td>41</td>
      <td>-2200</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Lagash II (ca. 2200-2100 BC)</td>
      <td>4664</td>
      <td>-2200</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>111285</td>
      <td>-2100</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Early Old Babylonian (ca. 2000-1900 BC)</td>
      <td>8630</td>
      <td>-2000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Old Assyrian (ca. 1950-1850 BC)</td>
      <td>6620</td>
      <td>-1950</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>66833</td>
      <td>-1900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Middle Hittite (ca. 1500-1100 BC)</td>
      <td>14692</td>
      <td>-1500</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Middle Babylonian (ca. 1400-1100 BC)</td>
      <td>12915</td>
      <td>-1400</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>4572</td>
      <td>-1400</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Middle Elamite (ca. 1300-1000 BC)</td>
      <td>841</td>
      <td>-1300</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Early Neo-Babylonian (ca. 1150-730 BC)</td>
      <td>231</td>
      <td>-1150</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Neo-Assyrian (ca. 911-612 BC)</td>
      <td>35661</td>
      <td>-911</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Neo-Elamite (ca. 770-539 BC)</td>
      <td>1033</td>
      <td>-770</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Neo-Babylonian (ca. 626-539 BC)</td>
      <td>17775</td>
      <td>-626</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Achaemenid (547-331 BC)</td>
      <td>6013</td>
      <td>-547</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Hellenistic (323-63 BC)</td>
      <td>3359</td>
      <td>-323</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>21</td>
      <td>-247</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sassanian (224-641 AD)</td>
      <td>61</td>
      <td>224</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-07bce1a8-c85f-4690-9e05-4d50a6217aeb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-07bce1a8-c85f-4690-9e05-4d50a6217aeb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-07bce1a8-c85f-4690-9e05-4d50a6217aeb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cae2633c-c895-4505-b605-de9b12916dd9">
  <button class="colab-df-quickchart" onclick="quickchart('df-cae2633c-c895-4505-b605-de9b12916dd9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cae2633c-c895-4505-b605-de9b12916dd9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Over Time (of Periods that Matched FactGrid Records, CDLI)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3fc0c9e15ca8f475c2c9d92aa1a9ec374affc69a0a329e8ffd3f6af896551945.png" src="_images/3fc0c9e15ca8f475c2c9d92aa1a9ec374affc69a0a329e8ffd3f6af896551945.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-periods">
<h5>Distribution of Unmatched Periods<a class="headerlink" href="#distribution-of-unmatched-periods" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">)[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cdli_dump_period
1200-700 BC                                                               1
Achaemenid?                                                               4
Early Dynastic IIIA (c. 2700-2500 BC)                                     1
Early Old Babylonian (ca. 1900-1600 BC)                                   1
Middle Babylonian (ca. 1400-1100 BC))                                     1
Old Elamite (ca. 2700-1500 BC)                                            1
Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)      1
copy (modern)                                                             1
fake (ancient) ?                                                          1
fake (modern)                                                           114
fake (modern) ?                                                          69
modern                                                                    5
modern?                                                                   2
modern?                                                                   1
uncertain                                                               847
Name: cdli_dump_period, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_periods</span> <span class="o">=</span> <span class="n">period_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period</span><span class="p">][</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">]</span>
<span class="n">unmatched_periods_clean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">unmatched_periods</span><span class="p">:</span>
  <span class="n">p</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="k">if</span> <span class="s1">&#39;modern&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">unmatched_periods_clean</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;modern&#39;</span><span class="p">]</span>

  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-period statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_periods_clean</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_periods_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_periods_clean</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_periods_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;uncertain&#39;, &#39;nan&#39;, &#39;modern&#39;, &#39;fake (ancient)&#39;,
       &#39;Old Elamite (ca. 2700-1500 BC)&#39;, &#39;Achaemenid&#39;,
       &#39;Early Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Early Dynastic IIIA (c. 2700-2500 BC)&#39;,
       &#39;Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)&#39;,
       &#39;1200-700 BC&#39;, &#39;Middle Babylonian (ca. 1400-1100 BC))&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_periods_clean</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_p_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">unmatched_p_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-75e7fe95-76c9-4b97-a0b5-17cfdafc1c76" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>35743</td>
    </tr>
    <tr>
      <th>1</th>
      <td>uncertain</td>
      <td>847</td>
    </tr>
    <tr>
      <th>2</th>
      <td>modern</td>
      <td>192</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Achaemenid</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fake (ancient)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Old Elamite (ca. 2700-1500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Early Old Babylonian (ca. 1900-1600 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Early Dynastic IIIA (c. 2700-2500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Uruk III (ca. 3200-3000 BC) - Early Dynastic I...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1200-700 BC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Middle Babylonian (ca. 1400-1100 BC))</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-75e7fe95-76c9-4b97-a0b5-17cfdafc1c76')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-75e7fe95-76c9-4b97-a0b5-17cfdafc1c76 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-75e7fe95-76c9-4b97-a0b5-17cfdafc1c76');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-edba25a5-4d01-4973-8626-dd2ecb7934bc">
  <button class="colab-df-quickchart" onclick="quickchart('df-edba25a5-4d01-4973-8626-dd2ecb7934bc')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-edba25a5-4d01-4973-8626-dd2ecb7934bc button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Periods of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones), CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/960fd2c9e4eaa5c1b6a96d5b0bccafd9c67b66080af32ae86e378cd8c13ddaa9.png" src="_images/960fd2c9e4eaa5c1b6a96d5b0bccafd9c67b66080af32ae86e378cd8c13ddaa9.png" />
</div>
</div>
</section>
</section>
</section>
<section id="oracc-periods">
<h3>7.3 ORACC Periods<a class="headerlink" href="#oracc-periods" title="Link to this heading">#</a></h3>
<p>####7.3.1 Match on the ORACC ‘period’ label to obtain the FactGrid Q-id.</p>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">period_df</span></code>, for all matches.</p>
<ul class="simple">
<li><p>if there’s a question mark in the CDLI for period, you can use the same method as the <code class="docutils literal notranslate"><span class="pre">language_df</span></code> above, by adding the following column:</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>period</p></th>
<th class="head"><p><a class="reference external" href="https://database.factgrid.de/wiki/Property:P155">(P155)</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘id_text’ in cdli_cat.csv</p></td>
<td><p>‘period’ in cdli_cat.csv</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a></p></td>
</tr>
</tbody>
</table>
<p>Make a separate data from of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_period_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;period_y&#39;</span><span class="p">]]</span>
<span class="n">period_df2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;period_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">})</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Uruk III&#39;, &#39;Uruk IV&#39;, &#39;ED I-II&#39;, nan, &#39;Early Dynastic IIIa&#39;,
       &#39;Early Dynastic I-II&#39;, &#39;Early Dynastic&#39;, &#39;ED IIIa&#39;,
       &#39;Old Babylonian&#39;, &#39;Early Dynastic IIIb&#39;, &#39;Ur III&#39;, &#39;Old Akkadian&#39;,
       &#39;ED IIIb&#39;, &#39;Lagash II&#39;, &#39;Early Old Babylonian&#39;, &#39;Lagaš II&#39;,
       &#39;Achaemenid&#39;, &#39;Neo-Babylonian&#39;, &#39;Middle Babylonian&#39;,
       &#39;Old Akkadian; Early Dynastic or Old Akkadian&#39;, &#39;Middle Assyrian&#39;,
       &#39;Old Akkadian; Ur III&#39;, &#39;Early Dynastic; Old Akkadian&#39;, &#39;Ebla&#39;,
       &#39;Neo-Assyrian&#39;, &#39;First Millennium&#39;, &#39;Hellenistic&#39;,
       &#39;Ur III; Old Akkadian&#39;, &#39;Early Dynastic; Ur III&#39;, &#39;uncertain&#39;,
       &#39;fake&#39;, &#39;Neo/Late Babylonian&#39;, &#39;Seleucid&#39;, &#39;Uncertain&#39;,
       &#39;Old Assyrian&#39;, &#39;unclear&#39;, &#39;Standard Babylonian&#39;, &#39;Middle Hittite&#39;,
       &#39;Pre-Uruk V&#39;, &#39;Late Babylonian&#39;, &#39;Pre-Writing&#39;, &#39;Hittite&#39;,
       &#39;Late Middle Assyrian or early Neo-Assyrian&#39;, &#39;Mitanni&#39;,
       &#39;Parthian&#39;, &#39;Archaic&#39;, &#39;Early Dynastic or Old Akkadian&#39;,
       &#39;Late Antique&#39;, &#39;ED IIIa; Old Babylonian&#39;,
       &#39;Urartian Eastern Anatolia&#39;, &#39;Early Dynastic or Ur III&#39;,
       &#39;Urartian&#39;, &#39;Unknown&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Typically, we need to clean this first, but the period data looks pretty neat after manual inspection so we will skip for now. We dealt with some special cases according to this csv file: <a class="reference external" href="https://docs.google.com/spreadsheets/d/1ttueqlFrtNE4eaZDdDq80Ksc4Wg8pwxXeS8eCiiHjmQ/edit#gid=714968975">link</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_wikidata_URI2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_period2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_possible_period2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple estimations of period</span>
<span class="n">no_match_indices_period2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">])):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first estimated period</span>
  <span class="n">first_p</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining estimations (if exist) away</span>
  <span class="n">other_possible_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">P155_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="n">first_p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and label for the first_p</span>

  <span class="c1"># deal with some typo first</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (626-539 BC)&#39;</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC).&#39;</span><span class="p">):</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Achaemenid (547–331 BC)&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Achaemenid (547-331 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Old Babylonian&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Old Babylonian (ca. 1900-1600 BC)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Parthian&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Parthian (247 BC - 224 AD)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Pre-Uruk V&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Pre-Writing (ca. 8500-3500 BC)&#39;</span>
    <span class="n">other_possible_period2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Uruk V (ca. 3500-3350 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Uruk IV (ca. 3350-3200 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Early Dynastic Period of Egypt&#39;</span><span class="p">]</span>

  <span class="c1"># if the period has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_p</span> <span class="ow">in</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">period2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_p</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_p</span><span class="p">)</span>
    <span class="n">period_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">period_wikidata_URI2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;Wikidata_URI&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_wikidata_URI2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;period_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_qid2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;period_wikidata_URI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_wikidata_URI2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;P155_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_period2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;other_possible_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_possible_period2</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">period_df2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oracc_period&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">})</span>

<span class="n">period_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-714e3e22-7efe-46e0-a95e-d4eea72f227a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-714e3e22-7efe-46e0-a95e-d4eea72f227a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-714e3e22-7efe-46e0-a95e-d4eea72f227a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-714e3e22-7efe-46e0-a95e-d4eea72f227a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dd550174-88d4-48b1-a9a1-07efcec5543a">
  <button class="colab-df-quickchart" onclick="quickchart('df-dd550174-88d4-48b1-a9a1-07efcec5543a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dd550174-88d4-48b1-a9a1-07efcec5543a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="id15">
<h4>7.2.2 matched_period_df<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="p">[</span><span class="o">~</span><span class="n">period_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_period2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_df2</span> <span class="o">=</span> <span class="n">matched_period_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_period_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e91d59a7-94bb-4c2a-8b63-0200ed163491" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>oracc_dump_id</th>
      <th>oracc_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P010733</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P101741</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P142806</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P102551</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P102659</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16647</th>
      <td>X130506</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16648</th>
      <td>X130507</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16649</th>
      <td>X130519</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16650</th>
      <td>Q002229</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16651</th>
      <td>Q009326</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>16652 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e91d59a7-94bb-4c2a-8b63-0200ed163491')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e91d59a7-94bb-4c2a-8b63-0200ed163491 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e91d59a7-94bb-4c2a-8b63-0200ed163491');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c71c40d3-dfde-4c89-b578-2b65c9086ef9">
  <button class="colab-df-quickchart" onclick="quickchart('df-c71c40d3-dfde-4c89-b578-2b65c9086ef9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c71c40d3-dfde-4c89-b578-2b65c9086ef9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(16652, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h4>7.2.3 no_match_period_df<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period2</span><span class="p">]</span>
<span class="n">no_match_period_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7aebe23f-0872-45ea-9577-1aacc5be608d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000001</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000002</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000003</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000004</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15168</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09169,d</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000005</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15153</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09206,k</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7aebe23f-0872-45ea-9577-1aacc5be608d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7aebe23f-0872-45ea-9577-1aacc5be608d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7aebe23f-0872-45ea-9577-1aacc5be608d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c0299ffd-e554-4e0f-9356-6e00ec96f49e">
  <button class="colab-df-quickchart" onclick="quickchart('df-c0299ffd-e554-4e0f-9356-6e00ec96f49e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c0299ffd-e554-4e0f-9356-6e00ec96f49e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(350264, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_period_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h4>Visualization<a class="headerlink" href="#id17" title="Link to this heading">#</a></h4>
<section id="id18">
<h5>Distribution of matched periods<a class="headerlink" href="#id18" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_counts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_period_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">matched_period_counts2</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span>
               <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-dfe25c88-5a92-4106-9a72-ee43bacacf3d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>16363</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Late Babylonian</td>
      <td>170</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>118</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dfe25c88-5a92-4106-9a72-ee43bacacf3d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dfe25c88-5a92-4106-9a72-ee43bacacf3d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dfe25c88-5a92-4106-9a72-ee43bacacf3d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-570de4c4-dc98-4c72-92ae-31f1eb96202d">
  <button class="colab-df-quickchart" onclick="quickchart('df-570de4c4-dc98-4c72-92ae-31f1eb96202d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-570de4c4-dc98-4c72-92ae-31f1eb96202d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Periods that Matched FactGrid Records, ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7b98da681152e5d2797183f5d34dca32c4ae111659deb4e6f01c88a765dadc5.png" src="_images/e7b98da681152e5d2797183f5d34dca32c4ae111659deb4e6f01c88a765dadc5.png" />
</div>
</div>
</section>
<section id="id19">
<h5>Distribution of matched tablets over time<a class="headerlink" href="#id19" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_year_of_period2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_period</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">]</span>
  <span class="c1"># only take what&#39;s between ()</span>
  <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;\(([^\)]+)\)&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">current_period</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">year_range</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;\(([^\)]+)\)&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">current_period</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># remove &#39;ca.&#39; and space to prepare for string manipulation</span>
  <span class="n">year_range</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ca. &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

  <span class="k">if</span> <span class="s1">&#39;BC&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;AD&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this range crosses AD and BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#i.e., this is a normal range within BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># since this is a BC year, make it negative</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">))</span>

  <span class="k">else</span><span class="p">:</span> <span class="c1">#&#39;AD&#39; only years</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;AD&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span>

  <span class="n">start_year_of_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">start_year</span><span class="p">]</span>

<span class="n">matched_period_counts2</span><span class="p">[</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_year_of_period2</span>
<span class="c1"># order the df by start_year_of_period</span>
<span class="n">matched_period_counts2</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">matched_period_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-12c2e4fa-14e1-4092-8757-2391a3bed742" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
      <th>start_year_of_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>1</td>
      <td>-8500</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>16363</td>
      <td>-1900</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Late Babylonian</td>
      <td>170</td>
      <td>-1900</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>118</td>
      <td>-247</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-12c2e4fa-14e1-4092-8757-2391a3bed742')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-12c2e4fa-14e1-4092-8757-2391a3bed742 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-12c2e4fa-14e1-4092-8757-2391a3bed742');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dcab31f5-f677-4d40-807c-d107a5d40600">
  <button class="colab-df-quickchart" onclick="quickchart('df-dcab31f5-f677-4d40-807c-d107a5d40600')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dcab31f5-f677-4d40-807c-d107a5d40600 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Over Time (of Periods that Matched FactGrid Records, ORACC)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1206ae971446a441745490592587392606ceb149f4eb67d4fac00a86a6595bd5.png" src="_images/1206ae971446a441745490592587392606ceb149f4eb67d4fac00a86a6595bd5.png" />
</div>
</div>
</section>
<section id="id20">
<h5>Distribution of Unmatched Periods<a class="headerlink" href="#id20" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">)[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oracc_dump_period
Achaemenid                                        855
Archaic                                            14
ED I-II                                             9
ED IIIa                                           318
ED IIIa; Old Babylonian                             1
ED IIIb                                           210
Early Dynastic                                   1188
Early Dynastic I-II                                87
Early Dynastic IIIa                               826
Early Dynastic IIIb                              3457
Early Dynastic or Old Akkadian                      1
Early Dynastic or Ur III                            1
Early Dynastic; Old Akkadian                        2
Early Dynastic; Ur III                              1
Early Old Babylonian                             2699
Ebla                                              220
First Millennium                                  792
Hellenistic                                      1013
Hittite                                             1
Lagash II                                         699
Lagaš II                                         3755
Late Antique                                        1
Late Middle Assyrian or early Neo-Assyrian         21
Middle Assyrian                                  3479
Middle Babylonian                                1690
Middle Hittite                                      4
Mitanni                                             1
Neo-Assyrian                                    14447
Neo-Babylonian                                   3362
Neo/Late Babylonian                                66
Old Akkadian                                     6325
Old Akkadian; Early Dynastic or Old Akkadian        1
Old Akkadian; Ur III                                1
Old Assyrian                                      477
Pre-Writing                                         1
Seleucid                                          547
Standard Babylonian                                 6
Uncertain                                         140
Unknown                                            35
Ur III                                          82083
Ur III; Old Akkadian                                2
Urartian                                           69
Urartian Eastern Anatolia                         773
Uruk III                                          707
Uruk IV                                            13
fake                                                2
uncertain                                          28
unclear                                             5
Name: oracc_dump_period, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_periods2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period2</span><span class="p">][</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">]</span>
<span class="n">unmatched_periods_clean2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">unmatched_periods</span><span class="p">:</span>
  <span class="n">p</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="k">if</span> <span class="s1">&#39;modern&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">unmatched_periods_clean</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;modern&#39;</span><span class="p">]</span>

  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-period statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_periods_clean2</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_periods_clean2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_periods_clean2</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_periods_clean2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;uncertain&#39;, &#39;nan&#39;, &#39;fake (ancient)&#39;,
       &#39;Old Elamite (ca. 2700-1500 BC)&#39;, &#39;Achaemenid&#39;,
       &#39;Early Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Early Dynastic IIIA (c. 2700-2500 BC)&#39;,
       &#39;Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)&#39;,
       &#39;1200-700 BC&#39;, &#39;Middle Babylonian (ca. 1400-1100 BC))&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_periods_clean2</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_p_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">unmatched_p_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-791dc034-4be4-4ca8-bb79-e8436ea27db8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>35743</td>
    </tr>
    <tr>
      <th>1</th>
      <td>uncertain</td>
      <td>847</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Achaemenid</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fake (ancient)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Old Elamite (ca. 2700-1500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Early Old Babylonian (ca. 1900-1600 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Early Dynastic IIIA (c. 2700-2500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Uruk III (ca. 3200-3000 BC) - Early Dynastic I...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1200-700 BC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Middle Babylonian (ca. 1400-1100 BC))</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-791dc034-4be4-4ca8-bb79-e8436ea27db8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-791dc034-4be4-4ca8-bb79-e8436ea27db8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-791dc034-4be4-4ca8-bb79-e8436ea27db8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6303eb67-f5a2-40ed-bffe-43ae3bd2732f">
  <button class="colab-df-quickchart" onclick="quickchart('df-6303eb67-f5a2-40ed-bffe-43ae3bd2732f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6303eb67-f5a2-40ed-bffe-43ae3bd2732f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Periods of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones), ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/118258f448fafc102be29379562ba49482da0193ea91d99600f3230de887d8c5.png" src="_images/118258f448fafc102be29379562ba49482da0193ea91d99600f3230de887d8c5.png" />
</div>
</div>
</section>
</section>
<section id="merging-period-dfs-of-cdli-and-oracc">
<h4>Merging period dfs of CDLI and ORACC<a class="headerlink" href="#merging-period-dfs-of-cdli-and-oracc" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">periods_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">period_df</span><span class="p">,</span> <span class="n">period_df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_periods_df</span> <span class="o">=</span> <span class="n">periods_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;period_x&#39;</span><span class="p">,</span><span class="s1">&#39;period_y&#39;</span><span class="p">,</span><span class="s1">&#39;period_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;period_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;period_wikidata_URI_x&#39;</span><span class="p">,</span><span class="s1">&#39;period_wikidata_URI_y&#39;</span><span class="p">,</span><span class="s1">&#39;P155_period_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_period_y&#39;</span><span class="p">,</span><span class="s1">&#39;other_possible_period_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_possible_period_y&#39;</span><span class="p">]]</span>
<span class="n">final_periods_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e4bc2df8-9a9c-40b3-b1ae-a40cf4a50de0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>period_qid_x</th>
      <th>period_qid_y</th>
      <th>period_wikidata_URI_x</th>
      <th>period_wikidata_URI_y</th>
      <th>P155_period_x</th>
      <th>P155_period_y</th>
      <th>other_possible_period_x</th>
      <th>other_possible_period_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e4bc2df8-9a9c-40b3-b1ae-a40cf4a50de0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e4bc2df8-9a9c-40b3-b1ae-a40cf4a50de0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e4bc2df8-9a9c-40b3-b1ae-a40cf4a50de0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-057e05c8-356d-4edc-a495-80a2278d3ff4">
  <button class="colab-df-quickchart" onclick="quickchart('df-057e05c8-356d-4edc-a495-80a2278d3ff4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-057e05c8-356d-4edc-a495-80a2278d3ff4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>#Preparing for Statements
Merging all final merged dfs, merge column values if same, title with QID.</p>
<p>CDLI = Q393513, ORACC = Q425152, header ‘qal131’</p>
<p>merge all of the final dataframes into one big dataframe as raw information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">all_merged</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">]</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">final_languages_df</span><span class="p">,</span> <span class="n">final_materials_df</span><span class="p">,</span> <span class="n">final_collections_df</span><span class="p">,</span> <span class="n">final_proveniences_df</span><span class="p">,</span> <span class="n">final_objects_df</span><span class="p">,</span> <span class="n">final_genres_df</span><span class="p">,</span> <span class="n">final_periods_df</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)):</span>
  <span class="n">all_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_merged</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">all_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9e65b493-b61c-4e63-b743-b5e6594edda9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>first_lang_x</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_x</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_x</th>
      <th>P155_lang_y</th>
      <th>other_lang_x</th>
      <th>other_lang_y</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>first_mat_x</th>
      <th>first_mat_y</th>
      <th>first_mat_label_x</th>
      <th>first_mat_label_y</th>
      <th>first_mat_qid_x</th>
      <th>first_mat_qid_y</th>
      <th>P155_mat_x</th>
      <th>P155_mat_y</th>
      <th>other_mat_x</th>
      <th>other_mat_y</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>collection_qid_x</th>
      <th>collection_qid_y</th>
      <th>collection_wikidata_id_x</th>
      <th>collection_wikidata_id_y</th>
      <th>collection_name_x</th>
      <th>collection_name_y</th>
      <th>collection_name_native_x</th>
      <th>collection_name_native_y</th>
      <th>collection_url_x</th>
      <th>collection_url_y</th>
      <th>wiki_url_eng_x</th>
      <th>wiki_url_eng_y</th>
      <th>wiki_url_native_x</th>
      <th>wiki_url_native_y</th>
      <th>P155_collection_x</th>
      <th>P155_collection_y</th>
      <th>other_collection_x</th>
      <th>other_collection_y</th>
      <th>id_text2</th>
      <th>provenience_x</th>
      <th>provenience_y</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>provenience</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>_merge</th>
      <th>object_type_x</th>
      <th>object_type_y</th>
      <th>FG_qid_x</th>
      <th>FG_qid_y</th>
      <th>FG_Label_x</th>
      <th>FG_Label_y</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>genre_qid_x</th>
      <th>genre_qid_y</th>
      <th>genre_current_count_x</th>
      <th>genre_current_count_y</th>
      <th>P155_genre_x</th>
      <th>P155_genre_y</th>
      <th>other_genre_x</th>
      <th>other_genre_y</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>period_qid_x</th>
      <th>period_qid_y</th>
      <th>period_wikidata_URI_x</th>
      <th>period_wikidata_URI_y</th>
      <th>P155_period_x</th>
      <th>P155_period_y</th>
      <th>other_possible_period_x</th>
      <th>other_possible_period_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain (mod. Nihavand ?)</td>
      <td>https://database.factgrid.de/entity/Q390022</td>
      <td>Nihāwand</td>
      <td>right_only</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>292.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain (mod. Nahr el-Kelb)</td>
      <td>https://database.factgrid.de/entity/Q390023</td>
      <td>Nahr al-Kalb</td>
      <td>right_only</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>310.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain (mod. Aşağı Yarımca)</td>
      <td>https://database.factgrid.de/entity/Q390057</td>
      <td>Aşağı Yarımca</td>
      <td>right_only</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>188.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain (mod. Yasuj)</td>
      <td>https://database.factgrid.de/entity/Q390032</td>
      <td>Yāsūj</td>
      <td>right_only</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>273.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain (mod. Negub tunnel)</td>
      <td>https://database.factgrid.de/entity/Q390019</td>
      <td>Nigūb</td>
      <td>right_only</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 80 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e65b493-b61c-4e63-b743-b5e6594edda9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e65b493-b61c-4e63-b743-b5e6594edda9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e65b493-b61c-4e63-b743-b5e6594edda9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-75197bf7-6806-4094-aab2-86fa36cff60e">
  <button class="colab-df-quickchart" onclick="quickchart('df-75197bf7-6806-4094-aab2-86fa36cff60e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-75197bf7-6806-4094-aab2-86fa36cff60e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_0ff312ec-30f8-457f-b843-6248dc57bae9">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('all_merged')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0ff312ec-30f8-457f-b843-6248dc57bae9 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('all_merged');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
</section>
<section id="cdli-and-qualifier-is-oracc">
<h2>CDLI and Qualifier is ORACC<a class="headerlink" href="#cdli-and-qualifier-is-oracc" title="Link to this heading">#</a></h2>
<p>CDLI will always be the identifier and ORACC will always be the qualifier value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p18q</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1">#languages</span>
<span class="n">p401q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#materials</span>
<span class="n">p329q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#museum/collection</span>
<span class="n">p695q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#provenience, P804 for excavation_no and P425 for findspot_square qualifiers</span>
<span class="n">p804q</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1">#excavation_no</span>
<span class="n">p425q</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1">#findspot_square</span>
<span class="n">p2q</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1">#object_type</span>
<span class="n">p608q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#genre</span>
<span class="n">p853q</span> <span class="o">=</span><span class="p">[]</span>   <span class="c1">#period</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">all_merged</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="c1">#LANGUAGE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>  <span class="c1">#if the languages for cdli and oracc are the same</span>
    <span class="n">p18q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>                                                           <span class="c1">#set the qualifier for that text to nothing [nothing to differentiate]</span>
  <span class="k">else</span><span class="p">:</span>                                                                       <span class="c1">#if they are different</span>
    <span class="n">p18q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>                            <span class="c1">#set qualifier to the oracc identification</span>

  <span class="c1">#MATERIAL</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p401q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p401q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#COLLECTION</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p329q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p329q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#PROVENIENCE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p695q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p695q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p804q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p804q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p425q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p425q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#OBJECT TYPE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;FG_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;FG_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p2q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p2q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;FG_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#GENRE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p608q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p608q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#PERIOD</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p853q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p853q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tester_export</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;qid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">all_merged</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                         <span class="s1">&#39;P18&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_18&#39;</span><span class="p">:</span> <span class="n">p18q</span><span class="p">,</span>
                         <span class="s1">&#39;P401&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_401&#39;</span><span class="p">:</span> <span class="n">p401q</span><span class="p">,</span>
                         <span class="s1">&#39;P329&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_329&#39;</span><span class="p">:</span> <span class="n">p329q</span><span class="p">,</span>
                         <span class="s1">&#39;P695&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_695&#39;</span><span class="p">:</span><span class="n">p695q</span><span class="p">,</span>
                         <span class="s1">&#39;P804&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">],</span><span class="s1">&#39;qal131_804&#39;</span><span class="p">:</span><span class="n">p804q</span><span class="p">,</span>
                         <span class="s1">&#39;P425&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">],</span><span class="s1">&#39;qal131_425&#39;</span><span class="p">:</span><span class="n">p425q</span><span class="p">,</span>
                         <span class="s1">&#39;P2&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;FG_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_2&#39;</span><span class="p">:</span> <span class="n">p2q</span><span class="p">,</span>
                         <span class="s1">&#39;P608&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_608&#39;</span><span class="p">:</span> <span class="n">p608q</span><span class="p">,</span>
                         <span class="s1">&#39;P853&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_853&#39;</span><span class="p">:</span> <span class="n">p853q</span>
                         <span class="p">})</span>
<span class="n">tester_export</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b74e4768-c922-4ed1-b0c9-763f1dc102a6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>qid</th>
      <th>P18</th>
      <th>qal131_18</th>
      <th>P401</th>
      <th>qal131_401</th>
      <th>P329</th>
      <th>qal131_329</th>
      <th>P695</th>
      <th>qal131_695</th>
      <th>P804</th>
      <th>qal131_804</th>
      <th>P425</th>
      <th>qal131_425</th>
      <th>P2</th>
      <th>qal131_2</th>
      <th>P608</th>
      <th>qal131_608</th>
      <th>P853</th>
      <th>qal131_853</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.995110e-310</td>
      <td></td>
      <td></td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.995106e-310</td>
      <td></td>
      <td></td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.995110e-310</td>
      <td></td>
      <td></td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.995106e-310</td>
      <td></td>
      <td></td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.602449e-310</td>
      <td></td>
      <td></td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>2.233314e-317</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>2.233315e-317</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>2.233315e-317</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>2.233316e-317</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>1.786654e-316</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 19 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b74e4768-c922-4ed1-b0c9-763f1dc102a6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b74e4768-c922-4ed1-b0c9-763f1dc102a6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b74e4768-c922-4ed1-b0c9-763f1dc102a6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-67ca9ead-7746-4e57-b3cc-5bbf3e4f5e18">
  <button class="colab-df-quickchart" onclick="quickchart('df-67ca9ead-7746-4e57-b3cc-5bbf3e4f5e18')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-67ca9ead-7746-4e57-b3cc-5bbf3e4f5e18 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_df7e579c-7b7f-4c55-be0e-bb31778d7e01">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('tester_export')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_df7e579c-7b7f-4c55-be0e-bb31778d7e01 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('tester_export');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">all_merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/all_merged.csv&#39;</span><span class="p">)</span>
<span class="n">tester_export</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/tester_export.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prepare-for-factgrid-quickstatement-batch-processing">
<h1>Prepare for <strong>FactGrid</strong> QuickStatement batch processing<a class="headerlink" href="#prepare-for-factgrid-quickstatement-batch-processing" title="Link to this heading">#</a></h1>
<p>Once the <code class="docutils literal notranslate"><span class="pre">all_merged</span></code> df is properly joined together, the last step before we export the resulting CSV is to include the FactGrid statements into the data frame, which we will call <code class="docutils literal notranslate"><span class="pre">factgrid_df</span></code>.</p>
<p>Most of this process is straightforward, but the one statement we need to create is a <strong>description</strong> for each object.</p>
<p>###1 To do so we will use a couple of the cleaned up fields from <code class="docutils literal notranslate"><span class="pre">all_merged</span></code> df above and add a new field with header ‘Den’ which will join three existing columns together to form a descriptive sentence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#import all_merged as den_df</span>
<span class="n">den_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/all_merged.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#fill null values with &#39;&#39;</span>
<span class="n">den_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">den_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-cc7b9fc5-a53a-4ae8-95a9-e35258a41f41" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>first_lang_x</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_x</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_x</th>
      <th>P155_lang_y</th>
      <th>other_lang_x</th>
      <th>other_lang_y</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>first_mat_x</th>
      <th>first_mat_y</th>
      <th>first_mat_label_x</th>
      <th>first_mat_label_y</th>
      <th>first_mat_qid_x</th>
      <th>first_mat_qid_y</th>
      <th>P155_mat_x</th>
      <th>P155_mat_y</th>
      <th>other_mat_x</th>
      <th>other_mat_y</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>collection_qid_x</th>
      <th>collection_qid_y</th>
      <th>collection_wikidata_id_x</th>
      <th>collection_wikidata_id_y</th>
      <th>collection_name_x</th>
      <th>collection_name_y</th>
      <th>collection_name_native_x</th>
      <th>collection_name_native_y</th>
      <th>collection_url_x</th>
      <th>collection_url_y</th>
      <th>wiki_url_eng_x</th>
      <th>wiki_url_eng_y</th>
      <th>wiki_url_native_x</th>
      <th>wiki_url_native_y</th>
      <th>P155_collection_x</th>
      <th>P155_collection_y</th>
      <th>other_collection_x</th>
      <th>other_collection_y</th>
      <th>id_text2</th>
      <th>provenience_x</th>
      <th>provenience_y</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>provenience</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>_merge</th>
      <th>object_type_x</th>
      <th>object_type_y</th>
      <th>FG_qid_x</th>
      <th>FG_qid_y</th>
      <th>FG_Label_x</th>
      <th>FG_Label_y</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>genre_qid_x</th>
      <th>genre_qid_y</th>
      <th>genre_current_count_x</th>
      <th>genre_current_count_y</th>
      <th>P155_genre_x</th>
      <th>P155_genre_y</th>
      <th>other_genre_x</th>
      <th>other_genre_y</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>period_qid_x</th>
      <th>period_qid_y</th>
      <th>period_wikidata_URI_x</th>
      <th>period_wikidata_URI_y</th>
      <th>P155_period_x</th>
      <th>P155_period_y</th>
      <th>other_possible_period_x</th>
      <th>other_possible_period_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td></td>
      <td>M XVIII,?</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td></td>
      <td>M XVIII,?</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td></td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td></td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td></td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>28.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Nihavand ?)</td>
      <td>https://database.factgrid.de/entity/Q390022</td>
      <td>Nihāwand</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4520279</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>292.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Nahr el-Kelb)</td>
      <td>https://database.factgrid.de/entity/Q390023</td>
      <td>Nahr al-Kalb</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4520280</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>310.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Aşağı Yarımca)</td>
      <td>https://database.factgrid.de/entity/Q390057</td>
      <td>Aşağı Yarımca</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4520281</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>188.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Yasuj)</td>
      <td>https://database.factgrid.de/entity/Q390032</td>
      <td>Yāsūj</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4520282</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>273.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Negub tunnel)</td>
      <td>https://database.factgrid.de/entity/Q390019</td>
      <td>Nigūb</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 80 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cc7b9fc5-a53a-4ae8-95a9-e35258a41f41')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cc7b9fc5-a53a-4ae8-95a9-e35258a41f41 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cc7b9fc5-a53a-4ae8-95a9-e35258a41f41');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bc187584-1e10-45a0-88e5-e4620c2aa923">
  <button class="colab-df-quickchart" onclick="quickchart('df-bc187584-1e10-45a0-88e5-e4620c2aa923')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bc187584-1e10-45a0-88e5-e4620c2aa923 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_1f9a973c-eb44-4bc9-b638-d62ac5c8b814">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('den_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_1f9a973c-eb44-4bc9-b638-d62ac5c8b814 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('den_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<p>###2 For each object with a ‘cdli_id’ + ‘designation’ we will make the description by joining the following fields:</p>
<ul class="simple">
<li><p>‘lang’ + ( and ‘lang2’) [if questionable, exclude ‘lang’]</p></li>
<li><p>‘genre’ +</p></li>
<li><p>‘object’ +</p></li>
<li><p>“ from “ +</p></li>
<li><p>‘provenience = Len’ + (the CDLI ‘provenience’ field has many missing fields, so we will use the ‘Len’ field instead)</p></li>
<li><p>“, dated to “ +</p></li>
<li><p>‘period’ +</p></li>
<li><p>“ and currently held in the” +</p></li>
<li><p>‘collection’</p></li>
</ul>
<p>###3 The result should look something like this: <strong>“Sumerian administrative tablet from Girsu, dated to Ur III (ca. 2100-2000 BC) and currently held in the British Museum, London, UK”</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">den</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">den_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

  <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

  <span class="c1">####### language ########</span>

  <span class="c1"># only includes lang if first_lang is not questionable</span>
  <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;P155_lang_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">first_l</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">first_l</span>

  <span class="c1"># check if other language exists</span>
  <span class="c1"># note that this way of adding up is only feasible because there happens to be no multiple other languages in this batch</span>
  <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;other_lang_x&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="c1"># split multiple other languages</span>
    <span class="n">other_l_lst</span> <span class="o">=</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;other_lang_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="c1"># if only one other language</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_l_lst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">other_l</span> <span class="o">=</span> <span class="n">other_l_lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">other_l</span><span class="p">:</span>
        <span class="n">other_l</span> <span class="o">=</span> <span class="n">other_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; and possibly &#39;</span> <span class="o">+</span> <span class="n">other_l</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">other_l</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>

    <span class="c1"># if more than one other languages</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># for all but the last one</span>
      <span class="k">for</span> <span class="n">other_l</span> <span class="ow">in</span> <span class="n">other_l_lst</span><span class="p">[</span><span class="mi">0</span><span class="p">:(</span><span class="nb">len</span><span class="p">(</span><span class="n">other_l_lst</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]:</span>
        <span class="c1"># remove spaces</span>
        <span class="n">other_l</span> <span class="o">=</span> <span class="n">other_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">other_l</span><span class="p">:</span>
          <span class="n">other_l</span> <span class="o">=</span> <span class="n">other_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
          <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, possibly &#39;</span> <span class="o">+</span> <span class="n">other_l</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">other_l</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
      <span class="c1"># for the last one</span>
      <span class="n">last_other_l</span> <span class="o">=</span> <span class="n">other_l_lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">last_other_l</span><span class="p">:</span>
        <span class="n">last_other_l</span> <span class="o">=</span> <span class="n">last_other_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, and possibly &#39;</span> <span class="o">+</span> <span class="n">last_other_l</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, and &#39;</span> <span class="o">+</span> <span class="n">last_other_l</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>


  <span class="c1">######## genre ########</span>

  <span class="n">g</span> <span class="o">=</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;genre_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

  <span class="c1"># if genre is questionable</span>
  <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;P155_genre_x&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="c1"># if genre starts the sentence</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">g</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; (?)&#39;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">g</span> <span class="o">+</span> <span class="s1">&#39; (?)&#39;</span>

  <span class="c1"># if genre is certain</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="c1"># if genre starts the sentence</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">g</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">g</span>


  <span class="c1">######## object ########</span>

  <span class="n">o</span> <span class="o">=</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;object_type_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

  <span class="c1"># if object is questionable</span>
  <span class="k">if</span> <span class="n">o</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;An&#39;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; object of an unknown type&#39;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">o</span>

  <span class="c1">######## provenience ########</span>

  <span class="n">p</span> <span class="o">=</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;Len&#39;</span><span class="p">]</span>

  <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; from an unspecified location&#39;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; found in the &#39;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39; provenience&#39;</span>

  <span class="c1">######## period ########</span>

  <span class="c1"># if period is questionable</span>
  <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;P155_period_x&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, dated to &#39;</span> <span class="o">+</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period_x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (?)&#39;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period_x&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, dated to &#39;</span> <span class="o">+</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period_x&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;, dated to an unspecified period&#39;</span>

  <span class="c1">######## collection ########</span>

  <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39; and currently held in &#39;</span>

  <span class="c1"># if the collection is questionable</span>
  <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;P155_collection_x&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;the &#39;</span> <span class="o">+</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;P155_collection_x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (?)&#39;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;collection_x&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;the &#39;</span> <span class="o">+</span> <span class="n">den_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;collection_x&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;an unspecified location&#39;</span>

  <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span>
  <span class="n">den</span> <span class="o">+=</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">den</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Lexical tablet from an unspecified location, dated to Uruk III (ca. 3200-3000 BC) and currently held in the Vorderasiatisches Museum, Berlin, Germany.&#39;,
       &#39;Lexical tablet from an unspecified location, dated to Uruk IV (ca. 3350-3200 BC) and currently held in the Vorderasiatisches Museum, Berlin, Germany.&#39;,
       &#39;Lexical tablet from an unspecified location, dated to Uruk III (ca. 3200-3000 BC) and currently held in the National Museum of Iraq, Baghdad, Iraq.&#39;,
       ...,
       &#39;An object of an unknown type found in the Aşağı Yarımca provenience, dated to an unspecified period and currently held in an unspecified location.&#39;,
       &#39;An object of an unknown type found in the Yāsūj provenience, dated to an unspecified period and currently held in an unspecified location.&#39;,
       &#39;An object of an unknown type found in the Nigūb provenience, dated to an unspecified period and currently held in an unspecified location.&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">den_df</span><span class="p">[</span><span class="s1">&#39;den&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">den</span>

<span class="n">den_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-869c4fa8-701e-456c-90d1-e0f01bc4f897" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>first_lang_x</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_x</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_x</th>
      <th>P155_lang_y</th>
      <th>other_lang_x</th>
      <th>other_lang_y</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>first_mat_x</th>
      <th>first_mat_y</th>
      <th>first_mat_label_x</th>
      <th>first_mat_label_y</th>
      <th>first_mat_qid_x</th>
      <th>first_mat_qid_y</th>
      <th>P155_mat_x</th>
      <th>P155_mat_y</th>
      <th>other_mat_x</th>
      <th>other_mat_y</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>collection_qid_x</th>
      <th>collection_qid_y</th>
      <th>collection_wikidata_id_x</th>
      <th>collection_wikidata_id_y</th>
      <th>collection_name_x</th>
      <th>collection_name_y</th>
      <th>collection_name_native_x</th>
      <th>collection_name_native_y</th>
      <th>collection_url_x</th>
      <th>collection_url_y</th>
      <th>wiki_url_eng_x</th>
      <th>wiki_url_eng_y</th>
      <th>wiki_url_native_x</th>
      <th>wiki_url_native_y</th>
      <th>P155_collection_x</th>
      <th>P155_collection_y</th>
      <th>other_collection_x</th>
      <th>other_collection_y</th>
      <th>id_text2</th>
      <th>provenience_x</th>
      <th>provenience_y</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>provenience</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>_merge</th>
      <th>object_type_x</th>
      <th>object_type_y</th>
      <th>FG_qid_x</th>
      <th>FG_qid_y</th>
      <th>FG_Label_x</th>
      <th>FG_Label_y</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>genre_qid_x</th>
      <th>genre_qid_y</th>
      <th>genre_current_count_x</th>
      <th>genre_current_count_y</th>
      <th>P155_genre_x</th>
      <th>P155_genre_y</th>
      <th>other_genre_x</th>
      <th>other_genre_y</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>period_qid_x</th>
      <th>period_qid_y</th>
      <th>period_wikidata_URI_x</th>
      <th>period_wikidata_URI_y</th>
      <th>P155_period_x</th>
      <th>P155_period_y</th>
      <th>other_possible_period_x</th>
      <th>other_possible_period_y</th>
      <th>den</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td></td>
      <td>M XVIII,?</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Lexical tablet from an unspecified location, d...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td></td>
      <td>M XVIII,?</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Lexical tablet from an unspecified location, d...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td></td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Lexical tablet from an unspecified location, d...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td></td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Lexical tablet from an unspecified location, d...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td></td>
      <td>Qa XVI,2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>left_only</td>
      <td>tablet</td>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Lexical tablet from an unspecified location, d...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>28.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Nihavand ?)</td>
      <td>https://database.factgrid.de/entity/Q390022</td>
      <td>Nihāwand</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>An object of an unknown type found in the Nihā...</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>292.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Nahr el-Kelb)</td>
      <td>https://database.factgrid.de/entity/Q390023</td>
      <td>Nahr al-Kalb</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>An object of an unknown type found in the Nahr...</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>310.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Aşağı Yarımca)</td>
      <td>https://database.factgrid.de/entity/Q390057</td>
      <td>Aşağı Yarımca</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>An object of an unknown type found in the Aşağ...</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>188.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Yasuj)</td>
      <td>https://database.factgrid.de/entity/Q390032</td>
      <td>Yāsūj</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>An object of an unknown type found in the Yāsū...</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>273.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>uncertain (mod. Negub tunnel)</td>
      <td>https://database.factgrid.de/entity/Q390019</td>
      <td>Nigūb</td>
      <td>right_only</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>An object of an unknown type found in the Nigū...</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 81 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-869c4fa8-701e-456c-90d1-e0f01bc4f897')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-869c4fa8-701e-456c-90d1-e0f01bc4f897 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-869c4fa8-701e-456c-90d1-e0f01bc4f897');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3279c3d0-cd1c-4f83-80dc-069af67780bf">
  <button class="colab-df-quickchart" onclick="quickchart('df-3279c3d0-cd1c-4f83-80dc-069af67780bf')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3279c3d0-cd1c-4f83-80dc-069af67780bf button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_47792f93-4506-41fa-af82-5dbd64ce58d3">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('den_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_47792f93-4506-41fa-af82-5dbd64ce58d3 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('den_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#export den_df</span>
<span class="n">den_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/den_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>###4 The final resulting data frame (<code class="docutils literal notranslate"><span class="pre">factgrid_df</span></code>) will include the following fields, with data from <code class="docutils literal notranslate"><span class="pre">all_merged_df</span></code> in single quotation marks (’ ‘). This includes a total of 15 columns new columns added at the beginning of the data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#import den_df</span>
<span class="n">den_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/den_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="initial-fields-with-description">
<h2>4.1 Initial fields with <strong>description</strong>:<a class="headerlink" href="#initial-fields-with-description" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>qid</p></th>
<th class="head"><p>Len</p></th>
<th class="head"><p>Den</p></th>
<th class="head"><p>P2</p></th>
<th class="head"><p>P131</p></th>
<th class="head"><p>id_text_P692</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(blank)</p></td>
<td><p>‘designation’</p></td>
<td><p><strong>description</strong></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q512006">Q512006</a> (for all)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q389597">Q389597</a> (for all)</p></td>
<td><p>(id_text)</p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">len</span></code>: language in english</p>
<p><code class="docutils literal notranslate"><span class="pre">den</span></code>: description</p>
<p>For each object with a ‘cdli_id’ + ‘designation’ we will make the description by joining the following fields:</p>
<p>‘lang’ +</p>
<p>‘genre’ +</p>
<p>‘object’ +</p>
<p>“ from “ +</p>
<p>‘provenience = Len’ + (the CDLI ‘provenience’ field has many missing fields, so we will use the ‘Len’ field instead)</p>
<p>“, dated to “ +</p>
<p>‘period’ +</p>
<p>“ and currently held in the” +
‘collection’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">ini</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">,</span> <span class="s1">&#39;den&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># add columns we need</span>
<span class="n">ini</span><span class="p">[</span><span class="s1">&#39;qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">ini</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ini</span><span class="p">[</span><span class="s1">&#39;P2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Q390181&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ini</span><span class="p">[</span><span class="s1">&#39;P131&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Q389597&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">ini</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Len&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;den&#39;</span><span class="p">:</span> <span class="s1">&#39;Den&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">ini</span> <span class="o">=</span> <span class="n">ini</span><span class="p">[[</span><span class="s1">&#39;qid&#39;</span><span class="p">,</span> <span class="s1">&#39;Len&#39;</span><span class="p">,</span> <span class="s1">&#39;Den&#39;</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">,</span> <span class="s1">&#39;P131&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">]]</span>

<span class="n">ini</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-5-b389872f1002&gt;:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  ini[&#39;qid&#39;] = np.empty(ini.shape[0])
&lt;ipython-input-5-b389872f1002&gt;:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  ini[&#39;P2&#39;] = [&#39;Q390181&#39;] * ini.shape[0]
&lt;ipython-input-5-b389872f1002&gt;:7: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  ini[&#39;P131&#39;] = [&#39;Q389597&#39;] * ini.shape[0]
</pre></div>
</div>
<div class="output text_html">
  <div id="df-426c0602-33ac-42a4-9f2b-cd45f82f4983" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>qid</th>
      <th>Len</th>
      <th>Den</th>
      <th>P2</th>
      <th>P131</th>
      <th>id_text_P692</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>Lexical tablet from an unspecified location, d...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>P000001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>Lexical tablet from an unspecified location, d...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>P000002</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>Lexical tablet from an unspecified location, d...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>P000003</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>Lexical tablet from an unspecified location, d...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>P000004</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>Lexical tablet from an unspecified location, d...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>P000005</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>An object of an unknown type found in the Nihā...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>An object of an unknown type found in the Nahr...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>An object of an unknown type found in the Aşağ...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>An object of an unknown type found in the Yāsū...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>An object of an unknown type found in the Nigū...</td>
      <td>Q390181</td>
      <td>Q389597</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 6 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-426c0602-33ac-42a4-9f2b-cd45f82f4983')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-426c0602-33ac-42a4-9f2b-cd45f82f4983 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-426c0602-33ac-42a4-9f2b-cd45f82f4983');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ea566c81-d269-42ce-ac51-e47fa35589b0">
  <button class="colab-df-quickchart" onclick="quickchart('df-ea566c81-d269-42ce-ac51-e47fa35589b0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ea566c81-d269-42ce-ac51-e47fa35589b0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="language-df-final-continued">
<h2>4.2 <strong>language_df_final</strong> (continued):<a class="headerlink" href="#language-df-final-continued" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Language</p></th>
<th class="head"><p>P18</p></th>
<th class="head"><p>qal155</p></th>
<th class="head"><p>P18_2</p></th>
<th class="head"><p>qal18</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>Akkadian (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q471146">Q471146</a></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a> (if questionable)</p></td>
<td><p>Sumerian (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q471149">Q471149</a> (for example)</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>For those with multiple language statements, we can save the second for batch 2</p></li>
<li><p>For those with questionable statements, we can save them for batch 2+ as well</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">language_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">,</span> <span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_lang_x&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;other_lang_x&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">language_df_final</span> <span class="o">=</span> <span class="n">language_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Language&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">:</span> <span class="s1">&#39;P18&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;P155_lang_x&#39;</span><span class="p">:</span> <span class="s1">&#39;qal155_lang&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;other_lang_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Lang2&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">language_df_final</span> <span class="o">=</span> <span class="n">language_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Language&#39;</span><span class="p">,</span> <span class="s1">&#39;P18&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;qal155_lang&#39;</span><span class="p">,</span> <span class="s1">&#39;Lang2&#39;</span><span class="p">]]</span>

<span class="n">language_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-3c72e591-2f1f-4018-b84d-adcb80f45a4c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Language</th>
      <th>P18</th>
      <th>qal155_lang</th>
      <th>Lang2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3c72e591-2f1f-4018-b84d-adcb80f45a4c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3c72e591-2f1f-4018-b84d-adcb80f45a4c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3c72e591-2f1f-4018-b84d-adcb80f45a4c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-898040c3-c07d-4f2d-918a-9af0483e7c4a">
  <button class="colab-df-quickchart" onclick="quickchart('df-898040c3-c07d-4f2d-918a-9af0483e7c4a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-898040c3-c07d-4f2d-918a-9af0483e7c4a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="material-df-continued">
<h2>4.3 <strong>material_df</strong> (continued):<a class="headerlink" href="#material-df-continued" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Material composition</p></th>
<th class="head"><p>P401</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>clay (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q471153">Q471153</a></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">material_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;first_mat_x&#39;</span><span class="p">,</span> <span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_mat_x&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">material_df_final</span> <span class="o">=</span> <span class="n">material_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;first_mat_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Material composition&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">:</span> <span class="s1">&#39;P401&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;P155_mat_x&#39;</span><span class="p">:</span> <span class="s1">&#39;qal155_mat&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">material_df_final</span> <span class="o">=</span> <span class="n">material_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Material composition&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;P401&#39;</span><span class="p">,</span><span class="s1">&#39;qal155_mat&#39;</span><span class="p">]]</span>

<span class="n">material_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-8ebffde0-3d43-47cf-aee0-6c5335e4d365" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Material composition</th>
      <th>P401</th>
      <th>qal155_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8ebffde0-3d43-47cf-aee0-6c5335e4d365')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8ebffde0-3d43-47cf-aee0-6c5335e4d365 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8ebffde0-3d43-47cf-aee0-6c5335e4d365');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5e6114c7-9881-4e0d-bdc9-a2b78b4f7e2f">
  <button class="colab-df-quickchart" onclick="quickchart('df-5e6114c7-9881-4e0d-bdc9-a2b78b4f7e2f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5e6114c7-9881-4e0d-bdc9-a2b78b4f7e2f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="museum-df-continued">
<h2>4.4 <strong>museum_df</strong> (continued):<a class="headerlink" href="#museum-df-continued" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Present holding</p></th>
<th class="head"><p>P329</p></th>
<th class="head"><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q499887#">qal10</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>British Museum (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q102010">Q102010</a></p></td>
<td><p>‘museum_no’</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>For those with questionable statements, we can save them for batch 2</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">museum_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">museum_df_final</span> <span class="o">=</span> <span class="n">museum_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;collection_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Present holding&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;collection_qid_x&#39;</span><span class="p">:</span> <span class="s1">&#39;P329&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;P155_collection_x&#39;</span><span class="p">:</span> <span class="s1">&#39;qal155_museum&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">museum_df_final</span> <span class="o">=</span> <span class="n">museum_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Present holding&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;P329&#39;</span><span class="p">,</span><span class="s1">&#39;qal155_museum&#39;</span><span class="p">]]</span>

<span class="n">museum_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-dd060eb9-52f0-4e56-91d5-40ea8b37cfa9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Present holding</th>
      <th>P329</th>
      <th>qal155_museum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dd060eb9-52f0-4e56-91d5-40ea8b37cfa9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dd060eb9-52f0-4e56-91d5-40ea8b37cfa9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dd060eb9-52f0-4e56-91d5-40ea8b37cfa9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-22b49b59-2657-4a9d-a3ee-aff50c7184da">
  <button class="colab-df-quickchart" onclick="quickchart('df-22b49b59-2657-4a9d-a3ee-aff50c7184da')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-22b49b59-2657-4a9d-a3ee-aff50c7184da button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="provenience-df-continued">
<h2>4.5 <strong>provenience_df</strong> (continued):<a class="headerlink" href="#provenience-df-continued" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Provenience</p></th>
<th class="head"><p>P695</p></th>
<th class="head"><p>qal804</p></th>
<th class="head"><p>qal425</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>‘Len’ = Kanesh (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q390036">Q390036</a></p></td>
<td><p>“kt a/k 0353”</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Note: the qualifiers P425 for ‘findspot_square’ could make issues for QuickStatements, because there will be a lot of null values. We can add the texts that have this statement first, and then add those that don’t in batch 2</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">provenience_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;Len&#39;</span><span class="p">,</span> <span class="s1">&#39;findspot_square_x&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">provenience_df_final</span> <span class="o">=</span> <span class="n">provenience_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Len&#39;</span><span class="p">:</span> <span class="s1">&#39;Provenience&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;findspot_square_x&#39;</span><span class="p">:</span> <span class="s1">&#39;qal425&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">provenience_df_final</span> <span class="o">=</span> <span class="n">provenience_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Provenience&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;qal425&#39;</span><span class="p">]]</span>

<span class="n">provenience_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b8f8dd80-a893-4ad2-a773-6c12a4bb37ca" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Provenience</th>
      <th>qal425</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>Nihāwand</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>Nahr al-Kalb</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>Aşağı Yarımca</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>Yāsūj</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>Nigūb</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b8f8dd80-a893-4ad2-a773-6c12a4bb37ca')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b8f8dd80-a893-4ad2-a773-6c12a4bb37ca button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b8f8dd80-a893-4ad2-a773-6c12a4bb37ca');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fdc14506-746b-4c77-8245-0c4664f4b51a">
  <button class="colab-df-quickchart" onclick="quickchart('df-fdc14506-746b-4c77-8245-0c4664f4b51a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fdc14506-746b-4c77-8245-0c4664f4b51a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="object-type-df-continued-to-be-added-in-batch-2">
<h2>4.6 <strong>object_type_df</strong> (continued): to be added in batch 2<a class="headerlink" href="#object-type-df-continued-to-be-added-in-batch-2" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Instance of</p></th>
<th class="head"><p>P2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>Tablet (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q512006">Q512006</a></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">object_type_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;object_type_x&#39;</span><span class="p">,</span><span class="s1">&#39;FG_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">object_type_df_final</span> <span class="o">=</span> <span class="n">object_type_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;object_type_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Instance of&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;FG_qid_x&#39;</span><span class="p">:</span><span class="s1">&#39;P2&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">object_type_df_final</span> <span class="o">=</span> <span class="n">object_type_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Instance of&#39;</span><span class="p">,</span><span class="s1">&#39;P2&#39;</span><span class="p">]]</span>

<span class="n">object_type_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-2d685807-ea6b-47a0-921d-ccf8f59400ac" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Instance of</th>
      <th>P2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>tablet</td>
      <td>Q512006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>tablet</td>
      <td>Q512006</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>tablet</td>
      <td>Q512006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>tablet</td>
      <td>Q512006</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>tablet</td>
      <td>Q512006</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2d685807-ea6b-47a0-921d-ccf8f59400ac')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2d685807-ea6b-47a0-921d-ccf8f59400ac button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2d685807-ea6b-47a0-921d-ccf8f59400ac');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d6bdf968-7a3c-4a60-9658-9ad369cf3f2e">
  <button class="colab-df-quickchart" onclick="quickchart('df-d6bdf968-7a3c-4a60-9658-9ad369cf3f2e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d6bdf968-7a3c-4a60-9658-9ad369cf3f2e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="genre-df-continued">
<h2>4.7 <strong>genre_df</strong> (continued):<a class="headerlink" href="#genre-df-continued" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Type of work</p></th>
<th class="head"><p>P121</p></th>
<th class="head"><p>P608</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>Letter (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q10510">Q10510</a> (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q257175">Q257175</a> (for example)</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>For those with questionable statements, we can save them for batch 2</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">genre_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;genre_x&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_genre_x&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">genre_df_final</span> <span class="o">=</span> <span class="n">genre_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;genre_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Type of work&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;genre_qid_x&#39;</span><span class="p">:</span> <span class="s1">&#39;P121&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;P155_genre_x&#39;</span><span class="p">:</span> <span class="s1">&#39;qal155_genre&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">genre_df_final</span> <span class="o">=</span> <span class="n">genre_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Type of work&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;P121&#39;</span><span class="p">,</span><span class="s1">&#39;qal155_genre&#39;</span><span class="p">]]</span>

<span class="n">genre_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-649ad391-967f-4a9d-b09c-3e48509faadc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Type of work</th>
      <th>P121</th>
      <th>qal155_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-649ad391-967f-4a9d-b09c-3e48509faadc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-649ad391-967f-4a9d-b09c-3e48509faadc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-649ad391-967f-4a9d-b09c-3e48509faadc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-572489a2-3af9-42c2-abac-87d4d53f4e12">
  <button class="colab-df-quickchart" onclick="quickchart('df-572489a2-3af9-42c2-abac-87d4d53f4e12')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-572489a2-3af9-42c2-abac-87d4d53f4e12 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="period-df-continued">
<h2>4.8 <strong>period_df</strong> (continued):<a class="headerlink" href="#period-df-continued" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text_P692</p></th>
<th class="head"><p>Period</p></th>
<th class="head"><p>P853</p></th>
<th class="head"><p>P155</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(id_text)</p></td>
<td><p>Old Assyrian Period (for example)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q512151">Q512151</a></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a> (if questionable)</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>For those with questionable statements, we can save them for batch 2</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get existing columns we need</span>
<span class="n">period_df_final</span> <span class="o">=</span> <span class="n">den_df</span><span class="p">[[</span><span class="s1">&#39;period_x&#39;</span><span class="p">,</span> <span class="s1">&#39;period_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_period_x&#39;</span><span class="p">,</span> <span class="s1">&#39;id_text&#39;</span><span class="p">]]</span>

<span class="c1"># rename the columns accordingly</span>
<span class="n">period_df_final</span> <span class="o">=</span> <span class="n">period_df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;period_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Period&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;period_qid_x&#39;</span><span class="p">:</span> <span class="s1">&#39;P853&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;P155_period_x&#39;</span><span class="p">:</span> <span class="s1">&#39;qal155_period&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">})</span>

<span class="c1"># reorder the columns accordingly</span>
<span class="n">period_df_final</span> <span class="o">=</span> <span class="n">period_df_final</span><span class="p">[[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="s1">&#39;Period&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;P853&#39;</span><span class="p">,</span><span class="s1">&#39;qal155_period&#39;</span><span class="p">]]</span>

<span class="n">period_df_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fb54bd02-967d-4de8-87c1-c603a81cc5a7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text_P692</th>
      <th>Period</th>
      <th>P853</th>
      <th>qal155_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4520278</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520279</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520280</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520281</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4520282</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4520283 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fb54bd02-967d-4de8-87c1-c603a81cc5a7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fb54bd02-967d-4de8-87c1-c603a81cc5a7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fb54bd02-967d-4de8-87c1-c603a81cc5a7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-686dc9b9-aad5-4ebd-a6e2-7fe67e69e483">
  <button class="colab-df-quickchart" onclick="quickchart('df-686dc9b9-aad5-4ebd-a6e2-7fe67e69e483')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-686dc9b9-aad5-4ebd-a6e2-7fe67e69e483 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="final-csv-with-examples">
<h2>__Final CSV (with examples):<a class="headerlink" href="#final-csv-with-examples" title="Link to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>qid</p></th>
<th class="head"><p>Len</p></th>
<th class="head"><p>Den</p></th>
<th class="head"><p>P2</p></th>
<th class="head"><p>P131</p></th>
<th class="head"><p>P692</p></th>
<th class="head"><p>P18</p></th>
<th class="head"><p>P401</p></th>
<th class="head"><p>P329</p></th>
<th class="head"><p>qal10</p></th>
<th class="head"><p>P695</p></th>
<th class="head"><p>qal804</p></th>
<th class="head"><p>qal425</p></th>
<th class="head"><p>P121</p></th>
<th class="head"><p>P608</p></th>
<th class="head"><p>P853</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(blank)</p></td>
<td><p>‘designation’</p></td>
<td><p><strong>description</strong></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q390181">Q390181</a> (for all)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q389597">Q389597</a> (for all)</p></td>
<td><p>(id_text)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q471146">Q471146</a></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q471153">Q471153</a></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q102010">Q102010</a></p></td>
<td><p>‘museum_no’ (string)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q390036">Q390036</a></p></td>
<td><p>“kt a/k 0353” (string)</p></td>
<td><p>(string)</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q10510">Q10510</a></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q257175">Q257175</a></p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q512151">Q512151</a></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>For the first batch, we will have to filter the results that have more than one P155 ‘questionable statement’</p></li>
</ul>
</section>
<section id="finalized-outcome-example-in-factgrid">
<h2>Finalized outcome (example in FactGrid):<a class="headerlink" href="#finalized-outcome-example-in-factgrid" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q499899"><strong>ICK 4 - I 437 (Q499899)</strong></a></p>
<p>This example shows how many of these statements will look for each text we are adding to FactGrid using QuickStatements. Since the text here is undated, it doesn’t illustrate the final section for ‘dates’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#attempt one of merging all dataframes, PROBLEM: SESSION CRASH</span>
<span class="c1">#factgrid_df = ini.merge(language_df_final, how = &#39;left&#39;).(material_df_final,how =&#39;left&#39;).merge(museum_df_final,how =&#39;left&#39;).merge(provenience_df_final,how=&#39;left&#39;).merge(object_type_df_final,how=&#39;left&#39;).merge(genre_df_final,how=&#39;left&#39;).merge(period_df_final,how=&#39;left&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># attempt two, PROBLEM: SESSION CRASHED</span>
<span class="n">factgrid_df</span> <span class="o">=</span> <span class="n">ini</span><span class="p">[</span><span class="s1">&#39;id_text_P692&#39;</span><span class="p">]</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ini</span><span class="p">,</span> <span class="n">language_df_final</span><span class="p">,</span> <span class="n">material_df_final</span><span class="p">,</span> <span class="n">museum_df_final</span><span class="p">,</span> <span class="n">provenience_df_final</span><span class="p">,</span> <span class="n">object_type_df_final</span><span class="p">,</span> <span class="n">genre_df_final</span><span class="p">,</span> <span class="n">period_df_final</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)):</span>
  <span class="n">factgrid_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">factgrid_df</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text_P692&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factgrid_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># saving the dataframe to designated folder</span>
<span class="n">factgrid_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/factgrid_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>#Important Counts &amp; Exporting the Metacatalogue:</p>
<p>Metacatalogue : 366916 rows × 46 columns</p>
<p>Matching IDs : 157512 texts</p>
<p>Tablet Texts : 102035</p>
<p>Envelope Texts : 3798</p>
<p>Cone Texts : 5667</p>
<p>Seal Texts : 6472</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#exports metacatalogue to the folder ORACC_DFS</span>
<span class="n">metacatalogue</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/metacatalogue.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Mount Google Drive folder + imports</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsets-based-on-object-type">Subsets based on Object Type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#language-language-p18-uncertainty-p155">1 Language = Language (P18) + uncertainty (P155)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id">1.1 Starting with the CDLI languages, we can match unique languages to their FG language id</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-languages-dataframes">1.3 Combining CDLI and ORACC Languages dataframes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-material-composition-p401">2 Material = Material Composition (P401)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id"><strong>2.1. We will only add the most basic material composition to a data frame, `material_df’, and then we match the first statement to the corresponding FactGrid Q-id.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.2. CDLI - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df">2.2.1 matched_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df">2.2.2 no_match_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-cdli-materials">2.2.3 Visualization of CDLI Materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-materials">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-finer-categories-within-matched-materials">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-materials">Distribution of unmatched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-materials-are-tablets-that-have-languages-on-them-made-of">What materials are tablets that have languages on them made of?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.3. ORACC - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df2">2.3.1 matched_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df2">2.3.2 no_match_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Distribution of unmatched materials</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-material-dataframes"><strong>2.4 Combining CDLI and ORACC Material dataframes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#museum-collection-present-holding-p329">3 <strong>museum/collection = present holding (P329)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df">3.1.2 collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df">3.1.3 matched_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df">3.1.4 no_match_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">3.1.5 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-collections">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries">Distribution of countries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-collections">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df2">3.2.1 collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df2">3.2.2 matched_collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df2">3.2.3 no_match_collection_df2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.2.4 Visualization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries-of-first-collections-that-matched">Distribution of countries of first collections that matched</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-collections-of-cdli-and-oracc">3.3 Merging collections of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#provenience-find-spot-p695">4 <strong>provenience = find spot (P695)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-two-columns-as-qualifiers">4.4 Add two columns as qualifiers:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#object-type-instance-of-p2">5 <strong>object_type = Instance of (P2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-objects">5.1 CDLI objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#n-b-for-double-entries">N.B. for double entries:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-objects">5.2 ORACC objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">N.B. for double entries:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-object-dfs-of-cdli-and-oracc">Merging object dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#genre-field-of-knowledge-p608">6 <strong>genre = Field of Knowledge (P608)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog">6.1 Use this CSV to obtain the FactGrid Q-ids for each object type in the CDLI catalog:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-genres">6.2 CDLI Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id">6.2.1 Match on the cdli label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df">6.2.2 matched_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-genre-df">6.2.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">6.2.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre-for-tablets-that-have-text-on-them">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-genre">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-genres">6.3 ORACC Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id">6.3.1 Match on the oracc label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df2">6.3.2 matched_genre_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">6.3.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">6.3.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-genre-dfs-of-cdli-and-oracc">Merging genre dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-period-p853">7 <strong>period = Period (P853)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog">7.1 Use this CSV to obtain the FactGrid Q-ids for each period of each texts in the CDLI catalog</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-periods">7.2 CDLI Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-period-df">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-period-df">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-periods">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-tablets-over-time">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-periods">Distribution of Unmatched Periods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-periods">7.3 ORACC Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Distribution of Unmatched Periods</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-period-dfs-of-cdli-and-oracc">Merging period dfs of CDLI and ORACC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-and-qualifier-is-oracc">CDLI and Qualifier is ORACC</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-for-factgrid-quickstatement-batch-processing">Prepare for <strong>FactGrid</strong> QuickStatement batch processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-fields-with-description">4.1 Initial fields with <strong>description</strong>:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#language-df-final-continued">4.2 <strong>language_df_final</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-df-continued">4.3 <strong>material_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#museum-df-continued">4.4 <strong>museum_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#provenience-df-continued">4.5 <strong>provenience_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#object-type-df-continued-to-be-added-in-batch-2">4.6 <strong>object_type_df</strong> (continued): to be added in batch 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#genre-df-continued">4.7 <strong>genre_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-df-continued">4.8 <strong>period_df</strong> (continued):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-csv-with-examples">__Final CSV (with examples):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finalized-outcome-example-in-factgrid">Finalized outcome (example in FactGrid):</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>