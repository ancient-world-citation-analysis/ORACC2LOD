
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mount Google Drive folder + imports &#8212; ORACC2LoD</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '7.2 - Fitting Headers';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mount Google Drive folder + imports" href="7.3%20-%20Factgrid%20Quickstatement%20Processing.html" />
    <link rel="prev" title="Mount Google Drive folder + imports" href="7.1%20-%20Metacatalogue.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="welcome.html">
  
  
  
  
  
  
    <p class="title logo__title">ORACC2LoD</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="welcome.html">
                    Sumerian Networks JupyterBook
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1-ORACC_ZIPS.html">Download ORACC Directory ZIP Files (Google Colab version)</a></li>




<li class="toctree-l1"><a class="reference internal" href="2-DataFrame%20Extraction.html">Extract words_df and df_cat DataFrames from ZIP files</a></li>


<li class="toctree-l1"><a class="reference internal" href="3-Large%20DF%20of%20Unique%20Words.html">Large DataFrame of Unique Words</a></li>



<li class="toctree-l1"><a class="reference internal" href="4-Megacatalogue.html">Mount Google Drive folder + imports + steps</a></li>

<li class="toctree-l1"><a class="reference internal" href="4.1%20-%20Counts%20for%20Megacatalogue.html">Counts for Megacatalogue</a></li>


<li class="toctree-l1"><a class="reference internal" href="5-Translations%20Extraction.html">Mount Google Drive folder + imports + steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.1-Counts%20for%20Transliterations%20and%20Translations.html">Counts for Transliterations and Translations</a></li>

<li class="toctree-l1"><a class="reference internal" href="7.1%20-%20Metacatalogue.html">Mount Google Drive folder + imports</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mount Google Drive folder + imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.3%20-%20Factgrid%20Quickstatement%20Processing.html">Mount Google Drive folder + imports</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/austin-pereira/Oracc2LoD/blob/main/book/7.2 - Fitting Headers.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/7.2 - Fitting Headers.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mount Google Drive folder + imports</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#language-language-p18-uncertainty-p155">1 Language = Language (P18) + uncertainty (P155)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id">1.1 Starting with the CDLI languages, we can match unique languages to their FG language id</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-languages-dataframes">1.3 Combining CDLI and ORACC Languages dataframes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-material-composition-p401">2 Material = Material Composition (P401)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id"><strong>2.1. We will only add the most basic material composition to a data frame, `material_df’, and then we match the first statement to the corresponding FactGrid Q-id.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.2. CDLI - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df">2.2.1 matched_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df">2.2.2 no_match_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-cdli-materials">2.2.3 Visualization of CDLI Materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-materials">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-finer-categories-within-matched-materials">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-materials">Distribution of unmatched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-materials-are-tablets-that-have-languages-on-them-made-of">What materials are tablets that have languages on them made of?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.3. ORACC - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df2">2.3.1 matched_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df2">2.3.2 no_match_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Distribution of unmatched materials</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-material-dataframes"><strong>2.4 Combining CDLI and ORACC Material dataframes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#museum-collection-present-holding-p329">3 <strong>museum/collection = present holding (P329)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df">3.1.2 collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df">3.1.3 matched_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df">3.1.4 no_match_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">3.1.5 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-collections">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries">Distribution of countries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-collections">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df2">3.2.1 collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df2">3.2.2 matched_collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df2">3.2.3 no_match_collection_df2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.2.4 Visualization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries-of-first-collections-that-matched">Distribution of countries of first collections that matched</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-collections-of-cdli-and-oracc">3.3 Merging collections of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#provenience-find-spot-p695">4 <strong>provenience = find spot (P695)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-two-columns-as-qualifiers">4.4 Add two columns as qualifiers:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#object-type-instance-of-p2">5 <strong>object_type = Instance of (P2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-objects">5.1 CDLI objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-objects">5.2 ORACC objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-object-dfs-of-cdli-and-oracc">Merging object dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#genre-field-of-knowledge-p608">6 <strong>genre = Field of Knowledge (P608)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog">6.1 Use this CSV to obtain the FactGrid Q-ids for each object type in the CDLI catalog:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-genres">6.2 CDLI Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id">6.2.1 Match on the cdli label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df">6.2.2 matched_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-genre-df">6.2.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">6.2.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre-for-tablets-that-have-text-on-them">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-genre">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-genres">6.3 ORACC Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id">6.3.1 Match on the oracc label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df2">6.3.2 matched_genre_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">6.3.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">6.3.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-genre-dfs-of-cdli-and-oracc">Merging genre dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-period-p853">7 <strong>period = Period (P853)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog">7.1 Use this CSV to obtain the FactGrid Q-ids for each period of each texts in the CDLI catalog</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-periods">7.2 CDLI Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-period-df">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-period-df">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-periods">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-tablets-over-time">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-periods">Distribution of Unmatched Periods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-periods">7.3 ORACC Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Distribution of Unmatched Periods</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-period-dfs-of-cdli-and-oracc">Merging period dfs of CDLI and ORACC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-and-qualifier-is-oracc">CDLI and Qualifier is ORACC</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>#Fitting Proper Factgrid Headers for All Properties</p>
<p>Notebook by Melinee Her</p>
<p>Harmonizes ORACC data with CDLI catalogue.</p>
<section class="tex2jax_ignore mathjax_ignore" id="mount-google-drive-folder-imports">
<h1>Mount Google Drive folder + imports<a class="headerlink" href="#mount-google-drive-folder-imports" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#any necessary imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="c1">#Set folder for remote drive</span>
<span class="c1">#folder = &#39;/content/drive/My Drive/FactGrid Cuneiform (AWCA)/people/Melinee/&#39;</span>
<span class="n">folder</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Melinee/&#39;</span>

<span class="c1">#importing utils for the method which downloads the current text json files</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;network/utils/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">oracc_download</span>

<span class="c1"># This is a user defined module that searches through the texts to find the entities in the text that</span>
<span class="c1"># are people and places, to be imported as nodes into the network</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;network/&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">rank_parser4</span> <span class="k">as</span> <span class="nn">rp</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#import metacatalogue</span>
<span class="n">metacatalogue</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/metacatalogue.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>#Fitting Proper FactGrid Headers
Adapted from the <a class="reference external" href="https://drive.google.com/file/d/1yhM_8fgF6p89E3qiH1LRK4EgEau7HLuT/view?usp=sharing">cdli_cat.ipynb</a> notebook.</p>
<section id="language-language-p18-uncertainty-p155">
<h2>1 Language = Language (P18) + uncertainty (P155)<a class="headerlink" href="#language-language-p18-uncertainty-p155" title="Link to this heading">#</a></h2>
<p>For reference, let’s start with the languages listed in the CDLI catalog.
In order to avoid adding question marks to these language items, we use the statement ‘how sure is this’ <a class="reference external" href="https://database.factgrid.de/wiki/Property:P155">P155</a>, that logs the language item as ‘questionable, not settled, ?’ <a class="reference external" href="https://database.factgrid.de/wiki/Item:Q160240">Q160240</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lang_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Language%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">lang_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># drop the first row that is empty</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:]</span>
<span class="c1"># drop the sequence column</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sequence&#39;</span><span class="p">])</span>
<span class="c1"># fill na values with space</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span>
<span class="c1"># use only rows with a QID</span>
<span class="n">lang_reference</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;FG_item&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">lang_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ed282ee6-2253-4c12-b150-ab805df7cc2f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Parent</th>
      <th>Language</th>
      <th>FG_item</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Elamite</td>
      <td>Elamite</td>
      <td>Q500430</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>Hurrian</td>
      <td>Hurrian</td>
      <td>Q512052</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>Hittite</td>
      <td>Hittite</td>
      <td>Q500429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14</td>
      <td>Hittite</td>
      <td>Hittite Logographic</td>
      <td>Q500429</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15</td>
      <td>Ugaritic</td>
      <td>Ugaritic</td>
      <td>Q500431</td>
    </tr>
    <tr>
      <th>5</th>
      <td>17</td>
      <td>Arabic</td>
      <td>Arabic</td>
      <td>Q389598</td>
    </tr>
    <tr>
      <th>6</th>
      <td>18</td>
      <td>Aramaic</td>
      <td>Aramaic</td>
      <td>Q393615</td>
    </tr>
    <tr>
      <th>7</th>
      <td>19</td>
      <td>Akkadian</td>
      <td>Eblaite</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>Greek</td>
      <td>Greek</td>
      <td>Q172951</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21</td>
      <td>Hebrew</td>
      <td>Hebrew</td>
      <td>Q389600</td>
    </tr>
    <tr>
      <th>10</th>
      <td>22</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>11</th>
      <td>23</td>
      <td>Akkadian</td>
      <td>Late Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>12</th>
      <td>24</td>
      <td>Akkadian</td>
      <td>Early Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25</td>
      <td>Akkadian</td>
      <td>Middle Assyrian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>Akkadian</td>
      <td>Middle Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>15</th>
      <td>27</td>
      <td>Akkadian</td>
      <td>Middle Babylonian peripheral</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>16</th>
      <td>28</td>
      <td>Akkadian</td>
      <td>Neo-Assyrian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>17</th>
      <td>29</td>
      <td>Akkadian</td>
      <td>Neo-Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>18</th>
      <td>30</td>
      <td>Akkadian</td>
      <td>Old Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>19</th>
      <td>31</td>
      <td>Akkadian</td>
      <td>Old Assyrian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>20</th>
      <td>32</td>
      <td>Akkadian</td>
      <td>Old Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>21</th>
      <td>33</td>
      <td>Akkadian</td>
      <td>Old Babylonian peripheral</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>22</th>
      <td>34</td>
      <td>Akkadian</td>
      <td>Ur III Akkadian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>23</th>
      <td>35</td>
      <td>Akkadian</td>
      <td>Standard Babylonian</td>
      <td>Q471146</td>
    </tr>
    <tr>
      <th>24</th>
      <td>36</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
    </tr>
    <tr>
      <th>25</th>
      <td>39</td>
      <td>Sumerian</td>
      <td>Udgalnun</td>
      <td>Q471149</td>
    </tr>
    <tr>
      <th>26</th>
      <td>40</td>
      <td>Sumerian</td>
      <td>Emesal</td>
      <td>Q471149</td>
    </tr>
    <tr>
      <th>27</th>
      <td>41</td>
      <td>Sumerian</td>
      <td>Syllabic</td>
      <td>Q471149</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ed282ee6-2253-4c12-b150-ab805df7cc2f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ed282ee6-2253-4c12-b150-ab805df7cc2f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ed282ee6-2253-4c12-b150-ab805df7cc2f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2409bb6c-0ca5-47aa-9810-2031be52dc0a">
  <button class="colab-df-quickchart" onclick="quickchart('df-2409bb6c-0ca5-47aa-9810-2031be52dc0a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2409bb6c-0ca5-47aa-9810-2031be52dc0a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id">
<h3>1.1 Starting with the CDLI languages, we can match unique languages to their FG language id<a class="headerlink" href="#starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">language_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">]]</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-715f1b67-db34-44e8-872f-db8566052d61" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>language_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-715f1b67-db34-44e8-872f-db8566052d61')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-715f1b67-db34-44e8-872f-db8566052d61 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-715f1b67-db34-44e8-872f-db8566052d61');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3a3f9f94-8006-460f-a005-011ffdd79bc7">
  <button class="colab-df-quickchart" onclick="quickchart('df-3a3f9f94-8006-460f-a005-011ffdd79bc7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3a3f9f94-8006-460f-a005-011ffdd79bc7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">langx</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span>

<span class="c1">#drop clay from langx because that is not a language</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;clay&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># there are two different entries of NA, merge them into one</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># remove the &#39;\x0b&#39; patterns</span>
<span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x0b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">langx</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">langx</span><span class="p">))])]</span>

<span class="n">langx</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;undetermined&#39;, &#39;Sumerian&#39;, &#39;Sumerian ?&#39;, &#39;Akkadian&#39;, nan,
       &#39;Sumerian; Akkadian&#39;, &#39;Elamite&#39;, &#39;Akkadian; Elamite&#39;, &#39;Hurrian&#39;,
       &#39;Akkadian ?&#39;, &#39;Eblaite&#39;, &#39;Akkadian; Elamite; Persian; Egyptian ?&#39;,
       &#39;\x0b&#39;, &#39;Ugaritic&#39;, &#39;undetermined (pseudo)&#39;, &#39;Aramaic&#39;,
       &#39;Sumerian; Akkadian (pseudo)&#39;, &#39;no linguistic content&#39;,
       &#39;Akkadian; Persian; Elamite; Egyptian &#39;, &#39;Hebrew&#39;, &#39;Aramaic ?&#39;,
       &#39;Akkadian; Aramaic&#39;, &#39;Hebrew ?&#39;, &#39;Greek&#39;, &#39;Phoenician&#39;, &#39;Sabaean&#39;,
       &#39;Hittite&#39;, &#39;Akkadian; Egyptian&#39;, &#39;Hurrian ?&#39;, &#39;Qatabanian&#39;,
       &#39;uncertain&#39;, &#39;Persian&#39;, &#39;Hittite ?&#39;, &#39;Hittite; Hattic&#39;, &#39;Syriac&#39;,
       &#39;Mandaic&#39;, &#39;Hittite; Hurrian&#39;, &#39;uninscribed&#39;, &#39;Akkadian\x0b&#39;,
       &#39;Akkadian\x0b\x0b&#39;, &#39;Sumerian; Akkadian ?&#39;, &#39;Egyptian ?&#39;,
       &#39;Akkadian; Elamite; Persian&#39;, &#39;Arabic&#39;, &#39;Akkadian; Greek&#39;,
       &#39;Urartian&#39;, &#39;Akkadian; Elamite; Persian; Egyptian&#39;,
       &#39;Akkadian; Persian&#39;, &#39;Egyptian&#39;, &#39;Luwian&#39;,
       &#39;Persian; Elamite; Akkadian&#39;, &#39;Akkadian; Persian; Elamite&#39;,
       &#39;Persian, &#39;, &#39;Persian; Elamite&#39;, &#39;Persian; Elamite &#39;,
       &#39;Akkadian; Persian, Elamite, Babylonian&#39;, &#39;Persian &#39;,
       &#39;Persian, Elamite&#39;, &#39;Persian, Babylonian&#39;,
       &#39;Akkadian; Persian; Elamite Egyptian&#39;, &#39;Akkadian, Aramaic&#39;,
       &#39;Akkadian, Aramaic?&#39;, &#39;unclear&#39;, &#39;Sumerian, Akkadian&#39;, &#39;clay&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_lang</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_parent</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_lang</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_lang</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple langauges</span>
<span class="n">no_match_indices_lang</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;language_x&#39;</span><span class="p">])):</span>
  <span class="n">l</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">language_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="c1">#print(l)</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first language</span>
  <span class="n">first_l</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining languages (if exist) away</span>
  <span class="n">other_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertaint</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_l</span><span class="p">:</span>
    <span class="n">P155_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_l</span> <span class="o">=</span> <span class="n">first_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># add in qid and parent for the first_l</span>

  <span class="c1"># if the language has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_l</span> <span class="ow">in</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the language</span>
    <span class="n">first_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_l</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Parent</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_l</span><span class="p">)</span>
    <span class="n">first_lang_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;FG_item&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">first_lang_parent</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Parent&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the language does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_parent</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_lang</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_qid</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang_parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_parent</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;P155_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_lang</span>
<span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;other_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_lang</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">language_df</span> <span class="o">=</span> <span class="n">language_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;language_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_language_dump&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dump refers to an unnecessary column from original data&quot;</span><span class="p">)</span>
<span class="n">language_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dump refers to an unnecessary column from original data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-7-840c174fe2ce&gt;:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;first_lang&#39;] = first_lang
&lt;ipython-input-7-840c174fe2ce&gt;:47: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;first_lang_qid&#39;] = first_lang_qid
&lt;ipython-input-7-840c174fe2ce&gt;:48: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;first_lang_parent&#39;] = first_lang_parent
&lt;ipython-input-7-840c174fe2ce&gt;:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;P155_lang&#39;] = P155_lang
&lt;ipython-input-7-840c174fe2ce&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df[&#39;other_lang&#39;] = other_lang
</pre></div>
</div>
<div class="output text_html">
  <div id="df-f74d7091-84f5-43dd-a8cd-0cc7a96c026c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f74d7091-84f5-43dd-a8cd-0cc7a96c026c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f74d7091-84f5-43dd-a8cd-0cc7a96c026c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f74d7091-84f5-43dd-a8cd-0cc7a96c026c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b014dcec-a550-4aa2-818e-ba23d593e262">
  <button class="colab-df-quickchart" onclick="quickchart('df-b014dcec-a550-4aa2-818e-ba23d593e262')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b014dcec-a550-4aa2-818e-ba23d593e262 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;first_lang_qid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q471149    143362
           112936
Q471146     92054
Q500429     14673
Q500430      2702
Q500431      1107
Q393615        58
Q172951         9
Q389600         8
Q512052         6
Q389598         1
Name: first_lang_qid, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Make a separate dataframe for all CDLI texts that have a first language that matches languaes that exist in FactGrid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_language_df</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="n">matched_language_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0bd804d6-8ee9-4cfc-8f11-59949e76172e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>353278</th>
      <td>P532443</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353279</th>
      <td>P532444</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
      <td>Akkadian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353280</th>
      <td>P532445</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
      <td>Akkadian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353281</th>
      <td>P532446</td>
      <td>Akkadian</td>
      <td>Akkadian</td>
      <td>Q471146</td>
      <td>Akkadian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353282</th>
      <td>P532447</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>253980 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0bd804d6-8ee9-4cfc-8f11-59949e76172e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0bd804d6-8ee9-4cfc-8f11-59949e76172e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0bd804d6-8ee9-4cfc-8f11-59949e76172e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f74a3906-f0fb-4571-a22f-15865915b276">
  <button class="colab-df-quickchart" onclick="quickchart('df-f74a3906-f0fb-4571-a22f-15865915b276')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f74a3906-f0fb-4571-a22f-15865915b276 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>###1.2 Repeating this process for the ORACC languages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">language_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;language_y&#39;</span><span class="p">]]</span>
<span class="n">language_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a5fa6e51-30f5-423a-82f9-adbab3e7e8c1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>language_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a5fa6e51-30f5-423a-82f9-adbab3e7e8c1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a5fa6e51-30f5-423a-82f9-adbab3e7e8c1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a5fa6e51-30f5-423a-82f9-adbab3e7e8c1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-37cc1d6c-5ea1-4537-a572-3f8a8879034e">
  <button class="colab-df-quickchart" onclick="quickchart('df-37cc1d6c-5ea1-4537-a572-3f8a8879034e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-37cc1d6c-5ea1-4537-a572-3f8a8879034e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">langy</span> <span class="o">=</span> <span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;language_y&#39;</span><span class="p">]</span>
<span class="n">langy</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;undetermined&#39;, &#39;Sumerian ?&#39;, nan, &#39;Sumerian&#39;, &#39;Akkadian&#39;,
       &#39;Akkadian; Elamite&#39;, &#39;S-A bilingual&#39;, &#39;Akkadian; Sumerian&#39;,
       &#39;Akkadian (with Sumerian colophon); Akkadian&#39;,
       &#39;Akkadian (with Sumerian colophon)&#39;, &#39;Old Assyrian&#39;,
       &#39;Sumerian; Akkadian&#39;, &#39;Sumerian, Akkadian&#39;,
       &#39;Sumerian; Akkadian (with Sumerian colophon)&#39;,
       &#39;Akkadian; Sumerian; Sumerian, Akkadian&#39;,
       &#39;Sumerian; Akkadian (with Sumerian colophon); Akkadian&#39;,
       &#39;Akkadian ?&#39;, &#39;non-Sumerian (undetermined)&#39;, &#39;Eblaite&#39;,
       &#39;bilingual&#39;, &#39;non-Sumerian (Eblaite)&#39;, &#39;Syllabic Sumerian&#39;,
       &#39;Middle Assyrian&#39;, &#39;Middle Babylonian&#39;, &#39;Hurrian ?&#39;,
       &#39;Neo-Assyrian&#39;, &#39;Sumerian/Akkadian Bilingual&#39;,
       &#39;Middle Babylonian peripheral&#39;, &#39;akkadian&#39;,
       &#39;non-Sumerian (Hurrian)&#39;, &#39;Akkadan&#39;, &#39;Hittite&#39;,
       &#39;Akkadian, Aramaic&#39;, &#39;Aramaic&#39;, &#39;Bilingual&#39;, &#39;Akkadian, Aramaic?&#39;,
       &#39;Akkadian, with Aramaic epigraph&#39;, &#39;Mitanni Akkadian&#39;,
       &#39;Old Persian&#39;, &#39;Akkadian, Old Persian, Elamite&#39;,
       &#39;Old Persian, Elamite&#39;, &#39;Akkadian, Elamite, Persian&#39;, &#39;Elamite&#39;,
       &#39;Akkadian, Old Persian, Elamite,  Hieroglyphs&#39;,
       &#39;Akkadian, Old Persian&#39;,
       &#39;Akkadian, Old Persian, Elamite, Hieroglyphs&#39;,
       &#39;Akkadian, Elamite, Old Persian, Hieroglyphs&#39;,
       &#39;Akkadian, Elamite, Old Persian, Hieroglyphs?&#39;, &#39;unknown&#39;,
       &#39;Akkadian?&#39;, &#39;Akkadian, Aramaic, Luwian&#39;, &#39;Urartian&#39;,
       &#39;Urartian, Akkadian&#39;, &#39;Standard Babylonian&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_lang2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_lang_parent2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_lang2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_lang2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple langauges</span>
<span class="n">no_match_indices_lang2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;language_y&#39;</span><span class="p">])):</span>
  <span class="n">l</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">language_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="c1">#print(l)</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first language</span>
  <span class="n">first_l</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining languages (if exist) away</span>
  <span class="n">other_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertaint</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_l</span><span class="p">:</span>
    <span class="n">P155_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_l</span> <span class="o">=</span> <span class="n">first_l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># add in qid and parent for the first_l</span>

  <span class="c1"># if the language has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_l</span> <span class="ow">in</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the language</span>
    <span class="n">first_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_l</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Parent</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_l</span><span class="p">)</span>
    <span class="n">first_lang_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;FG_item&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">first_lang_parent2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lang_reference</span><span class="p">[</span><span class="s1">&#39;Parent&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the language does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_lang_parent2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_lang2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;first_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;first_lang_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_qid2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;first_lang_parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_lang_parent2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;P155_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_lang2</span>
<span class="n">language_df2</span><span class="p">[</span><span class="s1">&#39;other_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_lang2</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">language_df2</span> <span class="o">=</span> <span class="n">language_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;language_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_language_dump&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dump refers to an unnecessary column from original data&quot;</span><span class="p">)</span>
<span class="n">language_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dump refers to an unnecessary column from original data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-12-43082b19e8d2&gt;:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;first_lang&#39;] = first_lang2
&lt;ipython-input-12-43082b19e8d2&gt;:47: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;first_lang_qid&#39;] = first_lang_qid2
&lt;ipython-input-12-43082b19e8d2&gt;:48: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;first_lang_parent&#39;] = first_lang_parent2
&lt;ipython-input-12-43082b19e8d2&gt;:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;P155_lang&#39;] = P155_lang2
&lt;ipython-input-12-43082b19e8d2&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  language_df2[&#39;other_lang&#39;] = other_lang2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-7dffcb1b-82d5-4823-99e3-4e3247c616b4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7dffcb1b-82d5-4823-99e3-4e3247c616b4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7dffcb1b-82d5-4823-99e3-4e3247c616b4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7dffcb1b-82d5-4823-99e3-4e3247c616b4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c4d57376-f70e-4be5-9b5f-f3259240d4db">
  <button class="colab-df-quickchart" onclick="quickchart('df-c4d57376-f70e-4be5-9b5f-f3259240d4db')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c4d57376-f70e-4be5-9b5f-f3259240d4db button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Make a separate dataframe for all ORACC texts that have a first language that matches languaes that exist in FactGrid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_language_df2</span> <span class="o">=</span> <span class="n">language_df2</span><span class="p">[</span><span class="o">~</span><span class="n">language_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang2</span><span class="p">)]</span>
<span class="n">matched_language_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-440ebe11-258d-42fc-b016-17ced0b08da8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_language_dump</th>
      <th>first_lang</th>
      <th>first_lang_qid</th>
      <th>first_lang_parent</th>
      <th>P155_lang</th>
      <th>other_lang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Sumerian ?</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366883</th>
      <td>P512808</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366884</th>
      <td>P512821</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366885</th>
      <td>P512822</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366886</th>
      <td>P515099</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366887</th>
      <td>P521777</td>
      <td>Sumerian</td>
      <td>Sumerian</td>
      <td>Q471149</td>
      <td>Sumerian</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>133460 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-440ebe11-258d-42fc-b016-17ced0b08da8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-440ebe11-258d-42fc-b016-17ced0b08da8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-440ebe11-258d-42fc-b016-17ced0b08da8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0fbe0949-830c-46c9-abec-1483f926541b">
  <button class="colab-df-quickchart" onclick="quickchart('df-0fbe0949-830c-46c9-abec-1483f926541b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0fbe0949-830c-46c9-abec-1483f926541b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="combining-cdli-and-oracc-languages-dataframes">
<h3>1.3 Combining CDLI and ORACC Languages dataframes<a class="headerlink" href="#combining-cdli-and-oracc-languages-dataframes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">language_df</span><span class="p">,</span> <span class="n">language_df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_languages</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e22eb054-3633-488c-bb7b-5906c1efdb5a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_language_dump</th>
      <th>first_lang_x</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_parent_x</th>
      <th>P155_lang_x</th>
      <th>other_lang_x</th>
      <th>oracc_language_dump</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_y</th>
      <th>other_lang_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>undetermined</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e22eb054-3633-488c-bb7b-5906c1efdb5a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e22eb054-3633-488c-bb7b-5906c1efdb5a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e22eb054-3633-488c-bb7b-5906c1efdb5a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-67848967-6dce-48e2-88ea-a8452ce7698c">
  <button class="colab-df-quickchart" onclick="quickchart('df-67848967-6dce-48e2-88ea-a8452ce7698c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-67848967-6dce-48e2-88ea-a8452ce7698c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages_df</span> <span class="o">=</span> <span class="n">final_languages</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">,</span> <span class="s1">&#39;first_lang_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;first_lang_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;first_lang_parent_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_lang_parent_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;P155_lang_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_lang_y&#39;</span><span class="p">,</span> <span class="s1">&#39;other_lang_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_lang_y&#39;</span><span class="p">]]</span>
<span class="n">final_languages_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7b39a549-1206-4546-a54e-0b4b8a1baa06" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>first_lang_x</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_x</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_x</th>
      <th>P155_lang_y</th>
      <th>other_lang_x</th>
      <th>other_lang_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7b39a549-1206-4546-a54e-0b4b8a1baa06')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7b39a549-1206-4546-a54e-0b4b8a1baa06 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7b39a549-1206-4546-a54e-0b4b8a1baa06');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e9d8a850-0939-4d08-8223-e0976fc662e4">
  <button class="colab-df-quickchart" onclick="quickchart('df-e9d8a850-0939-4d08-8223-e0976fc662e4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e9d8a850-0939-4d08-8223-e0976fc662e4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages_df</span><span class="p">[</span><span class="s1">&#39;first_lang_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> <span class="n">final_languages_df</span><span class="p">[</span><span class="s1">&#39;first_lang_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Sumerian    143362
             112936
 Akkadian     85183
 Hittite      14673
 Eblaite       6871
 Elamite       2702
 Ugaritic      1107
 Aramaic         58
 Greek            9
 Hebrew           8
 Hurrian          6
 Arabic           1
 Name: first_lang_x, dtype: int64,
                 233456
 Sumerian        112642
 Akkadian         20540
 Eblaite            141
 Hittite             91
 Aramaic             31
 Neo-Assyrian         7
 Elamite              7
 Hurrian              1
 Name: first_lang_y, dtype: int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_languages_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_languages_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="material-material-composition-p401">
<h2>2 Material = Material Composition (P401)<a class="headerlink" href="#material-material-composition-p401" title="Link to this heading">#</a></h2>
<section id="we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id">
<h3><strong>2.1. We will only add the most basic material composition to a data frame, `material_df’, and then we match the first statement to the corresponding FactGrid Q-id.</strong><a class="headerlink" href="#we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id" title="Link to this heading">#</a></h3>
<p>We can use this CSV to obtain the corresponding FactGrid Q-id:</p>
<p><a class="reference external" href="https://drive.google.com/file/d/12FH9ao4B-U_xIwwjcSoBfOqYoBrgRaJc/view?usp=share_link">https://drive.google.com/file/d/12FH9ao4B-U_xIwwjcSoBfOqYoBrgRaJc/view?usp=share_link</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">material_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Material%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">material_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># fill na values with space</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">mat_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a1d96126-283b-4fb4-942c-9698295257d3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Material</th>
      <th>FactGrid_Label</th>
      <th>FactGrid_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>?</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>bitumen</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>bone: bone</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bone: ivory</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bone: ivory ?</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>102</th>
      <td>stone: soapstone</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>103</th>
      <td>stone: steatite</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>104</th>
      <td>stone: travertine</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>105</th>
      <td>stone: tuff</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>106</th>
      <td>stone: volcanic</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
  </tbody>
</table>
<p>107 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a1d96126-283b-4fb4-942c-9698295257d3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a1d96126-283b-4fb4-942c-9698295257d3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a1d96126-283b-4fb4-942c-9698295257d3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bc0abdbe-3ed4-4ee2-8e52-d27ce7525b2a">
  <button class="colab-df-quickchart" onclick="quickchart('df-bc0abdbe-3ed4-4ee2-8e52-d27ce7525b2a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bc0abdbe-3ed4-4ee2-8e52-d27ce7525b2a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Prepare the dictonary dataframe above for matching. Please note that the following adjustments are made based on the specific cases of this google sheet. For example, we were able to simply drop the rows with question marks because for each of those rows there is another row that provides the exact same information but for the question mark. Suppose a newer version of the google sheet does not satisfy that, the following codes need to be altered.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove entries without a FactGrid QID</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="p">[</span><span class="n">mat_reference</span><span class="p">[</span><span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># remove the entries with question marks because we will deal with uncertainty in the P155 column</span>
<span class="n">rows_to_be_removed_mat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mat_reference</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_no</span><span class="p">,</span> <span class="s1">&#39;Material&#39;</span><span class="p">]:</span>
    <span class="n">rows_to_be_removed_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row_no</span><span class="p">]</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">rows_to_be_removed_mat</span><span class="p">)</span>
<span class="c1"># make sure that no new columns are included</span>
<span class="n">mat_reference</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="p">[[</span><span class="s1">&#39;Material&#39;</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span>

<span class="n">mat_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9fb54024-ecd5-49a3-86cf-d05cf3da63cd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Material</th>
      <th>FactGrid_Label</th>
      <th>FactGrid_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bone: bone</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bone: ivory</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bone: shell</td>
      <td>Bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>4</th>
      <td>clay</td>
      <td>Clay</td>
      <td>Q471153</td>
    </tr>
    <tr>
      <th>5</th>
      <td>clay; metal: bronze; stone: steatite</td>
      <td>Clay</td>
      <td>Q471153</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>97</th>
      <td>stone: soapstone</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>98</th>
      <td>stone: steatite</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>99</th>
      <td>stone: travertine</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>100</th>
      <td>stone: tuff</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>101</th>
      <td>stone: volcanic</td>
      <td>Stone</td>
      <td>Q254907</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9fb54024-ecd5-49a3-86cf-d05cf3da63cd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9fb54024-ecd5-49a3-86cf-d05cf3da63cd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9fb54024-ecd5-49a3-86cf-d05cf3da63cd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-68c39978-c994-485d-a339-69878096f262">
  <button class="colab-df-quickchart" onclick="quickchart('df-68c39978-c994-485d-a339-69878096f262')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-68c39978-c994-485d-a339-69878096f262 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">mat_reference</span><span class="p">[[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># lower all materail label for future matching</span>
<span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We are going to move the row of metal to the very end of the dataframe. This is to ensure that brozne, copper, gold, iron, lead, and silver are searched first in the next step. FactGrid categorizes records with material e.g., <em>metal: silver</em> as silver and not metal. Hence, we want the smaller categories to come before the big category.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metal_info</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">short_mat_ref</span><span class="p">,</span> <span class="n">metal_info</span><span class="p">])</span>
<span class="c1"># reset index</span>
<span class="n">short_mat_ref</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">short_mat_ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-dcd18c2c-035a-470e-8a1f-39ae810ad00c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FactGrid_Label</th>
      <th>FactGrid_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bone</td>
      <td>Q512051</td>
    </tr>
    <tr>
      <th>1</th>
      <td>clay</td>
      <td>Q471153</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gypsum</td>
      <td>Q146565</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bronze</td>
      <td>Q512050</td>
    </tr>
    <tr>
      <th>4</th>
      <td>copper</td>
      <td>Q102059</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gold</td>
      <td>Q102068</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iron</td>
      <td>Q512047</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lead</td>
      <td>Q512048</td>
    </tr>
    <tr>
      <th>8</th>
      <td>silver</td>
      <td>Q102025</td>
    </tr>
    <tr>
      <th>9</th>
      <td>shell</td>
      <td>Q512049</td>
    </tr>
    <tr>
      <th>10</th>
      <td>stone</td>
      <td>Q254907</td>
    </tr>
    <tr>
      <th>11</th>
      <td>metal</td>
      <td>Q102057</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dcd18c2c-035a-470e-8a1f-39ae810ad00c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dcd18c2c-035a-470e-8a1f-39ae810ad00c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dcd18c2c-035a-470e-8a1f-39ae810ad00c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-06fee3ce-b60a-4b77-8f67-5148980b0bb6">
  <button class="colab-df-quickchart" onclick="quickchart('df-06fee3ce-b60a-4b77-8f67-5148980b0bb6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-06fee3ce-b60a-4b77-8f67-5148980b0bb6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id">
<h3><strong>2.2. CDLI - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong><a class="headerlink" href="#cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id" title="Link to this heading">#</a></h3>
<p>See the unique values of materials in the CDLI data dump below. There are many different entries and the data entry is not very consistent. Doing a detailed string matching using the <code class="docutils literal notranslate"><span class="pre">Material</span></code> column in the reference dataframe above would be rather troublesome. This is why we created the shorter reference dataframe with only <code class="docutils literal notranslate"><span class="pre">FactGrid_Label</span></code> and <code class="docutils literal notranslate"><span class="pre">FactGrid_Q</span></code>. We will simply see if the material entry in the CDLI data dump contain the less-than-20 big labels in the shorter reference dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mat_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;material_x&#39;</span><span class="p">]]</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material_x&#39;</span><span class="p">]</span>
<span class="n">mat</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, &#39;gypsum&#39;, &#39;stone: steatite&#39;, &#39;stone: limestone&#39;, &#39;stone&#39;,
       &#39;stone: onyx&#39;, &#39;stone: slate&#39;, &#39;stone: basalt&#39;, &#39;stone: alabaster&#39;,
       &#39;clay\x0b&#39;, &#39;stone: agate&#39;, &#39;metal: bronze&#39;, &#39;stone: granite&#39;,
       &#39;stone: agate ?&#39;, &#39;stone: diorite&#39;, &#39;stone: alabaster ?&#39;, nan,
       &#39;metal&#39;, &#39;stone: calcite&#39;, &#39;stone: marble&#39;, &#39;stone: rock crystal&#39;,
       &#39;stone: calcite ?&#39;, &#39;stone ?&#39;, &#39;bitumen&#39;, &#39;metal: copper&#39;,
       &#39;stone: dolomite&#39;, &#39;stone: haematite&#39;, &#39;bone: shell&#39;,
       &#39;stone: dolerite&#39;, &#39;metal: gold&#39;, &#39;stone: quartz&#39;,
       &#39;stone: carnelian&#39;, &#39;metal: bronze ?&#39;, &#39;clay: terracotta&#39;,
       &#39;stone: lapis lazuli&#39;, &#39;stone: serpentine&#39;, &#39;stone: hematite&#39;,
       &#39;stone: jasper&#39;, &#39;stone: greenstone&#39;, &#39;stone: schist&#39;,
       &#39;stone: crystal&#39;, &#39;stone: aragonite&#39;, &#39;stone: diorite ?&#39;,
       &#39;stone: gypsum&#39;, &#39;stone: shale&#39;, &#39;stone: limestone ?&#39;,
       &#39;stone: syenite&#39;, &#39;stone: gypsum ?&#39;, &#39;metal: silver&#39;,
       &#39;stone: hornfels&#39;, &#39;stone: porphyry&#39;, &#39;stone: lava&#39;,
       &#39;stone: chlorite&#39;, &#39;stone (newimages)&#39;, &#39;metal: copper alloy&#39;,
       &#39;stone: trachyte&#39;, &#39;stone: sandstone&#39;, &#39;stone: tuff&#39;,
       &#39;bone: shell; stone: gypsum; stone: lapis lazuli&#39;,
       &#39;metal: bronze; stone: steatite&#39;, &#39;stone: obsidian&#39;,
       &#39;stone: chalcedony ?&#39;, &#39;clay; metal: bronze; stone: steatite&#39;,
       &#39;clay; metal: bronze; stone&#39;, &#39;stone: chlorite, schist&#39;,
       &#39;metal: bronze; stone&#39;, &#39;bone: ivory&#39;, &#39;clay; metal: copper&#39;,
       &#39;stone: felsite&#39;, &#39;metal: copper; stone&#39;, &#39;stone : steatite&#39;,
       &#39;stone: slate ?&#39;, &#39;gypsum: plaster&#39;, &#39;stone: steatite ?&#39;,
       &#39;stone: dolerite, quartz &#39;, &#39;stone: limestone; metal: bronze&#39;,
       &#39;stone: diabase&#39;, &#39;Stone&#39;, &#39;stone: chalcedony&#39;, &#39;glass&#39;,
       &#39;bone: bone&#39;, &#39;stone: feldspar&#39;, &#39;stone: magnetite&#39;, &#39;clay ?&#39;,
       &#39;stone: menaccanite&#39;, &#39;shell&#39;, &#39;Glass&#39;, &#39;stone: red jasper&#39;,
       &#39;metal: silver ?&#39;, &#39;clay; gypsum: plaster&#39;, &#39;stone: gneiss&#39;,
       &#39;stone: bloodstone&#39;, &#39;clay: glazed pottery&#39;, &#39;stone: jade-like&#39;,
       &#39;stone: jade&#39;, &#39;stone: hematite ?&#39;, &#39;Stone: alabaster&#39;,
       &#39;stone: travertine&#39;, &#39;stone: flint ?&#39;, &#39;stone: jadeite&#39;,
       &#39;stone: limonite&#39;, &#39;stone: breccia&#39;, &#39;stone: quartz ?&#39;,
       &#39;stone: quartzite&#39;, &#39;stone: black&#39;, &#39;stone: marble ?&#39;,
       &#39;metal: iron&#39;, &#39;stone: white&#39;, &#39;stone: granite ?&#39;,
       &#39;clay: terra-cotta&#39;, &#39;metal: lead&#39;, &#39;stone: agate, banded &#39;,
       &#39;Metal&#39;, &#39;stone: aphrite&#39;, &#39;stone: clinochlore&#39;, &#39;bone: ivory ?&#39;,
       &#39;stone:marble&#39;, &#39;stone: nephrite&#39;, &#39;clay: ceramic&#39;,
       &#39;stone: carnelian ?&#39;, &#39;metal: copper ?&#39;, &#39;stone: sandstone ?&#39;,
       &#39;composite&#39;, &#39;stone: iron oxide&#39;,
       &#39;stone: crystal; metal: silver, gold&#39;, &#39;stone: amethyst&#39;,
       &#39;metal: electrum&#39;, &#39;stone: stalagmite&#39;, &#39;stone: ?&#39;,
       &#39;stone: sardonyx&#39;, &#39;stone ?)&#39;, &#39;stone: (black)&#39;,
       &#39;stone: chalcedony, jasper&#39;, &#39;stone: (brown)&#39;, &#39;Clay&#39;,
       &#39;metal: silver, electrum&#39;, &#39;stone: calcite/ dolomite&#39;,
       &#39;stone: lapis lazuli ?&#39;, &#39;stone: magnesite&#39;, &#39;clay: porcelain ?&#39;,
       &#39;metal: bronze or copper&#39;, &#39;stone: turquoise&#39;, &#39;stone: shell&#39;,
       &#39;stone; calcite&#39;, &#39;stone: basalt ?&#39;, &#39;stone: black serpentine&#39;,
       &#39;stone: onyx marble&#39;, &#39;stone: soapstone&#39;, &#39;stone: jasper-like&#39;,
       &#39;stone: volcanic&#39;, &#39;stone: geothite&#39;, &#39;stone:chlorite&#39;,
       &#39;stone: chlorite &#39;, &#39;stone: harmatite&#39;, &#39;stone: azurite&#39;,
       &#39;stone: jadeite ?&#39;, &#39;stone: black marble&#39;, &#39;stone: rock-crystal&#39;,
       &#39;petrified shell&#39;, &#39;stone: magnesite ?&#39;, &#39;stone: chalcedon&#39;,
       &#39;stone: chalcedon ?&#39;, &#39;stone: copper&#39;, &#39;wood; shell&#39;,
       &#39;stone: bronze&#39;, &#39;stone: sardonyx ?&#39;, &#39;ivory&#39;, &#39;stone: calcedony&#39;,
       &#39;stone: cornaline&#39;, &#39;clay: faéence ?&#39;, &#39;stone: stéatite&#39;,
       &#39;stone: hematite (?)&#39;, &#39;stone: polypier fossil&#39;, &#39;clay: faéence&#39;,
       &#39;bone&#39;, &#39;glass; blue&#39;, &#39;stone: serpentine or black steatite&#39;, &#39;?&#39;,
       &#39;stone: chakcedony&#39;, &#39;stone: dioirite&#39;, &#39;stone: hornblende&#39;,
       &#39;stone: &#39;, &#39;stone &#39;, &#39;ston&#39;, &#39;stone: jade?&#39;, &#39;stone: amazonite&#39;,
       &#39;stone: malachite&#39;, &#39;stone haematite&#39;, &#39;gold&#39;, &#39;silver&#39;,
       &#39;metal: copper; stone: lapis lazuli; shell: nacre&#39;,
       &#39;metal: copper &amp; silver&#39;, &#39;other&#39;, &#39;stone: chlorite ?&#39;,
       &#39;wood; shell; stone: red limestone: stone:  lapis lazuli; bitumen&#39;,
       &#39;stone:limestone&#39;, &#39;metal ?&#39;,
       &#39;shell: gastropod (Charonia tritonis?)&#39;, &#39;stone: green schist&#39;,
       &#39;stone: crystal quartz&#39;, &#39;composition&#39;, &#39;glass ?&#39;,
       &#39;shell: bivalve (Tridacna maxima?)&#39;, &#39;stone: glazed steatite&#39;,
       &#39;ivory ? &#39;, &#39;fossilised gastropod&#39;, &#39;stone: malachite: hematite&#39;,
       &#39;metal: copper?&#39;, &#39;shell: bivalve (tridacna maxima?)&#39;, &#39;faience&#39;,
       &#39;shell: bivalve (tridacna maxima?): lapis lazuli&#39;,
       &#39;shell: gastropod (Charonia Tritonis?)&#39;, &#39;stone: Agate&#39;,
       &#39;faience ? &#39;, &#39;diorite&#39;, &#39;faience; bronze&#39;, &#39;limestone&#39;,
       &#39;chalcedony&#39;, &#39;calcite&#39;, &#39;serpentine&#39;, &#39;soapstone&#39;, &#39;quartz&#39;,
       &#39;marble&#39;, &#39;stone; soapstone&#39;, &#39;terracotta&#39;, &#39;carnelian&#39;,
       &#39;stone; ceramic&#39;, &#39;stone; agate&#39;, &#39;stone; plaster&#39;, &#39;stone; onyx&#39;,
       &#39;stone; jasper&#39;, &#39;stone; chalcedony&#39;, &#39;stone; carnelian&#39;,
       &#39;soapstone; plaster&#39;, &#39;bone; ivory&#39;, &#39;talc&#39;, &#39;talc; schist&#39;,
       &#39;silver; plaster&#39;, &#39;sardonyx&#39;, &#39;sard&#39;, &#39;quartz crystal; gold&#39;,
       &#39;quartz crystal&#39;, &#39;jasper; chalcedony&#39;, &#39;ceramic&#39;, &#39;porphyry&#39;,
       &#39;plaster&#39;, &#39;agate&#39;, &#39;jasper&#39;, &#39;onyx&#39;, &#39;schist&#39;, &#39;obsidian&#39;,
       &#39;alabaster&#39;, &#39;lapis lazuli&#39;, &#39;iron&#39;, &#39;hematite&#39;, &#39;mica; schist&#39;,
       &#39;frit&#39;, &#39;glass; stone&#39;, &#39;garnet&#39;, &#39;faience; glass&#39;,
       &#39;faience; clay&#39;, &#39;Egyptian blue; frit&#39;, &#39;siderite&#39;,
       &#39;stone; soapstone &#39;, &#39;cuprous sulfide&#39;, &#39;crystal&#39;, &#39;copper alloy&#39;,
       &#39;serpentine; soapstone&#39;, &#39;chalcedony; plaster&#39;, &#39;plaster; stone&#39;,
       &#39;jasper; agate&#39;, &#39;chert&#39;, &#39;bronze&#39;, &#39;chalcedony; stone&#39;,
       &#39;limestone; plaster&#39;, &#39;shale&#39;, &#39;rock crystal&#39;, &#39;tuff&#39;, &#39;copper&#39;,
       &#39;hematite ?&#39;, &#39;agate ?&#39;, &#39;steatite&#39;, &#39;shell; stone ?&#39;, &#39;sandstone&#39;,
       &#39;bronze; copper&#39;, &#39;frit; glass&#39;, &#39;stone; bronze&#39;, &#39;basalt&#39;,
       &#39;chalcedony; gold&#39;, &#39;cornelian&#39;, &#39;shell; stone&#39;, &#39;lak&#39;,
       &#39;bruine stone&#39;, &#39;silver; cornelian&#39;, &#39;basanite&#39;, &#39;flint&#39;,
       &#39;hematite; metal&#39;, &#39;ophicalcite&#39;, &#39;bloodstone&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>But as usual, we need to first clean the material column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the `\x0b` pattern</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x0b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">))])</span>
<span class="c1"># there are different versions of NA, merge them into one</span>
<span class="n">mat</span><span class="p">[</span><span class="n">mat</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># lowercase all</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

<span class="c1"># update the language dataframe</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span>

<span class="c1"># check if the language dataframe has been properly cleaned</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">mat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-134-4fad14ef8bc1&gt;:9: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;material&#39;] = mat
</pre></div>
</div>
<div class="output text_html">
  <div id="df-8bf0b571-93d8-40e7-8c54-3a248dea1a06" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>material_x</th>
      <th>material</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8bf0b571-93d8-40e7-8c54-3a248dea1a06')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8bf0b571-93d8-40e7-8c54-3a248dea1a06 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8bf0b571-93d8-40e7-8c54-3a248dea1a06');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fd3efc00-2c3f-446b-a8c3-565b31cf25b7">
  <button class="colab-df-quickchart" onclick="quickchart('df-fd3efc00-2c3f-446b-a8c3-565b31cf25b7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fd3efc00-2c3f-446b-a8c3-565b31cf25b7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>add in the matched information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_label</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_mat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_mat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple materials</span>
<span class="n">no_match_indices_mat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="n">FG_existing_materials</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">])):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first material</span>
  <span class="n">first_m</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining materials (if exist) away</span>
  <span class="n">other_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
    <span class="n">P155_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_m</span> <span class="o">=</span> <span class="n">first_m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># store the original first_m for investigating finer categories later</span>
  <span class="n">first_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_m</span><span class="p">]</span>

  <span class="c1"># add in qid and label for the first_m</span>

  <span class="c1"># if the material has a QID in FactGrid</span>
  <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FG_existing_materials</span><span class="p">)):</span>
    <span class="n">material</span> <span class="o">=</span> <span class="n">FG_existing_materials</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">material</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
      <span class="n">first_mat_label</span> <span class="o">+=</span> <span class="p">[</span><span class="n">material</span><span class="p">]</span>
      <span class="n">first_mat_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">short_mat_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span>
      <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">break</span>

  <span class="c1"># if the material does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">if</span> <span class="n">matched</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">first_mat_label</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_mat_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_mat</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_label</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_qid</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;P155_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_mat</span>
<span class="n">mat_df</span><span class="p">[</span><span class="s1">&#39;other_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_mat</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">mat_df</span> <span class="o">=</span> <span class="n">mat_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;material_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_material_dump&#39;</span><span class="p">})</span>

<span class="n">mat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-135-e4148bf1cb13&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;first_mat&#39;] = first_mat
&lt;ipython-input-135-e4148bf1cb13&gt;:51: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;first_mat_label&#39;] = first_mat_label
&lt;ipython-input-135-e4148bf1cb13&gt;:52: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;first_mat_qid&#39;] = first_mat_qid
&lt;ipython-input-135-e4148bf1cb13&gt;:53: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;P155_mat&#39;] = P155_mat
&lt;ipython-input-135-e4148bf1cb13&gt;:54: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df[&#39;other_mat&#39;] = other_mat
</pre></div>
</div>
<div class="output text_html">
  <div id="df-b630cae0-a0da-4d31-92b7-de4f6b6760d8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b630cae0-a0da-4d31-92b7-de4f6b6760d8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b630cae0-a0da-4d31-92b7-de4f6b6760d8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b630cae0-a0da-4d31-92b7-de4f6b6760d8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8e3fb38a-4d89-45d8-8d1b-3ac3c9656a5e">
  <button class="colab-df-quickchart" onclick="quickchart('df-8e3fb38a-4d89-45d8-8d1b-3ac3c9656a5e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8e3fb38a-4d89-45d8-8d1b-3ac3c9656a5e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="matched-mat-df">
<h4>2.2.1 matched_mat_df<a class="headerlink" href="#matched-mat-df" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="o">~</span><span class="n">mat_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_mat</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_mat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c4030ac1-5652-4c12-a6d9-5d6923896a09" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>344220</th>
      <td>P532443</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344221</th>
      <td>P532444</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344222</th>
      <td>P532445</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344223</th>
      <td>P532446</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>344224</th>
      <td>P532447</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>344225 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c4030ac1-5652-4c12-a6d9-5d6923896a09')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c4030ac1-5652-4c12-a6d9-5d6923896a09 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c4030ac1-5652-4c12-a6d9-5d6923896a09');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fd3e1c7c-cd23-4f12-ad25-5268700ceab3">
  <button class="colab-df-quickchart" onclick="quickchart('df-fd3e1c7c-cd23-4f12-ad25-5268700ceab3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fd3e1c7c-cd23-4f12-ad25-5268700ceab3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>a little sanity check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(344225, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, &#39;gypsum&#39;, &#39;stone&#39;, &#39;bronze&#39;, &#39;metal&#39;, &#39;copper&#39;, &#39;bone&#39;,
       &#39;gold&#39;, &#39;silver&#39;, &#39;shell&#39;, &#39;iron&#39;, &#39;lead&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>finer categories</p>
<p>Now, let’s see what finer categories are there under the big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat_finer_category</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">full_mat</span> <span class="o">=</span> <span class="n">matched_mat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;first_mat&#39;</span><span class="p">]</span>
  <span class="k">if</span> <span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">full_mat</span><span class="p">:</span>
    <span class="n">finer_mat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(?&lt;=: ).*&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">full_mat</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove the parenthesis</span>
    <span class="n">finer_mat</span> <span class="o">=</span> <span class="n">finer_mat</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># remove the space at the end of the string, if any</span>
    <span class="n">finer_mat</span> <span class="o">=</span> <span class="n">finer_mat</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># check if this is a big label</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">finer_mat</span> <span class="ow">in</span> <span class="n">FG_existing_materials</span><span class="p">:</span>
      <span class="n">first_mat_finer_category</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finer_mat</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">first_mat_finer_category</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_mat_finer_category</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

<span class="n">matched_mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_finer_category</span>

<span class="n">matched_mat_df</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;&#39;, &#39;steatite&#39;, &#39;limestone&#39;, &#39;onyx&#39;, &#39;slate&#39;, &#39;basalt&#39;,
       &#39;alabaster&#39;, &#39;agate&#39;, &#39;granite&#39;, &#39;diorite&#39;, &#39;calcite&#39;, &#39;marble&#39;,
       &#39;rock crystal&#39;, &#39;dolomite&#39;, &#39;haematite&#39;, &#39;dolerite&#39;, &#39;quartz&#39;,
       &#39;carnelian&#39;, &#39;terracotta&#39;, &#39;lapis lazuli&#39;, &#39;serpentine&#39;,
       &#39;hematite&#39;, &#39;jasper&#39;, &#39;greenstone&#39;, &#39;schist&#39;, &#39;crystal&#39;,
       &#39;aragonite&#39;, &#39;shale&#39;, &#39;syenite&#39;, &#39;hornfels&#39;, &#39;porphyry&#39;, &#39;lava&#39;,
       &#39;chlorite&#39;, &#39;copper alloy&#39;, &#39;trachyte&#39;, &#39;sandstone&#39;, &#39;tuff&#39;,
       &#39;obsidian&#39;, &#39;chalcedony&#39;, &#39;ivory&#39;, &#39;felsite&#39;, &#39;plaster&#39;, &#39;diabase&#39;,
       &#39;feldspar&#39;, &#39;magnetite&#39;, &#39;menaccanite&#39;, &#39;red jasper&#39;, &#39;gneiss&#39;,
       &#39;bloodstone&#39;, &#39;glazed pottery&#39;, &#39;jade-like&#39;, &#39;jade&#39;, &#39;travertine&#39;,
       &#39;flint&#39;, &#39;jadeite&#39;, &#39;limonite&#39;, &#39;breccia&#39;, &#39;quartzite&#39;, &#39;black&#39;,
       &#39;white&#39;, &#39;terra-cotta&#39;, &#39;aphrite&#39;, &#39;clinochlore&#39;, &#39;nephrite&#39;,
       &#39;ceramic&#39;, &#39;iron oxide&#39;, &#39;amethyst&#39;, &#39;electrum&#39;, &#39;stalagmite&#39;,
       &#39;sardonyx&#39;, &#39;brown&#39;, &#39;calcite/ dolomite&#39;, &#39;magnesite&#39;, &#39;porcelain&#39;,
       &#39;bronze or copper&#39;, &#39;turquoise&#39;, &#39;black serpentine&#39;, &#39;onyx marble&#39;,
       &#39;soapstone&#39;, &#39;jasper-like&#39;, &#39;volcanic&#39;, &#39;geothite&#39;, &#39;harmatite&#39;,
       &#39;azurite&#39;, &#39;black marble&#39;, &#39;rock-crystal&#39;, &#39;chalcedon&#39;,
       &#39;calcedony&#39;, &#39;cornaline&#39;, &#39;faéence&#39;, &#39;stéatite&#39;, &#39;polypier fossil&#39;,
       &#39;serpentine or black steatite&#39;, &#39;chakcedony&#39;, &#39;dioirite&#39;,
       &#39;hornblende&#39;, &#39;amazonite&#39;, &#39;malachite&#39;, &#39;copper &amp; silver&#39;,
       &#39;gastropod charonia tritonis&#39;, &#39;green schist&#39;, &#39;crystal quartz&#39;,
       &#39;bivalve tridacna maxima&#39;, &#39;glazed steatite&#39;,
       &#39;malachite: hematite&#39;, &#39;bivalve tridacna maxima: lapis lazuli&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-mat-df">
<h4>2.2.2 no_match_mat_df<a class="headerlink" href="#no-match-mat-df" title="Link to this heading">#</a></h4>
<p>Make a separate dataframe of the items not matched for export and supervision: <code class="docutils literal notranslate"><span class="pre">no_material_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat</span><span class="p">]</span>
<span class="n">no_match_mat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9eed96c0-2809-4ca7-8262-27da7099f042" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>designation_x</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
      <th>designation_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64452</th>
      <td>NaN</td>
      <td>P213226</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>NaN</td>
      <td>unlocated</td>
      <td>unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical cylinder seal</td>
      <td>no translation</td>
      <td>CDLI Seals 000602 (physical)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>66843</th>
      <td>needed</td>
      <td>P215652</td>
      <td>NaN</td>
      <td>other (see object remarks)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>NaN</td>
      <td>Louvre Museum, Paris, France</td>
      <td>Sb 00055; AS 12801</td>
      <td>Susa (mod. Shush)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal/Monumental</td>
      <td>witness</td>
      <td>no translation</td>
      <td>MDP 14, 007-016 pl. 1-2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>66963</th>
      <td>NaN</td>
      <td>P215773</td>
      <td>Sumerian</td>
      <td>other (see object remarks)</td>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>NaN</td>
      <td>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri,...</td>
      <td>Ist EŞEM 00501</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Private/Votive</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NABU 1997/052</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67555</th>
      <td>Q001445</td>
      <td>P216380</td>
      <td>NaN</td>
      <td>other (see object remarks)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>bitumen</td>
      <td>Louvre Museum, Paris, France</td>
      <td>AO 04798</td>
      <td>Umma (mod. Tell Jokha)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Shurush-kin.00.00.00</td>
      <td>Shurush-kin.00.00.00</td>
      <td>Royal/Monumental</td>
      <td>witness</td>
      <td>no translation</td>
      <td>RIME 2.11.05.01, ex. 01</td>
      <td>Sumerian</td>
      <td>bitumen</td>
      <td>tenon</td>
      <td>Old Akkadian</td>
      <td>Tell Jokha (Umma)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal Inscription</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Louvre Museum, Paris, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIT</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P216380</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>RIME 2.11.05.01, ex. 01</td>
    </tr>
    <tr>
      <th>67624</th>
      <td>Q000837</td>
      <td>P216458</td>
      <td>NaN</td>
      <td>other (see object remarks)</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>NaN</td>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>CBS 08863a</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Rimush.00.00.00</td>
      <td>Rimush.00.00.00</td>
      <td>Royal/Monumental</td>
      <td>witness</td>
      <td>no translation</td>
      <td>RIME 2.01.02.11, ex. 21</td>
      <td>Akkadian</td>
      <td>stone</td>
      <td>vase</td>
      <td>Old Akkadian</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal Inscription</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIT</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P216458</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>RIME 2.01.02.11, ex. 21</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9eed96c0-2809-4ca7-8262-27da7099f042')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9eed96c0-2809-4ca7-8262-27da7099f042 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9eed96c0-2809-4ca7-8262-27da7099f042');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-811fe441-60eb-459b-b1a1-c9431b4bda03">
  <button class="colab-df-quickchart" onclick="quickchart('df-811fe441-60eb-459b-b1a1-c9431b4bda03')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-811fe441-60eb-459b-b1a1-c9431b4bda03 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(22691, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization-of-cdli-materials">
<h4>2.2.3 Visualization of CDLI Materials<a class="headerlink" href="#visualization-of-cdli-materials" title="Link to this heading">#</a></h4>
</section>
<section id="distribution-of-matched-first-materials">
<h4>Distribution of matched first materials<a class="headerlink" href="#distribution-of-matched-first-materials" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_m_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_m_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_m_df</span> <span class="o">=</span> <span class="n">first_m_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_label&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_m_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fbc85cd5-5192-4a79-8ed0-cbc135cbb7fa" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>clay</td>
      <td>324611</td>
    </tr>
    <tr>
      <th>11</th>
      <td>stone</td>
      <td>18656</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bronze</td>
      <td>315</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bone</td>
      <td>217</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gypsum</td>
      <td>171</td>
    </tr>
    <tr>
      <th>9</th>
      <td>shell</td>
      <td>77</td>
    </tr>
    <tr>
      <th>3</th>
      <td>copper</td>
      <td>71</td>
    </tr>
    <tr>
      <th>10</th>
      <td>silver</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gold</td>
      <td>31</td>
    </tr>
    <tr>
      <th>8</th>
      <td>metal</td>
      <td>22</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lead</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iron</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fbc85cd5-5192-4a79-8ed0-cbc135cbb7fa')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fbc85cd5-5192-4a79-8ed0-cbc135cbb7fa button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fbc85cd5-5192-4a79-8ed0-cbc135cbb7fa');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-290f82c8-87cc-493c-bdb6-5f28ced9d5ff">
  <button class="colab-df-quickchart" onclick="quickchart('df-290f82c8-87cc-493c-bdb6-5f28ced9d5ff')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-290f82c8-87cc-493c-bdb6-5f28ced9d5ff button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_m_df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;First Material Used in Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of First Materials on Tablets that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0bd67b929bcbacb7d3a3c1c810e3421c32045b6fed1c73e96cddb1540bf5bc98.png" src="_images/0bd67b929bcbacb7d3a3c1c810e3421c32045b6fed1c73e96cddb1540bf5bc98.png" />
</div>
</div>
</section>
<section id="distribution-of-finer-categories-within-matched-materials">
<h4>Distribution of finer categories within matched materials<a class="headerlink" href="#distribution-of-finer-categories-within-matched-materials" title="Link to this heading">#</a></h4>
<p>We have recorded the big material labels for the matched tablets. The graph below summarizes the finer categories within those big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">finer_cat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">finer_cat_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">finer_cat_df</span> <span class="o">=</span> <span class="n">finer_cat_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">finer_cat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finer_cat_df</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">)</span>
<span class="n">finer_cat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0b42fb29-873b-4482-bf35-f45bcc844b7b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>undetermined</td>
      <td>340133</td>
    </tr>
    <tr>
      <th>65</th>
      <td>limestone</td>
      <td>1068</td>
    </tr>
    <tr>
      <th>63</th>
      <td>lapis lazuli</td>
      <td>270</td>
    </tr>
    <tr>
      <th>2</th>
      <td>alabaster</td>
      <td>257</td>
    </tr>
    <tr>
      <th>35</th>
      <td>diorite</td>
      <td>250</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>78</th>
      <td>polypier fossil</td>
      <td>1</td>
    </tr>
    <tr>
      <th>79</th>
      <td>porcelain</td>
      <td>1</td>
    </tr>
    <tr>
      <th>80</th>
      <td>porphyry</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>azurite</td>
      <td>1</td>
    </tr>
    <tr>
      <th>105</th>
      <td>white</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>106 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0b42fb29-873b-4482-bf35-f45bcc844b7b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0b42fb29-873b-4482-bf35-f45bcc844b7b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0b42fb29-873b-4482-bf35-f45bcc844b7b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8ab6dae1-2fb9-44c6-9d94-4132e972ab72">
  <button class="colab-df-quickchart" onclick="quickchart('df-8ab6dae1-2fb9-44c6-9d94-4132e972ab72')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8ab6dae1-2fb9-44c6-9d94-4132e972ab72 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Note that there are unproportionately the most records that have NA value for their material. Since the purpose of this plot is to determine which labels to add into FactGrid, we will exclude the undetermined ones when we plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">finer_cat_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1150</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Sub-Category of First Materials on Tablets that Matched FactGrid Records</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23c41b36583a2eed9aa02d719f593b0ca81cd7def4092346c5d05de453c67cbe.png" src="_images/23c41b36583a2eed9aa02d719f593b0ca81cd7def4092346c5d05de453c67cbe.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-materials">
<h4>Distribution of unmatched materials<a class="headerlink" href="#distribution-of-unmatched-materials" title="Link to this heading">#</a></h4>
<p>Select the top 10 of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_mats</span> <span class="o">=</span> <span class="n">mat_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat</span><span class="p">][</span><span class="s1">&#39;cdli_material_dump&#39;</span><span class="p">]</span>
<span class="n">unmatched_mats_clean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">unmatched_mats</span><span class="p">:</span>
  <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-language statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_mats_clean</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_mats_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_mats_clean</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_mats_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;nan&#39;, &#39;bitumen&#39;, &#39;glass&#39;, &#39;Glass&#39;, &#39;composite&#39;, &#39;wood&#39;, &#39;shell&#39;,
       &#39;ivory&#39;, &#39;blue&#39;, &#39;?&#39;, &#39;ston&#39;, &#39;other&#39;,
       &#39;stone: red limestone: stone:  lapis lazuli&#39;, &#39;composition&#39;,
       &#39;fossilised gastropod&#39;, &#39;faience&#39;, &#39;diorite&#39;, &#39;bronze&#39;,
       &#39;chalcedony&#39;, &#39;calcite&#39;, &#39;serpentine&#39;, &#39;quartz&#39;, &#39;marble&#39;,
       &#39;terracotta&#39;, &#39;carnelian&#39;, &#39;talc&#39;, &#39;schist&#39;, &#39;sardonyx&#39;, &#39;sard&#39;,
       &#39;quartz crystal&#39;, &#39;gold&#39;, &#39;jasper&#39;, &#39;ceramic&#39;, &#39;porphyry&#39;,
       &#39;plaster&#39;, &#39;agate&#39;, &#39;onyx&#39;, &#39;obsidian&#39;, &#39;alabaster&#39;,
       &#39;lapis lazuli&#39;, &#39;hematite&#39;, &#39;mica&#39;, &#39;frit&#39;, &#39;stone&#39;, &#39;garnet&#39;,
       &#39;clay&#39;, &#39;Egyptian blue&#39;, &#39;siderite&#39;, &#39;cuprous sulfide&#39;, &#39;crystal&#39;,
       &#39;soapstone&#39;, &#39;chert&#39;, &#39;shale&#39;, &#39;rock crystal&#39;, &#39;tuff&#39;, &#39;steatite&#39;,
       &#39;basalt&#39;, &#39;cornelian&#39;, &#39;lak&#39;, &#39;basanite&#39;, &#39;flint&#39;, &#39;metal&#39;,
       &#39;ophicalcite&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d_mat</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_mats_clean</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_mat_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d_mat</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">unmatched_mat_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-957d6e60-520d-4100-8025-788d5d7dcd76" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>18367</td>
    </tr>
    <tr>
      <th>1</th>
      <td>composite</td>
      <td>3598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>serpentine</td>
      <td>141</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chalcedony</td>
      <td>86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>hematite</td>
      <td>71</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58</th>
      <td>composition</td>
      <td>1</td>
    </tr>
    <tr>
      <th>59</th>
      <td>stone: red limestone: stone:  lapis lazuli</td>
      <td>1</td>
    </tr>
    <tr>
      <th>60</th>
      <td>other</td>
      <td>1</td>
    </tr>
    <tr>
      <th>61</th>
      <td>ston</td>
      <td>1</td>
    </tr>
    <tr>
      <th>62</th>
      <td>ophicalcite</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-957d6e60-520d-4100-8025-788d5d7dcd76')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-957d6e60-520d-4100-8025-788d5d7dcd76 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-957d6e60-520d-4100-8025-788d5d7dcd76');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-aa2a5392-93f2-4d42-afa7-38a0416a3471">
  <button class="colab-df-quickchart" onclick="quickchart('df-aa2a5392-93f2-4d42-afa7-38a0416a3471')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-aa2a5392-93f2-4d42-afa7-38a0416a3471 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_mat_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3900</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Material Labels of the Tablets not in FactGrid</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9be8b9869e97849c75a0161341e1ff8cd11a79238d2107ab6137adb976e3beb.png" src="_images/b9be8b9869e97849c75a0161341e1ff8cd11a79238d2107ab6137adb976e3beb.png" />
</div>
</div>
</section>
<section id="what-materials-are-tablets-that-have-languages-on-them-made-of">
<h4>What materials are tablets that have languages on them made of?<a class="headerlink" href="#what-materials-are-tablets-that-have-languages-on-them-made-of" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># slice the matched_mat_df with no_match_indices_lang</span>
<span class="n">lang_mat_matched_df</span> <span class="o">=</span> <span class="n">mat_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="c1"># count the materials and create a df for the material with corresponding count</span>
<span class="n">lang_mat_matched_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lang_mat_matched_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="c1"># rename the columns</span>
<span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_mat_matched_counts</span> <span class="o">=</span> <span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># sort the rows by count</span>
<span class="n">lang_mat_matched_counts</span> <span class="o">=</span> <span class="n">lang_mat_matched_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">lang_mat_matched_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9e145de8-c41e-4368-93ab-8d10a7a239b7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_mat_label</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>clay</td>
      <td>239720</td>
    </tr>
    <tr>
      <th>12</th>
      <td>stone</td>
      <td>10375</td>
    </tr>
    <tr>
      <th>0</th>
      <td></td>
      <td>3473</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bronze</td>
      <td>228</td>
    </tr>
    <tr>
      <th>6</th>
      <td>gypsum</td>
      <td>63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>copper</td>
      <td>41</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gold</td>
      <td>26</td>
    </tr>
    <tr>
      <th>11</th>
      <td>silver</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bone</td>
      <td>12</td>
    </tr>
    <tr>
      <th>9</th>
      <td>metal</td>
      <td>11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lead</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>shell</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>iron</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e145de8-c41e-4368-93ab-8d10a7a239b7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e145de8-c41e-4368-93ab-8d10a7a239b7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e145de8-c41e-4368-93ab-8d10a7a239b7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-60548cca-1fdb-42a6-8486-4de9f3167195">
  <button class="colab-df-quickchart" onclick="quickchart('df-60548cca-1fdb-42a6-8486-4de9f3167195')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-60548cca-1fdb-42a6-8486-4de9f3167195 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">lang_mat_matched_counts</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_mat_label&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">262000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First Material Labels Tablets that Have Matched First Languages Are Made Of&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8dd271d2255d8174cec74bd72ee335a8f02d9d027180b961b95fe39a62b7e451.png" src="_images/8dd271d2255d8174cec74bd72ee335a8f02d9d027180b961b95fe39a62b7e451.png" />
</div>
</div>
</section>
</section>
<section id="oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id">
<h3><strong>2.3. ORACC - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong><a class="headerlink" href="#oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mat_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;material_y&#39;</span><span class="p">]]</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material_y&#39;</span><span class="p">]</span>
<span class="n">mat2</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, nan, &#39;stone: limestone&#39;, &#39;metal: bronze&#39;, &#39;stone&#39;,
       &#39;stone: granite&#39;, &#39;stone: calcite&#39;, &#39;stone: alabaster&#39;,
       &#39;stone: diorite&#39;, &#39;bitumen&#39;, &#39;stone: marble&#39;, &#39;metal&#39;,
       &#39;metal: copper&#39;, &#39;stone: dolomite&#39;, &#39;stone: steatite&#39;,
       &#39;stone: haematite&#39;, &#39;bone: shell&#39;, &#39;stone: dolerite&#39;,
       &#39;stone: slate&#39;, &#39;metal: gold&#39;, &#39;stone: carnelian&#39;,
       &#39;clay: terracotta&#39;, &#39;stone: onyx&#39;, &#39;stone: basalt&#39;,
       &#39;stone: schist&#39;, &#39;stone: aragonite&#39;, &#39;stone: gypsum&#39;,
       &#39;metal: silver&#39;, &#39;stone: hornfels&#39;, &#39;stone: porphyry&#39;,
       &#39;stone: lava&#39;, &#39;stone: chlorite&#39;, &#39;stone: lapis lazuli&#39;,
       &#39;stone: trachyte&#39;, &#39;stone: sandstone&#39;, &#39;stone: tuff&#39;,
       &#39;stone: agate&#39;, &#39;bone: shell; stone: gypsum, lapis lazuli&#39;,
       &#39;metal: bronze; stone: steatite&#39;, &#39;stone: obsidian&#39;,
       &#39;stone: chalcedony&#39;, &#39;clay; metal: bronze; stone: steatite&#39;,
       &#39;clay; metal: bronze; stone&#39;, &#39;stone: chlorite, schist&#39;,
       &#39;bone: ivory&#39;, &#39;clay; metal: copper&#39;, &#39;stone: felsite&#39;,
       &#39;metal: copper; stone&#39;, &#39;gypsum: plaster&#39;,
       &#39;stone: dolerite, quartz&#39;, &#39;stone: limestone; metal: bronze&#39;,
       &#39;stone: diabase&#39;, &#39;stone: serpentine&#39;, &#39;stone: hematite&#39;, &#39;Clay&#39;,
       &#39;glass&#39;, &#39;stone: feldspar&#39;, &#39;stone: magnetite&#39;, &#39;Stone&#39;,
       &#39;clay; gypsum: plaster&#39;, &#39;stone: travertine&#39;, &#39;stone:marble&#39;,
       &#39;stone: crystal; metal: silver, gold&#39;, &#39;composite&#39;,
       &#39;stone: amethyst&#39;, &#39;metal: electrum&#39;, &#39;stone: banded-agate&#39;,
       &#39;stone: agate or onyx&#39;, &#39;stone: stalagmite&#39;, &#39;metal: lead&#39;,
       &#39;stone: magnesite&#39;, &#39;stone: cornelian&#39;, &#39;stone: porcelain&#39;,
       &#39;metal: bronze or copper&#39;, &#39;stone: turquoise&#39;, &#39;stone: breccia&#39;,
       &#39;metal: iron&#39;, &#39;stone: jadeite&#39;, &#39;metal: bronze; stone&#39;,
       &#39;stone: copper&#39;, &#39;stone: greenstone&#39;, &#39;metal: copper, silver&#39;,
       &#39;stone: alabaster, clay&#39;, &#39;stone, clay&#39;, &#39;clay (original: stone)&#39;,
       &#39;clay, stone&#39;, &#39;stone: limestone, obsisian&#39;, &#39;clay; metal: bronze&#39;,
       &#39;stone: diorite, limestone&#39;, &#39;clay; stone: limestone, diorite&#39;,
       &#39;stone; stone: diorite, metal: bronze; clay&#39;,
       &#39;stone: limestone; clay&#39;, &#39;clay; stone: limestone&#39;,
       &#39;stone: marble, steatite&#39;, &#39;clay; stone; metal: bronze&#39;,
       &#39;metal: bronze; stone: steatite or basalt&#39;,
       &#39;stone; stone: limestone&#39;, &#39;metal: copper, stone: steatite&#39;,
       &#39;stone: steatite  or diorite; metal: bronze&#39;,
       &#39;metal: copper, stone&#39;,
       &#39;clay; metal: copper, bronze, iron; stone; wood&#39;,
       &#39;stone: diorite, basalt, granite&#39;,
       &#39;stone: diorite, granite, limestone&#39;, &#39;stone; metal: bronze&#39;,
       &#39;stone: lapis lazuli, schist, steatite; metal: bronze&#39;,
       &#39;stone: diorite, granite&#39;, &#39;stone: alabaster, steatite&#39;,
       &#39;stone: mother of pearl&#39;, &#39;stone: alabaster; metal: copper; clay&#39;,
       &#39;metal: copper or bronze&#39;, &#39;stone: syenite&#39;,
       &#39;clay; stone; metal: copper&#39;, &#39;stone: steatite or basalt&#39;,
       &#39;stone: pumice&#39;, &#39;metal: copper, gold&#39;,
       &#39;stone: marble; metal: copper&#39;, &#39;stone; stone: diorite&#39;,
       &#39;stone: calcite or aragonite&#39;, &#39;clay; stone; stone: limestone&#39;,
       &#39;stone: granite or diorite&#39;, &#39;stone: gmarble&#39;,
       &#39;stone: calcite stalagmite&#39;, &#39;stone: greenstone schist&#39;,
       &#39;bituminous substance&#39;, &#39;stone: shell&#39;, &#39;stone: marbe&#39;,
       &#39;stone: alabaster or paragonite&#39;, &#39;stone: diorite or gabbro&#39;,
       &#39;stone: uralite-quartz-dolerite&#39;, &#39;stone: soapstone&#39;,
       &#39;stone: basic hornfels&#39;, &#39;ivory&#39;, &#39;stone: jasper&#39;, &#39;stone: cacite&#39;,
       &#39;stone: chalcedon, agate&#39;, &#39;metal: copper; clay&#39;,
       &#39;metal: copper, stone: soapstone&#39;, &#39;clay; stone: steatite&#39;,
       &#39;metal: copper; stone; clay&#39;, &#39;stone: hornblende-diorite&#39;,
       &#39;stone: limestone; metal: bronze, copper&#39;, &#39;stone: diorite; clay&#39;,
       &#39;unknown&#39;, &#39;stone: stalagmitic calcite&#39;, &#39;stone; bone (ivory)&#39;,
       &#39;stone: slate or shale&#39;, &#39;stone: calcite, limestone&#39;,
       &#39;clay, stone, metal&#39;, &#39;clay, metal&#39;, &#39;stone, metal&#39;,
       &#39;glass; stone: alabaster, calcite, yellow calcite (or alabaster)&#39;,
       &#39;stone: &quot;marble&quot;&#39;, &#39;stone: calcite, onyx&#39;, &#39;bone&#39;, &#39;rock&#39;,
       &#39;stone ?&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>But as usual, we need to first clean the material column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the `\x0b` pattern</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x0b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mat2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat2</span><span class="p">))])</span>
<span class="c1"># there are different versions of NA, merge them into one</span>
<span class="n">mat2</span><span class="p">[</span><span class="n">mat2</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># lowercase all</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">mat2</span><span class="p">)</span>

<span class="c1"># update the language dataframe</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat2</span>

<span class="c1"># check if the language dataframe has been properly cleaned</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-153-164a5d10a9fc&gt;:9: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;material&#39;] = mat2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-fe924e01-bb6c-44a2-9124-91904f8413c2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>material_y</th>
      <th>material</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fe924e01-bb6c-44a2-9124-91904f8413c2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fe924e01-bb6c-44a2-9124-91904f8413c2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fe924e01-bb6c-44a2-9124-91904f8413c2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1ac1a3cd-3986-4ec7-908e-80fc83fdd47c">
  <button class="colab-df-quickchart" onclick="quickchart('df-1ac1a3cd-3986-4ec7-908e-80fc83fdd47c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1ac1a3cd-3986-4ec7-908e-80fc83fdd47c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>add in the matched information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_label2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">first_mat_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_mat2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_mat2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when multiple materials</span>
<span class="n">no_match_indices_mat2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>

<span class="n">FG_existing_materials</span> <span class="o">=</span> <span class="n">short_mat_ref</span><span class="p">[</span><span class="s1">&#39;FactGrid_Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">])):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># remove the space in every entry and split it by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first material</span>
  <span class="n">first_m</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># store the remaining materials (if exist) away</span>
  <span class="n">other_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
    <span class="n">P155_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_m</span> <span class="o">=</span> <span class="n">first_m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

  <span class="c1"># store the original first_m for investigating finer categories later</span>
  <span class="n">first_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_m</span><span class="p">]</span>

  <span class="c1"># add in qid and label for the first_m</span>

  <span class="c1"># if the material has a QID in FactGrid</span>
  <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FG_existing_materials</span><span class="p">)):</span>
    <span class="n">material</span> <span class="o">=</span> <span class="n">FG_existing_materials</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">material</span> <span class="ow">in</span> <span class="n">first_m</span><span class="p">:</span>
      <span class="n">first_mat_label2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">material</span><span class="p">]</span>
      <span class="n">first_mat_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">short_mat_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;FactGrid_Q&#39;</span><span class="p">]]</span>
      <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">break</span>

  <span class="c1"># if the material does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">if</span> <span class="n">matched</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">first_mat_label2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">first_mat_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_mat2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># append these columns to the dataframe</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_label2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_qid2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;P155_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_mat2</span>
<span class="n">mat_df2</span><span class="p">[</span><span class="s1">&#39;other_mat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_mat2</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">mat_df2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;material_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_material_dump&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dump refers to an unnecessary column from original data&quot;</span><span class="p">)</span>
<span class="n">mat_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dump refers to an unnecessary column from original data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-154-0bdd50b0964a&gt;:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;first_mat&#39;] = first_mat2
&lt;ipython-input-154-0bdd50b0964a&gt;:51: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;first_mat_label&#39;] = first_mat_label2
&lt;ipython-input-154-0bdd50b0964a&gt;:52: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;first_mat_qid&#39;] = first_mat_qid2
&lt;ipython-input-154-0bdd50b0964a&gt;:53: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;P155_mat&#39;] = P155_mat2
&lt;ipython-input-154-0bdd50b0964a&gt;:54: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mat_df2[&#39;other_mat&#39;] = other_mat2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-7dc7356c-d039-40ad-91fa-e43f13284971" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7dc7356c-d039-40ad-91fa-e43f13284971')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7dc7356c-d039-40ad-91fa-e43f13284971 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7dc7356c-d039-40ad-91fa-e43f13284971');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-03ca8c31-2b12-451e-a835-42186f7b28e9">
  <button class="colab-df-quickchart" onclick="quickchart('df-03ca8c31-2b12-451e-a835-42186f7b28e9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-03ca8c31-2b12-451e-a835-42186f7b28e9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="matched-mat-df2">
<h4>2.3.1 matched_mat_df2<a class="headerlink" href="#matched-mat-df2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="p">[</span><span class="o">~</span><span class="n">mat_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_mat2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-24ad28da-5849-40ad-800d-e0232c7d4d22" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-24ad28da-5849-40ad-800d-e0232c7d4d22')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-24ad28da-5849-40ad-800d-e0232c7d4d22 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-24ad28da-5849-40ad-800d-e0232c7d4d22');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1d999292-172a-4b77-a4cd-5039ea95ebbd">
  <button class="colab-df-quickchart" onclick="quickchart('df-1d999292-172a-4b77-a4cd-5039ea95ebbd')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1d999292-172a-4b77-a4cd-5039ea95ebbd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>a little sanity check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(47260, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;clay&#39;, &#39;stone&#39;, &#39;bronze&#39;, &#39;metal&#39;, &#39;copper&#39;, &#39;bone&#39;, &#39;gold&#39;,
       &#39;gypsum&#39;, &#39;silver&#39;, &#39;lead&#39;, &#39;iron&#39;, &#39;shell&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>finer categories</p>
<p>Now, let’s see what finer categories are there under the big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_mat_finer_category2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">full_mat2</span> <span class="o">=</span> <span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;first_mat&#39;</span><span class="p">]</span>
  <span class="k">if</span> <span class="s1">&#39;: &#39;</span> <span class="ow">in</span> <span class="n">full_mat2</span><span class="p">:</span>
    <span class="n">finer_mat2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(?&lt;=: ).*&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">full_mat2</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove the parenthesis</span>
    <span class="n">finer_mat2</span> <span class="o">=</span> <span class="n">finer_mat2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># remove the space at the end of the string, if any</span>
    <span class="n">finer_mat2</span> <span class="o">=</span> <span class="n">finer_mat2</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># check if this is a big label</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">finer_mat2</span> <span class="ow">in</span> <span class="n">FG_existing_materials</span><span class="p">:</span>
      <span class="n">first_mat_finer_category2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finer_mat2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">first_mat_finer_category2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">first_mat_finer_category2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

<span class="n">matched_mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_mat_finer_category2</span>

<span class="n">matched_mat_df2</span><span class="p">[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;&#39;, &#39;limestone&#39;, &#39;granite&#39;, &#39;calcite&#39;, &#39;alabaster&#39;, &#39;diorite&#39;,
       &#39;marble&#39;, &#39;dolomite&#39;, &#39;steatite&#39;, &#39;haematite&#39;, &#39;dolerite&#39;, &#39;slate&#39;,
       &#39;carnelian&#39;, &#39;terracotta&#39;, &#39;onyx&#39;, &#39;basalt&#39;, &#39;schist&#39;, &#39;aragonite&#39;,
       &#39;hornfels&#39;, &#39;porphyry&#39;, &#39;lava&#39;, &#39;chlorite&#39;, &#39;lapis lazuli&#39;,
       &#39;trachyte&#39;, &#39;sandstone&#39;, &#39;tuff&#39;, &#39;agate&#39;, &#39;obsidian&#39;, &#39;chalcedony&#39;,
       &#39;ivory&#39;, &#39;felsite&#39;, &#39;plaster&#39;, &#39;diabase&#39;, &#39;serpentine&#39;, &#39;hematite&#39;,
       &#39;feldspar&#39;, &#39;magnetite&#39;, &#39;travertine&#39;, &#39;crystal&#39;, &#39;amethyst&#39;,
       &#39;electrum&#39;, &#39;banded-agate&#39;, &#39;agate or onyx&#39;, &#39;stalagmite&#39;,
       &#39;magnesite&#39;, &#39;cornelian&#39;, &#39;porcelain&#39;, &#39;bronze or copper&#39;,
       &#39;turquoise&#39;, &#39;breccia&#39;, &#39;jadeite&#39;, &#39;greenstone&#39;,
       &#39;steatite  or diorite&#39;, &#39;mother of pearl&#39;, &#39;copper or bronze&#39;,
       &#39;syenite&#39;, &#39;steatite or basalt&#39;, &#39;pumice&#39;, &#39;calcite or aragonite&#39;,
       &#39;granite or diorite&#39;, &#39;gmarble&#39;, &#39;calcite stalagmite&#39;,
       &#39;greenstone schist&#39;, &#39;marbe&#39;, &#39;alabaster or paragonite&#39;,
       &#39;diorite or gabbro&#39;, &#39;uralite-quartz-dolerite&#39;, &#39;soapstone&#39;,
       &#39;basic hornfels&#39;, &#39;jasper&#39;, &#39;cacite&#39;, &#39;chalcedon&#39;,
       &#39;hornblende-diorite&#39;, &#39;stalagmitic calcite&#39;, &#39;slate or shale&#39;,
       &#39;&quot;marble&quot;&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-mat-df2">
<h4>2.3.2 no_match_mat_df2<a class="headerlink" href="#no-match-mat-df2" title="Link to this heading">#</a></h4>
<p>Make a separate dataframe of the items not matched for export and supervision: <code class="docutils literal notranslate"><span class="pre">no_material_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat2</span><span class="p">]</span>
<span class="n">no_match_mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ecfc44fa-7702-49b6-93a6-a56a52cb2988" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>designation_x</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
      <th>designation_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>669</th>
      <td>NaN</td>
      <td>P000730</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15316</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,1</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>ATU 5, pl. 001, W 1872,1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>670</th>
      <td>NaN</td>
      <td>P000731</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15315</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,2</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>ATU 5, pl. 001, W 1872,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>671</th>
      <td>NaN</td>
      <td>P000732</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15345</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02134</td>
      <td>?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>ATU 5, pl. 001, W 2134</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>672</th>
      <td>NaN</td>
      <td>P000733</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15289</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02352</td>
      <td>Oc XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>ATU 5, pl. 001, W 2352</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>673</th>
      <td>NaN</td>
      <td>P000734</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15245</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 05233,a</td>
      <td>Pd XVI,4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>ATU 5, pl. 001, W 5233,a</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ecfc44fa-7702-49b6-93a6-a56a52cb2988')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ecfc44fa-7702-49b6-93a6-a56a52cb2988 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ecfc44fa-7702-49b6-93a6-a56a52cb2988');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-70b7efdf-0d28-463c-af11-8f747214f418">
  <button class="colab-df-quickchart" onclick="quickchart('df-70b7efdf-0d28-463c-af11-8f747214f418')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-70b7efdf-0d28-463c-af11-8f747214f418 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_mat_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(319656, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>#####2.3.3 Visualization of ORACC Materials</p>
</section>
<section id="id1">
<h4>Distribution of matched first materials<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_m_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_m_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_m_df2</span> <span class="o">=</span> <span class="n">first_m_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_label&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_m_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-af647fdb-4e07-46e0-9e1c-742b7e9a2ed2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>clay</td>
      <td>40954</td>
    </tr>
    <tr>
      <th>11</th>
      <td>stone</td>
      <td>5591</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bronze</td>
      <td>422</td>
    </tr>
    <tr>
      <th>8</th>
      <td>metal</td>
      <td>95</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gypsum</td>
      <td>63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>copper</td>
      <td>61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gold</td>
      <td>33</td>
    </tr>
    <tr>
      <th>10</th>
      <td>silver</td>
      <td>16</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bone</td>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lead</td>
      <td>10</td>
    </tr>
    <tr>
      <th>9</th>
      <td>shell</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>iron</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-af647fdb-4e07-46e0-9e1c-742b7e9a2ed2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-af647fdb-4e07-46e0-9e1c-742b7e9a2ed2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-af647fdb-4e07-46e0-9e1c-742b7e9a2ed2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5e9ca26f-af7e-4e25-9a8e-2c16eb054f93">
  <button class="colab-df-quickchart" onclick="quickchart('df-5e9ca26f-af7e-4e25-9a8e-2c16eb054f93')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5e9ca26f-af7e-4e25-9a8e-2c16eb054f93 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_m_df2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;First Material Used in Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of First Materials on Tablets that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1aeae0febb9c61ab71e136717565f69d7eafb95b837e0f379e68794dedac45ab.png" src="_images/1aeae0febb9c61ab71e136717565f69d7eafb95b837e0f379e68794dedac45ab.png" />
</div>
</div>
</section>
<section id="id2">
<h4>Distribution of finer categories within matched materials<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>We have recorded the big material labels for the matched tablets. The graph below summarizes the finer categories within those big labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">finer_cat_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">)[</span><span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">finer_cat_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">finer_cat_df2</span> <span class="o">=</span> <span class="n">finer_cat_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span>
               <span class="s1">&#39;first_mat_finer_category&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">finer_cat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finer_cat_df2</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">)</span>
<span class="n">finer_cat_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4a419306-d02e-442b-abae-d01e1a7e7f0a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>undetermined</td>
      <td>45187</td>
    </tr>
    <tr>
      <th>46</th>
      <td>limestone</td>
      <td>945</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alabaster</td>
      <td>249</td>
    </tr>
    <tr>
      <th>25</th>
      <td>diorite</td>
      <td>166</td>
    </tr>
    <tr>
      <th>14</th>
      <td>calcite</td>
      <td>143</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>cornelian</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>copper or bronze</td>
      <td>1</td>
    </tr>
    <tr>
      <th>55</th>
      <td>porcelain</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>chalcedon</td>
      <td>1</td>
    </tr>
    <tr>
      <th>75</th>
      <td>uralite-quartz-dolerite</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>76 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4a419306-d02e-442b-abae-d01e1a7e7f0a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4a419306-d02e-442b-abae-d01e1a7e7f0a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4a419306-d02e-442b-abae-d01e1a7e7f0a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a9f6e0cd-4125-4fbc-8f14-54d713a33f36">
  <button class="colab-df-quickchart" onclick="quickchart('df-a9f6e0cd-4125-4fbc-8f14-54d713a33f36')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a9f6e0cd-4125-4fbc-8f14-54d713a33f36 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Note that there are unproportionately the most records that have NA value for their material. Since the purpose of this plot is to determine which labels to add into FactGrid, we will exclude the undetermined ones when we plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">finer_cat_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1150</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Sub-Category of First Materials on Tablets that Matched FactGrid Records</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d43316cd6ff74847ddb7759904fddf43767d8b01667e799f6320af9c132aa858.png" src="_images/d43316cd6ff74847ddb7759904fddf43767d8b01667e799f6320af9c132aa858.png" />
</div>
</div>
</section>
<section id="id3">
<h4>Distribution of unmatched materials<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Select the top 10 of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_mats2</span> <span class="o">=</span> <span class="n">mat_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_mat2</span><span class="p">][</span><span class="s1">&#39;oracc_material_dump&#39;</span><span class="p">]</span>
<span class="n">unmatched_mats_clean2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">nancount</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">unmatched_mats2</span><span class="p">:</span>
  <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
    <span class="n">nancount</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">elif</span> <span class="n">m</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-language statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_mats_clean2</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_mats_clean2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_mats_clean2</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nancount</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; nans in the ORACC materials&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_mats_clean2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 319626 nans in the ORACC materials
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;bitumen&#39;, &#39;glass&#39;, &#39;composite&#39;, &#39;bituminous substance&#39;, &#39;ivory&#39;,
       &#39;unknown&#39;, &#39;stone: alabaster&#39;, &#39;calcite&#39;,
       &#39;yellow calcite (or alabaster)&#39;, &#39;rock&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d_mat2</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_mats_clean2</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_mat_counts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d_mat2</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nancount</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; nans in the ORACC materials&#39;</span><span class="p">)</span>
<span class="n">unmatched_mat_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 319626 nans in the ORACC materials
</pre></div>
</div>
<div class="output text_html">
  <div id="df-fa907e42-ad8e-4ee8-9430-3147fd8ed6d0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>material</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bitumen</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>unknown</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>glass</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ivory</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>composite</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bituminous substance</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>stone: alabaster</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>calcite</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>yellow calcite (or alabaster)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>rock</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fa907e42-ad8e-4ee8-9430-3147fd8ed6d0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fa907e42-ad8e-4ee8-9430-3147fd8ed6d0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fa907e42-ad8e-4ee8-9430-3147fd8ed6d0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cbe372d9-0d36-42ee-b400-822687402009">
  <button class="colab-df-quickchart" onclick="quickchart('df-cbe372d9-0d36-42ee-b400-822687402009')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cbe372d9-0d36-42ee-b400-822687402009 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_mat_counts2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">,],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Material Labels of the Tablets not in FactGrid</span><span class="se">\n</span><span class="s1">(Excluding undetermined ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a4f9d4b3e51a80ce35e25c6a9e33037412c261b8621582effb27648720fed53.png" src="_images/7a4f9d4b3e51a80ce35e25c6a9e33037412c261b8621582effb27648720fed53.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matched_mat_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">matched_mat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(344225, 9)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-598ccd6d-ef69-44a9-979f-e772dc2cce12" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
      <th>first_mat_finer_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-598ccd6d-ef69-44a9-979f-e772dc2cce12')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-598ccd6d-ef69-44a9-979f-e772dc2cce12 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-598ccd6d-ef69-44a9-979f-e772dc2cce12');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6c495ecc-9bfb-4bc5-8bd3-942151fa3aeb">
  <button class="colab-df-quickchart" onclick="quickchart('df-6c495ecc-9bfb-4bc5-8bd3-942151fa3aeb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6c495ecc-9bfb-4bc5-8bd3-942151fa3aeb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">matched_mat_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(47260, 9)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-19ac7fb8-746a-4c90-b8b5-2c8e0a22cb9e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_material_dump</th>
      <th>material</th>
      <th>first_mat</th>
      <th>first_mat_label</th>
      <th>first_mat_qid</th>
      <th>P155_mat</th>
      <th>other_mat</th>
      <th>first_mat_finer_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-19ac7fb8-746a-4c90-b8b5-2c8e0a22cb9e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-19ac7fb8-746a-4c90-b8b5-2c8e0a22cb9e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-19ac7fb8-746a-4c90-b8b5-2c8e0a22cb9e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3973274c-dcdd-4471-996d-bbe1707509de">
  <button class="colab-df-quickchart" onclick="quickchart('df-3973274c-dcdd-4471-996d-bbe1707509de')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3973274c-dcdd-4471-996d-bbe1707509de button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="combining-cdli-and-oracc-material-dataframes">
<h3><strong>2.4 Combining CDLI and ORACC Material dataframes</strong><a class="headerlink" href="#combining-cdli-and-oracc-material-dataframes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">materials_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mat_df</span><span class="p">,</span> <span class="n">mat_df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_materials_df</span> <span class="o">=</span> <span class="n">materials_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;material_x&#39;</span><span class="p">,</span> <span class="s1">&#39;material_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;first_mat_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_mat_y&#39;</span><span class="p">,</span> <span class="s1">&#39;first_mat_label_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_mat_label_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;first_mat_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;P155_mat_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_mat_y&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;other_mat_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_mat_y&#39;</span><span class="p">]]</span>
<span class="n">final_materials_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4bc66848-e832-4c08-bebb-6dacdb246a46" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>first_mat_x</th>
      <th>first_mat_y</th>
      <th>first_mat_label_x</th>
      <th>first_mat_label_y</th>
      <th>first_mat_qid_x</th>
      <th>first_mat_qid_y</th>
      <th>P155_mat_x</th>
      <th>P155_mat_y</th>
      <th>other_mat_x</th>
      <th>other_mat_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4bc66848-e832-4c08-bebb-6dacdb246a46')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4bc66848-e832-4c08-bebb-6dacdb246a46 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4bc66848-e832-4c08-bebb-6dacdb246a46');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-44a78459-13ec-4383-8f40-32e070b9ba8f">
  <button class="colab-df-quickchart" onclick="quickchart('df-44a78459-13ec-4383-8f40-32e070b9ba8f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-44a78459-13ec-4383-8f40-32e070b9ba8f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_materials_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_materials_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="museum-collection-present-holding-p329">
<h2>3 <strong>museum/collection = present holding <a class="reference external" href="https://database.factgrid.de/wiki/Property:P329">(P329)</a></strong><a class="headerlink" href="#museum-collection-present-holding-p329" title="Link to this heading">#</a></h2>
<p>####3.1 CDLI collection</p>
<p>Next we list all the unique statements in the ‘collection’ field in a data frame, <code class="docutils literal notranslate"><span class="pre">museum_df</span></code> and match them with the FactGrid Q-ids.</p>
<p>We can use this dataset, which has the corresponding FactGrid Q-ids for some, but perhaps not all (after we see how many FG items are needed to match, Adam will finish making the necessary Q-ids in FactGrid): <a class="reference external" href="https://docs.google.com/spreadsheets/d/1BdRndVP3JFGWAtv1WTlXiYsGBuCADHnblYeoihfQcLI/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1BdRndVP3JFGWAtv1WTlXiYsGBuCADHnblYeoihfQcLI/edit?usp=sharing</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Museum%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">collection_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># only use a certain collection of columns</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[[</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="s1">&#39;factgrid_id&#39;</span><span class="p">,</span> <span class="s1">&#39;wikidata_id&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_native&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_url&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">,</span> <span class="s1">&#39;wiki_url_native&#39;</span><span class="p">]]</span>
<span class="c1"># fill na values with space</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># remove entries without a FactGrid QID</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;factgrid_id&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">collection_reference</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="n">collection_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ff835ee3-4a29-4dde-a25d-3b9d6737c510" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection</th>
      <th>factgrid_id</th>
      <th>wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Louvre Museum, Paris, France</td>
      <td>Q511925</td>
      <td>Q19675</td>
      <td>Louvre</td>
      <td>Louvre</td>
      <td>https://www.louvre.fr</td>
      <td>https://en.wikipedia.org/wiki/Louvre</td>
      <td>https://ar.wikipedia.org/wiki/متحف_اللوفر</td>
    </tr>
    <tr>
      <th>2</th>
      <td>British Museum, London, UK</td>
      <td>Q102010</td>
      <td>Q6373</td>
      <td>British Museum</td>
      <td>British Museum</td>
      <td>https://www.britishmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Q511934</td>
      <td>Q636400</td>
      <td>Ashmolean Museum</td>
      <td>Ashmolean Museum</td>
      <td>https://www.ashmolean.org</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>Q512004</td>
      <td>Q160236</td>
      <td>Metropolitan Museum of Art</td>
      <td>Metropolitan Museum of Art</td>
      <td>https://www.metmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Rubenstein Rare Book &amp; Manuscript Library, Duk...</td>
      <td>Q511884</td>
      <td>Q74061200</td>
      <td>David M. Rubenstein Rare Book &amp; Manuscript Lib...</td>
      <td>David M. Rubenstein Rare Book &amp; Manuscript Lib...</td>
      <td>https://library.duke.edu/rubenstein/about/library</td>
      <td>https://en.wikipedia.org/wiki/Duke_University_...</td>
      <td>https://en.wikipedia.org/wiki/Duke_University_...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Università Cattolica del S. Cuore, Milan, Italy</td>
      <td>Q511917</td>
      <td>Q229022</td>
      <td>Università Cattolica del Sacro Cuore</td>
      <td>Università Cattolica del Sacro Cuore</td>
      <td>https://www.unicatt.it</td>
      <td>https://en.wikipedia.org/wiki/Università_Catto...</td>
      <td>https://it.wikipedia.org/wiki/Università_Catto...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>University of Liège, Liège, Belgium</td>
      <td>Q173222</td>
      <td>Q1334582</td>
      <td>University of Liège</td>
      <td>Université de Liège</td>
      <td>https://www.uliege.be</td>
      <td>https://en.wikipedia.org/wiki/University_of_Liège</td>
      <td>https://fr.wikipedia.org/wiki/Université_de_Liège</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Oriental Institute Museum</td>
      <td>Q511904</td>
      <td>Q1276053</td>
      <td>Oriental Institute Museum</td>
      <td>Oriental Institute Museum</td>
      <td>https://oi.uchicago.edu/museum-exhibits</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
    </tr>
    <tr>
      <th>73</th>
      <td>University of Southern California</td>
      <td>Q511879</td>
      <td>Q4614</td>
      <td>University of Southern California</td>
      <td>University of Southern California</td>
      <td>https://www.usc.edu</td>
      <td>https://en.wikipedia.org/wiki/University_of_So...</td>
      <td>https://en.wikipedia.org/wiki/University_of_So...</td>
    </tr>
  </tbody>
</table>
<p>74 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ff835ee3-4a29-4dde-a25d-3b9d6737c510')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ff835ee3-4a29-4dde-a25d-3b9d6737c510 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ff835ee3-4a29-4dde-a25d-3b9d6737c510');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3d77ba9c-690b-4773-a1ad-e95c8a2272f1">
  <button class="colab-df-quickchart" onclick="quickchart('df-3d77ba9c-690b-4773-a1ad-e95c8a2272f1')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3d77ba9c-690b-4773-a1ad-e95c8a2272f1 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="collection-df">
<h3>3.1.2 collection_df<a class="headerlink" href="#collection-df" title="Link to this heading">#</a></h3>
<p>Match on cdli label to obtain the corresponding FactGrid Q-id for ‘collection’ field and add matching data to <code class="docutils literal notranslate"><span class="pre">museum_df</span></code>.</p>
<p>From the cdil_cat.csv include a column / field for the corresponding <strong>‘museum_no’ = ‘inventory position’ <a class="reference external" href="https://database.factgrid.de/wiki/Property:P10">(P10)</a></strong>.</p>
<p>Format of the result: <a class="reference external" href="https://cdli.mpiwg-berlin.mpg.de/search?simple-value%5B%5D=P215773&amp;amp;simple-field%5B%5D=keyword">Example</a></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>collection</p></th>
<th class="head"><p>museum_no</p></th>
<th class="head"><p>factgrid_id</p></th>
<th class="head"><p>wikidata_id</p></th>
<th class="head"><p>P155</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>P215773</p></td>
<td><p>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey</p></td>
<td><p>Ist EŞEM 00501</p></td>
<td><p>Q511898</p></td>
<td><p>Q636978</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>If there are any question marks, we can use the P155 field and fill the cell with <a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a></p></li>
<li><p>There are of course more fields in the dataset linked above which we will want to get once the matching stage is finalized (i.e. those fields highlighted in green)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_x&#39;</span><span class="p">]]</span>
<span class="n">collection_df</span> <span class="o">=</span> <span class="n">collection_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;collection_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">})</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Vorderasiatisches Museum, Berlin, Germany&#39;,
       ..., &#39;Mardin Museum, Mardin, Turkey&#39;, &#39;Oylum Höyük, Oylum, Turkey&#39;,
       &#39;private: William T. Grant Jr., Pelham Manor, New York, USA&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_wikidata_id</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name_native</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_url</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_eng</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_native</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_collection</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_collection</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple collections</span>
<span class="n">no_match_indices_collection</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">])):</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_c</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_c</span><span class="p">:</span>
    <span class="n">P155_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_c</span> <span class="o">=</span> <span class="n">first_c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_c</span>

  <span class="c1"># if the collection has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_c</span> <span class="ow">in</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">collection</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_c</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_c</span><span class="p">)</span>
    <span class="n">collection_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;factgrid_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_wikidata_id</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wikidata_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name_native</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_url</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_eng</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_native</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">collection</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_wikidata_id</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name_native</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_url</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_eng</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_native</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_collection</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_qid</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_wikidata_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_wikidata_id</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name_native</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_url</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_eng</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_native</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;P155_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_collection</span>
<span class="n">collection_df</span><span class="p">[</span><span class="s1">&#39;other_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_collection</span>

<span class="n">collection_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bfaff030-02aa-42cd-8d28-1ae4bf6538bf" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bfaff030-02aa-42cd-8d28-1ae4bf6538bf')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bfaff030-02aa-42cd-8d28-1ae4bf6538bf button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bfaff030-02aa-42cd-8d28-1ae4bf6538bf');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1dbbb346-005d-4aef-980a-6499e23cedfe">
  <button class="colab-df-quickchart" onclick="quickchart('df-1dbbb346-005d-4aef-980a-6499e23cedfe')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1dbbb346-005d-4aef-980a-6499e23cedfe button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-collection-df">
<h3>3.1.3 matched_collection_df<a class="headerlink" href="#matched-collection-df" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df</span> <span class="o">=</span> <span class="n">collection_df</span><span class="p">[</span><span class="o">~</span><span class="n">collection_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_collection</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_collection_df</span> <span class="o">=</span> <span class="n">matched_collection_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_collection_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-44ce8b20-d114-426e-b83e-a759333900c2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdli_dump_id</th>
      <th>cdli_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>237386</th>
      <td>P532441</td>
      <td>National Museum of Syria, Damascus, Syria ?</td>
      <td>National Museum of Syria, Damascus, Syria</td>
      <td>Q511875</td>
      <td>Q617254</td>
      <td>Damascus National Museum</td>
      <td>المتحف الوطني دمشق</td>
      <td>http://dgam.gov.sy/المتاحف-الوطنية/المتحف-الوطني/</td>
      <td>https://en.wikipedia.org/wiki/National_Museum_...</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_الوطني_بدمشق</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>237387</th>
      <td>P532442</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>237388</th>
      <td>P532443</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>237389</th>
      <td>P532444</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>237390</th>
      <td>P532445</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>Q511874</td>
      <td>Q521251</td>
      <td>Iraq Museum</td>
      <td>المتحف العراقي</td>
      <td>https://www.theiraqmuseum.com/index.html</td>
      <td>https://en.wikipedia.org/wiki/Iraq_Museum</td>
      <td>https://ar.wikipedia.org/wiki/المتحف_العراقي</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>237391 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-44ce8b20-d114-426e-b83e-a759333900c2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-44ce8b20-d114-426e-b83e-a759333900c2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-44ce8b20-d114-426e-b83e-a759333900c2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-37c8c0a0-7142-495e-9b1e-9e2be286cbe3">
  <button class="colab-df-quickchart" onclick="quickchart('df-37c8c0a0-7142-495e-9b1e-9e2be286cbe3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-37c8c0a0-7142-495e-9b1e-9e2be286cbe3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(237391, 12)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-collection-df">
<h3>3.1.4 no_match_collection_df<a class="headerlink" href="#no-match-collection-df" title="Link to this heading">#</a></h3>
<p>Make a separate data frame for the texts when there is no match / museum / collection: <code class="docutils literal notranslate"><span class="pre">no_collection_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection</span><span class="p">]</span>
<span class="n">no_match_collection_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5b7928d2-85b9-48f1-ae0a-1dda608180a1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>designation_x</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
      <th>designation_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>Q000002</td>
      <td>P000166</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19412,8</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19412,08</td>
      <td>Nb XVI,3/4</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000002, ex. 175</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000166</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19412,8</td>
    </tr>
    <tr>
      <th>152</th>
      <td>Q000026</td>
      <td>P000171</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19667,e</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19667,e</td>
      <td>Nc XVI,5</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Metal (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000026, ex. 037</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000171</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19667,e</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Q000023</td>
      <td>P000173</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19724</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19724</td>
      <td>Nb XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Vessels and Garments (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000023, ex. 041</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000173</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19724</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Q000002</td>
      <td>P000174</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,b</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,b</td>
      <td>Na XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000002, ex. 094</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000174</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19726,b</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Q000013</td>
      <td>P000175</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,c</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,c</td>
      <td>Na XVI,3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Fish (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000013, ex. 009</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000175</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>S013836</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19726,c</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5b7928d2-85b9-48f1-ae0a-1dda608180a1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5b7928d2-85b9-48f1-ae0a-1dda608180a1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5b7928d2-85b9-48f1-ae0a-1dda608180a1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-61e2135d-ddb1-4468-ba08-abe180090d7b">
  <button class="colab-df-quickchart" onclick="quickchart('df-61e2135d-ddb1-4468-ba08-abe180090d7b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-61e2135d-ddb1-4468-ba08-abe180090d7b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(129525, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_collection_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h3>3.1.5 Visualization<a class="headerlink" href="#visualization" title="Link to this heading">#</a></h3>
<section id="distribution-of-matched-first-collections">
<h4>Distribution of matched first collections<a class="headerlink" href="#distribution-of-matched-first-collections" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_collection_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">)[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_c_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_c_df</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span>
               <span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_c_df</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_c_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-8e5622b1-78fc-450a-a96f-643e8d6f99ec" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>74943</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>26377</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>19207</td>
    </tr>
    <tr>
      <th>3</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>19072</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>15823</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Rubenstein Rare Book &amp; Manuscript Library, Duk...</td>
      <td>9</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>9</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Boston Public Library, Boston, Massachusetts, USA</td>
      <td>8</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Museon, The Hague, Holland</td>
      <td>7</td>
    </tr>
    <tr>
      <th>61</th>
      <td>National Geographic Society, Washington, DC, USA</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8e5622b1-78fc-450a-a96f-643e8d6f99ec')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8e5622b1-78fc-450a-a96f-643e8d6f99ec button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8e5622b1-78fc-450a-a96f-643e8d6f99ec');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3e88c9dc-dc7d-4212-92d4-980190f4bdd8">
  <button class="colab-df-quickchart" onclick="quickchart('df-3e88c9dc-dc7d-4212-92d4-980190f4bdd8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3e88c9dc-dc7d-4212-92d4-980190f4bdd8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collection&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b661d58c00461e655d7e183c3161609c44cab4ed16f0ac6f3e7c89e9bad854ae.png" src="_images/b661d58c00461e655d7e183c3161609c44cab4ed16f0ac6f3e7c89e9bad854ae.png" />
</div>
</div>
</section>
<section id="distribution-of-countries">
<h4>Distribution of countries<a class="headerlink" href="#distribution-of-countries" title="Link to this heading">#</a></h4>
<p>of first collections that matched</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_country</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_c_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_country</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="n">collection_country</span> <span class="o">+=</span> <span class="p">[</span><span class="n">current_country</span><span class="p">]</span>

<span class="n">first_c_df</span><span class="p">[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_country</span>

<span class="n">first_c_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0f486a60-bcba-48ff-ac63-2922d25ba305" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
      <th>collection_country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>74943</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>26377</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>19207</td>
      <td>Turkey</td>
    </tr>
    <tr>
      <th>3</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>19072</td>
      <td>Iraq</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>15823</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Rubenstein Rare Book &amp; Manuscript Library, Duk...</td>
      <td>9</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>9</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Boston Public Library, Boston, Massachusetts, USA</td>
      <td>8</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Museon, The Hague, Holland</td>
      <td>7</td>
      <td>Holland</td>
    </tr>
    <tr>
      <th>61</th>
      <td>National Geographic Society, Washington, DC, USA</td>
      <td>4</td>
      <td>USA</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0f486a60-bcba-48ff-ac63-2922d25ba305')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0f486a60-bcba-48ff-ac63-2922d25ba305 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0f486a60-bcba-48ff-ac63-2922d25ba305');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3c10f890-2cc5-4859-b093-bd1621385bc7">
  <button class="colab-df-quickchart" onclick="quickchart('df-3c10f890-2cc5-4859-b093-bd1621385bc7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3c10f890-2cc5-4859-b093-bd1621385bc7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_country_count</span> <span class="o">=</span> <span class="n">first_c_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;collection_country&#39;</span><span class="p">])[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">first_c_country_count</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-184-a59efc2431c5&gt;:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  first_c_country_count = first_c_df.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
&lt;ipython-input-184-a59efc2431c5&gt;:1: FutureWarning: The operation &lt;built-in function sum&gt; failed on a column. If any error is raised, this will raise an exception in a future version of pandas. Drop these columns to avoid this warning.
  first_c_country_count = first_c_df.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
</pre></div>
</div>
<div class="output text_html">
  <div id="df-0b3c6e41-796f-46e2-8d3d-c7bc590a9066" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection_country</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>UK</td>
      <td>83258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USA</td>
      <td>73783</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Turkey</td>
      <td>20558</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Iraq</td>
      <td>19072</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Germany</td>
      <td>15023</td>
    </tr>
    <tr>
      <th>5</th>
      <td>France</td>
      <td>12973</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Syria</td>
      <td>5106</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RussianFederation</td>
      <td>2187</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Canada</td>
      <td>1367</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Italy</td>
      <td>1366</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Spain</td>
      <td>1161</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Belgium</td>
      <td>705</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Jerusalem</td>
      <td>271</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Denmark</td>
      <td>218</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Japan</td>
      <td>199</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Lebanon</td>
      <td>67</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Switzerland</td>
      <td>26</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Hungary</td>
      <td>20</td>
    </tr>
    <tr>
      <th>18</th>
      <td>CzechRepublic</td>
      <td>13</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Ireland</td>
      <td>11</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Holland</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0b3c6e41-796f-46e2-8d3d-c7bc590a9066')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0b3c6e41-796f-46e2-8d3d-c7bc590a9066 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0b3c6e41-796f-46e2-8d3d-c7bc590a9066');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1397a661-13dd-4abf-b8bc-31b8e6660414">
  <button class="colab-df-quickchart" onclick="quickchart('df-1397a661-13dd-4abf-b8bc-31b8e6660414')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1397a661-13dd-4abf-b8bc-31b8e6660414 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_country_count</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Countries of First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70792925c1c6b7a91634219b36f3c9e6d16458930061a988923d44e7a81c3a5e.png" src="_images/70792925c1c6b7a91634219b36f3c9e6d16458930061a988923d44e7a81c3a5e.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-collections">
<h4>Distribution of unmatched collections<a class="headerlink" href="#distribution-of-unmatched-collections" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">)[</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cdli_dump_collection
 Institute of Archaeology, University of Turin, Turin, Italy                               1
A&#39;ali, Bahrain                                                                             7
A. M. Chisholm Museum, Duluth, Minnesota, USA                                              1
A. V. Lane Museum, Bridwell Library, Southern Methodist University, Dallas, Texas, USA    11
Abbaye de Maredsous, Denée, Belgium                                                        1
                                                                                          ..
Übersee-Museum, Bremen, Germany                                                            2
Übersee-Museum, Bremen, Germany; École Pratique des Hautes Études, Paris, France           1
Şanlıurfa Archaeological Museum, Şanlıurfa, Turkey                                         2
Şanlıurfa Arkeoloji Müzesi, Şanlıurfa, Turkey                                              1
Šiauliai Aušros Museum, Šiauliai, Lithuania                                                3
Name: cdli_dump_collection, Length: 1400, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_collections</span> <span class="o">=</span> <span class="n">collection_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection</span><span class="p">][</span><span class="s1">&#39;cdli_dump_collection&#39;</span><span class="p">]</span>
<span class="n">unmatched_collections_clean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unmatched_collections</span><span class="p">:</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># split a multi statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_collections_clean</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_collections_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_collections_clean</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_collections_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;German Archaeological Institute, Berlin, Germany (on loan, University of Heidelberg)&#39;,
       &#39;unlocated&#39;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada (cast)&#39;,
       ..., &#39;Mardin Museum, Mardin, Turkey&#39;, &#39;Oylum Höyük, Oylum, Turkey&#39;,
       &#39;private: William T. Grant Jr., Pelham Manor, New York, USA&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_collections_clean</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_c_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">unmatched_c_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-43d2d928-ef08-49ea-a81a-07954696febf" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>26060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anadolu Medeniyetleri Müzesi, Ankara, Turkey</td>
      <td>15950</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Department of Near Eastern Studies, Cornell Un...</td>
      <td>10445</td>
    </tr>
    <tr>
      <th>3</th>
      <td>National Museum of Syria, Der-ez-Zor, Syria</td>
      <td>9506</td>
    </tr>
    <tr>
      <th>4</th>
      <td>National Museum of Syria, Idlib, Syria</td>
      <td>6852</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1382</th>
      <td>Palace Museum, Beijing, PRC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1383</th>
      <td>Meissner Collection</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1384</th>
      <td>West Point Museum, West Point, New York USA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1385</th>
      <td>Garrett-Evangelical Theological Seminary, Evan...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1386</th>
      <td>private: William T. Grant Jr., Pelham Manor, N...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1387 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-43d2d928-ef08-49ea-a81a-07954696febf')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-43d2d928-ef08-49ea-a81a-07954696febf button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-43d2d928-ef08-49ea-a81a-07954696febf');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3c3daf8b-77d2-4954-bb3a-bf9bf00d173e">
  <button class="colab-df-quickchart" onclick="quickchart('df-3c3daf8b-77d2-4954-bb3a-bf9bf00d173e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3c3daf8b-77d2-4954-bb3a-bf9bf00d173e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_c_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/unmatched_cdli_collections_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_c_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">17500</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collections&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Top 10 Collections of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/140ea6bd072f19a4abd10e0d10bc4932675a930be5447d0319cd173a6778b7b0.png" src="_images/140ea6bd072f19a4abd10e0d10bc4932675a930be5447d0319cd173a6778b7b0.png" />
</div>
</div>
<p>####3.2 ORACC collection
Repeating the process on the CDLI collection above for ORACC.</p>
</section>
</section>
<section id="collection-df2">
<h3>3.2.1 collection_df2<a class="headerlink" href="#collection-df2" title="Link to this heading">#</a></h3>
<p>Match on oracc label to obtain the corresponding FactGrid Q-id for ‘collection’ field and add matching data to <code class="docutils literal notranslate"><span class="pre">museum_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_y&#39;</span><span class="p">]]</span>
<span class="n">collection_df2</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;collection_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">})</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;German Archaeological Institute, Berlin, Germany (on loan, University of Heidelberg)&#39;,
       &#39;Ashmolean Museum, Oxford, UK&#39;, &#39;British Museum, London, UK&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;unlocated&#39;, nan, &#39;private: anonymous, unlocated&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium&#39;,
       &#39;private: Michail, Louise, Milan, Italy&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Mead Art Gallery, Amherst College, Amherst, Massacusetts, USA&#39;,
       &#39;Nies Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Bible Lands Museum, Pittsburgh Theological Seminary, Pittsburgh, Pennsylvania, USA&#39;,
       &#39;Kyoto University, Kyoto, Japan&#39;,
       &#39;Free Library of Philadelphia, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Manchester Museum, University of Manchester, Manchester, UK&#39;,
       &#39;Crozer Theological Seminary, Rochester, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Hilprecht Collection, University of Jena, Germany&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &quot;Musées royaux d&#39;Art et d&#39;Histoire, Brussels, Belgium&quot;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Montserrat Museum, Barcelona, Spain&#39;,
       &#39;Louvre Museum, Paris, France&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria ?&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Louvre Museum, Paris, France ?&#39;,
       &#39;National Museum, Tehran, Iran ?&#39;,
       &#39;Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;National Museum, Tehran, Iran&#39;,
       &#39;private: de Serres, J. Mariaud, Paris, France&#39;,
       &#39;private: Foroughi, Mohsen, Tehran, Iran ?&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;J. Pierpont Morgan Library Collection, New York, New York, USA&#39;,
       &#39;Bible Lands Museum, Jerusalem&#39;,
       &#39;private: Frauenberger, K., Germany ?&#39;,
       &#39;Kalamazoo Valley Museum, Kalamazoo, Michigan, USA&#39;,
       &#39;The Israel Museum, Jerusalem&#39;, &#39;private: Foroughi, Teheran, Iran&#39;,
       &#39;Musée d’Art et d’Histoire, Geneva, Switzerland&#39;,
       &#39;Institute of Archaeology, London, UK&#39;,
       &#39;New York Public Library, New York, New York, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA ?&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey ?&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;Gallery of Fine Arts, Yale University, New Haven, Connecticut, USA&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany&#39;,
       &#39;Allard Pierson Museum, University of Amsterdam, Amsterdam, Holland&#39;,
       &#39;Archäologisches Museum, Universität Halle-Wittenberg, Germany&#39;,
       &#39;private: Hoza, Camberg, Germany&#39;,
       &#39;National Museum of Syria, Raqqa, Syria ?&#39;,
       &#39;British Museum, London, UK ?&#39;, &#39;private: Baldacci, Milan, Italy&#39;,
       &#39;École Pratique des Hautes Études, Paris, France&#39;,
       &#39;private: Hideo Mihira, Chiba, Japan&#39;,
       &#39;Ancient Orient Museum, Tokyo, Japan&#39;,
       &#39;Osaka Prefectural Chikatsu-Asuka Museum, Osaka, Japan&#39;,
       &#39;Takahashi Collection, Municipal Museum, Fujisawa, Japan&#39;,
       &#39;private: Namio Egami, Tokyo, Japan&#39;,
       &#39;Tokyo National Museum, Tokyo, Japan&#39;,
       &#39;National Museum of Ethnology, Osaka, Japan&#39;,
       &#39;Kelsey Museum of Archaeology, University of Michigan, Ann Arbor, Michigan, USA&#39;,
       &#39;Harvard Museum of the Ancient Near East, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Louvre Museum, Paris, France; Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;British Museum, London, UK; Louvre Museum, Paris, France&#39;,
       &#39;private: Cros, unlocated&#39;, &#39;Munich, Germany?&#39;,
       &#39;Bodmer Museum, Cologny, Switzerland&#39;,
       &#39;private: Erlenmeyer, Basel, Switzerland (dispersed)&#39;,
       &#39;private: anonymous, Baghdad, Iraq&#39;, &#39;private: Banks, unlocated&#39;,
       &#39;private: Samhery, unlocated&#39;, &#39;private: Greene, unlocated&#39;,
       &#39;private: Tournay, unlocated&#39;,
       &#39;Medelhavsmuseet, Stockholm, Sweden&#39;,
       &#39;private: Haldar, Alfred O., Uppsala, Sweden&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany ?&#39;,
       &#39;Milwaukee Public Museum, Milwaukee, Wisconsin, USA&#39;,
       &#39;New Brunswick Museum, St. John, New Brunswick, Canada&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq ?&#39;,
       &#39;Hearst Museum of Anthropology, University of California at Berkeley, Berkeley, California, USA&#39;,
       &#39;Rosicrucian Egyptian Museum, San Jose, California, USA&#39;,
       &#39;J. Pierpont Morgan Library Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Chester Beatty Library, Dublin, Ireland&#39;,
       &#39;Birmingham Museums and Art Gallery, Birmingham, UK&#39;,
       &#39;private: anonymous, Göttingen, Germany&#39;,
       &#39;Liebighaus, Frankfurt, Germany&#39;,
       &#39;private: Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Reber Collection, Lausanne, Switzerland&#39;,
       &#39;private: Schimmel, Norbert, unlocated&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;National Museum of Syria, Idlib, Syria&#39;,
       &#39;British Museum, London, UK; National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (on loan, British Museum, London, UK ?)&#39;,
       &#39;British Museum, London, UK; National Museum of Iraq, Baghdad, Iraq ?&#39;,
       &#39;National Museum of Syria, Aleppo, Syria&#39;,
       &#39;Robert Hull Fleming Museum, University of Vermont, Burlington, Vermont, USA&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK&#39;,
       &#39;Field Museum of Natural History, Chicago, Illinois, USA&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel; Hilprecht Collection, University of Jena, Jena, Germany&#39;,
       &#39;Louvre Museum, Paris, France; Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkeyurkey&#39;,
       &#39;Studium Biblicum Franciscanum Archaeological Museum, Jerusalem&#39;,
       &#39;Cabinet des Médailles, Musée d’Histoire et d’Art, Musées de l’Etat, Luxemburg&#39;,
       &#39;Ethnological Collections, Redpath Museum, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: David, E.S., New York, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;private: Hechich, Rome, Italy&#39;, &#39;Museo Barracco, Rome, Italy&#39;,
       &#39;Bibliothèque Nationale et Universitaire de Strasbourg, Strasbourg, France&#39;,
       &#39;private: Galling, Kurt, Tübingen, Germany&#39;,
       &#39;Museum of Anthropology, University of British Columbia, Vancouver, British Columbia, Canada&#39;,
       &#39;private: Ligabue, Giancarlo, Venice, Italy&#39;,
       &#39;private: Southesk collection&#39;,
       &#39;World Museum Liverpool, Liverpool, UK&#39;,
       &#39;Couvent Saint-Etienne, Jerusalem&#39;,
       &#39;National Museum of Iraq, Baghdad,Iraq&#39;,
       &#39;Spurlock Museum, University of Illinois, Urbana-Champaign, Illinois, USA&#39;,
       &#39;private: anonmymous, unlocated ?&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel&#39;,
       &#39;Hilprecht Collection, University of Jena, Germany; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Hilprecht Collection, University of Jena, Germany&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Rare Book and Manuscript Library, Columbia University, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq: University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;private: Hoffman, E. A., unlocated&#39;,
       &#39;private: Barton, G. A., unlocated&#39;,
       &#39;Rijksmuseum van Oudheden, Leiden, Holland&#39;,
       &#39;Katholieke Universiteit, Nijmegen, Holland&#39;,
       &#39;Detroit Institute of Arts, Detroit, Michigan, USA&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation ?&#39;,
       &#39;private: Hechler&#39;, &#39;private: Cugnin, L., unlocated&#39;,
       &#39;Deutsches Museum, Munich, Germany&#39;,
       &#39;Musée des Antiquités à Rouen, France&#39;, &#39;private,: Hechler&#39;,
       &#39;private: Chandon de Briailles, unlocated&#39;,
       &#39;Museum Haaretz, Tel Aviv, Israel&#39;,
       &#39;private: Mercer, S.A.B., Toronto, Ontario, Canada&#39;,
       &#39;Museo Archeologico Nazionale di Firenze, Florence, Italy&#39;,
       &#39;Institute of Semitics, University of Groningen, Groningen, Holland&#39;,
       &#39;University of Pretoria, Pretoria, South Africa&#39;,
       &#39;Cracow National Museum, Cracow, Poland&#39;,
       &#39;Bryn Mawr College, Bryn Mawr, Pennsylvania, USA&#39;,
       &#39;private: Jager, H. J. de , unlocated&#39;, &#39;Japan ?&#39;,
       &#39;Ziegelei-Museum, Meienberg, Germany&#39;,
       &#39;Musée St. Remi, Reims, France&#39;,
       &#39;private: Béghin, Versailles, France&#39;,
       &#39;Landesmuseum Joanneum, Graz, Austria&#39;,
       &#39;Kestner Museum, Hannover, Germany&#39;,
       &#39;Musée Royal de Mariemont, Morlanwelz, Belgium&#39;,
       &#39;Museo Barraco, Rome, Italy&#39;, &#39;Musée de Cinquantenaire Brussels&#39;,
       &#39;private: de Clercq, unlocated&#39;,
       &#39;private: Seidl-Geuthner, F., unlocated&#39;,
       &#39;private: Clark, Cumberland (probably dispersed)&#39;,
       &#39;Newell Bequest Collection, Wheaton College, Wheaton, Illinois, USA&#39;,
       &#39;private: Collection de Clercq, Paris, France&#39;,
       &#39;Louvre Museum, Paris, France; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;private: Golenishev, unlocated&#39;,
       &#39;Gutenberg Museum, Mainz,Germany&#39;,
       &#39;Archaeological Research Collection, University of Southern California, Los Angeles, California, USA&#39;,
       &#39;California Museum of Ancient Art, Los Angeles, California, USA&#39;,
       &#39;Department of Near Eastern Studies, Cornell University, Ithaca, New York, USA&#39;,
       &#39;private: Jensen, William, Austin, Texas, USA&#39;,
       &#39;private: LaForme, William, USA&#39;,
       &#39;California Museum of Ancient Art, Los Angeles, California, USA ?&#39;,
       &#39;private: Kuhs, R., Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA&#39;,
       &#39;Schøyen Collection, Oslo, Norway&#39;,
       &#39;Princeton Theological Seminary, Princeton, New Jersey, USA&#39;,
       &#39;Kelsey Museum&#39;,
       &#39;Kelsey Museum, University of Michigan, Ann Arbor, Michigan, USA&#39;,
       &#39;Archeological Museum, Antakya, Hatay, Turkey&#39;,
       &#39;Kelsey Museum of Archaeology, University of Michigan, Ann Arbor, Michigan, USA; National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;private: Stefanik,Deborah, Las Vegas, Nevada, USA&#39;,
       &#39;Library of Congress, Washington, DC, USA&#39;,
       &#39;Siegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK&#39;,
       &#39;Couvent Saint-Étienne, Jerusalem&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey&#39;,
       &#39;École Biblique et Archéologique Française, Jerusalem&#39;,
       &#39;Oakland Museum of California, Oakland, California, USA&#39;,
       &#39;iSegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;Newell Collections of Babylonian Tablets, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Museum fur Volkerkunde, Freiburg, Germany&#39;,
       &#39;Ruhrlandmuseum, Essen, Germany&#39;, &#39;Schøyen collection, Oslo&#39;,
       &#39;private: anonymous, Europe&#39;,
       &#39;Oriental Museum, University of Durham, Durham, UK&#39;,
       &#39;private: Homsy, E., Beirut, Lebanon ?&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Louvre Museum, Paris, France&#39;,
       &#39;Oriental Institute, University of Chicago, Illinois, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Hilprecht Collection, University of Jena, Germany&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;University Museum, University of Pennsylvania, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Center for Advanced Judaic Studies, University of Pennsylvania, Philadephia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA: Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Hilprecht Collection, University of Jena, Germany; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Rare Manuscript Collections, Cornell University Library, Ithaca, New York, USA&#39;,
       &#39;National Museum of Syria, Aleppo, Syria ?&#39;,
       &#39;Near Eastern Studies, UC Berkeley (Dales Collection), Berkeley, California, USA&#39;,
       &#39;private: anonymous, Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA (a)&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA (a); Nimrud, Iraq (b)&#39;,
       &#39;British Museum, London, UK; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Site museum, Boghazkoi, Turkey&#39;,
       &#39;Israel Antiquities Authority, Jerusalem&#39;,
       &#39;Science Museum of Minnesota, St. Paul, Minnesota, USA&#39;,
       &#39;private: Hebenstreit, Laurent, Paris, France&#39;,
       &#39;Museo di Antichità di Torino, Turin, Italy&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;private: Cotsen, Los Angeles, California, USA&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, USA&#39;,
       &#39;Hesburgh Library, University of Notre Dame, Notre Dame, Indiana, USA&#39;,
       &#39;Special Collections and Archives, John T. Richardson Library, DePaul University, Chicago, Illinois, USA; Louvre Museum, Paris, France&#39;,
       &#39;Special Collections and Archives, John T. Richardson Library, DePaul University, Chicago, Illinois, USA&#39;,
       &#39;Collection Beghin, Versailles&#39;,
       &#39;Vorderasiatisches Museum, Berlin&#39;,
       &#39;Andersen Library, University of Minnesota, Minneapolis-St. Paul, Minnesota, USA&#39;,
       &#39;Staley Library, Millikin University, Decatur, Illinois, USA&#39;,
       &#39;British Museum, London, UK; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria&#39;,
       &#39;Michael C. Carlos Museum, Emory University, Atlanta, Georgia, USA&#39;,
       &#39;The Ashmolean Museum, Oxford&#39;,
       &#39;Rosen Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Goucher College Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Yale Babylonian Collection, New Haven&#39;,
       &#39;Nies Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Nies Babylonian Collection, Yale Babilonian Collection, New Haven&#39;,
       &#39;private: anonmymous, unlocated&#39;,
       &#39;Archäologisches Museum, Universität Halle, Halle, Germany&#39;,
       &#39;National Museum of Syria, Damascus, Syria&#39;,
       &#39;private: Totten, Norman, Bentley College, Waltham, Massachusetts, USA&#39;,
       &#39;Louvre Museum, Paris, France; National Museum of Syria, Aleppo, Syria&#39;,
       &#39;Utah State University Museum of Anthropology, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Institute of Religion, Utah State University, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Museum of Church History and Art, Salt Lake City, Utah, USA&#39;,
       &#39;Department of Jordanian Antiquities, Amman, Jordan&#39;,
       &#39;Johns Hopkins University, Baltimore, MD, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turke&#39;, &#39;private: annonymous&#39;,
       &#39;Bibliothèque Nationale, Paris, France&#39;,
       &#39;Topkapı Sarayı Müzesi, Istanbul, Turkey&#39;,
       &#39;Mosul Museum, Mosul, Iraq&#39;,
       &#39;German Archaeological Institute, Berlin, Germany&#39;,
       &#39;Heidelberger Orientalisches Seminar, Heidelberg, Germany&#39;,
       &#39;Semitic Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Hilprecht-Sammlung, University of Jena, Germany&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Hilprecht Collection, University of Jena, Germany; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;British Museum, London, UK; Hirayama collection, Hirayama, Japan&#39;,
       &#39;Couvent Saint-Étienne, Jerusalem; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;National Museum of Syria, Raqqa, Syria&#39;,
       &#39;private: anonymous, Tel Aviv, Israel&#39;,
       &#39;École Pratique des Hautes Études, Paris, France; Vorderasiatisches Museum, Berlin, Germany ?&#39;,
       &#39;Musée de Beyrouth, Beirut, Libanon&#39;, &#39;private: anonymous, Canada&#39;,
       &#39;Museum of Corum, Corum, Turkey&#39;,
       &#39;John Rylands University Library, Manchester, UK&#39;,
       &#39;National Museum, Beirut, Lebanon&#39;, &#39;Iraq Museum, Baghdad&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; National Museum of Iraq, Baghdad, Iraq&#39;,
       &#39;private: anonymous, Victoria, Australia&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Louvre Museum, Paris, France; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Louvre Museum, Paris, France; Oriental Institute, University of Chicago, Chicago, Illinois, USA&#39;,
       &#39;Department of Geology, Union College, Schenectady, New York, USA&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Institute of Oriental Culture, University of Tokyo, Tokyo, Japan&#39;,
       &#39;Albertson College of Idaho, Caldwell, Idaho, USA&#39;,
       &#39;School of Archaeology and Oriental Studies, Liverpool University, Liverpool, UK&#39;,
       &#39;Columbia University Library, New York, New York, USA&#39;,
       &#39;Cincinnati Art Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Clinton Historical Society, Clinton, Massachusetts, USA&#39;,
       &#39;Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;Erzabtei St. Martin zu Beuron, Beuron, Germany&#39;,
       &#39;Special Collections, Robert Manning Strozier Library, Florida State University, Tallahassee, Florida, USA&#39;,
       &#39;American University of Beirut Archaeological Museum, Beirut, Lebanon&#39;,
       &#39;private: Moussaieff, Shlomo, London, UK&#39;,
       &#39;MacKenzie Art Gallery, University of Regina Collection&#39;,
       &#39;Knox College, Galesburg, IL, USA&#39;,
       &#39;private: anonymous, New York, New York, USA ?&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collection, UCLA, Los Angeles, USA&#39;,
       &#39;John Rylands Library, University of Manchester, Manchester, UK&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, The Netherlands&#39;,
       &#39;The Oriental Institute, Chicago&#39;,
       &#39;Los Angeles Unified School District, Los Angeles, California, USA&#39;,
       &#39;Diyarbakır Archaeological Museum, Diyarbakır, Turkey&#39;,
       &#39;Harvard Art Museum / Arthur M. Sackler Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Denver Museum of Natural Science, Denver, Colorado, USA&#39;,
       &#39;Badè Museum of Biblical Archaeology, Pacific School of Religion, Berkeley, California, USA&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;private: anonymous, New Jersey, USA&#39;,
       &#39;University of Pécs, Pécs, Hungary&#39;,
       &#39;Museum of Fine Arts, Budapest, Hungary&#39;,
       &#39;Department of Assyriology and Hebrew Studies, Eötvös L. University, Budapest&#39;,
       &#39;Arizona State Museum, Tucson, Arizona, USA&#39;,
       &#39;Morgan Library, Colorado State University, Fort Collins, Colorado, USA&#39;,
       &#39;Toppan Rare Books Library, University of Wyoming, Laramie, Wyoming, USA&#39;,
       &#39;Museum Forum der Völker (Völkerkundemuseum der Franziskaner), Werl, Germany&#39;,
       &#39;private: Owen, E. L., Lake Hopatcong, New Jersey, USA&#39;,
       &#39;Peabody Essex Museum, Salem, Massachusetts, USA&#39;,
       &#39;Penrose Library, Whitman College, Walla Walla, Washington, USA&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA&#39;,
       &#39;Lilly Library, Indiana University, Bloomington, Indiana, USA&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA (permanent loan from Missouri School of Religion [formerly “Bible College of Missouri”], Jefferson City, Missouri)&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA&#39;,
       &#39;Saint Louis Art Museum, St. Louis, Missouri, USA&#39;,
       &#39;private: anonymous, New York, New York, USA&#39;,
       &#39;Semitics/ICOR Collections, Catholic University of America, Washington, DC, USA&#39;,
       &#39;Nicholson Museum, University of Sydney, Sydney, Australia&#39;,
       &#39;Ethniko Archaiologiko Museo, Athens, Greece&#39;,
       &#39;Eugene Fuller Memorial Collection,  Seattle Art Museum, Seattle, Washington, USA&#39;,
       &#39;Chancellor University Collection, Cleveland, Ohio, USA&#39;,
       &#39;American Museum of Natural History, New York, New York, USA&#39;,
       &#39;Couvent Sainte-Anne, Jerusalem&#39;,
       &#39;New Brunswick Theological Seminary, New Brunswick, New Jersey, USA&#39;,
       &#39;Rush Rhees Library, University of Rochester, Rochester, New York, USA&#39;,
       &#39;Nimrud, Iraq (a) &amp; (d); Musei Vaticani, Vatican CIty, Rome, Italy (b); Memorial Art Gallery, University of Rochester, Rochester, New York, USA (c); unlocated (e)&#39;,
       &#39;Memorial Art Gallery, University of Rochester, Rochester, New York, USA&#39;,
       &#39;Australian Institute of Archaeology, Melbourne,Victoria, Australia&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a)&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;David Alderfer Collection, Downers Grove, Illinois, USA&#39;,
       &#39;Burrell Collection. Art Gallery and Museum, Glasgow  (a); Metropolitan Museum of Art, New York, New York, USA (b); Nimrud Collection, Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a); Nimrud, Iraq (b); Metropolitan Museum of Art, New York, New York, USA (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a) &amp; (d); Metropolitan Museum of Art, New York, New York, USA (b); State Hermitage Museum, St. Petersburg, Russian Federation (c); Muzeum Narodowe w Warszawie, Warsaw (e); State Hermitage Museum, St. Petersburg, Russian Federation (f); unloc&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a); Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (b)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a-b); Nimrud, Iraq (c)&#39;,
       &#39;Nimrud, Iraq (a) &amp; (c); Metropolitan Museum of Art, New York, New York, USA (b); unlocated (d)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a); Nimrud, Iraq (b)&#39;,
       &#39;Mayo, Ireland (Gwyn)&#39;, &#39;Kyoto, Japan&#39;,
       &#39;private: anonymous, Venice, Italy&#39;,
       &quot;Mabee-Gerrer Museum, St. Gergory&#39;s University, Shawnee, Oklahoma, USA&quot;,
       &#39;Museum for Art and History, Geneva&#39;,
       &#39;Williams College Museum of Art, Williamstown, Massachusetts, USA&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA&#39;,
       &#39;British Museum, London, UK (a)&#39;,
       &#39;Nimrud, Iraq (a); unlocated (b)&#39;,
       &#39;British Museum, London, UK (a-b); unlocated (c)&#39;,
       &#39;British Museum, London, UK (a-c); unlocated (d)&#39;,
       &#39;British Museum, London, UK (a); Museo Civico di Archeologia Ligure, Genua, Italy (b); Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (c); British Museum, London, UK (d); Nimrud, Iraq (e); Collection Fred Elghanayan, New York, New York, USA (f); unlo&#39;,
       &#39;British Museum, London, UK (a-b); National Museum of Iraq, Baghdad, Iraq (c); unlocated (d)&#39;,
       &#39;British Museum, London, UK (a-b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a); Fitzwilliam Museum, University of Cambridge, Cambridge, UK (b); private: anonymous, unlocated (c); unlocated (d)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a); Bowdoin College, Brunswick, Maine, USA (b); unlocated (c)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); British Museum, London, UK (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Skulpturensammlung, Dresden, Germany (a)&#39;,
       &#39;Nimrud, Iraq (a-c); unlocated (d)&#39;,
       &#39;Fogg Art Museum, Harvard University, Cambridge, Massachusetts, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;British Museum, London, UK (a); unlocated (b)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a); British Museum, London, UK (b)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (a)&#39;,
       &#39;British Museum, London, UK (a); National Museum of Iraq, Baghdad, Iraq (b); British Museum, London, UK (c)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 381ff. (description) (a)&#39;,
       &#39;unlocated: reconstructed analog to C-12; Meuszynski, BaF 2, p. 26. 28 (a)&#39;,
       &#39;Louvre Museum, Paris, France (a); unlocated (b)&#39;,
       &#39;Miho Museum, Kyoto, Japan (a); unlocated (b)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (a); Nimrud, Iraq (b-e); unlocated (f)&#39;,
       &#39;Virginia Museum of Fine Arts, Richmond, Virginia, USA (a); National Museum of Iraq, Baghdad, Iraq (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a); unlocated (b)&#39;,
       &#39;unlocated: reconstructed according to position mirrored by C-02 (a)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 384f. (description) (a)&#39;,
       &#39;Nimrud, Iraq (a)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a); unlocated (b)&#39;,
       &#39;Nimrud, Iraq (a-c); Williams College Museum of Art, Williamstown, Massachusetts, USA (d);  unlocated (e)&#39;,
       &#39;Brooklyn Museum, Brooklyn, New York, USA (a)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s description of the room (unlocated: Layard, Monuments of Nineveh I, p. 385f. (a)&quot;,
       &#39;Mosul Museum, Mosul, Iraq (a)&#39;,
       &#39;unlocated: reconstructed according to the placement of slabs in this room; cp. Paley/Sobolewski, BaF 10, p. 85 and pl. 6, 33 (a)&#39;,
       &#39;Museum and Art Gallery, Bristol, UK (a)&#39;,
       &#39;Nimrud, Iraq (a); Vorderasiatisches Museum, Berlin, Germany (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a-h); unlocated (i)&#39;,
       &#39;Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (a)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA (a); British Museum, London, UK (b); Nimrud, Iraq (c)&#39;,
       &#39;private: anonymous, New York, New York, USA (a); National Museum of Iraq, Baghdad, Iraq (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a-b, d); Musées royaux d’Art et d’Histoire, Brussels, Belgium (c); unlocated (e)&#39;,
       &#39;British Museum, London, UK (a); Nimrud, Iraq (b-d); Kalamazoo Valley Museum, Kalamazoo, Michigan, USA (e); unlocated (f)&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK (a)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. XXXIX (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 385f. (description) (a)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 386f. (description) (a)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Louvre Museum, Paris, France (a)&#39;,
       &#39;unlocated: reconstructed according to analog slabs H-11 and H-24 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. LXII (a)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a)&#39;,
       &#39;Museum Calouste Gulbenkian, Lisbon, Portugal (a)&#39;,
       &#39;Christ Church College, Oxford, UK (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;M.H. De Young Museum, San Francisco, California, USA (a); unlocated (b)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s general description (Monuments of Nineveh I, 145. 386) of the room and analog to the opposite wall (a)&quot;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (now Dresden) (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA&#39;,
       &#39;Wadsworth Atheneum, Hartford, Connecticut, USA (a); Montreal Museum of Fine Arts, Montreal, Canada (b)&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA (a); Amherst College, Amherst, Masssachusetts, USA (b)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a); National Museum of Iraq, Baghdad, Iraq (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a-d); unlocated (e)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (a); Nimrud, Iraq (b)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Nimrud, Iraq (b); Fitzwilliam Museum, University of Cambridge, Cambridge, UK (c); unlocated (d)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland (a); British Museum, London, UK (b); British Museum, London, UK (c); unlocated (d)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Museo Barracco, Rome, Italy (b); Nimrud, Iraq (c); Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (d); unlocated (e)&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a); Nimrud, Iraq (b) &amp; (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a-b); unlocated (c)&#39;,
       &#39;private: anonymous (a); Nimrud, Iraq (b); Idemitsu Museum of Arts, Tokyo, Japan (c); unlocated (d)&#39;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada (a); British Museum, London, UK (b); unlocated (c)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (a); British Museum, London, UK (b); unlocated (c)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a); Nationalmuseet, Copenhagen, Denmark (b); Ashmolean Museum, Oxford, UK (c); Nimrud, Iraq (d); unlocated (e)&#39;,
       &#39;Louvre Museum, Paris, France (a); Bhau Daji Lad Museum, Mumbai, India (formerly Victoria and Albert Museum) (b); unlocated (c)&#39;,
       &quot;Arts &amp; Culture Centre, Memorial Univ., St. John&#39;s, Newfoundland, Canada (a); Nimrud, Iraq (b-c); Paisley Art Gallery and Museum, Renfrewshire, UK (d)&quot;,
       &#39;British Museum, London, UK (a); Nimrud, Iraq (b); Museum of Fine Arts, Houston, Texas, USA (c); unlocated (d)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a); private: Collection Samuel Josefowitz, Lausanne, Switzerland (b); Nimrud, Iraq (c); British Museum, London, UK (d); unloca&#39;,
       &#39;Nimrud, Iraq (a); British Museum, London, UK (b); Louvre Museum, Paris, France (c); Nimrud, Iraq (d); Detroit Institute of Arts, Detroit, Michigan, USA (e); British Museum, London, UK; Louvre Museum, Paris, France (f); unlocated (g)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a-b, e); Magdalen College, Oxford, UK (c); Nimrud, Iraq (d); Amherst College, Amherst, Masssachusetts, USA (f); unlocated (g)&#39;,
       &#39;Nimrud, Iraq (a); Arkeoloji Müzeleri, Istanbul, Turkey (b); Glencairn Museum, Bryn Athyn, Pennsylvania, USA (c); Nimrud, Iraq (d); British Museum, London, UK (e); unlocated (f)&#39;,
       &#39;Nimrud, Iraq (a); Ashmolean Museum, Oxford, UK (b); Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (c); unlocated (d)&#39;,
       &#39;unlocated: reconstructed based on composition of neighboring reliefs only; cp. Paley/Sobolewski, BaF 10, p. 33 (a)&#39;,
       &#39;Chrysler Museum of Art, Norfolk, Virginia, USA (a); unlocated (b)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA ? (a; =? L-14 (b)); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a); unlocated (b)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Middlebury College, Middlebury, Vermont, USA&#39;,
       &#39;Nimrud, Iraq (a); Cincinnati Art Museum, Cincinnati, Ohio, USA (b); unlocated (c)&#39;,
       &#39;Nelson-Atkins Museum of Art, Kansas City, Missouri, USA (a)&#39;,
       &#39;Nimrud, Iraq (a); Kimbell Art Museum, Fort Worth, Texas, USA (b)&#39;,
       &#39;Nimrud, Iraq (a); Glencairn Museum, Bryn Athyn, Pennsylvania, USA ? (b; =? L-03 (a)); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a); British Museum, London, UK (b)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (a); unlocated (b)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (a); Saint Louis Art Museum, St. Louis, Missouri, USA (b); unlocated (c)&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a); Nimrud, Iraq (b-c); unlocated (d)&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a); Nimrud, Iraq (b)&#39;,
       &#39;British Museum, London, UK (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA (a)&#39;,
       &#39;Fleming Museum, University of Vermont, Burlington, Vermont, USA (a)&#39;,
       &#39;Nimrud, Iraq (a); British Museum, London, UK (b); Nimrud, Iraq (c); unlocated (d)&#39;,
       &#39;Nimrud, Iraq (a); Abegg Foundation, Bern, Switzerland (b)&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA (a)&#39;,
       &#39;unlocated: reconstructed based on symmetrical relief N-08; Meuszynski, BaF 2, p. 75 (a)&#39;,
       &#39;Swedish National Museum, Stockholm, Sweden (a)&#39;,
       &#39;Worcester Art Museum, Worcester, Massachusetts, USA (a)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a); Ny Carlsberg Glyptotek, Copenhagen, Denmark (b)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a)&#39;,
       &#39;Museum of Art, Cleveland, Ohio, USA (a); unlocated (b)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (a)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a); Nimrud, Iraq (b); unlocated (c)&#39;,
       &#39;Nimrud, Iraq (a. c-e); The Art Institute of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;private: anonymous, unlocated (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (a)&#39;,
       &#39;Nimrud, Iraq (a); private: anonymous, unlocated (b); Nimrud, Iraq (c, e); Museum für Kunst und Gewerbe, Hamburg, Germany (d);&#39;,
       &#39;Nimrud, Iraq (a-b, d-g); private: Collection Merrin, New York, New York, USA ? (c); unlocated (h)&#39;,
       &#39;Nimrud, Iraq (a); Manchester University, Museum, Manchester, UK (b)&#39;,
       &#39;Nimrud, Iraq (a, c-h); Musées royaux d’Art et d’Histoire, Brussels, Belgium (b)&#39;,
       &#39;Nimrud, Iraq (a), d-f; Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (b); unlocated (g)&#39;,
       &#39;Tigris, Iraq&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a); Skulpturensammlung, Dresden, Germany (b); Nimrud, Iraq (c)&#39;,
       &quot;unlocated: reconstructed according to Layard&#39;s description (Layard, Monuments of Nineveh I, p.389) and the arrangement of neighboring reliefs (a)&quot;,
       &#39;unlocated: reconstructed according to the available space and arrangement of reliefs in this entrance (a); unlocated (b)&#39;,
       &#39;Nimrud, Iraq (a-c)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 32; Original Drawings III, S.W. IV (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (a); unlocated (c)&#39;,
       &#39;unlocated: Layard, Original Drawings IV, Misc. I (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 28 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, S.W. X (a)&#39;,
       &#39;Mosul Museum, Mosul, Iraq (a); unlocated (b)&#39;,
       &quot;Arts &amp; Culture Centre, Memorial Univ., St. John&#39;s, Newfoundland, Canada (a); unlocated (b)&quot;,
       &#39;British Museum, London, UK (a); Oriental Institute, University of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;British Museum, London, UK (a); British Museum, London, UK (b)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a)&#39;,
       &#39;Nimrud, Iraq (a); unlocated: reconstructed as counterpart to Z-09 (b)&#39;,
       &#39;Louvre Museum, Paris, France (a); Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (b)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a); National Museum of Iraq, Baghdad, Iraq (b-d); British Museum, London, UK (e); Nimrud, Iraq (f); unlocated (g)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 35, possibly lost in the Tigris (a)&#39;,
       &#39;unlocated: reconstructed parallel to Zb-02 (a)&#39;,
       &#39;unlocated: reconstructed analog to other entrances (a)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland&#39;,
       &#39;Canadian Museum of Civilization, Ottawa, Ontario, Canada&#39;,
       &#39;Irvin Department of Rare Books and Special Collections, Ernest F. Hollings Special Collections Library, University of South Carolina Libraries, Columbia, South Carolina, USA&#39;,
       &#39;Tufts University, Bendetson Hall, Medford, Massachusetts, USA&#39;,
       &#39;The British Museum, London&#39;, &#39;Tell Muqayyar, Iraq&#39;,
       &#39;Museo Arqueológico Nacional, Madrid, Spain&#39;,
       &#39;private: anonymous, uncertain&#39;,
       &#39;Institute of Archaeology, Hebrew University, Jerusalem&#39;,
       &#39;private: Mr. Arieh Ben Eli, Haifa, Israel&#39;,
       &#39;The Israel Museum, Jerusalem; private: Mahboubian, H.&#39;,
       &quot;St. Andrew&#39;s Memorial Church, Church of Scotland, Jerusalem&quot;,
       &#39;Niedersächsische Landesmuseum Hannover, Germany&#39;,
       &#39;Library of Centenary College, Shreveport, Louisiana, USA&#39;,
       &#39;Allen Memorial Arl Museum, Oberlin, Ohio, USA&#39;,
       &#39;McLennan Library, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: Pabst, J. B, unlocated&#39;,
       &#39;Department of Classics, University of Cincinnati, Cincinnati, Ohio, USA&#39;,
       &#39;Hebrew Union College Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Historical Society, Suffield, Connecticut, USA&#39;,
       &#39;Drew University, Madison, New Jersey, USA&#39;,
       &#39;New Brunswick Museum, Saint John, New Brunswick, Canada&#39;,
       &#39;Stovall Museum of Science and History, University of Oklahoma, Norman, Oklahoma, USA&#39;,
       &#39;private: anonymous, France&#39;,
       &#39;Public Library of Cincinnati and Hamilton County, Cincinnati, Ohio, USA&#39;,
       &#39;Royal Albert Memorial Museum and Art Gallery, Exeter, Devon, UK&#39;,
       &#39;private: Strauss, unlocated&#39;,
       &#39;private: Gîatzer, V., Wiesbaden, Germany&#39;,
       &#39;Museum of Fine Arts, Boston, Massachusetts, USA&#39;,
       &#39;Walker Art Center, Minneapolis, Minnesota, USA (diszpersed)&#39;,
       &#39;Musée de Picardie. Amiens, France&#39;,
       &#39;George Ortiz Collection, Geneva, Switzerland&#39;,
       &#39;National Museum of Syria, Damascus, Syria ?&#39;,
       &#39;private: Armas Salonen (?), Helsinki, Finland&#39;, &#39;unclear&#39;,
       &#39;private: anonymous, UK&#39;, &#39;private: anonymous, Jerusalem&#39;,
       &#39;Finnish National Museum, Helsinki, Finland&#39;,
       &#39;Altorientalisches Seminar, Free University of Berlin, Berlin, Germany&#39;,
       &#39;private: Likhochev&#39;,
       &#39;Smith College, Northampton, Massachusetts, USA&#39;,
       &#39;Manitoba Museum of Man and Nature, Winnipeg, Manitoba, Canada&#39;,
       &#39;Museum of the Buffalo Society of Natural Sciences, Buffalo, New York, USA&#39;,
       &#39;private: Mercer, S., unlocated&#39;,
       &#39;Crocker Art Museum, Sacramento, California, USA&#39;,
       &#39;private: Cherkasy&#39;, &#39;Newbury District Museum, Newbury, UK&#39;,
       &#39;private: F. Seidl-Geuthner, Paris, France&#39;,
       &#39;Claremont School of Theology, Claremont, California, USA&#39;,
       &#39;Übersee-Museum, Bremen, Germany&#39;,
       &#39;Toledo Museum of Art, Toledo, Ohio, USA&#39;,
       &#39;Institute of Egyptian Studies, University of Cambridge, Cambridge, UK&#39;,
       &#39;Private Arnold Spaer, FM 44 E.000-5, Jerusalem&#39;,
       &#39;Crocker Art Museum, Sacramento, CA, USA&#39;,
       &#39;Brooklyn Museum of Art, Brooklyn, New York, USA&#39;,
       &#39;St. Paul Public Library Collection, St. Paul, Minnesota, USA (dispersed)&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey; British Museum, London, UK&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey; Ashmolean Museum, Oxford, UK ?&#39;,
       &#39;Karpeles Collection, Santa Barbara, California, USA&#39;,
       &#39;private: Sivan, Raanan, Jerusalem&#39;,
       &quot;Musée d&#39;art de Joliette, Québec, Canada&quot;,
       &#39;private: anonymous, Pasadena, California, USA&#39;,
       &#39;Mount Holyoke College Art Museum, South Hadley, Massachusetts, USA&#39;,
       &#39;private: Harari, Moshe, Tel Aviv, Israel&#39;,
       &#39;Smithsonian Institution, Washington, DC, USA&#39;,
       &#39;Museum and Art Gallery, Bristol, UK&#39;,
       &#39;Institute of Archaeology, University of Copenhagen, Denmark&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA ?&#39;,
       &#39;private: Feuardent, M., London, UK ?&#39;,
       &#39;Département des Monnaies, Médailles et Antiques, Bibliothèque Nationale, Paris, France&#39;,
       &#39;Institute of Egyptian Studies, Cambridge, UK&#39;,
       &#39;Tyndale House, University of Cambridge, Cambridge, UK&#39;,
       &#39;Kunsthistorisches Museum, Vienna, Austria&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland&#39;,
       &#39;British Museum, London, UK; Detroit Institute of Arts, Detroit, Michigan, USA&#39;,
       &#39;Collection de Clerq&#39;,
       &#39;National Museum of Syria, Aleppo, Syria; National Museum of Syria, Raqqa, Syria&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian&#39;,
       &#39;private: anonymous, Sweden&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy&#39;,
       &#39;private: Seelye, L.H., New York, New York, USA&#39;,
       &#39;Wiener Museum für Völkerkunde, Vienna, Austria&#39;,
       &#39;private: Hares, D., unlocated, UK&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Philadelphia Museum of Art, Philadelphia, Pennsylvania, USA&#39;,
       &#39;private: anonymous, Berlin, Germany&#39;,
       &#39;private: anonymous, Russia&#39;, &#39;private: Rosen, J., USA&#39;,
       &#39;private: Garret, R., Baltimore, Maryland, USA&#39;,
       &#39;Museum of Ancient Cultures, Macquarie University, Sydney, Australia&#39;,
       &#39;The Hunterian Museum and Art Gallery, Glasgow, UK&#39;,
       &#39;University of Leuven, Leuven, Belgium&#39;,
       &#39;Davidson College Library, Davidson, NC, USA&#39;,
       &#39;Università Pontificia Salesiana, Rome, Italy&#39;,
       &#39;Pickler Memorial Library, Truman State University, Kirksville, Missouri, USA&#39;,
       &#39;Center for Advanced Judaic Studies, University of Pennsylvania, Philadephia, Pennsylvania, USA&#39;,
       &#39;Private: anonymous, Sweden&#39;, &#39;Patterson Museum, New Jersey, USA&#39;,
       &#39;Princeton University Library, Princeton, New Jersey, USA&#39;,
       &#39;Brooklyn Museum, Brooklyn, New York, USA&#39;, &#39;Tello, Iraq&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, California, USA; de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &#39;private: Jacobsen collection ?&#39;, &#39;private: Cugnin, France&#39;,
       &#39;Trinity College, Dublin, Ireland&#39;,
       &#39;private: Binning, Mellerstain, Berwickshire, UK&#39;,
       &#39;private: Smit, Amsterdam, Holland&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian Federation&#39;,
       &#39;Charlotte M. Smith Collection of Miniature Books, University Libraries, University of Iowa, Iowa City, Iowa, USA&#39;,
       &#39;private: anonymous, Barcelona, Spain&#39;,
       &#39;Kenneth Spencer Research Library, University of Kansas, Lawrence, Kansas, USA&#39;,
       &#39;University of King’s College, Halifax, Nova Scotia, Canada&#39;,
       &#39;Musée de la Castre, Cannes, France&#39;,
       &#39;British Museum, London, UK; Metropolitan Museum of Art, New York, New York, USA&#39;,
       &#39;Mustansiriyah, Baghdad, Iraq&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA&#39;,
       &#39;Allegheny College, Meadville, Pennsylvania, USA&#39;,
       &#39;Buffalo and Erie County Public Library, Buffalo, New York, USA&#39;,
       &#39;St Louis, Missouri, USA&#39;, &#39;Leiden&#39;,
       &#39;private: Brenner, Ori, Rehovot, Israel&#39;,
       &#39;Kahramanmaraş Museum, Turkey&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria ?unlocated&#39;,
       &#39;Muséum Peronne, France&#39;, &#39;Joanneum Museum, Graz, Austria&#39;,
       &#39;University of Leeds, Leeds, UK&#39;, &#39;University of Lwów, Poland&#39;,
       &#39;Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri, Istanbul, Turkey ?&#39;,
       &#39;private: Dorsky, Morris (on loan to J. Pierpont Morgan Library Collection, New York, New York, USA)&#39;,
       &#39;Abbey Museum, Queensland, Australia&#39;,
       &#39;Kestner Museum, Hannover, UK&#39;,
       &#39;private: anonymous, Vienna, Austria&#39;,
       &#39;Real Academia de la Historia, Madrid, Spain&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;private, Perk, H., Turkey&#39;,
       &#39;Mount Holyoke College, South Hadley, Massachusetts, USA&#39;,
       &#39;Erebuni Historico-Archaeological Museum- Reserve,&#39;,
       &#39;private: Foroughi collecllon&#39;, &#39;Iran Bastan Museum, Tehran, Iran&#39;,
       &#39;Eski Sark Museum, Istanbul, Turkey&#39;,
       &#39;private: Chappée collecllon&#39;, &#39;private: Mazda, A., Tehran, Iran&#39;,
       &#39;private: R.F. Harper collection&#39;, &#39;private: Foroughi collection&#39;,
       &#39;Oesterle Library, North Central College, Naperville, Illinois, USA&#39;,
       &#39;Russell Library, Maynooth University &amp; St. Patrick’s College, Maynooth, Co. Kildare, Ireland&#39;,
       &#39;Northwestern University Library, Evanston, Illinois, USA&#39;,
       &#39;National Car Museum of Iran, Tehran, Iran&#39;,
       &#39;Erie Historical Museum, Erie, Pennsylvania, USA&#39;,
       &#39;San Diego Museum of Man, San Diego, California, USA&#39;,
       &#39;Museum of Peoples and Cultures, Brigham Young University, Provo, Utah, USA&#39;,
       &#39;Missouri History Museum, St. Louis, Missouri, USA&#39;,
       &#39;Erebuni Museum, Yerevan, Armenia&#39;, &#39;private: Estonia&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a); unlocated (b)&#39;,
       &#39;Private collection: F.S. Clark, Mayfield, UK&#39;,
       &#39;Department of Classics, University of Texas at Austin, Texas, USA&#39;,
       &#39;Archäologische Staatssammlung, Museum für Vor- und Frühgeschichte, Munich, Germany&#39;,
       &#39;Association Bible &amp; Civilisations, Jerusalem&#39;,
       &#39;Leipziger Altorientalischen Institut, Leipzig, Germany&#39;,
       &#39;Saint Louis Public Library, St. Louis, Missouri, USA&#39;,
       &#39;Sulaymaniyah Museum, Sulaymaniyah, Iraq&#39;,
       &#39;private: Lichatschew, N. P., Istanbul, Turkey&#39;, &#39;missing&#39;,
       &#39;Sächsische Landesbibliothek, Staats- und Universitätsbibliothek Dresden, Germany&#39;,
       &#39;private: Vora&#39;, &#39;IM&#39;,
       &#39;Oneida County Historical Society, Utica, New York, USA&#39;,
       &#39;Abu Shahrain, Iraq&#39;, &#39;El-Hiba, Iraq&#39;, &#39;Nuffar, Iraq&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA&#39;, &#39;left in situ&#39;,
       &#39;private: anonymous, Vienna, Austria ?&#39;,
       &#39;Creighton University, Omaha, Nebraska, USA&#39;,
       &#39;Brighton Museum and Art Gallery, Brighton, UK&#39;,
       &#39;Aichi Prefectural University, Aichi, Japan&#39;,
       &#39;Quayle Bible Collection, Baker University, Baldwin City, Kansas, USA&#39;,
       &#39;private: Jerusalem&#39;, &#39;private: unlocated&#39;,
       &#39;Tsurumi University Library, Yokohama, Japan&#39;,
       &quot;Kobe Women&#39;s University Library, Kobe, Japan&quot;,
       &#39;Meiji University Library, Tokyo, Japan&#39;,
       &#39;Kansai University Library, Osaka, Japan&#39;,
       &#39;private: Ponsar, Jean-François, Brussels, Belgium&#39;,
       &quot;A&#39;ali, Bahrain&quot;, &#39;Musée des Confluences, Lyon, France&#39;,
       &#39;Dover Museum, Dover, UK&#39;,
       &#39;private: Foxvog, Daniel A., Rio Nido, CA, USA&#39;,
       &#39;private: anonymous&#39;, &#39;private: unknown, unlocated&#39;,
       &#39;Department of Middle Eastern Studies, University of West Bohemia, Pilsen, Czech Republic&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA&#39;,
       &#39;Private Collection&#39;,
       &#39;Istanbul Arkeoloki Museum, Istanbul, Turkey&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; Istanbul Arkeoloki Museum, Istanbul, Turkey&#39;,
       &#39;Garstang Museum of Archaeology, University of Liverpool, Liverpool, UK&#39;,
       &#39;Civico Museo Archeologico Paolo Giovio, Como, Italy&#39;,
       &#39;Louvre Museum, Paris, France; British Museum, London, UK&#39;,
       &#39;Diözesanmuseum, Breslau, Poland&#39;, &#39;Mosul, Iraq ?&#39;,
       &#39;Eşki Şark Eserleri Müzesi, Istanbul, Turkey ?&#39;,
       &#39;Babylon, Iraq (in situ) ?&#39;,
       &#39;Private collection: anonymous, Berlin, Germany&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; British Museum, London, UK&#39;,
       &#39;Institute of Archaeology, University of Turin, Turin, Italy&#39;,
       &#39;Urfa Museum, Urfa, Turkey&#39;, &#39;Private collection: anonymous&#39;,
       &#39;Sela, Jordan&#39;, &#39;Tayma, Saudi Arabia&#39;,
       &#39;Archaeological Museum, Anakara, Turkey&#39;, &#39;private collection&#39;,
       &#39;private: Lizana, Joaquín, Huesca, Spain&#39;,
       &#39;private: Saaedi, London&#39;, &#39;Sammlung H. Grimme, Cologne, Germany&#39;,
       &#39;Erimtan Museum of Archaeology and Art, Ankara, Turkey&#39;,
       &#39;Gaziantep Archaeological Museum, Gaziantep, Turkey&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium; Kayseri Archaeological Museum, Kayseri, Turkey&#39;,
       &#39;private: Peter Franke, Saarbrücken, Germany&#39;,
       &#39;Lands of the Bible Archaeology Foundation&#39;,
       &#39;Hatay Archaeological Museum, Antakya, Turkey&#39;,
       &#39;Altorientalischen Seminar der Universität Tübingen, Germany&#39;,
       &#39;H.I.H. Prince Takahito Mikasa&#39;, &#39;Private collection&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (unlocated (formerly in theTell Halaf Museum); British Museum, London, UK&#39;,
       &#39;unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, USA&#39;,
       &#39;Merseyside Museum, Liverpool, UK&#39;, &#39;Louvre, Paris&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany; British Museum, London, UK; Département des Monnaies, Médailles et Antiques, Bibliothèque Nationale, Paris, France; Nebuchadnezzar Museum, Babylon, Iraq; Iraq Museum, Baghdad, Iraq&#39;,
       &#39;Arkeoloji Müzerleri, Istanbul, Turkey&#39;,
       &#39;British Museum, London, UK; Vorderasiatisches Museum, Berlin, Germany; Arkeoloji Müzerleri, Istanbul, Turkey&#39;,
       &#39;Private Collection: de Clercq, Paris, France&#39;,
       &#39;Arkeoloji Müzerleri, Istanbul, Turkey; Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Philadelphia Museum of Art, Philadelphia, Pennsylvania, USA; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;British Museum, London, UK; Ashmolean Museum, Oxford, UK; City of Bristol Museum and Art Gallery, Bristol, UK; University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA; Arkeoloji Müzerleri, Istanbul, Turkey; Yale Collection, New Haven, Connecticut, USA; Private Collection: Harper, Unknown, USA; Hilprecht-Sammlung, Fr. Schiller University, Jena, Germany; McGill University Ethnological Collections, Montreal, Quebec Province, Canada&#39;,
       &#39;Seminar für Assyriologie, Universität Heidelberg, Heidelberg, Germany; Yale Collection, New Haven, Connecticut, USA; Hearst Museum of Anthropology, University of California at Berkeley, Berkeley, California, USA&#39;,
       &#39;stele today lost photo of squeeze in the Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Georgian National Museum, Tbilisi, Georgia&#39;,
       &#39;British Museum, London, Great Britain&#39;, &#39;in situ&#39;,
       &#39;Sulaymaniyah Museum,&#39;, &#39;British Museum&#39;, &#39;University of Leeds&#39;,
       &#39;VAM&#39;, &#39;IAM&#39;, &#39;MMA&#39;, &#39;VAM and IAM&#39;,
       &#39;in situ, but never seen/found again&#39;, &#39;Van Museum, Van, Turkey&#39;,
       &#39;moulds of the three fragments (a-c) preserved in the Georgian National Museum, Tbilisi, Armenia (fragment a): found again in a private garden fragment c): lost)&#39;,
       &#39;lost&#39;,
       &#39;in situ, immured in the ruins of the church well preserved cast&#39;,
       &#39;History Museum of Armenia, Erevan, Armenia&#39;,
       &#39;ragment a): Van Museum, Van, Turkey fragment b): Istanbul Archaeology Museums, Istanbul, Turkey&#39;,
       &#39;Iraq Museum, Baghdad, Iraq&#39;,
       &#39;Tell Halaf museum collection, Berlin (destroyed)&#39;,
       &#39;Syro-Chaldean seminary of Mosul&#39;,
       &#39;Private collection of Prof. Peter Franke, Saarbrücken&#39;,
       &#39;Private collection of Shlomo Moussaieff, on long-term loan in the Bible Lands Museum, Jerusalem, Israel&#39;,
       &#39;Private: H. V. Hilprecht&#39;,
       &#39;John F. Lewis collection, Philadelphia Free Library, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Brisith Museum, London, UK&#39;, &#39;Private: H.V. Hilprecht&#39;,
       &#39;Metropolitan Museum of Art, New York, USA&#39;,
       &#39;private: Amherst, unlocated (dispersed)&#39;,
       &#39;private: Ifergan Gallery (antiquarian), Málaga, Spain&#39;,
       &#39;University of Utah, J. Willard Marriott Library, Salt Lake City, USA&#39;,
       &#39;private: Green, Oklahoma City, USA&#39;, &#39;unknown, unlocated&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_wikidata_id2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_name_native2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">collection_url2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_eng2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wiki_url_native2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_collection2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_collection2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple collections</span>
<span class="n">no_match_indices_collection2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">])):</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_c</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_c</span><span class="p">:</span>
    <span class="n">P155_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_c</span> <span class="o">=</span> <span class="n">first_c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_c</span>

  <span class="c1"># if the collection has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_c</span> <span class="ow">in</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_c</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_c</span><span class="p">)</span>
    <span class="n">collection_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;factgrid_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_wikidata_id2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wikidata_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_name_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">collection_url2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_eng2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">wiki_url_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">collection_reference</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_wikidata_id2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_name_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">collection_url2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_eng2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">wiki_url_native2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_collection2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_qid2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_wikidata_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_wikidata_id2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_name_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_name_native2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;collection_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_url2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;wiki_url_eng&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_eng2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;wiki_url_native&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki_url_native2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;P155_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_collection2</span>
<span class="n">collection_df2</span><span class="p">[</span><span class="s1">&#39;other_collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_collection2</span>

<span class="n">collection_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-39b63a7d-37d5-4f3b-9c3b-ae22cf6ffe8d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-39b63a7d-37d5-4f3b-9c3b-ae22cf6ffe8d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-39b63a7d-37d5-4f3b-9c3b-ae22cf6ffe8d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-39b63a7d-37d5-4f3b-9c3b-ae22cf6ffe8d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3546667d-77d7-4134-8a84-b17febbd070d">
  <button class="colab-df-quickchart" onclick="quickchart('df-3546667d-77d7-4134-8a84-b17febbd070d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3546667d-77d7-4134-8a84-b17febbd070d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-collection-df2">
<h3>3.2.2 matched_collection_df2<a class="headerlink" href="#matched-collection-df2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df2</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="p">[</span><span class="o">~</span><span class="n">collection_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_collection2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_collection_df2</span> <span class="o">=</span> <span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_collection_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-70baebc7-1f4f-4a77-9402-c5324627ea31" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>oracc_dump_id</th>
      <th>oracc_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32452</th>
      <td>Q008369</td>
      <td>British Museum, London, UK</td>
      <td>British Museum, London, UK</td>
      <td>Q102010</td>
      <td>Q6373</td>
      <td>British Museum</td>
      <td>British Museum</td>
      <td>https://www.britishmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
      <td>https://en.wikipedia.org/wiki/British_Museum</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32453</th>
      <td>P101902</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Q511934</td>
      <td>Q636400</td>
      <td>Ashmolean Museum</td>
      <td>Ashmolean Museum</td>
      <td>https://www.ashmolean.org</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32454</th>
      <td>P330624</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>Q511934</td>
      <td>Q636400</td>
      <td>Ashmolean Museum</td>
      <td>Ashmolean Museum</td>
      <td>https://www.ashmolean.org</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td>https://en.wikipedia.org/wiki/Ashmolean_Museum</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>32455</th>
      <td>P374078</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>Q511904</td>
      <td>Q1276053</td>
      <td>Oriental Institute, University of Chicago</td>
      <td>Oriental Institute, University of Chicago</td>
      <td>https://oi.uchicago.edu</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
      <td>https://en.wikipedia.org/wiki/Oriental_Institu...</td>
      <td>Q22757</td>
      <td></td>
    </tr>
    <tr>
      <th>32456</th>
      <td>P500761</td>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>Q512004</td>
      <td>Q160236</td>
      <td>Metropolitan Museum of Art</td>
      <td>Metropolitan Museum of Art</td>
      <td>https://www.metmuseum.org</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Mus...</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>32457 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-70baebc7-1f4f-4a77-9402-c5324627ea31')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-70baebc7-1f4f-4a77-9402-c5324627ea31 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-70baebc7-1f4f-4a77-9402-c5324627ea31');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fd72fcb6-505f-4168-b976-a1cfa0decfb2">
  <button class="colab-df-quickchart" onclick="quickchart('df-fd72fcb6-505f-4168-b976-a1cfa0decfb2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fd72fcb6-505f-4168-b976-a1cfa0decfb2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32457, 12)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-collection-df2">
<h3>3.2.3 no_match_collection_df2<a class="headerlink" href="#no-match-collection-df2" title="Link to this heading">#</a></h3>
<p>Make a separate data frame for the texts when there is no match / museum / collection: <code class="docutils literal notranslate"><span class="pre">no_collection_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection2</span><span class="p">]</span>
<span class="n">no_match_collection_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-76b3b11d-8aec-4aba-9a5a-6ce7856191c5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>designation_x</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
      <th>designation_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>Q000002</td>
      <td>P000166</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19412,8</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19412,08</td>
      <td>Nb XVI,3/4</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000002, ex. 175</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000166</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19412,8</td>
    </tr>
    <tr>
      <th>152</th>
      <td>Q000026</td>
      <td>P000171</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19667,e</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19667,e</td>
      <td>Nc XVI,5</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Metal (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000026, ex. 037</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000171</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19667,e</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Q000023</td>
      <td>P000173</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19724</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19724</td>
      <td>Nb XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Vessels and Garments (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000023, ex. 041</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000173</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19724</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Q000002</td>
      <td>P000174</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,b</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,b</td>
      <td>Na XVI,3</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000002, ex. 094</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000174</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19726,b</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Q000013</td>
      <td>P000175</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 19726,c</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 19726,c</td>
      <td>Na XVI,3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Fish (witness)</td>
      <td>no translation</td>
      <td>CDLI Lexical 000013, ex. 009</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000175</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>S013836</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W 19726,c</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-76b3b11d-8aec-4aba-9a5a-6ce7856191c5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-76b3b11d-8aec-4aba-9a5a-6ce7856191c5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-76b3b11d-8aec-4aba-9a5a-6ce7856191c5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3f355d7d-4386-4cdf-b054-d9752166121d">
  <button class="colab-df-quickchart" onclick="quickchart('df-3f355d7d-4386-4cdf-b054-d9752166121d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3f355d7d-4386-4cdf-b054-d9752166121d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_collection_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(334459, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_collection_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h4>3.2.4 Visualization<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
</section>
<section id="id5">
<h4>Distribution of matched first collections<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_collection_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">)[</span><span class="s1">&#39;collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_c_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_c_df2</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span>
               <span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_c_df2</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_c_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c424e71f-94a3-414a-9785-d061781e2eb0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>9464</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>6171</td>
    </tr>
    <tr>
      <th>2</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>4654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>2649</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>2232</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Louvre Museum, Paris, France</td>
      <td>1812</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri,...</td>
      <td>1322</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>957</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>947</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hilprecht Collection, University of Jena, Germany</td>
      <td>369</td>
    </tr>
    <tr>
      <th>10</th>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>354</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>318</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Free Library of Philadelphia, Philadelphia, Pe...</td>
      <td>223</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Montserrat Museum, Barcelona, Spain</td>
      <td>132</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Nies Babylonian Collection, Yale Babylonian Co...</td>
      <td>129</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Musées royaux d’Art et d’Histoire, Brussels, B...</td>
      <td>121</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>68</td>
    </tr>
    <tr>
      <th>17</th>
      <td>State Hermitage Museum, St. Petersburg, Russia...</td>
      <td>65</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Royal Ontario Museum of Archaeology, Toronto, ...</td>
      <td>64</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Newell Collections of Babylonian Tablets, Yale...</td>
      <td>51</td>
    </tr>
    <tr>
      <th>20</th>
      <td>National Museum of Syria, Damascus, Syria</td>
      <td>48</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Hearst Museum of Anthropology, University of C...</td>
      <td>42</td>
    </tr>
    <tr>
      <th>22</th>
      <td>New York Public Library, New York, New York, USA</td>
      <td>38</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Spurlock Museum, University of Illinois, Urban...</td>
      <td>25</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Israel Museum, Jerusalem</td>
      <td>19</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Museo Archeologico Nazionale di Firenze, Flore...</td>
      <td>16</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Kelsey Museum of Archaeology, University of Mi...</td>
      <td>15</td>
    </tr>
    <tr>
      <th>27</th>
      <td>World Museum Liverpool, Liverpool, UK</td>
      <td>15</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Fitzwilliam Museum, University of Cambridge, C...</td>
      <td>14</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Nationalmuseet, Copenhagen, Denmark</td>
      <td>13</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Princeton Theological Seminary, Princeton, New...</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Museo di Antichità di Torino, Turin, Italy</td>
      <td>9</td>
    </tr>
    <tr>
      <th>32</th>
      <td>John Rylands Library, University of Manchester...</td>
      <td>9</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Museum Forum der Völker (Völkerkundemuseum der...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Archaeological Research Collection, University...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Bible Lands Museum, Jerusalem</td>
      <td>8</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Manchester Museum, University of Manchester, M...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Los Angeles County Museum of Art (LACMA), Los ...</td>
      <td>6</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Bibliothèque Nationale et Universitaire de Str...</td>
      <td>6</td>
    </tr>
    <tr>
      <th>39</th>
      <td>American University of Beirut Archaeological M...</td>
      <td>5</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Bodmer Museum, Cologny, Switzerland</td>
      <td>5</td>
    </tr>
    <tr>
      <th>41</th>
      <td>National Museum of Ethnology, Osaka, Japan</td>
      <td>4</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Peabody Essex Museum, Salem, Massachusetts, USA</td>
      <td>4</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Memorial Art Gallery, University of Rochester,...</td>
      <td>4</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Rosicrucian Egyptian Museum, San Jose, Califor...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Deutsches Museum, Munich, Germany</td>
      <td>3</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>2</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Glencairn Museum, Bryn Athyn, Pennsylvania, USA</td>
      <td>2</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Museum of Fine Arts, Budapest, Hungary</td>
      <td>1</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trinity College, Dublin, Ireland</td>
      <td>1</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Università Pontificia Salesiana, Rome, Italy</td>
      <td>1</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Ancient Orient Museum, Tokyo, Japan</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c424e71f-94a3-414a-9785-d061781e2eb0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c424e71f-94a3-414a-9785-d061781e2eb0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c424e71f-94a3-414a-9785-d061781e2eb0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c717ea52-9a3e-475d-a54b-0e8b1afc10b1">
  <button class="colab-df-quickchart" onclick="quickchart('df-c717ea52-9a3e-475d-a54b-0e8b1afc10b1')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c717ea52-9a3e-475d-a54b-0e8b1afc10b1 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collection&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ORACC: Top 10 First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/414058e4146215fa9c7cd0460b1958ff50cfc66e059d967700649050854cbf59.png" src="_images/414058e4146215fa9c7cd0460b1958ff50cfc66e059d967700649050854cbf59.png" />
</div>
</div>
</section>
<section id="distribution-of-countries-of-first-collections-that-matched">
<h4>Distribution of countries of first collections that matched<a class="headerlink" href="#distribution-of-countries-of-first-collections-that-matched" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_country2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_c_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_country</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;first_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="n">collection_country2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">current_country</span><span class="p">]</span>

<span class="n">first_c_df2</span><span class="p">[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection_country2</span>

<span class="n">first_c_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-cffc82b5-e1ff-4092-ab13-01c95f4df1a2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_collection</th>
      <th>count</th>
      <th>collection_country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>British Museum, London, UK</td>
      <td>9464</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>University of Pennsylvania Museum of Archaeolo...</td>
      <td>6171</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>National Museum of Iraq, Baghdad, Iraq</td>
      <td>4654</td>
      <td>Iraq</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>2649</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>2232</td>
      <td>Turkey</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Louvre Museum, Paris, France</td>
      <td>1812</td>
      <td>France</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Eski Şark Eserleri Müzesi, Arkeoloji Müzeleri,...</td>
      <td>1322</td>
      <td>Turkey</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ashmolean Museum, Oxford, UK</td>
      <td>957</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>947</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hilprecht Collection, University of Jena, Germany</td>
      <td>369</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>10</th>
      <td>National Museum of Syria, Aleppo, Syria</td>
      <td>354</td>
      <td>Syria</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yale Babylonian Collection, New Haven, Connect...</td>
      <td>318</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Free Library of Philadelphia, Philadelphia, Pe...</td>
      <td>223</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Montserrat Museum, Barcelona, Spain</td>
      <td>132</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Nies Babylonian Collection, Yale Babylonian Co...</td>
      <td>129</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Musées royaux d’Art et d’Histoire, Brussels, B...</td>
      <td>121</td>
      <td>Belgium</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Metropolitan Museum of Art, New York, New York...</td>
      <td>68</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>17</th>
      <td>State Hermitage Museum, St. Petersburg, Russia...</td>
      <td>65</td>
      <td>RussianFederation</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Royal Ontario Museum of Archaeology, Toronto, ...</td>
      <td>64</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Newell Collections of Babylonian Tablets, Yale...</td>
      <td>51</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>20</th>
      <td>National Museum of Syria, Damascus, Syria</td>
      <td>48</td>
      <td>Syria</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Hearst Museum of Anthropology, University of C...</td>
      <td>42</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>22</th>
      <td>New York Public Library, New York, New York, USA</td>
      <td>38</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Spurlock Museum, University of Illinois, Urban...</td>
      <td>25</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Israel Museum, Jerusalem</td>
      <td>19</td>
      <td>Jerusalem</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Museo Archeologico Nazionale di Firenze, Flore...</td>
      <td>16</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Kelsey Museum of Archaeology, University of Mi...</td>
      <td>15</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>27</th>
      <td>World Museum Liverpool, Liverpool, UK</td>
      <td>15</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Fitzwilliam Museum, University of Cambridge, C...</td>
      <td>14</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Nationalmuseet, Copenhagen, Denmark</td>
      <td>13</td>
      <td>Denmark</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Princeton Theological Seminary, Princeton, New...</td>
      <td>12</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Museo di Antichità di Torino, Turin, Italy</td>
      <td>9</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>32</th>
      <td>John Rylands Library, University of Manchester...</td>
      <td>9</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Museum Forum der Völker (Völkerkundemuseum der...</td>
      <td>8</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Archaeological Research Collection, University...</td>
      <td>8</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Bible Lands Museum, Jerusalem</td>
      <td>8</td>
      <td>Jerusalem</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Manchester Museum, University of Manchester, M...</td>
      <td>8</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Los Angeles County Museum of Art (LACMA), Los ...</td>
      <td>6</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Bibliothèque Nationale et Universitaire de Str...</td>
      <td>6</td>
      <td>France</td>
    </tr>
    <tr>
      <th>39</th>
      <td>American University of Beirut Archaeological M...</td>
      <td>5</td>
      <td>Lebanon</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Bodmer Museum, Cologny, Switzerland</td>
      <td>5</td>
      <td>Switzerland</td>
    </tr>
    <tr>
      <th>41</th>
      <td>National Museum of Ethnology, Osaka, Japan</td>
      <td>4</td>
      <td>Japan</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Peabody Essex Museum, Salem, Massachusetts, USA</td>
      <td>4</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Memorial Art Gallery, University of Rochester,...</td>
      <td>4</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Rosicrucian Egyptian Museum, San Jose, Califor...</td>
      <td>3</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Deutsches Museum, Munich, Germany</td>
      <td>3</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Museum and Art Gallery, Bristol, UK</td>
      <td>2</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Glencairn Museum, Bryn Athyn, Pennsylvania, USA</td>
      <td>2</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Museum of Fine Arts, Budapest, Hungary</td>
      <td>1</td>
      <td>Hungary</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trinity College, Dublin, Ireland</td>
      <td>1</td>
      <td>Ireland</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Università Pontificia Salesiana, Rome, Italy</td>
      <td>1</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Ancient Orient Museum, Tokyo, Japan</td>
      <td>1</td>
      <td>Japan</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cffc82b5-e1ff-4092-ab13-01c95f4df1a2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cffc82b5-e1ff-4092-ab13-01c95f4df1a2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cffc82b5-e1ff-4092-ab13-01c95f4df1a2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ac66a7d7-b99e-4637-9f18-7bce2b19d235">
  <button class="colab-df-quickchart" onclick="quickchart('df-ac66a7d7-b99e-4637-9f18-7bce2b19d235')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ac66a7d7-b99e-4637-9f18-7bce2b19d235 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_c_country_count2</span> <span class="o">=</span> <span class="n">first_c_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;collection_country&#39;</span><span class="p">])[</span><span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">first_c_country_count2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-201-1a8b76927ae6&gt;:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  first_c_country_count2 = first_c_df2.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
&lt;ipython-input-201-1a8b76927ae6&gt;:1: FutureWarning: The operation &lt;built-in function sum&gt; failed on a column. If any error is raised, this will raise an exception in a future version of pandas. Drop these columns to avoid this warning.
  first_c_country_count2 = first_c_df2.groupby([&#39;collection_country&#39;])[&#39;collection_country&#39;, &#39;count&#39;].agg(sum)\
</pre></div>
</div>
<div class="output text_html">
  <div id="df-ec150da7-3dc5-4454-beb2-de58f284240d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection_country</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>UK</td>
      <td>10469</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USA</td>
      <td>8066</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Iraq</td>
      <td>4654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Turkey</td>
      <td>3554</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Germany</td>
      <td>3029</td>
    </tr>
    <tr>
      <th>5</th>
      <td>France</td>
      <td>1818</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Syria</td>
      <td>402</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Spain</td>
      <td>132</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Belgium</td>
      <td>121</td>
    </tr>
    <tr>
      <th>9</th>
      <td>RussianFederation</td>
      <td>65</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Canada</td>
      <td>64</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Jerusalem</td>
      <td>27</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Italy</td>
      <td>26</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Denmark</td>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Lebanon</td>
      <td>5</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Switzerland</td>
      <td>5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Japan</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Ireland</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Hungary</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ec150da7-3dc5-4454-beb2-de58f284240d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ec150da7-3dc5-4454-beb2-de58f284240d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ec150da7-3dc5-4454-beb2-de58f284240d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6d9dac18-3388-4302-9d1e-e99b0e59c09b">
  <button class="colab-df-quickchart" onclick="quickchart('df-6d9dac18-3388-4302-9d1e-e99b0e59c09b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6d9dac18-3388-4302-9d1e-e99b0e59c09b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_c_country_count2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection_country&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ORACC: Countries of First Collections that Matched FactGrid Records&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c56803e925d27457e54ae1746ba9f5a03362a05f389a52f0ce348985028453fb.png" src="_images/c56803e925d27457e54ae1746ba9f5a03362a05f389a52f0ce348985028453fb.png" />
</div>
</div>
</section>
<section id="id6">
<h4>Distribution of unmatched collections<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">)[</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oracc_dump_collection
A&#39;ali, Bahrain                                                                                   6
Abbey Museum, Queensland, Australia                                                              1
Abu Shahrain, Iraq                                                                               4
Aichi Prefectural University, Aichi, Japan                                                       2
Albertson College of Idaho, Caldwell, Idaho, USA                                                 1
                                                                                                ..
unlocated: reconstructed parallel to Zb-02 (a)                                                   1
École Biblique et Archéologique Française, Jerusalem                                             2
École Pratique des Hautes Études, Paris, France                                                 10
École Pratique des Hautes Études, Paris, France; Vorderasiatisches Museum, Berlin, Germany ?     1
Übersee-Museum, Bremen, Germany                                                                  1
Name: oracc_dump_collection, Length: 660, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_collections2</span> <span class="o">=</span> <span class="n">collection_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_collection2</span><span class="p">][</span><span class="s1">&#39;oracc_dump_collection&#39;</span><span class="p">]</span>
<span class="n">unmatched_collections_clean2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unmatched_collections2</span><span class="p">:</span>
  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># split a multi statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_collections_clean2</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_collections_clean2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_collections_clean2</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_collections_clean2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;German Archaeological Institute, Berlin, Germany (on loan, University of Heidelberg)&#39;,
       &#39;unlocated&#39;, &#39;nan&#39;, &#39;private: anonymous, unlocated&#39;,
       &#39;private: Michail, Louise, Milan, Italy&#39;,
       &#39;Mead Art Gallery, Amherst College, Amherst, Massacusetts, USA&#39;,
       &#39;Bible Lands Museum, Pittsburgh Theological Seminary, Pittsburgh, Pennsylvania, USA&#39;,
       &#39;Kyoto University, Kyoto, Japan&#39;,
       &#39;Crozer Theological Seminary, Rochester, New York, USA&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, Holland&#39;,
       &quot;Musées royaux d&#39;Art et d&#39;Histoire, Brussels, Belgium&quot;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria&#39;,
       &#39;National Museum, Tehran, Iran&#39;,
       &#39;private: de Serres, J. Mariaud, Paris, France&#39;,
       &#39;private: Foroughi, Mohsen, Tehran, Iran&#39;,
       &#39;J. Pierpont Morgan Library Collection, New York, New York, USA&#39;,
       &#39;private: Frauenberger, K., Germany&#39;,
       &#39;Kalamazoo Valley Museum, Kalamazoo, Michigan, USA&#39;,
       &#39;private: Foroughi, Teheran, Iran&#39;,
       &#39;Musée d’Art et d’Histoire, Geneva, Switzerland&#39;,
       &#39;Institute of Archaeology, London, UK&#39;,
       &#39;Gallery of Fine Arts, Yale University, New Haven, Connecticut, USA&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany&#39;,
       &#39;Allard Pierson Museum, University of Amsterdam, Amsterdam, Holland&#39;,
       &#39;Archäologisches Museum, Universität Halle-Wittenberg, Germany&#39;,
       &#39;private: Hoza, Camberg, Germany&#39;,
       &#39;National Museum of Syria, Raqqa, Syria&#39;,
       &#39;private: Baldacci, Milan, Italy&#39;,
       &#39;École Pratique des Hautes Études, Paris, France&#39;,
       &#39;private: Hideo Mihira, Chiba, Japan&#39;,
       &#39;Osaka Prefectural Chikatsu-Asuka Museum, Osaka, Japan&#39;,
       &#39;Takahashi Collection, Municipal Museum, Fujisawa, Japan&#39;,
       &#39;private: Namio Egami, Tokyo, Japan&#39;,
       &#39;Tokyo National Museum, Tokyo, Japan&#39;,
       &#39;Harvard Museum of the Ancient Near East, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;private: Cros, unlocated&#39;, &#39;Munich, Germany&#39;,
       &#39;private: Erlenmeyer, Basel, Switzerland (dispersed)&#39;,
       &#39;private: anonymous, Baghdad, Iraq&#39;, &#39;private: Banks, unlocated&#39;,
       &#39;private: Samhery, unlocated&#39;, &#39;private: Greene, unlocated&#39;,
       &#39;private: Tournay, unlocated&#39;,
       &#39;Medelhavsmuseet, Stockholm, Sweden&#39;,
       &#39;private: Haldar, Alfred O., Uppsala, Sweden&#39;,
       &#39;Milwaukee Public Museum, Milwaukee, Wisconsin, USA&#39;,
       &#39;New Brunswick Museum, St. John, New Brunswick, Canada&#39;,
       &#39;J. Pierpont Morgan Library Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Chester Beatty Library, Dublin, Ireland&#39;,
       &#39;Birmingham Museums and Art Gallery, Birmingham, UK&#39;,
       &#39;private: anonymous, Göttingen, Germany&#39;,
       &#39;Liebighaus, Frankfurt, Germany&#39;,
       &#39;private: Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Reber Collection, Lausanne, Switzerland&#39;,
       &#39;private: Schimmel, Norbert, unlocated&#39;,
       &#39;National Museum of Syria, Idlib, Syria&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (on loan, British Museum, London, UK )&#39;,
       &#39;Robert Hull Fleming Museum, University of Vermont, Burlington, Vermont, USA&#39;,
       &#39;Field Museum of Natural History, Chicago, Illinois, USA&#39;,
       &#39;Burrell Collection, Glasgow, Scotland, UK&#39;,
       &#39;Brockmon Collection, University of Haifa, Haifa, Israel&#39;,
       &#39;Hilprecht Collection, University of Jena, Jena, Germany&#39;,
       &#39;Studium Biblicum Franciscanum Archaeological Museum, Jerusalem&#39;,
       &#39;Cabinet des Médailles, Musée d’Histoire et d’Art, Musées de l’Etat, Luxemburg&#39;,
       &#39;Ethnological Collections, Redpath Museum, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: David, E.S., New York, New York, USA&#39;,
       &#39;private: Hechich, Rome, Italy&#39;, &#39;Museo Barracco, Rome, Italy&#39;,
       &#39;private: Galling, Kurt, Tübingen, Germany&#39;,
       &#39;Museum of Anthropology, University of British Columbia, Vancouver, British Columbia, Canada&#39;,
       &#39;private: Ligabue, Giancarlo, Venice, Italy&#39;,
       &#39;private: Southesk collection&#39;, &#39;Couvent Saint-Etienne, Jerusalem&#39;,
       &#39;National Museum of Iraq, Baghdad,Iraq&#39;,
       &#39;private: anonmymous, unlocated&#39;,
       &#39;Rare Book and Manuscript Library, Columbia University, New York, USA&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq: University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;private: Hoffman, E. A., unlocated&#39;,
       &#39;private: Barton, G. A., unlocated&#39;,
       &#39;Rijksmuseum van Oudheden, Leiden, Holland&#39;,
       &#39;Katholieke Universiteit, Nijmegen, Holland&#39;,
       &#39;Detroit Institute of Arts, Detroit, Michigan, USA&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark&#39;, &#39;private: Hechler&#39;,
       &#39;private: Cugnin, L., unlocated&#39;,
       &#39;Musée des Antiquités à Rouen, France&#39;, &#39;private,: Hechler&#39;,
       &#39;private: Chandon de Briailles, unlocated&#39;,
       &#39;Museum Haaretz, Tel Aviv, Israel&#39;,
       &#39;private: Mercer, S.A.B., Toronto, Ontario, Canada&#39;,
       &#39;Institute of Semitics, University of Groningen, Groningen, Holland&#39;,
       &#39;University of Pretoria, Pretoria, South Africa&#39;,
       &#39;Cracow National Museum, Cracow, Poland&#39;,
       &#39;Bryn Mawr College, Bryn Mawr, Pennsylvania, USA&#39;,
       &#39;private: Jager, H. J. de , unlocated&#39;, &#39;Japan&#39;,
       &#39;Ziegelei-Museum, Meienberg, Germany&#39;,
       &#39;Musée St. Remi, Reims, France&#39;,
       &#39;private: Béghin, Versailles, France&#39;,
       &#39;Landesmuseum Joanneum, Graz, Austria&#39;,
       &#39;Kestner Museum, Hannover, Germany&#39;,
       &#39;Musée Royal de Mariemont, Morlanwelz, Belgium&#39;,
       &#39;Museo Barraco, Rome, Italy&#39;, &#39;Musée de Cinquantenaire Brussels&#39;,
       &#39;private: de Clercq, unlocated&#39;,
       &#39;private: Seidl-Geuthner, F., unlocated&#39;,
       &#39;private: Clark, Cumberland (probably dispersed)&#39;,
       &#39;Newell Bequest Collection, Wheaton College, Wheaton, Illinois, USA&#39;,
       &#39;private: Collection de Clercq, Paris, France&#39;,
       &#39;private: Golenishev, unlocated&#39;,
       &#39;Gutenberg Museum, Mainz,Germany&#39;,
       &#39;California Museum of Ancient Art, Los Angeles, California, USA&#39;,
       &#39;Department of Near Eastern Studies, Cornell University, Ithaca, New York, USA&#39;,
       &#39;private: Jensen, William, Austin, Texas, USA&#39;,
       &#39;private: LaForme, William, USA&#39;, &#39;private: Kuhs, R., Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA&#39;,
       &#39;Schøyen Collection, Oslo, Norway&#39;, &#39;Kelsey Museum&#39;,
       &#39;Kelsey Museum, University of Michigan, Ann Arbor, Michigan, USA&#39;,
       &#39;Archeological Museum, Antakya, Hatay, Turkey&#39;,
       &#39;private: Stefanik,Deborah, Las Vegas, Nevada, USA&#39;,
       &#39;Library of Congress, Washington, DC, USA&#39;,
       &#39;Siegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK&#39;,
       &#39;Couvent Saint-Étienne, Jerusalem&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara, Turkey&#39;,
       &#39;École Biblique et Archéologique Française, Jerusalem&#39;,
       &#39;Oakland Museum of California, Oakland, California, USA&#39;,
       &#39;iSegfried H. Horn Museum, Institute of Archaeology, Andrews University, Berrien Springs, Michigan, USA&#39;,
       &#39;Museum fur Volkerkunde, Freiburg, Germany&#39;,
       &#39;Ruhrlandmuseum, Essen, Germany&#39;, &#39;Schøyen collection, Oslo&#39;,
       &#39;private: anonymous, Europe&#39;,
       &#39;Oriental Museum, University of Durham, Durham, UK&#39;,
       &#39;private: Homsy, E., Beirut, Lebanon&#39;,
       &#39;Oriental Institute, University of Chicago, Illinois, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology&#39;,
       &#39;University Museum, University of Pennsylvania, Philadelphia, Pennsylvania, USA&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA: Arkeoloji Müzeleri, Istanbul, Turkey&#39;,
       &#39;Rare Manuscript Collections, Cornell University Library, Ithaca, New York, USA&#39;,
       &#39;Near Eastern Studies, UC Berkeley (Dales Collection), Berkeley, California, USA&#39;,
       &#39;private: anonymous, Germany&#39;,
       &#39;Walters Art Museum, Baltimore, Maryland, USA (a)&#39;,
       &#39;Nimrud, Iraq (b)&#39;, &#39;Site museum, Boghazkoi, Turkey&#39;,
       &#39;Israel Antiquities Authority, Jerusalem&#39;,
       &#39;Science Museum of Minnesota, St. Paul, Minnesota, USA&#39;,
       &#39;private: Hebenstreit, Laurent, Paris, France&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;private: Cotsen, Los Angeles, California, USA&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collections, UCLA, Los Angeles, USA&#39;,
       &#39;Hesburgh Library, University of Notre Dame, Notre Dame, Indiana, USA&#39;,
       &#39;Special Collections and Archives, John T. Richardson Library, DePaul University, Chicago, Illinois, USA&#39;,
       &#39;Louvre Museum, Paris, France&#39;, &#39;Collection Beghin, Versailles&#39;,
       &#39;Vorderasiatisches Museum, Berlin&#39;,
       &#39;Andersen Library, University of Minnesota, Minneapolis-St. Paul, Minnesota, USA&#39;,
       &#39;Staley Library, Millikin University, Decatur, Illinois, USA&#39;,
       &#39;Michael C. Carlos Museum, Emory University, Atlanta, Georgia, USA&#39;,
       &#39;The Ashmolean Museum, Oxford&#39;,
       &#39;Rosen Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Goucher College Babylonian Collection, Yale Babylonian Collection, New Haven, Connecticut, USA&#39;,
       &#39;Yale Babylonian Collection, New Haven&#39;,
       &#39;Nies Babylonian Collection, Yale Babilonian Collection, New Haven&#39;,
       &#39;Archäologisches Museum, Universität Halle, Halle, Germany&#39;,
       &#39;private: Totten, Norman, Bentley College, Waltham, Massachusetts, USA&#39;,
       &#39;Utah State University Museum of Anthropology, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Institute of Religion, Utah State University, Logan, Utah, USA&#39;,
       &#39;Church of Jesus Christ of Latter Day Saints Museum of Church History and Art, Salt Lake City, Utah, USA&#39;,
       &#39;Department of Jordanian Antiquities, Amman, Jordan&#39;,
       &#39;Johns Hopkins University, Baltimore, MD, USA&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turke&#39;, &#39;private: annonymous&#39;,
       &#39;Bibliothèque Nationale, Paris, France&#39;,
       &#39;Topkapı Sarayı Müzesi, Istanbul, Turkey&#39;,
       &#39;Mosul Museum, Mosul, Iraq&#39;,
       &#39;German Archaeological Institute, Berlin, Germany&#39;,
       &#39;Heidelberger Orientalisches Seminar, Heidelberg, Germany&#39;,
       &#39;Semitic Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Hilprecht-Sammlung, University of Jena, Germany&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;private: anonymous, Tel Aviv, Israel&#39;,
       &#39;Musée de Beyrouth, Beirut, Libanon&#39;, &#39;private: anonymous, Canada&#39;,
       &#39;Museum of Corum, Corum, Turkey&#39;,
       &#39;John Rylands University Library, Manchester, UK&#39;,
       &#39;National Museum, Beirut, Lebanon&#39;, &#39;Iraq Museum, Baghdad&#39;,
       &#39;private: anonymous, Victoria, Australia&#39;,
       &#39;Department of Geology, Union College, Schenectady, New York, USA&#39;,
       &#39;Institute of Oriental Culture, University of Tokyo, Tokyo, Japan&#39;,
       &#39;Albertson College of Idaho, Caldwell, Idaho, USA&#39;,
       &#39;School of Archaeology and Oriental Studies, Liverpool University, Liverpool, UK&#39;,
       &#39;Columbia University Library, New York, New York, USA&#39;,
       &#39;Cincinnati Art Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Clinton Historical Society, Clinton, Massachusetts, USA&#39;,
       &#39;Special Collections, UCLA, Los Angeles, California, USA&#39;,
       &#39;Erzabtei St. Martin zu Beuron, Beuron, Germany&#39;,
       &#39;Special Collections, Robert Manning Strozier Library, Florida State University, Tallahassee, Florida, USA&#39;,
       &#39;private: Moussaieff, Shlomo, London, UK&#39;,
       &#39;MacKenzie Art Gallery, University of Regina Collection&#39;,
       &#39;Knox College, Galesburg, IL, USA&#39;,
       &#39;private: anonymous, New York, New York, USA&#39;,
       &#39;Cotsen Collection of Cuneiform Tablets, Special Collection, UCLA, Los Angeles, USA&#39;,
       &#39;de Liagre Böhl Collection, Netherlands Institute for the Near East, Leiden, The Netherlands&#39;,
       &#39;The Oriental Institute, Chicago&#39;,
       &#39;Los Angeles Unified School District, Los Angeles, California, USA&#39;,
       &#39;Diyarbakır Archaeological Museum, Diyarbakır, Turkey&#39;,
       &#39;Harvard Art Museum / Arthur M. Sackler Museum, Harvard University, Cambridge, Massachusetts, USA&#39;,
       &#39;Denver Museum of Natural Science, Denver, Colorado, USA&#39;,
       &#39;Badè Museum of Biblical Archaeology, Pacific School of Religion, Berkeley, California, USA&#39;,
       &#39;private: anonymous, New Jersey, USA&#39;,
       &#39;University of Pécs, Pécs, Hungary&#39;,
       &#39;Department of Assyriology and Hebrew Studies, Eötvös L. University, Budapest&#39;,
       &#39;Arizona State Museum, Tucson, Arizona, USA&#39;,
       &#39;Morgan Library, Colorado State University, Fort Collins, Colorado, USA&#39;,
       &#39;Toppan Rare Books Library, University of Wyoming, Laramie, Wyoming, USA&#39;,
       &#39;private: Owen, E. L., Lake Hopatcong, New Jersey, USA&#39;,
       &#39;Penrose Library, Whitman College, Walla Walla, Washington, USA&#39;,
       &#39;Lilly Library, Indiana University, Bloomington, Indiana, USA&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA (permanent loan from Missouri School of Religion [formerly “Bible College of Missouri”], Jefferson City, Missouri)&#39;,
       &#39;Museum of Art and Archaeology, University of Missouri-Columbia, Columbia, Missouri, USA&#39;,
       &#39;Saint Louis Art Museum, St. Louis, Missouri, USA&#39;,
       &#39;Semitics/ICOR Collections, Catholic University of America, Washington, DC, USA&#39;,
       &#39;Nicholson Museum, University of Sydney, Sydney, Australia&#39;,
       &#39;Ethniko Archaiologiko Museo, Athens, Greece&#39;,
       &#39;Eugene Fuller Memorial Collection,  Seattle Art Museum, Seattle, Washington, USA&#39;,
       &#39;Chancellor University Collection, Cleveland, Ohio, USA&#39;,
       &#39;American Museum of Natural History, New York, New York, USA&#39;,
       &#39;Couvent Sainte-Anne, Jerusalem&#39;,
       &#39;New Brunswick Theological Seminary, New Brunswick, New Jersey, USA&#39;,
       &#39;Rush Rhees Library, University of Rochester, Rochester, New York, USA&#39;,
       &#39;Nimrud, Iraq (a) &amp; (d)&#39;,
       &#39;Musei Vaticani, Vatican CIty, Rome, Italy (b)&#39;,
       &#39;Memorial Art Gallery, University of Rochester, Rochester, New York, USA (c)&#39;,
       &#39;unlocated (e)&#39;,
       &#39;Australian Institute of Archaeology, Melbourne,Victoria, Australia&#39;,
       &#39;Los Angeles County Museum of Art (LACMA), Los Angeles, California, USA (a)&#39;,
       &#39;unlocated (c)&#39;,
       &#39;David Alderfer Collection, Downers Grove, Illinois, USA&#39;,
       &#39;Burrell Collection. Art Gallery and Museum, Glasgow  (a)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (b)&#39;,
       &#39;Nimrud Collection, Nimrud, Iraq (c)&#39;, &#39;unlocated (d)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (a)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (c)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (c)&#39;,
       &#39;Muzeum Narodowe w Warszawie, Warsaw (e)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (f)&#39;,
       &#39;unloc&#39;,
       &#39;Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (b)&#39;,
       &#39;Metropolitan Museum of Art, New York, New York, USA (a-b)&#39;,
       &#39;Nimrud, Iraq (c)&#39;, &#39;Nimrud, Iraq (a) &amp; (c)&#39;,
       &#39;Mayo, Ireland (Gwyn)&#39;, &#39;Kyoto, Japan&#39;,
       &#39;private: anonymous, Venice, Italy&#39;,
       &quot;Mabee-Gerrer Museum, St. Gergory&#39;s University, Shawnee, Oklahoma, USA&quot;,
       &#39;Museum for Art and History, Geneva&#39;,
       &#39;Williams College Museum of Art, Williamstown, Massachusetts, USA&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA&#39;,
       &#39;British Museum, London, UK (a)&#39;, &#39;Nimrud, Iraq (a)&#39;,
       &#39;unlocated (b)&#39;, &#39;British Museum, London, UK (a-b)&#39;,
       &#39;British Museum, London, UK (a-c)&#39;,
       &#39;Museo Civico di Archeologia Ligure, Genua, Italy (b)&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (c)&#39;,
       &#39;British Museum, London, UK (d)&#39;, &#39;Nimrud, Iraq (e)&#39;,
       &#39;Collection Fred Elghanayan, New York, New York, USA (f)&#39;, &#39;unlo&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (c)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (b)&#39;,
       &#39;private: anonymous, unlocated (c)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (b)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (a)&#39;,
       &#39;British Museum, London, UK (b)&#39;,
       &#39;Skulpturensammlung, Dresden, Germany (a)&#39;, &#39;Nimrud, Iraq (a-c)&#39;,
       &#39;Fogg Art Museum, Harvard University, Cambridge, Massachusetts, USA (a)&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA (a)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (a)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (a)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (b)&#39;,
       &#39;British Museum, London, UK (c)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 381ff. (description) (a)&#39;,
       &#39;unlocated: reconstructed analog to C-12&#39;,
       &#39;Meuszynski, BaF 2, p. 26. 28 (a)&#39;,
       &#39;Louvre Museum, Paris, France (a)&#39;,
       &#39;Miho Museum, Kyoto, Japan (a)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (a)&#39;,
       &#39;Nimrud, Iraq (b-e)&#39;, &#39;unlocated (f)&#39;,
       &#39;Virginia Museum of Fine Arts, Richmond, Virginia, USA (a)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (a)&#39;,
       &#39;unlocated: reconstructed according to position mirrored by C-02 (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 384f. (description) (a)&#39;,
       &#39;Nimrud, Iraq&#39;,
       &#39;Williams College Museum of Art, Williamstown, Massachusetts, USA (d)&#39;,
       &#39; unlocated (e)&#39;, &#39;Brooklyn Museum, Brooklyn, New York, USA (a)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s description of the room (unlocated: Layard, Monuments of Nineveh I, p. 385f. (a)&quot;,
       &#39;Mosul Museum, Mosul, Iraq (a)&#39;,
       &#39;unlocated: reconstructed according to the placement of slabs in this room&#39;,
       &#39;cp. Paley/Sobolewski, BaF 10, p. 85 and pl. 6, 33 (a)&#39;,
       &#39;Museum and Art Gallery, Bristol, UK (a)&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (b)&#39;,
       &#39;Nimrud, Iraq (a-h)&#39;, &#39;unlocated (i)&#39;,
       &#39;Hood Museum of Art, Dartmouth College, Hanover, New Hampshire, USA (a)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA (a)&#39;,
       &#39;private: anonymous, New York, New York, USA (a)&#39;,
       &#39;Nimrud, Iraq (a-b, d)&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium (c)&#39;,
       &#39;Nimrud, Iraq (b-d)&#39;,
       &#39;Kalamazoo Valley Museum, Kalamazoo, Michigan, USA (e)&#39;,
       &#39;National Museums Scotland, Edinburgh, Scotland, UK (a)&#39;,
       &#39;State Hermitage Museum, St. Petersburg, Russian Federation (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. XXXIX (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 385f. (description) (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, p. 386f. (description) (a)&#39;,
       &#39;Staatliches Museum Ägyptischer Kunst, Munich, Germany (a)&#39;,
       &#39;unlocated: reconstructed according to analog slabs H-11 and H-24 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, N.W. LXII (a)&#39;,
       &#39;Museum Calouste Gulbenkian, Lisbon, Portugal (a)&#39;,
       &#39;Christ Church College, Oxford, UK (a)&#39;,
       &#39;M.H. De Young Museum, San Francisco, California, USA (a)&#39;,
       &quot;unlocated: reconstructed according to unlocated: Layard&#39;s general description (Monuments of Nineveh I, 145. 386) of the room and analog to the opposite wall (a)&quot;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (now Dresden) (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA&#39;,
       &#39;Wadsworth Atheneum, Hartford, Connecticut, USA (a)&#39;,
       &#39;Montreal Museum of Fine Arts, Montreal, Canada (b)&#39;,
       &#39;Minneapolis Institute of Arts, Minneapolis, Minnesota, USA (a)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (b)&#39;,
       &#39;Nimrud, Iraq (a-d)&#39;,
       &#39;Fitzwilliam Museum, University of Cambridge, Cambridge, UK (c)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland (a)&#39;,
       &#39;Museo Barracco, Rome, Italy (b)&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy (d)&#39;,
       &#39;Nimrud, Iraq (b) &amp; (c)&#39;, &#39;Nimrud, Iraq (a-b)&#39;,
       &#39;private: anonymous (a)&#39;,
       &#39;Idemitsu Museum of Arts, Tokyo, Japan (c)&#39;,
       &#39;Royal Ontario Museum of Archaeology, Toronto, Ontario, Canada (a)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (a)&#39;,
       &#39;Nationalmuseet, Copenhagen, Denmark (b)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (c)&#39;, &#39;Nimrud, Iraq (d)&#39;,
       &#39;Bhau Daji Lad Museum, Mumbai, India (formerly Victoria and Albert Museum) (b)&#39;,
       &quot;Arts &amp; Culture Centre, Memorial Univ., St. John&#39;s, Newfoundland, Canada (a)&quot;,
       &#39;Nimrud, Iraq (b-c)&#39;,
       &#39;Paisley Art Gallery and Museum, Renfrewshire, UK (d)&#39;,
       &#39;Museum of Fine Arts, Houston, Texas, USA (c)&#39;,
       &#39;private: Collection Samuel Josefowitz, Lausanne, Switzerland (b)&#39;,
       &#39;unloca&#39;, &#39;Louvre Museum, Paris, France (c)&#39;,
       &#39;Detroit Institute of Arts, Detroit, Michigan, USA (e)&#39;,
       &#39;British Museum, London, UK&#39;, &#39;Louvre Museum, Paris, France (f)&#39;,
       &#39;unlocated (g)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a-b, e)&#39;,
       &#39;Magdalen College, Oxford, UK (c)&#39;,
       &#39;Amherst College, Amherst, Masssachusetts, USA (f)&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul, Turkey (b)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA (c)&#39;,
       &#39;British Museum, London, UK (e)&#39;,
       &#39;Ashmolean Museum, Oxford, UK (b)&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (c)&#39;,
       &#39;unlocated: reconstructed based on composition of neighboring reliefs only&#39;,
       &#39;cp. Paley/Sobolewski, BaF 10, p. 33 (a)&#39;,
       &#39;Chrysler Museum of Art, Norfolk, Virginia, USA (a)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA  (a&#39;,
       &#39;= L-14 (b))&#39;, &#39;Middlebury College, Middlebury, Vermont, USA&#39;,
       &#39;Cincinnati Art Museum, Cincinnati, Ohio, USA (b)&#39;,
       &#39;Nelson-Atkins Museum of Art, Kansas City, Missouri, USA (a)&#39;,
       &#39;Kimbell Art Museum, Fort Worth, Texas, USA (b)&#39;,
       &#39;Glencairn Museum, Bryn Athyn, Pennsylvania, USA  (b&#39;,
       &#39;= L-03 (a))&#39;, &#39;Amherst College, Amherst, Masssachusetts, USA (a)&#39;,
       &#39;Saint Louis Art Museum, St. Louis, Missouri, USA (b)&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland (a)&#39;,
       &#39;University of Pennsylvania Museum of Archaeology and Anthropology, Philadelphia, Pennsylvania, USA (a)&#39;,
       &#39;Fleming Museum, University of Vermont, Burlington, Vermont, USA (a)&#39;,
       &#39;Abegg Foundation, Bern, Switzerland (b)&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA (a)&#39;,
       &#39;unlocated: reconstructed based on symmetrical relief N-08&#39;,
       &#39;Meuszynski, BaF 2, p. 75 (a)&#39;,
       &#39;Swedish National Museum, Stockholm, Sweden (a)&#39;,
       &#39;Worcester Art Museum, Worcester, Massachusetts, USA (a)&#39;,
       &#39;Ny Carlsberg Glyptotek, Copenhagen, Denmark (b)&#39;,
       &#39;Yale University, New Haven, Connecticut, USA (a)&#39;,
       &#39;Museum of Art, Cleveland, Ohio, USA (a)&#39;, &#39;Nimrud, Iraq (a. c-e)&#39;,
       &#39;The Art Institute of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;private: anonymous, unlocated (a)&#39;,
       &#39;Bowdoin College, Brunswick, Maine, USA (a)&#39;,
       &#39;private: anonymous, unlocated (b)&#39;, &#39;Nimrud, Iraq (c, e)&#39;,
       &#39;Museum für Kunst und Gewerbe, Hamburg, Germany (d);&#39;,
       &#39;Nimrud, Iraq (a-b, d-g)&#39;,
       &#39;private: Collection Merrin, New York, New York, USA  (c)&#39;,
       &#39;unlocated (h)&#39;,
       &#39;Manchester University, Museum, Manchester, UK (b)&#39;,
       &#39;Nimrud, Iraq (a, c-h)&#39;,
       &#39;Musées royaux d’Art et d’Histoire, Brussels, Belgium (b)&#39;,
       &#39;Nimrud, Iraq (a), d-f&#39;,
       &#39;Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai, India (formerly Prince of Wales Museum of Western India, Mumbai, India) (b)&#39;,
       &#39;Tigris, Iraq&#39;, &#39;Skulpturensammlung, Dresden, Germany (b)&#39;,
       &quot;unlocated: reconstructed according to Layard&#39;s description (Layard, Monuments of Nineveh I, p.389) and the arrangement of neighboring reliefs (a)&quot;,
       &#39;unlocated: reconstructed according to the available space and arrangement of reliefs in this entrance (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 32&#39;,
       &#39;Original Drawings III, S.W. IV (a)&#39;,
       &#39;unlocated: Layard, Original Drawings IV, Misc. I (a)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 28 (a)&#39;,
       &#39;unlocated: Layard, Original Drawings III, S.W. X (a)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, Illinois, USA (b)&#39;,
       &#39;unlocated: reconstructed as counterpart to Z-09 (b)&#39;,
       &#39;National Museum of Iraq, Baghdad, Iraq (b-d)&#39;, &#39;Nimrud, Iraq (f)&#39;,
       &#39;unlocated: Layard, Monuments of Nineveh I, pl. 35, possibly lost in the Tigris (a)&#39;,
       &#39;unlocated: reconstructed parallel to Zb-02 (a)&#39;,
       &#39;unlocated: reconstructed analog to other entrances (a)&#39;,
       &#39;Weingreen Museum of Biblical Antiquities, Trinity College, Dublin, Ireland&#39;,
       &#39;Canadian Museum of Civilization, Ottawa, Ontario, Canada&#39;,
       &#39;Irvin Department of Rare Books and Special Collections, Ernest F. Hollings Special Collections Library, University of South Carolina Libraries, Columbia, South Carolina, USA&#39;,
       &#39;Tufts University, Bendetson Hall, Medford, Massachusetts, USA&#39;,
       &#39;The British Museum, London&#39;, &#39;Tell Muqayyar, Iraq&#39;,
       &#39;Museo Arqueológico Nacional, Madrid, Spain&#39;,
       &#39;private: anonymous, uncertain&#39;,
       &#39;Institute of Archaeology, Hebrew University, Jerusalem&#39;,
       &#39;private: Mr. Arieh Ben Eli, Haifa, Israel&#39;,
       &quot;St. Andrew&#39;s Memorial Church, Church of Scotland, Jerusalem&quot;,
       &#39;Niedersächsische Landesmuseum Hannover, Germany&#39;,
       &#39;Library of Centenary College, Shreveport, Louisiana, USA&#39;,
       &#39;Allen Memorial Arl Museum, Oberlin, Ohio, USA&#39;,
       &#39;McLennan Library, McGill University, Montreal, Quebec Province, Canada&#39;,
       &#39;private: Pabst, J. B, unlocated&#39;,
       &#39;Department of Classics, University of Cincinnati, Cincinnati, Ohio, USA&#39;,
       &#39;Hebrew Union College Museum, Cincinnati, Ohio, USA&#39;,
       &#39;Historical Society, Suffield, Connecticut, USA&#39;,
       &#39;Drew University, Madison, New Jersey, USA&#39;,
       &#39;New Brunswick Museum, Saint John, New Brunswick, Canada&#39;,
       &#39;Stovall Museum of Science and History, University of Oklahoma, Norman, Oklahoma, USA&#39;,
       &#39;private: anonymous, France&#39;,
       &#39;Public Library of Cincinnati and Hamilton County, Cincinnati, Ohio, USA&#39;,
       &#39;Royal Albert Memorial Museum and Art Gallery, Exeter, Devon, UK&#39;,
       &#39;private: Strauss, unlocated&#39;,
       &#39;private: Gîatzer, V., Wiesbaden, Germany&#39;,
       &#39;Museum of Fine Arts, Boston, Massachusetts, USA&#39;,
       &#39;Walker Art Center, Minneapolis, Minnesota, USA (diszpersed)&#39;,
       &#39;Musée de Picardie. Amiens, France&#39;,
       &#39;George Ortiz Collection, Geneva, Switzerland&#39;,
       &#39;private: Armas Salonen (), Helsinki, Finland&#39;, &#39;unclear&#39;,
       &#39;private: anonymous, UK&#39;, &#39;private: anonymous, Jerusalem&#39;,
       &#39;Finnish National Museum, Helsinki, Finland&#39;,
       &#39;Altorientalisches Seminar, Free University of Berlin, Berlin, Germany&#39;,
       &#39;private: Likhochev&#39;,
       &#39;Smith College, Northampton, Massachusetts, USA&#39;,
       &#39;Manitoba Museum of Man and Nature, Winnipeg, Manitoba, Canada&#39;,
       &#39;Museum of the Buffalo Society of Natural Sciences, Buffalo, New York, USA&#39;,
       &#39;private: Mercer, S., unlocated&#39;,
       &#39;Crocker Art Museum, Sacramento, California, USA&#39;,
       &#39;private: Cherkasy&#39;, &#39;Newbury District Museum, Newbury, UK&#39;,
       &#39;private: F. Seidl-Geuthner, Paris, France&#39;,
       &#39;Claremont School of Theology, Claremont, California, USA&#39;,
       &#39;Übersee-Museum, Bremen, Germany&#39;,
       &#39;Toledo Museum of Art, Toledo, Ohio, USA&#39;,
       &#39;Institute of Egyptian Studies, University of Cambridge, Cambridge, UK&#39;,
       &#39;Private Arnold Spaer, FM 44 E.000-5, Jerusalem&#39;,
       &#39;Crocker Art Museum, Sacramento, CA, USA&#39;,
       &#39;Brooklyn Museum of Art, Brooklyn, New York, USA&#39;,
       &#39;St. Paul Public Library Collection, St. Paul, Minnesota, USA (dispersed)&#39;,
       &#39;Anadolu Medeniyetleri Müzesi, Ankara&#39;,
       &#39;Ashmolean Museum, Oxford, UK&#39;,
       &#39;Karpeles Collection, Santa Barbara, California, USA&#39;,
       &#39;private: Sivan, Raanan, Jerusalem&#39;,
       &quot;Musée d&#39;art de Joliette, Québec, Canada&quot;,
       &#39;private: anonymous, Pasadena, California, USA&#39;,
       &#39;Mount Holyoke College Art Museum, South Hadley, Massachusetts, USA&#39;,
       &#39;private: Harari, Moshe, Tel Aviv, Israel&#39;,
       &#39;Smithsonian Institution, Washington, DC, USA&#39;,
       &#39;Institute of Archaeology, University of Copenhagen, Denmark&#39;,
       &#39;private: Feuardent, M., London, UK&#39;,
       &#39;Département des Monnaies, Médailles et Antiques, Bibliothèque Nationale, Paris, France&#39;,
       &#39;Institute of Egyptian Studies, Cambridge, UK&#39;,
       &#39;Tyndale House, University of Cambridge, Cambridge, UK&#39;,
       &#39;Kunsthistorisches Museum, Vienna, Austria&#39;,
       &#39;Archäologisches Institut und Archäologische Sammlung der Universität Zürich, Zurich, Switzerland&#39;,
       &#39;Collection de Clerq&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian&#39;,
       &#39;private: anonymous, Sweden&#39;,
       &#39;Musei Vaticani, Museo Gregoriano Egizio, Rome, Italy&#39;,
       &#39;private: Seelye, L.H., New York, New York, USA&#39;,
       &#39;Wiener Museum für Völkerkunde, Vienna, Austria&#39;,
       &#39;private: Hares, D., unlocated, UK&#39;,
       &#39;private: anonymous, Berlin, Germany&#39;,
       &#39;private: anonymous, Russia&#39;, &#39;private: Rosen, J., USA&#39;,
       &#39;private: Garret, R., Baltimore, Maryland, USA&#39;,
       &#39;Museum of Ancient Cultures, Macquarie University, Sydney, Australia&#39;,
       &#39;The Hunterian Museum and Art Gallery, Glasgow, UK&#39;,
       &#39;University of Leuven, Leuven, Belgium&#39;,
       &#39;Davidson College Library, Davidson, NC, USA&#39;,
       &#39;Pickler Memorial Library, Truman State University, Kirksville, Missouri, USA&#39;,
       &#39;Center for Advanced Judaic Studies, University of Pennsylvania, Philadephia, Pennsylvania, USA&#39;,
       &#39;Private: anonymous, Sweden&#39;, &#39;Patterson Museum, New Jersey, USA&#39;,
       &#39;Princeton University Library, Princeton, New Jersey, USA&#39;,
       &#39;Brooklyn Museum, Brooklyn, New York, USA&#39;, &#39;Tello, Iraq&#39;,
       &#39;private: Jacobsen collection&#39;, &#39;private: Cugnin, France&#39;,
       &#39;private: Binning, Mellerstain, Berwickshire, UK&#39;,
       &#39;private: Smit, Amsterdam, Holland&#39;,
       &#39;Pushkin State Museum of Fine Arts, Moscow, Russian Federation&#39;,
       &#39;Charlotte M. Smith Collection of Miniature Books, University Libraries, University of Iowa, Iowa City, Iowa, USA&#39;,
       &#39;private: anonymous, Barcelona, Spain&#39;,
       &#39;Kenneth Spencer Research Library, University of Kansas, Lawrence, Kansas, USA&#39;,
       &#39;University of King’s College, Halifax, Nova Scotia, Canada&#39;,
       &#39;Musée de la Castre, Cannes, France&#39;,
       &#39;Mustansiriyah, Baghdad, Iraq&#39;,
       &#39;Museum of Fine Arts, Boston, Massacusetts, USA&#39;,
       &#39;Allegheny College, Meadville, Pennsylvania, USA&#39;,
       &#39;Buffalo and Erie County Public Library, Buffalo, New York, USA&#39;,
       &#39;St Louis, Missouri, USA&#39;, &#39;Leiden&#39;,
       &#39;private: Brenner, Ori, Rehovot, Israel&#39;,
       &#39;Kahramanmaraş Museum, Turkey&#39;,
       &#39;National Museum of Syria, Der-ez-Zor, Syria unlocated&#39;,
       &#39;Muséum Peronne, France&#39;, &#39;Joanneum Museum, Graz, Austria&#39;,
       &#39;University of Leeds, Leeds, UK&#39;, &#39;University of Lwów, Poland&#39;,
       &#39;private: Dorsky, Morris (on loan to J. Pierpont Morgan Library Collection, New York, New York, USA)&#39;,
       &#39;Abbey Museum, Queensland, Australia&#39;,
       &#39;Kestner Museum, Hannover, UK&#39;,
       &#39;private: anonymous, Vienna, Austria&#39;,
       &#39;Real Academia de la Historia, Madrid, Spain&#39;,
       &#39;private, Perk, H., Turkey&#39;,
       &#39;Mount Holyoke College, South Hadley, Massachusetts, USA&#39;,
       &#39;Erebuni Historico-Archaeological Museum- Reserve,&#39;,
       &#39;private: Foroughi collecllon&#39;, &#39;Iran Bastan Museum, Tehran, Iran&#39;,
       &#39;Eski Sark Museum, Istanbul, Turkey&#39;,
       &#39;private: Chappée collecllon&#39;, &#39;private: Mazda, A., Tehran, Iran&#39;,
       &#39;private: R.F. Harper collection&#39;, &#39;private: Foroughi collection&#39;,
       &#39;Oesterle Library, North Central College, Naperville, Illinois, USA&#39;,
       &#39;Russell Library, Maynooth University &amp; St. Patrick’s College, Maynooth, Co. Kildare, Ireland&#39;,
       &#39;Northwestern University Library, Evanston, Illinois, USA&#39;,
       &#39;National Car Museum of Iran, Tehran, Iran&#39;,
       &#39;Erie Historical Museum, Erie, Pennsylvania, USA&#39;,
       &#39;San Diego Museum of Man, San Diego, California, USA&#39;,
       &#39;Museum of Peoples and Cultures, Brigham Young University, Provo, Utah, USA&#39;,
       &#39;Missouri History Museum, St. Louis, Missouri, USA&#39;,
       &#39;Erebuni Museum, Yerevan, Armenia&#39;, &#39;private: Estonia&#39;,
       &#39;Private collection: F.S. Clark, Mayfield, UK&#39;,
       &#39;Department of Classics, University of Texas at Austin, Texas, USA&#39;,
       &#39;Archäologische Staatssammlung, Museum für Vor- und Frühgeschichte, Munich, Germany&#39;,
       &#39;Association Bible &amp; Civilisations, Jerusalem&#39;,
       &#39;Leipziger Altorientalischen Institut, Leipzig, Germany&#39;,
       &#39;Saint Louis Public Library, St. Louis, Missouri, USA&#39;,
       &#39;Sulaymaniyah Museum, Sulaymaniyah, Iraq&#39;,
       &#39;private: Lichatschew, N. P., Istanbul, Turkey&#39;, &#39;missing&#39;,
       &#39;Sächsische Landesbibliothek, Staats- und Universitätsbibliothek Dresden, Germany&#39;,
       &#39;private: Vora&#39;, &#39;IM&#39;,
       &#39;Oneida County Historical Society, Utica, New York, USA&#39;,
       &#39;Abu Shahrain, Iraq&#39;, &#39;El-Hiba, Iraq&#39;, &#39;Nuffar, Iraq&#39;,
       &#39;left in situ&#39;, &#39;Creighton University, Omaha, Nebraska, USA&#39;,
       &#39;Brighton Museum and Art Gallery, Brighton, UK&#39;,
       &#39;Aichi Prefectural University, Aichi, Japan&#39;,
       &#39;Quayle Bible Collection, Baker University, Baldwin City, Kansas, USA&#39;,
       &#39;private: Jerusalem&#39;, &#39;private: unlocated&#39;,
       &#39;Tsurumi University Library, Yokohama, Japan&#39;,
       &quot;Kobe Women&#39;s University Library, Kobe, Japan&quot;,
       &#39;Meiji University Library, Tokyo, Japan&#39;,
       &#39;Kansai University Library, Osaka, Japan&#39;,
       &#39;private: Ponsar, Jean-François, Brussels, Belgium&#39;,
       &quot;A&#39;ali, Bahrain&quot;, &#39;Musée des Confluences, Lyon, France&#39;,
       &#39;Dover Museum, Dover, UK&#39;,
       &#39;private: Foxvog, Daniel A., Rio Nido, CA, USA&#39;,
       &#39;private: anonymous&#39;, &#39;private: unknown, unlocated&#39;,
       &#39;Department of Middle Eastern Studies, University of West Bohemia, Pilsen, Czech Republic&#39;,
       &#39;Princeton University Art Museum, Princeton, New Jersey, USA&#39;,
       &#39;Private Collection&#39;,
       &#39;Istanbul Arkeoloki Museum, Istanbul, Turkey&#39;,
       &#39;Garstang Museum of Archaeology, University of Liverpool, Liverpool, UK&#39;,
       &#39;Civico Museo Archeologico Paolo Giovio, Como, Italy&#39;,
       &#39;Diözesanmuseum, Breslau, Poland&#39;, &#39;Mosul, Iraq&#39;,
       &#39;Eşki Şark Eserleri Müzesi, Istanbul, Turkey&#39;,
       &#39;Babylon, Iraq (in situ)&#39;,
       &#39;Private collection: anonymous, Berlin, Germany&#39;,
       &#39;Institute of Archaeology, University of Turin, Turin, Italy&#39;,
       &#39;Urfa Museum, Urfa, Turkey&#39;, &#39;Private collection: anonymous&#39;,
       &#39;Sela, Jordan&#39;, &#39;Tayma, Saudi Arabia&#39;,
       &#39;Archaeological Museum, Anakara, Turkey&#39;, &#39;private collection&#39;,
       &#39;private: Lizana, Joaquín, Huesca, Spain&#39;,
       &#39;private: Saaedi, London&#39;, &#39;Sammlung H. Grimme, Cologne, Germany&#39;,
       &#39;Erimtan Museum of Archaeology and Art, Ankara, Turkey&#39;,
       &#39;Gaziantep Archaeological Museum, Gaziantep, Turkey&#39;,
       &#39;private: Peter Franke, Saarbrücken, Germany&#39;,
       &#39;Lands of the Bible Archaeology Foundation&#39;,
       &#39;Hatay Archaeological Museum, Antakya, Turkey&#39;,
       &#39;Altorientalischen Seminar der Universität Tübingen, Germany&#39;,
       &#39;H.I.H. Prince Takahito Mikasa&#39;, &#39;Private collection&#39;,
       &#39;Vorderasiatisches Museum, Berlin, Germany (unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;unlocated (formerly in theTell Halaf Museum)&#39;,
       &#39;Oriental Institute, University of Chicago, Chicago, USA&#39;,
       &#39;Merseyside Museum, Liverpool, UK&#39;, &#39;Louvre, Paris&#39;,
       &#39;Arkeoloji Müzeleri, Istanbul&#39;,
       &#39;Arkeoloji Müzerleri, Istanbul, Turkey&#39;,
       &#39;Private Collection: de Clercq, Paris, France&#39;,
       &#39;Philadelphia Museum of Art, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Seminar für Assyriologie, Universität Heidelberg, Heidelberg, Germany&#39;,
       &#39;Yale Collection, New Haven, Connecticut, USA&#39;,
       &#39;Hearst Museum of Anthropology, University of California at Berkeley, Berkeley, California, USA&#39;,
       &#39;stele today lost photo of squeeze in the Vorderasiatisches Museum, Berlin, Germany&#39;,
       &#39;Georgian National Museum, Tbilisi, Georgia&#39;,
       &#39;British Museum, London, Great Britain&#39;, &#39;in situ&#39;,
       &#39;Sulaymaniyah Museum,&#39;, &#39;British Museum&#39;, &#39;University of Leeds&#39;,
       &#39;VAM&#39;, &#39;IAM&#39;, &#39;MMA&#39;, &#39;VAM and IAM&#39;,
       &#39;in situ, but never seen/found again&#39;, &#39;Van Museum, Van, Turkey&#39;,
       &#39;moulds of the three fragments (a-c) preserved in the Georgian National Museum, Tbilisi, Armenia (fragment a): found again in a private garden fragment c): lost)&#39;,
       &#39;lost&#39;,
       &#39;in situ, immured in the ruins of the church well preserved cast&#39;,
       &#39;History Museum of Armenia, Erevan, Armenia&#39;,
       &#39;ragment a): Van Museum, Van, Turkey fragment b): Istanbul Archaeology Museums, Istanbul, Turkey&#39;,
       &#39;Iraq Museum, Baghdad, Iraq&#39;,
       &#39;Tell Halaf museum collection, Berlin (destroyed)&#39;,
       &#39;Syro-Chaldean seminary of Mosul&#39;,
       &#39;Private collection of Prof. Peter Franke, Saarbrücken&#39;,
       &#39;Private collection of Shlomo Moussaieff, on long-term loan in the Bible Lands Museum, Jerusalem, Israel&#39;,
       &#39;Private: H. V. Hilprecht&#39;,
       &#39;John F. Lewis collection, Philadelphia Free Library, Philadelphia, Pennsylvania, USA&#39;,
       &#39;Brisith Museum, London, UK&#39;, &#39;Private: H.V. Hilprecht&#39;,
       &#39;Metropolitan Museum of Art, New York, USA&#39;,
       &#39;private: Amherst, unlocated (dispersed)&#39;,
       &#39;private: Ifergan Gallery (antiquarian), Málaga, Spain&#39;,
       &#39;University of Utah, J. Willard Marriott Library, Salt Lake City, USA&#39;,
       &#39;private: Green, Oklahoma City, USA&#39;, &#39;unknown, unlocated&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_collections_clean2</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_c_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">unmatched_c_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4f3cdfca-081f-42db-bbb9-00bbf0984de6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>collection</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>327408</td>
    </tr>
    <tr>
      <th>1</th>
      <td>unlocated</td>
      <td>1606</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Department of Near Eastern Studies, Cornell Un...</td>
      <td>698</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Anadolu Medeniyetleri Müzesi, Ankara, Turkey</td>
      <td>511</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Schøyen Collection, Oslo, Norway</td>
      <td>453</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>672</th>
      <td>unlocated: reconstructed according to unlocate...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>673</th>
      <td>M.H. De Young Museum, San Francisco, Californi...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>674</th>
      <td>Christ Church College, Oxford, UK (a)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>675</th>
      <td>Museum Calouste Gulbenkian, Lisbon, Portugal (a)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>676</th>
      <td>unknown, unlocated</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>677 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4f3cdfca-081f-42db-bbb9-00bbf0984de6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4f3cdfca-081f-42db-bbb9-00bbf0984de6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4f3cdfca-081f-42db-bbb9-00bbf0984de6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fe76635e-5f1e-4a86-88d4-0376b0778fd6">
  <button class="colab-df-quickchart" onclick="quickchart('df-fe76635e-5f1e-4a86-88d4-0376b0778fd6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fe76635e-5f1e-4a86-88d4-0376b0778fd6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_c_df2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/unmatched_oracc_collections_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_c_df2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Collections&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Top 10 Collections of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bc3a2688b8e9b7392ef749b90cb7718e781907280a4509bc766e6f5d0f13d83f.png" src="_images/bc3a2688b8e9b7392ef749b90cb7718e781907280a4509bc766e6f5d0f13d83f.png" />
</div>
</div>
</section>
</section>
<section id="merging-collections-of-cdli-and-oracc">
<h3>3.3 Merging collections of CDLI and ORACC<a class="headerlink" href="#merging-collections-of-cdli-and-oracc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">collection_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">collection_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(366916, 12)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-bdf02426-12c0-44d8-8575-d7511274dd65" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bdf02426-12c0-44d8-8575-d7511274dd65')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bdf02426-12c0-44d8-8575-d7511274dd65 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bdf02426-12c0-44d8-8575-d7511274dd65');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d7f9b98c-90ee-40f5-82e0-4fce10cfa59f">
  <button class="colab-df-quickchart" onclick="quickchart('df-d7f9b98c-90ee-40f5-82e0-4fce10cfa59f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d7f9b98c-90ee-40f5-82e0-4fce10cfa59f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">collection_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">collection_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(366916, 12)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-7a4fe658-0cac-43a9-8782-baddb7860fe6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_collection</th>
      <th>collection</th>
      <th>collection_qid</th>
      <th>collection_wikidata_id</th>
      <th>collection_name</th>
      <th>collection_name_native</th>
      <th>collection_url</th>
      <th>wiki_url_eng</th>
      <th>wiki_url_native</th>
      <th>P155_collection</th>
      <th>other_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7a4fe658-0cac-43a9-8782-baddb7860fe6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7a4fe658-0cac-43a9-8782-baddb7860fe6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7a4fe658-0cac-43a9-8782-baddb7860fe6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2fc25108-aea0-493d-a92f-05dbb9bd210a">
  <button class="colab-df-quickchart" onclick="quickchart('df-2fc25108-aea0-493d-a92f-05dbb9bd210a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2fc25108-aea0-493d-a92f-05dbb9bd210a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collection_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id_text&#39;, &#39;cdli_dump_collection&#39;, &#39;collection&#39;, &#39;collection_qid&#39;,
       &#39;collection_wikidata_id&#39;, &#39;collection_name&#39;, &#39;collection_name_native&#39;,
       &#39;collection_url&#39;, &#39;wiki_url_eng&#39;, &#39;wiki_url_native&#39;, &#39;P155_collection&#39;,
       &#39;other_collection&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">collections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">collection_df</span><span class="p">,</span> <span class="n">collection_df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_collections_df</span> <span class="o">=</span> <span class="n">collections_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_y&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_qid_y&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;collection_wikidata_id_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_wikidata_id_y&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_y&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_native_x&#39;</span><span class="p">,</span><span class="s1">&#39;collection_name_native_y&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;collection_url_x&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_url_y&#39;</span><span class="p">,</span> <span class="s1">&#39;wiki_url_eng_x&#39;</span><span class="p">,</span><span class="s1">&#39;wiki_url_eng_y&#39;</span><span class="p">,</span> <span class="s1">&#39;wiki_url_native_x&#39;</span><span class="p">,</span><span class="s1">&#39;wiki_url_native_y&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;P155_collection_y&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;other_collection_x&#39;</span><span class="p">,</span> <span class="s1">&#39;other_collection_y&#39;</span><span class="p">]]</span>

<span class="n">final_collections_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a55f29cf-f39e-4ad4-a817-cdd430ca1f7c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>collection_qid_x</th>
      <th>collection_qid_y</th>
      <th>collection_wikidata_id_x</th>
      <th>collection_wikidata_id_y</th>
      <th>collection_name_x</th>
      <th>collection_name_y</th>
      <th>collection_name_native_x</th>
      <th>collection_name_native_y</th>
      <th>collection_url_x</th>
      <th>collection_url_y</th>
      <th>wiki_url_eng_x</th>
      <th>wiki_url_eng_y</th>
      <th>wiki_url_native_x</th>
      <th>wiki_url_native_y</th>
      <th>P155_collection_x</th>
      <th>P155_collection_y</th>
      <th>other_collection_x</th>
      <th>other_collection_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a55f29cf-f39e-4ad4-a817-cdd430ca1f7c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a55f29cf-f39e-4ad4-a817-cdd430ca1f7c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a55f29cf-f39e-4ad4-a817-cdd430ca1f7c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-03f9546d-55aa-41db-9aac-a8adabdbf84a">
  <button class="colab-df-quickchart" onclick="quickchart('df-03f9546d-55aa-41db-9aac-a8adabdbf84a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-03f9546d-55aa-41db-9aac-a8adabdbf84a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_collections_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_collections_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="provenience-find-spot-p695">
<h2>4 <strong>provenience = find spot <a class="reference external" href="https://database.factgrid.de/wiki/Property:P695">(P695)</a></strong><a class="headerlink" href="#provenience-find-spot-p695" title="Link to this heading">#</a></h2>
<p>####4.1. Use this CSV to obtain the FactGrid Q-ids for each provenience location in the CDLI catalog:</p>
<p><a class="reference external" href="https://drive.google.com/file/d/1C8hj2nVC8_qzFb8HbArbMpsx41OAV9-m/view?usp=share_link">https://drive.google.com/file/d/1C8hj2nVC8_qzFb8HbArbMpsx41OAV9-m/view?usp=share_link</a></p>
<p>####4.2. Matching can be done either on the cdli ‘provenience’ label, or on the ‘cdli_id2’ number <a class="reference external" href="https://database.factgrid.de/entity/P694">(P694)</a>, but we will need to add the <code class="docutils literal notranslate"><span class="pre">id_text2</span></code> from the original cdli_cat.csv</p>
<p>####4.3. make a data frame, called <code class="docutils literal notranslate"><span class="pre">provenience_df</span></code>, for all matches of the text’s ‘provenience’ to  FactGrid Q-id for ‘find spot’.</p>
<section id="add-two-columns-as-qualifiers">
<h3>4.4 Add two columns as qualifiers:<a class="headerlink" href="#add-two-columns-as-qualifiers" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>‘excavation_no’ = <a class="reference external" href="https://database.factgrid.de/entity/P804">P804</a> Inventory number</p></li>
<li><p>‘findspot_square’ = <a class="reference external" href="https://database.factgrid.de/entity/P425">P425</a> Precision of localisation</p></li>
<li><p>Example text <a class="reference external" href="https://cdli.mpiwg-berlin.mpg.de/artifacts/285665">P285665</a></p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>P695</p></th>
<th class="head"><p>provenience</p></th>
<th class="head"><p>excavation_no</p></th>
<th class="head"><p>findspot_square</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>285665</p></td>
<td><p>Q390001</p></td>
<td><p>Assur (mod. Qalat Sherqat)</p></td>
<td><p>Ass 17861,d + Ass 17861,b + Ass 17861,g + Ass 17861,a</p></td>
<td><p>hD81 (house of the exorcist), excavation trench</p></td>
</tr>
</tbody>
</table>
<p>####4.5. make a separate data frame of all texts which were not matched (or no location identified): <code class="docutils literal notranslate"><span class="pre">no_provenience_df</span></code>.
#####4.5.1. export a CSV of all the unique values (done 7/11/23)
#####4.5.2. Resolve the non-matched labels for the occurance of ‘?’ in the label, or ‘:’ as a separator of joined labels.</p>
<ul class="simple">
<li><p>If there are any question marks, we can use the P155 field in a new column and fill the cell with <a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a>, then remove the question mark from the label</p></li>
<li><p>For labels with double entries, seaprated by a colon ‘:’ we can add these to a new column named: find_spot_2, find_spot_3, etc.
#####4.5.3. Optional: when a provenience label consists of multiple labels joined by ‘:’, we can add the separated labels to a new dataframe, which we can use for matching purposes. This will be useful for making a lookup table for future tasks as well, i.e. when matching with the toponyms for provenience from the ocr-output, where the spellings of these toponyms change depending on the langauge.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">otest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/LOD Tablet Dictionary (FG Cuneiform) - FG_CIGS.csv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;provenience&#39;</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1">#ultimately decided to drop na because there were too many unidentified provenience-len pairs</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Len&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cat_df1</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no_x&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no_y&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">:</span><span class="s1">&#39;provenience&#39;</span><span class="p">})</span>
<span class="n">cat_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">:</span><span class="s1">&#39;provenience&#39;</span><span class="p">})</span>

<span class="n">otest_ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-de99577e-015a-4cc9-a726-27607edf94aa" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FG_qid</th>
      <th>provenience</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>id_text2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q389888</td>
      <td>Garšana (mod. uncertain)</td>
      <td>https://database.factgrid.de/entity/Q389888</td>
      <td>Garshana</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q389722</td>
      <td>uncertain (mod. Shahr-i Sokhta)</td>
      <td>https://database.factgrid.de/entity/Q389722</td>
      <td>Shahr-i Sūkhta</td>
      <td>309.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q390040</td>
      <td>Samal (mod. Zinčirli)</td>
      <td>https://database.factgrid.de/entity/Q390040</td>
      <td>Zinčirli</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q389604</td>
      <td>Kourion (mod. Cyprus)</td>
      <td>https://database.factgrid.de/entity/Q389604</td>
      <td>Kourion</td>
      <td>375.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q390044</td>
      <td>uncertain (mod. Kuşaklı)</td>
      <td>https://database.factgrid.de/entity/Q390044</td>
      <td>Kuşaklı</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>250</th>
      <td>Q390023</td>
      <td>uncertain (mod. Nahr el-Kelb)</td>
      <td>https://database.factgrid.de/entity/Q390023</td>
      <td>Nahr al-Kalb</td>
      <td>292.0</td>
    </tr>
    <tr>
      <th>251</th>
      <td>Q390057</td>
      <td>uncertain (mod. Aşağı Yarımca)</td>
      <td>https://database.factgrid.de/entity/Q390057</td>
      <td>Aşağı Yarımca</td>
      <td>310.0</td>
    </tr>
    <tr>
      <th>252</th>
      <td>Q390053</td>
      <td>uncertain (mod. Tell Fray)</td>
      <td>https://database.factgrid.de/entity/Q390053</td>
      <td>Tall Fray</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>253</th>
      <td>Q390032</td>
      <td>uncertain (mod. Yasuj)</td>
      <td>https://database.factgrid.de/entity/Q390032</td>
      <td>Yāsūj</td>
      <td>188.0</td>
    </tr>
    <tr>
      <th>254</th>
      <td>Q390019</td>
      <td>uncertain (mod. Negub tunnel)</td>
      <td>https://database.factgrid.de/entity/Q390019</td>
      <td>Nigūb</td>
      <td>273.0</td>
    </tr>
  </tbody>
</table>
<p>255 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-de99577e-015a-4cc9-a726-27607edf94aa')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-de99577e-015a-4cc9-a726-27607edf94aa button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-de99577e-015a-4cc9-a726-27607edf94aa');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-909ae803-d4f5-4bc6-a262-196dba8c4570">
  <button class="colab-df-quickchart" onclick="quickchart('df-909ae803-d4f5-4bc6-a262-196dba8c4570')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-909ae803-d4f5-4bc6-a262-196dba8c4570 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cdli_proveniences_df</span> <span class="o">=</span> <span class="n">cat_df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">otest_ref</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;provenience&quot;</span><span class="p">)</span>
<span class="n">cdli_proveniences_df</span> <span class="o">=</span> <span class="n">cdli_proveniences_df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">:</span> <span class="s1">&#39;provenience_FG_qid&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cdli_proveniences_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-588e0a9d-6962-48a1-b150-83562757e9f2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>provenience</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>museum_no_x</th>
      <th>museum_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>provenience_FG_qid</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>id_text2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>VAT 01533</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>VAT 15263</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>VAT 15253</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>VAT 15168</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>VAT 15153</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>Warkāʼ</td>
      <td>105.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-588e0a9d-6962-48a1-b150-83562757e9f2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-588e0a9d-6962-48a1-b150-83562757e9f2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-588e0a9d-6962-48a1-b150-83562757e9f2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-59f73463-bbda-4c79-9b16-6522d270532b">
  <button class="colab-df-quickchart" onclick="quickchart('df-59f73463-bbda-4c79-9b16-6522d270532b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-59f73463-bbda-4c79-9b16-6522d270532b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">oracc_proveniences_df</span> <span class="o">=</span> <span class="n">cat_df2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">otest_ref</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;provenience&quot;</span><span class="p">)</span>
<span class="n">oracc_proveniences_df</span> <span class="o">=</span> <span class="n">oracc_proveniences_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span> <span class="c1">#no column is fully empty, this line of code confirms that</span>
<span class="n">oracc_proveniences_df</span> <span class="o">=</span> <span class="n">oracc_proveniences_df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">:</span> <span class="s1">&#39;provenience_FG_qid&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">oracc_proveniences_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7ee110c2-4f7d-4bdc-9ffa-8de8d8c3ce5f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>provenience</th>
      <th>provenience_FG_qid</th>
      <th>ancientplace</th>
      <th>Len</th>
      <th>id_text2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 6 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7ee110c2-4f7d-4bdc-9ffa-8de8d8c3ce5f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7ee110c2-4f7d-4bdc-9ffa-8de8d8c3ce5f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7ee110c2-4f7d-4bdc-9ffa-8de8d8c3ce5f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1a7635c6-cfb3-49e1-b63c-be7bd3c37be1">
  <button class="colab-df-quickchart" onclick="quickchart('df-1a7635c6-cfb3-49e1-b63c-be7bd3c37be1')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1a7635c6-cfb3-49e1-b63c-be7bd3c37be1 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_proveniences_df</span> <span class="o">=</span> <span class="n">cdli_proveniences_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">oracc_proveniences_df</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id_text&quot;</span><span class="p">)</span>
<span class="n">final_proveniences_df</span> <span class="o">=</span> <span class="n">final_proveniences_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_FG_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_FG_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">,</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">,</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">,</span><span class="s1">&#39;museum_no_x&#39;</span><span class="p">,</span> <span class="s1">&#39;museum_no_y&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">,</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">,</span><span class="s1">&#39;ancientplace_x&#39;</span><span class="p">,</span><span class="s1">&#39;ancientplace_y&#39;</span><span class="p">,</span><span class="s1">&#39;Len_x&#39;</span><span class="p">,</span><span class="s1">&#39;Len_y&#39;</span><span class="p">]]</span>

<span class="n">final_proveniences_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-28941962-e374-49da-93fe-f892618ef4c8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>provenience_FG_qid_x</th>
      <th>provenience_FG_qid_y</th>
      <th>provenience_x</th>
      <th>provenience_y</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>museum_no_x</th>
      <th>museum_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>ancientplace_x</th>
      <th>ancientplace_y</th>
      <th>Len_x</th>
      <th>Len_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>VAT 01533</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>VAT 15263</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>VAT 15253</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>VAT 15168</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>VAT 15153</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 15 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-28941962-e374-49da-93fe-f892618ef4c8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-28941962-e374-49da-93fe-f892618ef4c8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-28941962-e374-49da-93fe-f892618ef4c8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f86cae40-768a-4a1e-9200-4bf2ca2d89ce">
  <button class="colab-df-quickchart" onclick="quickchart('df-f86cae40-768a-4a1e-9200-4bf2ca2d89ce')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f86cae40-768a-4a1e-9200-4bf2ca2d89ce button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_proveniences_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_proveniences_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="object-type-instance-of-p2">
<h2>5 <strong>object_type = Instance of <a class="reference external" href="https://database.factgrid.de/wiki/Property:P2">(P2)</a></strong><a class="headerlink" href="#object-type-instance-of-p2" title="Link to this heading">#</a></h2>
<p>####5.1 Use this CSV to obtain the FactGrid Q-ids for each object type in the CDLI catalog:
<a class="reference external" href="https://drive.google.com/file/d/12yQ8rI-_WRSOQIcwV3TBs5xyPRHliFeK/view?usp=share_link">https://drive.google.com/file/d/12yQ8rI-_WRSOQIcwV3TBs5xyPRHliFeK/view?usp=share_link</a></p>
<p>####5.2. Match on the cdli label for ‘object_type’ to obtain the FactGrid Q-id</p>
<p>####5.3. Make a data frame, called <code class="docutils literal notranslate"><span class="pre">object_type_df</span></code>, for all matches.</p>
<p>####5.4. Make a separate data frame of the texts / artifacts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_object_type_df</span></code>.</p>
<p>note: dont have objects that overlap live as a separate class</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">object_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/ancient-world-citation-analysis/CDLI2LoD/main/data/Object%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">otest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">object_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">otest_ref</span> <span class="o">=</span> <span class="n">otest</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="n">otest_ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4546edea-fc61-4100-929a-f7da8d41bf7b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>object_type</th>
      <th>FG_qid</th>
      <th>FG_Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>barrel</td>
      <td>Q512054</td>
      <td>Clay barrel</td>
    </tr>
    <tr>
      <th>1</th>
      <td>block</td>
      <td>Q512055</td>
      <td>Clay block</td>
    </tr>
    <tr>
      <th>2</th>
      <td>brick</td>
      <td>Q512056</td>
      <td>Clay brick</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bulla</td>
      <td>Q512057</td>
      <td>Clay bulla</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cone</td>
      <td>Q512058</td>
      <td>Clay cone</td>
    </tr>
    <tr>
      <th>5</th>
      <td>cylinder</td>
      <td>Q512059</td>
      <td>Clay cylinder</td>
    </tr>
    <tr>
      <th>6</th>
      <td>docket</td>
      <td>Q512060</td>
      <td>Clay docket</td>
    </tr>
    <tr>
      <th>7</th>
      <td>envelope</td>
      <td>Q512061</td>
      <td>Clay envelope</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lentil</td>
      <td>Q512062</td>
      <td>Clay lentil tablet</td>
    </tr>
    <tr>
      <th>9</th>
      <td>prism</td>
      <td>Q512063</td>
      <td>Clay prism</td>
    </tr>
    <tr>
      <th>10</th>
      <td>prismatic cylinder</td>
      <td>Q512064</td>
      <td>Clay prismatic cylinder</td>
    </tr>
    <tr>
      <th>11</th>
      <td>seal</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>12</th>
      <td>sealing</td>
      <td>Q512066</td>
      <td>Clay sealing</td>
    </tr>
    <tr>
      <th>13</th>
      <td>tablet</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>14</th>
      <td>tag</td>
      <td>Q512067</td>
      <td>Clay tag</td>
    </tr>
    <tr>
      <th>15</th>
      <td>vase</td>
      <td>Q512068</td>
      <td>Clay vase</td>
    </tr>
    <tr>
      <th>16</th>
      <td>vessel</td>
      <td>Q512069</td>
      <td>Clay vessel</td>
    </tr>
    <tr>
      <th>17</th>
      <td>other</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>other (see object remarks)</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>seal (not impression)</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>20</th>
      <td>stamp seal</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4546edea-fc61-4100-929a-f7da8d41bf7b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4546edea-fc61-4100-929a-f7da8d41bf7b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4546edea-fc61-4100-929a-f7da8d41bf7b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-618eef8b-7ae7-43e4-b7df-e61e1dc820f7">
  <button class="colab-df-quickchart" onclick="quickchart('df-618eef8b-7ae7-43e4-b7df-e61e1dc820f7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-618eef8b-7ae7-43e4-b7df-e61e1dc820f7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="cdli-objects">
<h3>5.1 CDLI objects<a class="headerlink" href="#cdli-objects" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#cleaning up the object_type_x column and creating a secondary column to hold any further identifiable object types</span>
<span class="n">object_type</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_x&#39;</span><span class="p">]</span>
<span class="n">object_type</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">object_type</span> <span class="o">=</span> <span class="n">object_type</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">object_type</span> <span class="o">=</span> <span class="n">object_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;tablet &quot;</span><span class="p">,</span> <span class="s2">&quot;tablet&quot;</span><span class="p">)</span>
<span class="n">object_type2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">object_type</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">object_type</span><span class="p">)):</span>
  <span class="c1"># print(object_type[i], type(object_type[i]))</span>
  <span class="k">if</span> <span class="s1">&#39;&amp;&#39;</span> <span class="ow">in</span> <span class="n">object_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;in&#39;</span> <span class="ow">in</span> <span class="n">object_type</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">object_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tablet&#39;</span>
    <span class="n">object_type2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;envelope&#39;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">object_type2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">object_type</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         tablet
1         tablet
2         tablet
3         tablet
4         tablet
           ...  
366911          
366912          
366913          
366914          
366915          
Name: object_type_x, Length: 366916, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">],</span> <span class="s1">&#39;object_type&#39;</span><span class="p">:</span> <span class="n">object_type</span><span class="p">,</span> <span class="s1">&#39;object_type2&#39;</span><span class="p">:</span><span class="n">object_type2</span><span class="p">})</span>

<span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;stamp seal&quot;</span><span class="p">:</span> <span class="s2">&quot;seal&quot;</span><span class="p">})</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">otest_ref</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">non_merged_rows</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span>
<span class="c1">#merged_df = merged_df[merged_df[&#39;_merge&#39;] == &#39;both&#39;]</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;_merge&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;FG_qid&quot;</span><span class="p">:</span> <span class="s2">&quot;object_FG_qid&quot;</span><span class="p">,</span> <span class="s2">&quot;FG_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;object_FG_Label&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">merged_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e301ac3e-7ccf-4698-9ef9-3916a9b4e643" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>object_type</th>
      <th>object_type2</th>
      <th>object_FG_qid</th>
      <th>object_FG_Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X000972</td>
      <td>bronze cross</td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366916</th>
      <td>NaN</td>
      <td>cylinder</td>
      <td>NaN</td>
      <td>Q512059</td>
      <td>Clay cylinder</td>
    </tr>
    <tr>
      <th>366917</th>
      <td>NaN</td>
      <td>prismatic cylinder</td>
      <td>NaN</td>
      <td>Q512064</td>
      <td>Clay prismatic cylinder</td>
    </tr>
    <tr>
      <th>366919</th>
      <td>NaN</td>
      <td>seal</td>
      <td>NaN</td>
      <td>Q512065</td>
      <td>seal</td>
    </tr>
    <tr>
      <th>366920</th>
      <td>NaN</td>
      <td>sealing</td>
      <td>NaN</td>
      <td>Q512066</td>
      <td>Clay sealing</td>
    </tr>
  </tbody>
</table>
<p>366920 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e301ac3e-7ccf-4698-9ef9-3916a9b4e643')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e301ac3e-7ccf-4698-9ef9-3916a9b4e643 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e301ac3e-7ccf-4698-9ef9-3916a9b4e643');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f5e45d33-7e4c-4ab4-8775-d631400ed1f7">
  <button class="colab-df-quickchart" onclick="quickchart('df-f5e45d33-7e4c-4ab4-8775-d631400ed1f7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f5e45d33-7e4c-4ab4-8775-d631400ed1f7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="oracc-objects">
<h3>5.2 ORACC objects<a class="headerlink" href="#oracc-objects" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#cleaning up the object_type_x column and creating a secondary column to hold any further identifiable object types</span>
<span class="n">object_type</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;object_type_y&#39;</span><span class="p">]</span>
<span class="n">object_type</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">object_type</span> <span class="o">=</span> <span class="n">object_type</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">object_type</span> <span class="o">=</span> <span class="n">object_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;tablet &quot;</span><span class="p">,</span> <span class="s2">&quot;tablet&quot;</span><span class="p">)</span>
<span class="n">object_type2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">object_type</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">object_type</span><span class="p">)):</span>
  <span class="c1"># print(object_type[i], type(object_type[i]))</span>
  <span class="k">if</span> <span class="s1">&#39;&amp;&#39;</span> <span class="ow">in</span> <span class="n">object_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;in&#39;</span> <span class="ow">in</span> <span class="n">object_type</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">object_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tablet&#39;</span>
    <span class="n">object_type2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;envelope&#39;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">object_type2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">object_type</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         tablet
1         tablet
2         tablet
3         tablet
4         tablet
           ...  
366911          
366912          
366913          
366914          
366915          
Name: object_type_y, Length: 366916, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cat2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">],</span> <span class="s1">&#39;object_type&#39;</span><span class="p">:</span> <span class="n">object_type</span><span class="p">,</span> <span class="s1">&#39;object_type2&#39;</span><span class="p">:</span><span class="n">object_type2</span><span class="p">})</span>

<span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">otest_ref</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;stamp seal&quot;</span><span class="p">,</span> <span class="s2">&quot;seal&quot;</span><span class="p">)</span>

<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cat2</span><span class="p">,</span> <span class="n">otest_ref</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;object_type&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">non_merged_rows2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="p">[</span><span class="n">merged_df2</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span>
<span class="c1">#merged_df = merged_df[merged_df[&#39;_merge&#39;] == &#39;both&#39;]</span>
<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;_merge&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">merged_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;FG_qid&quot;</span><span class="p">:</span> <span class="s2">&quot;object_FG_qid&quot;</span><span class="p">,</span> <span class="s2">&quot;FG_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;object_FG_Label&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#non_merged_rows</span>
<span class="c1">#cat2</span>
<span class="n">merged_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-98dc0b4e-2fd6-4fb8-b828-953e9f1e052b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>object_type</th>
      <th>object_type2</th>
      <th>object_FG_qid</th>
      <th>object_FG_Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-98dc0b4e-2fd6-4fb8-b828-953e9f1e052b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-98dc0b4e-2fd6-4fb8-b828-953e9f1e052b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-98dc0b4e-2fd6-4fb8-b828-953e9f1e052b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-53460ac7-f5bc-4c47-856b-39c61975ec22">
  <button class="colab-df-quickchart" onclick="quickchart('df-53460ac7-f5bc-4c47-856b-39c61975ec22')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-53460ac7-f5bc-4c47-856b-39c61975ec22 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="merging-object-dfs-of-cdli-and-oracc">
<h3>Merging object dfs of CDLI and ORACC<a class="headerlink" href="#merging-object-dfs-of-cdli-and-oracc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">objects_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_df2</span><span class="p">,</span> <span class="n">merged_df</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">final_objects_df</span> <span class="o">=</span> <span class="n">objects_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_x&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type2_x&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type_y&#39;</span><span class="p">,</span> <span class="s1">&#39;object_type2_y&#39;</span><span class="p">,</span> <span class="s1">&#39;object_FG_qid_x&#39;</span><span class="p">,</span> <span class="s1">&#39;object_FG_qid_y&#39;</span><span class="p">,</span> <span class="s1">&#39;object_FG_Label_x&#39;</span><span class="p">,</span> <span class="s1">&#39;object_FG_Label_y&#39;</span><span class="p">]]</span>
<span class="n">final_objects_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6500ec4f-d2e8-4c07-9b62-0800ab2cd556" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>object_type_x</th>
      <th>object_type2_x</th>
      <th>object_type_y</th>
      <th>object_type2_y</th>
      <th>object_FG_qid_x</th>
      <th>object_FG_qid_y</th>
      <th>object_FG_Label_x</th>
      <th>object_FG_Label_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>tablet</td>
      <td></td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>tablet</td>
      <td></td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>tablet</td>
      <td></td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>tablet</td>
      <td></td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>tablet</td>
      <td></td>
      <td>tablet</td>
      <td></td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6500ec4f-d2e8-4c07-9b62-0800ab2cd556')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6500ec4f-d2e8-4c07-9b62-0800ab2cd556 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6500ec4f-d2e8-4c07-9b62-0800ab2cd556');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e43833e7-34bf-4228-8825-c100623cdce5">
  <button class="colab-df-quickchart" onclick="quickchart('df-e43833e7-34bf-4228-8825-c100623cdce5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e43833e7-34bf-4228-8825-c100623cdce5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_objects_df</span> <span class="o">=</span> <span class="n">final_objects_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_objects_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_objects_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="genre-field-of-knowledge-p608">
<h2>6 <strong>genre = Field of Knowledge <a class="reference external" href="https://database.factgrid.de/wiki/Property:P608">(P608)</a></strong><a class="headerlink" href="#genre-field-of-knowledge-p608" title="Link to this heading">#</a></h2>
<section id="use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog">
<h3>6.1 Use this <a class="reference external" href="https://drive.google.com/file/d/1Xo-Wh0JCRDMRTpYEm5GYz_tOljUtiyLo/view?usp=drive_link">CSV</a> to obtain the FactGrid Q-ids for each object type in the CDLI catalog:<a class="headerlink" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog" title="Link to this heading">#</a></h3>
<p>N.B. some items have double entries, e.g. ‘prayer/incantation’ or ‘lexical; literary’. We can either separate these before performing the match and duplicate the item’s <code class="docutils literal notranslate"><span class="pre">id_text</span></code> or we can use the additional columns for matches with multiple entries. Either way we will need to resolve the double entries in batches when using QuickStatements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Genre%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">genre_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># use the second row as column name</span>

<span class="c1"># fill na values with space</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># rename the columns</span>
<span class="n">genre_reference</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Typeofwork&#39;</span><span class="p">:</span> <span class="s1">&#39;FG_qid&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># remove entries without a FactGrid QID</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># remove the question marks as we will deal with it later</span>
<span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;cdli_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
<span class="c1"># drop duplicated rows</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">])</span>
<span class="c1"># drop P155 and cdli_genre and reorder the dataframe</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[[</span><span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_2&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_3&#39;</span><span class="p">,</span> <span class="s1">&#39;current_count&#39;</span><span class="p">]]</span>


<span class="c1"># for now, we will not consider the ones with multiple entires</span>
<span class="c1"># so remove the ones with ; or , in the record</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[[(</span><span class="s1">&#39;;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">i</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]]]</span>
<span class="c1"># drop FG_qid_2 and 3</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_qid_2&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_qid_3&#39;</span><span class="p">])</span>
<span class="c1"># reset_index</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># standardize format to prepare for the match</span>
<span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]]</span>
<span class="c1"># drop rows with typo</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="c1"># reset_index</span>
<span class="n">genre_reference</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">genre_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5a7ffb33-39eb-4a31-94cb-dda57b041829" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>FG_qid</th>
      <th>current_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Astronomical</td>
      <td>Q390194</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Historical</td>
      <td>Q39130</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Letter</td>
      <td>Q10510</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Literary</td>
      <td>Q245823</td>
      <td>10k+</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mathematical</td>
      <td>Q146582</td>
      <td>2098</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Medical</td>
      <td>Q76112</td>
      <td>1054</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Monumental</td>
      <td>Q537039</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Omen</td>
      <td>Q246074</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Prayer/incantation</td>
      <td>Q10315</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Prayer</td>
      <td>Q10315</td>
      <td>1194</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Incantation</td>
      <td>Q246184</td>
      <td>281</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Ritual</td>
      <td>Q77545</td>
      <td>1578</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Royal</td>
      <td>Q537039</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>School</td>
      <td>Q246098</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Scientific</td>
      <td>Q245824</td>
      <td>8538</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Votive</td>
      <td>Q537055</td>
      <td>17</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Omens</td>
      <td>Q246074</td>
      <td></td>
    </tr>
    <tr>
      <th>20</th>
      <td>Pottery (seal)</td>
      <td>Q512065</td>
      <td></td>
    </tr>
    <tr>
      <th>21</th>
      <td>Private/votive</td>
      <td>Q537055</td>
      <td></td>
    </tr>
    <tr>
      <th>22</th>
      <td>Royal/monumental</td>
      <td>Q537039</td>
      <td></td>
    </tr>
    <tr>
      <th>23</th>
      <td>Royal/votive</td>
      <td>Q537039</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5a7ffb33-39eb-4a31-94cb-dda57b041829')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5a7ffb33-39eb-4a31-94cb-dda57b041829 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5a7ffb33-39eb-4a31-94cb-dda57b041829');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-18567975-adf0-42c9-8b4e-7c48d7d42f47">
  <button class="colab-df-quickchart" onclick="quickchart('df-18567975-adf0-42c9-8b4e-7c48d7d42f47')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-18567975-adf0-42c9-8b4e-7c48d7d42f47 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="cdli-genres">
<h3>6.2 CDLI Genres<a class="headerlink" href="#cdli-genres" title="Link to this heading">#</a></h3>
<section id="match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id">
<h4>6.2.1 Match on the cdli label ‘genre’ to obtain the FactGrid Q-id.<a class="headerlink" href="#match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_x&#39;</span><span class="p">]]</span>
<span class="n">genre_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;genre_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">})</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Lexical&#39;, &#39;Administrative&#39;, &#39;School&#39;, &#39;uncertain&#39;, &#39;Legal&#39;,
       &#39;Royal/Monumental&#39;, &#39;Literary&#39;, &#39;Administrative ?&#39;, &#39;Mathematical&#39;,
       &#39;Prayer/Incantation&#39;, &#39;Mathematical ?&#39;, &#39;Letter&#39;, &#39;School ?&#39;,
       &#39;fake (modern)&#39;, &#39;Literary ?&#39;, &#39;Ritual&#39;, &#39;Private/Votive&#39;,
       &#39;Other (see subgenre)&#39;, &#39;Scientific&#39;, nan, &#39;Royal/Monumental ?&#39;,
       &#39;Legal ?&#39;, &#39;Omen&#39;, &#39;Uncertain&#39;, &#39;Literary; Mathematical&#39;,
       &#39;Lexical; Literary&#39;, &#39;Lexical; Mathematical&#39;, &#39;Lexical; School&#39;,
       &#39;Lexical; Literary; Mathematical&#39;, &#39;Literary; Lexical&#39;,
       &#39;Literary; Letter&#39;, &#39;Lexical ?&#39;, &#39;Ritual ?&#39;, &#39;Royal/Votive&#39;,
       &#39;Letter ?&#39;, &#39;fake (modern) ?&#39;, &#39;Astronomical&#39;,
       &#39;Literary; Administrative&#39;, &#39;Scientific ?&#39;,
       &#39;Royal/Monumental; Literary&#39;, &#39;Historical&#39;, &#39;Legal\x0b&#39;,
       &#39;Private/Votive ?&#39;, &#39;School; Literary&#39;, &#39;literary&#39;, &#39;Omen ?&#39;,
       &#39;Prayer/Incantation ?&#39;, &#39;letter&#39;, &#39;lexical&#39;, &#39;Astronomical ?&#39;,
       &#39;Astronomical, Omen&#39;, &#39;Pottery (seal)&#39;, &#39;administrative&#39;, &#39;Votive&#39;,
       &#39;Legal?&#39;, &#39;Letter?&#39;, &#39;School?&#39;, &#39;Administrative?&#39;, &#39;scientific&#39;,
       &#39;legal&#39;, &#39;administative&#39;, &#39;school&#39;, &#39;Administrative &#39;, &#39;Medical&#39;,
       &#39;Omens&#39;, &#39;Administrative Record&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_count</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_genre</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_genre</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple genres</span>
<span class="n">no_match_indices_genre</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">])):</span>
  <span class="n">g</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># make sure the first letter is capitalized</span>
  <span class="n">g</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_g</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_g</span><span class="p">:</span>
    <span class="n">P155_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="n">first_g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_g</span>

  <span class="c1"># account for typos</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administative&#39;</span> <span class="ow">or</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administrative record&#39;</span><span class="p">:</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="s1">&#39;Administrative&#39;</span>

  <span class="c1"># if the genre has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the genre</span>
    <span class="n">genre</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_g</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_g</span><span class="p">)</span>
    <span class="n">genre_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">genre_count</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;current_count&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">genre</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_count</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_genre</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;genre_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_qid</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;genre_current_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_count</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;P155_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_genre</span>
<span class="n">genre_df</span><span class="p">[</span><span class="s1">&#39;other_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_genre</span>

<span class="n">genre_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e6860044-e81f-4b3f-9344-aedd5c80b967" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e6860044-e81f-4b3f-9344-aedd5c80b967')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e6860044-e81f-4b3f-9344-aedd5c80b967 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e6860044-e81f-4b3f-9344-aedd5c80b967');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a49d0f92-0fa2-4c03-a5e2-150257323a88">
  <button class="colab-df-quickchart" onclick="quickchart('df-a49d0f92-0fa2-4c03-a5e2-150257323a88')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a49d0f92-0fa2-4c03-a5e2-150257323a88 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-genre-df">
<h4>6.2.2 matched_genre_df<a class="headerlink" href="#matched-genre-df" title="Link to this heading">#</a></h4>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">matched_genre_df</span></code>, for all matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="o">~</span><span class="n">genre_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_genre</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_genre_df</span> <span class="o">=</span> <span class="n">matched_genre_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_genre_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-28ea7a07-950e-4ffc-9758-08defc06a089" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdli_dump_id</th>
      <th>cdli_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>285670</th>
      <td>P532443</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285671</th>
      <td>P532444</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285672</th>
      <td>P532445</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285673</th>
      <td>P532446</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>285674</th>
      <td>P532447</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>285675 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-28ea7a07-950e-4ffc-9758-08defc06a089')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-28ea7a07-950e-4ffc-9758-08defc06a089 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-28ea7a07-950e-4ffc-9758-08defc06a089');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1e08cc7e-29ef-417c-826a-9d7055d380d2">
  <button class="colab-df-quickchart" onclick="quickchart('df-1e08cc7e-29ef-417c-826a-9d7055d380d2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1e08cc7e-29ef-417c-826a-9d7055d380d2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(285675, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-genre-df">
<h4>6.2.3 no_match_genre_df<a class="headerlink" href="#no-match-genre-df" title="Link to this heading">#</a></h4>
<p>Make a separate data frame of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_match_genre_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre</span><span class="p">]</span>
<span class="n">no_match_genre_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-18f692cb-d7f5-4095-8205-f99c18a6929f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3943</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P004142</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>German Archaeological Institute, Berlin, Germa...</td>
      <td>HD: W 20938</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 20938</td>
      <td>Nc XV,1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>unclear if proto-cuneiform, other (in cartouch...</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8091</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P010072</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VA 10004</td>
      <td>Šuruppak (mod. Fara)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8092</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P010073</td>
      <td>Sumerian</td>
      <td>tablet</td>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VA 10005</td>
      <td>Šuruppak (mod. Fara)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11524</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P102634</td>
      <td>Sumerian</td>
      <td>bulla</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Oakland Museum of California, Oakland, Califor...</td>
      <td>OPM 28-225</td>
      <td>Puzriš-Dagan (mod. Drehem)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Amar-Suen.03.07.00</td>
      <td>Amar-Suen.03.07.00</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Bulla</td>
      <td>Ur III</td>
      <td>Puzriš-Dagan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>OPM 28-255</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AS03 - 07 - 00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38784.0</td>
    </tr>
    <tr>
      <th>11547</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P102657</td>
      <td>Sumerian</td>
      <td>tablet &amp; envelope</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>clay</td>
      <td>Hearst Museum of Anthropology, University of C...</td>
      <td>HMA 9-00069a &amp; HMA 9-00069b</td>
      <td>Nippur (mod. Nuffar)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Šū-Suen.08.05.13</td>
      <td>Šū-Suen.08.05.13</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>Envelope - Closed</td>
      <td>Ur III</td>
      <td>Nippur</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>uncertain</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>HMA 9-69AB</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SS08 - 05 - 13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38807.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-18f692cb-d7f5-4095-8205-f99c18a6929f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-18f692cb-d7f5-4095-8205-f99c18a6929f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-18f692cb-d7f5-4095-8205-f99c18a6929f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fdff427c-74a1-47a6-a8d8-19928f2a9291">
  <button class="colab-df-quickchart" onclick="quickchart('df-fdff427c-74a1-47a6-a8d8-19928f2a9291')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fdff427c-74a1-47a6-a8d8-19928f2a9291 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(81241, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_genre_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h4>6.2.4 Visualization<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<section id="distribution-of-matched-genre">
<h5>Distribution of matched genre<a class="headerlink" href="#distribution-of-matched-genre" title="Link to this heading">#</a></h5>
<p>Please note that we are calling it “genre” instead of “first genre” here because, unlike most other columns in this dump of data, there is no multi-entry of genre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_g_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_genre_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_g_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_g_df</span> <span class="o">=</span> <span class="n">first_g_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span>
               <span class="s1">&#39;genre&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_g_df</span> <span class="o">=</span> <span class="n">first_g_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_g_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-3cf59804-1145-4c9d-b01a-ca1c7fa7fec2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>199275</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Royal/monumental</td>
      <td>22315</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Legal</td>
      <td>16757</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Letter</td>
      <td>15983</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Literary</td>
      <td>9816</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lexical</td>
      <td>8597</td>
    </tr>
    <tr>
      <th>6</th>
      <td>School</td>
      <td>3966</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Omen</td>
      <td>3043</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Mathematical</td>
      <td>1983</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Astronomical</td>
      <td>1631</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Prayer/incantation</td>
      <td>973</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Scientific</td>
      <td>766</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Ritual</td>
      <td>432</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>55</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Private/votive</td>
      <td>55</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Royal/votive</td>
      <td>14</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Votive</td>
      <td>11</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Pottery (seal)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Medical</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Omens</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3cf59804-1145-4c9d-b01a-ca1c7fa7fec2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3cf59804-1145-4c9d-b01a-ca1c7fa7fec2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3cf59804-1145-4c9d-b01a-ca1c7fa7fec2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-798e16b9-fe55-4bbd-af2a-df17d17d8d72">
  <button class="colab-df-quickchart" onclick="quickchart('df-798e16b9-fe55-4bbd-af2a-df17d17d8d72')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-798e16b9-fe55-4bbd-af2a-df17d17d8d72 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_g_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">220000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genre that Matched FactGrid Records, CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4782b17fc7a6104ad55f523b61ded9db94734b2453a1594d07f1c152a23790fc.png" src="_images/4782b17fc7a6104ad55f523b61ded9db94734b2453a1594d07f1c152a23790fc.png" />
</div>
</div>
</section>
<section id="distribution-of-matched-genre-for-tablets-that-have-text-on-them">
<h5>Distribution of matched genre for tablets that have text on them<a class="headerlink" href="#distribution-of-matched-genre-for-tablets-that-have-text-on-them" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lang_genre_matched_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="n">lang_genre_matched_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-77f8f3b0-8416-4cb1-b3c9-6e18995391c7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>353278</th>
      <td>P532443</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353279</th>
      <td>P532444</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353280</th>
      <td>P532445</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353281</th>
      <td>P532446</td>
      <td>Legal</td>
      <td>Legal</td>
      <td>Q388465</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>353282</th>
      <td>P532447</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>253980 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-77f8f3b0-8416-4cb1-b3c9-6e18995391c7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-77f8f3b0-8416-4cb1-b3c9-6e18995391c7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-77f8f3b0-8416-4cb1-b3c9-6e18995391c7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-99803a3e-a17f-4db4-84dc-42b3c2ad153f">
  <button class="colab-df-quickchart" onclick="quickchart('df-99803a3e-a17f-4db4-84dc-42b3c2ad153f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-99803a3e-a17f-4db4-84dc-42b3c2ad153f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># slice the matched_mat_df with no_match_indices_lang</span>
<span class="n">lang_genre_matched_df</span> <span class="o">=</span> <span class="n">genre_df</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang</span><span class="p">)]</span>
<span class="c1"># count the materials and create a df for the material with corresponding count</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lang_genre_matched_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="c1"># rename the columns</span>
<span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># sort the rows by count</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># drop the empty one</span>
<span class="n">lang_genre_matched_counts</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a2696626-79eb-4b10-9025-663a5a4094d9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>161871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Royal/monumental</td>
      <td>18989</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Letter</td>
      <td>13848</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>9520</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Literary</td>
      <td>7721</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lexical</td>
      <td>4171</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Omen</td>
      <td>2743</td>
    </tr>
    <tr>
      <th>7</th>
      <td>School</td>
      <td>1130</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Prayer/incantation</td>
      <td>793</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ritual</td>
      <td>302</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Scientific</td>
      <td>242</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mathematical</td>
      <td>126</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Astronomical</td>
      <td>62</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>54</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Private/votive</td>
      <td>36</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Royal/votive</td>
      <td>13</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Votive</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Medical</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Omens</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a2696626-79eb-4b10-9025-663a5a4094d9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a2696626-79eb-4b10-9025-663a5a4094d9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a2696626-79eb-4b10-9025-663a5a4094d9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-83592068-395a-4592-b716-880900bc78a9">
  <button class="colab-df-quickchart" onclick="quickchart('df-83592068-395a-4592-b716-880900bc78a9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-83592068-395a-4592-b716-880900bc78a9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genres that Have Languages on the Tablet, CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5c0150fb971fc92601bfa0b39a0e33aeefe7031b942fb3a363831d483de579e4.png" src="_images/5c0150fb971fc92601bfa0b39a0e33aeefe7031b942fb3a363831d483de579e4.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-genre">
<h5>Distribution of unmatched genre<a class="headerlink" href="#distribution-of-unmatched-genre" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">)[</span><span class="s1">&#39;cdli_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cdli_dump_genre
Other (see subgenre)      39
Uncertain                 10
fake (modern)            230
fake (modern) ?           16
uncertain               2793
Name: cdli_dump_genre, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>we can see that the matching of genre is actually done really well.</p>
</section>
</section>
</section>
<section id="oracc-genres">
<h3>6.3 ORACC Genres<a class="headerlink" href="#oracc-genres" title="Link to this heading">#</a></h3>
<section id="match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id">
<h4>6.3.1 Match on the oracc label ‘genre’ to obtain the FactGrid Q-id.<a class="headerlink" href="#match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_y&#39;</span><span class="p">]]</span>
<span class="n">genre_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;genre_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">})</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Lexical&#39;, nan, &#39;mathematical&#39;, &#39;Administrative&#39;,
       &#39;Royal Inscription&#39;, &#39;Literary&#39;, &#39;Legal&#39;, &#39;School&#39;, &#39;Letter&#39;,
       &#39;uncertain&#39;, &#39;Royal/Monumental&#39;, &#39;lexical&#39;, &#39;fake (modern)&#39;,
       &#39;Mathematical&#39;, &#39;Prayer/Incantation&#39;, &#39;Signlists&#39;, &#39;Scientific&#39;,
       &#39;Literary Work&#39;, &#39;Ritual&#39;, &#39;Liturgy&#39;, &#39;Royal lnscription&#39;,
       &#39;school&#39;, &#39;Administrative Letter&#39;, &#39;Legal Transaction&#39;,
       &#39;Administrative Record&#39;, &#39;Uncertain&#39;, &#39;Ritual Text&#39;,
       &#39;Lexical Text&#39;, &#39;Literary Text&#39;, &#39;Incantation&#39;,
       &#39;Literary; Mathematical&#39;, &#39;Astrological Report&#39;, &#39;Extispicy Query&#39;,
       &#39;Scholarly Letter&#39;, &#39;Priestly Letter&#39;, &#39;Extispicy Report&#39;,
       &#39;Treaty&#39;, &#39;Divination&#39;, &#39;Medical&#39;, &#39;Miscellanea&#39;, &#39;Omen&#39;,
       &#39;Lexical; Mathematical&#39;, &#39;Literary; Administrative&#39;,
       &#39;Divination (astrological)&#39;, &#39;letter&#39;, &#39;scholarly&#39;,
       &#39;administrative&#39;, &#39;Lexical; Literary&#39;, &#39;Royal Ritual&#39;,
       &#39;technical procedure&#39;, &#39;Eponym List&#39;, &#39;Votive Donation&#39;, &#39;Decree&#39;,
       &#39;Grant&#39;, &#39;Magic&#39;, &#39;Incantation-Ritual&#39;, &#39;Hymn-Prayer&#39;, &#39;Scholarly&#39;,
       &#39;Prophecy&#39;, &#39;Gift&#39;, &#39;Appointment&#39;, &#39;literary work&#39;, &#39;Blessings&#39;,
       &#39;School Text&#39;, &#39;Historical&#39;, &#39;Eponym Chronicle&#39;, &#39;Hemerological&#39;,
       &#39;Astronomical&#39;, &#39;unknown&#39;, &#39;Astrological&#39;, &#39;Lexical (signlist)&#39;,
       &#39;School; Literary&#39;, &#39;Metrological&#39;, &#39;plan&#39;, &#39;Lexical; School&#39;,
       &#39;Prayer&#39;, &#39;Historical Text&#39;, &#39;Miscellanea (literary, divination)&#39;,
       &#39;Miscellanea (astrological or literary)&#39;,
       &#39;Miscellanea (ritual/qualifications of the diviner)&#39;, &#39;Other&#39;,
       &#39;healing&#39;, &#39;Astronomical Diary&#39;, &#39;Goal-year text&#39;, &#39;lunar text&#39;,
       &#39;planetary text&#39;, &#39;Building Inscription&#39;, &#39;Prayer-Incantation&#39;,
       &#39;incantation-Ritual&#39;, &#39;Divine Seal&#39;, &#39;Lexical (Ura)&#39;, &#39;Contract&#39;,
       &#39;Royal stone inscription&#39;, &#39;Lexical (ED Plants)&#39;, &#39;School (Ura)&#39;,
       &#39;Lexical (OB Aa)&#39;, &#39;School (OB Ura)&#39;, &#39;School (OB Lu)&#39;,
       &#39;School (SAa)&#39;, &#39;School (List of Names)&#39;, &#39;Lexical (God List)&#39;,
       &#39;extispicy query&#39;, &#39;Royal Seal&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">genre_count2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_genre2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_genre2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple genres</span>
<span class="n">no_match_indices_genre2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">])):</span>
  <span class="n">g</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># make sure the first letter is capitalized</span>
  <span class="n">g</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first collection</span>
  <span class="n">first_g</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining ecollections (if exist) away</span>
  <span class="n">other_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_g</span><span class="p">:</span>
    <span class="n">P155_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="n">first_g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and labels for the first_g</span>

  <span class="c1"># account for typos</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administative&#39;</span> <span class="ow">or</span> <span class="n">first_g</span> <span class="o">==</span> <span class="s1">&#39;Administrative record&#39;</span><span class="p">:</span>
    <span class="n">first_g</span> <span class="o">=</span> <span class="s1">&#39;Administrative&#39;</span>

  <span class="c1"># if the genre has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_g</span> <span class="ow">in</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the genre</span>
    <span class="n">genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_g</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_g</span><span class="p">)</span>
    <span class="n">genre_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">genre_count2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">genre_reference</span><span class="p">[</span><span class="s1">&#39;current_count&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">genre_count2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_genre2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;genre_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_qid2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;genre_current_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genre_count2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;P155_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_genre2</span>
<span class="n">genre_df2</span><span class="p">[</span><span class="s1">&#39;other_genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_genre2</span>

<span class="n">genre_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-65e8715f-4e35-41da-8a48-b4a3e523b02f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-65e8715f-4e35-41da-8a48-b4a3e523b02f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-65e8715f-4e35-41da-8a48-b4a3e523b02f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-65e8715f-4e35-41da-8a48-b4a3e523b02f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-83c25bdd-89f5-4243-a144-ec2c082321e6">
  <button class="colab-df-quickchart" onclick="quickchart('df-83c25bdd-89f5-4243-a144-ec2c082321e6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-83c25bdd-89f5-4243-a144-ec2c082321e6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="matched-genre-df2">
<h4>6.3.2 matched_genre_df2<a class="headerlink" href="#matched-genre-df2" title="Link to this heading">#</a></h4>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">matched_genre_df2</span></code>, for all matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="o">~</span><span class="n">genre_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_genre2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_genre_df2</span> <span class="o">=</span> <span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_genre_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-962595ff-acc1-4f39-9981-6bb94a6acd29" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>oracc_dump_id</th>
      <th>oracc_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>112655</th>
      <td>P512808</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112656</th>
      <td>P512821</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112657</th>
      <td>P512822</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112658</th>
      <td>P515099</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>112659</th>
      <td>P521777</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>112660 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-962595ff-acc1-4f39-9981-6bb94a6acd29')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-962595ff-acc1-4f39-9981-6bb94a6acd29 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-962595ff-acc1-4f39-9981-6bb94a6acd29');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7d281222-89fa-4ec2-9996-e08808585b0e">
  <button class="colab-df-quickchart" onclick="quickchart('df-7d281222-89fa-4ec2-9996-e08808585b0e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7d281222-89fa-4ec2-9996-e08808585b0e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(112660, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h4>6.3.3 no_match_genre_df<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<p>Make a separate data frame of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_match_genre_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre2</span><span class="p">]</span>
<span class="n">no_match_genre_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-08628f35-44de-4cde-9aa6-46afded0604d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>669</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000730</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15316</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,1</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>670</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000731</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15315</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 01872,2</td>
      <td>Od XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>671</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000732</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15345</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02134</td>
      <td>?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>672</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000733</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15289</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 02352</td>
      <td>Oc XV,5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>673</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000734</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15245</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 05233,a</td>
      <td>Pd XVI,4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-08628f35-44de-4cde-9aa6-46afded0604d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-08628f35-44de-4cde-9aa6-46afded0604d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-08628f35-44de-4cde-9aa6-46afded0604d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bce3de20-1bf1-49c4-99a1-9bf3b77b85ea">
  <button class="colab-df-quickchart" onclick="quickchart('df-bce3de20-1bf1-49c4-99a1-9bf3b77b85ea')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bce3de20-1bf1-49c4-99a1-9bf3b77b85ea button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_genre_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(254256, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_genre_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h4>6.3.4 Visualization<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<section id="id10">
<h5>Distribution of matched genre<a class="headerlink" href="#id10" title="Link to this heading">#</a></h5>
<p>Please note that we are calling it “genre” instead of “first genre” here because, unlike most other columns in this dump of data, there is no multi-entry of genre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_g_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_genre_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">first_g_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">first_g_df2</span> <span class="o">=</span> <span class="n">first_g_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span>
               <span class="s1">&#39;genre&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">first_g_df2</span> <span class="o">=</span> <span class="n">first_g_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">first_g_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fbdf2a2c-44a9-46f2-aeef-54f840730038" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>91116</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lexical</td>
      <td>7583</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Literary</td>
      <td>6107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>2640</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mathematical</td>
      <td>1193</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Letter</td>
      <td>1187</td>
    </tr>
    <tr>
      <th>6</th>
      <td>School</td>
      <td>870</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Prayer/incantation</td>
      <td>846</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Omen</td>
      <td>554</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Medical</td>
      <td>265</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Astronomical</td>
      <td>175</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Ritual</td>
      <td>95</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Royal/monumental</td>
      <td>13</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Scientific</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Prayer</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Incantation</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fbdf2a2c-44a9-46f2-aeef-54f840730038')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fbdf2a2c-44a9-46f2-aeef-54f840730038 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fbdf2a2c-44a9-46f2-aeef-54f840730038');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b1c4de38-5bbc-4cc7-87ae-2580c7e70ab2">
  <button class="colab-df-quickchart" onclick="quickchart('df-b1c4de38-5bbc-4cc7-87ae-2580c7e70ab2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b1c4de38-5bbc-4cc7-87ae-2580c7e70ab2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">first_g_df2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genre that Matched FactGrid Records, ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de3e35de41cc664a96e523d32d50a33ae1f609b794110810924cbf3a4ed1c308.png" src="_images/de3e35de41cc664a96e523d32d50a33ae1f609b794110810924cbf3a4ed1c308.png" />
</div>
</div>
</section>
<section id="id11">
<h5>Distribution of matched genre for tablets that have text on them<a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lang_genre_matched_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang2</span><span class="p">)]</span>
<span class="n">lang_genre_matched_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1b69d687-b073-4316-ac67-956a60eb20f1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_genre</th>
      <th>genre</th>
      <th>genre_qid</th>
      <th>genre_current_count</th>
      <th>P155_genre</th>
      <th>other_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>662</th>
      <td>P000723</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>663</th>
      <td>P000724</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>664</th>
      <td>P000725</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>665</th>
      <td>P000726</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>666</th>
      <td>P000727</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>8273</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366883</th>
      <td>P512808</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366884</th>
      <td>P512821</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366885</th>
      <td>P512822</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366886</th>
      <td>P515099</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366887</th>
      <td>P521777</td>
      <td>Administrative</td>
      <td>Administrative</td>
      <td>Q394396</td>
      <td>10k+</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>133460 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1b69d687-b073-4316-ac67-956a60eb20f1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1b69d687-b073-4316-ac67-956a60eb20f1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1b69d687-b073-4316-ac67-956a60eb20f1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3a8af6e5-18f7-46a4-873e-4311d78b4bef">
  <button class="colab-df-quickchart" onclick="quickchart('df-3a8af6e5-18f7-46a4-873e-4311d78b4bef')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3a8af6e5-18f7-46a4-873e-4311d78b4bef button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># slice the matched_mat_df with no_match_indices_lang</span>
<span class="n">lang_genre_matched_df2</span> <span class="o">=</span> <span class="n">genre_df2</span><span class="p">[</span><span class="o">~</span><span class="n">language_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_lang2</span><span class="p">)]</span>
<span class="c1"># count the materials and create a df for the material with corresponding count</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lang_genre_matched_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="c1"># rename the columns</span>
<span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># sort the rows by count</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># drop the empty one</span>
<span class="n">lang_genre_matched_counts2</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">lang_genre_matched_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-68ecaf7c-87ba-4a17-9d53-f6dcf5bde8c6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Administrative</td>
      <td>90783</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Literary</td>
      <td>5751</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lexical</td>
      <td>3495</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Legal</td>
      <td>2553</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Prayer/incantation</td>
      <td>844</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Letter</td>
      <td>838</td>
    </tr>
    <tr>
      <th>6</th>
      <td>School</td>
      <td>268</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Omen</td>
      <td>173</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Astronomical</td>
      <td>140</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ritual</td>
      <td>91</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Medical</td>
      <td>86</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mathematical</td>
      <td>23</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Royal/monumental</td>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Historical</td>
      <td>6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Scientific</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Prayer</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Incantation</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-68ecaf7c-87ba-4a17-9d53-f6dcf5bde8c6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-68ecaf7c-87ba-4a17-9d53-f6dcf5bde8c6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-68ecaf7c-87ba-4a17-9d53-f6dcf5bde8c6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bc9c0d57-81ad-42bb-921c-a36432edeade">
  <button class="colab-df-quickchart" onclick="quickchart('df-bc9c0d57-81ad-42bb-921c-a36432edeade')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bc9c0d57-81ad-42bb-921c-a36432edeade button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">lang_genre_matched_counts2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Genre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Tablet Genres that Have Languages on the Tablet, ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2c927ce96e14b90633adcb89d0590097cbf19ec5cf235e34b64b6f3e963962aa.png" src="_images/2c927ce96e14b90633adcb89d0590097cbf19ec5cf235e34b64b6f3e963962aa.png" />
</div>
</div>
</section>
<section id="id12">
<h5>Distribution of unmatched genre<a class="headerlink" href="#id12" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genre_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_genre2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">)[</span><span class="s1">&#39;oracc_dump_genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oracc_dump_genre
Administrative Letter    2099
Appointment                 4
Astrological               20
Astrological Report       567
Astronomical Diary        417
                         ... 
planetary text             55
scholarly                  34
technical procedure         1
uncertain                  64
unknown                   135
Name: oracc_dump_genre, Length: 73, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>we can see that the matching of genre is actually done really well.</p>
</section>
</section>
</section>
<section id="merging-genre-dfs-of-cdli-and-oracc">
<h3>Merging genre dfs of CDLI and ORACC<a class="headerlink" href="#merging-genre-dfs-of-cdli-and-oracc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genres_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">genre_df</span><span class="p">,</span> <span class="n">genre_df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_genres_df</span> <span class="o">=</span> <span class="n">genres_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;genre_x&#39;</span><span class="p">,</span> <span class="s1">&#39;genre_y&#39;</span><span class="p">,</span><span class="s1">&#39;genre_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;genre_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;genre_current_count_x&#39;</span><span class="p">,</span><span class="s1">&#39;genre_current_count_y&#39;</span><span class="p">,</span><span class="s1">&#39;P155_genre_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_genre_y&#39;</span><span class="p">,</span><span class="s1">&#39;other_genre_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_genre_y&#39;</span><span class="p">]]</span>
<span class="n">final_genres_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-63c1ec3c-cf44-428f-ac85-2cbc7dde417a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>genre_qid_x</th>
      <th>genre_qid_y</th>
      <th>genre_current_count_x</th>
      <th>genre_current_count_y</th>
      <th>P155_genre_x</th>
      <th>P155_genre_y</th>
      <th>other_genre_x</th>
      <th>other_genre_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-63c1ec3c-cf44-428f-ac85-2cbc7dde417a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-63c1ec3c-cf44-428f-ac85-2cbc7dde417a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-63c1ec3c-cf44-428f-ac85-2cbc7dde417a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c10e9592-e3df-44b4-be2a-1ecd11fe6d8a">
  <button class="colab-df-quickchart" onclick="quickchart('df-c10e9592-e3df-44b4-be2a-1ecd11fe6d8a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c10e9592-e3df-44b4-be2a-1ecd11fe6d8a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_genres_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_genres_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="period-period-p853">
<h2>7 <strong>period = Period <a class="reference external" href="https://database.factgrid.de/wiki/Property:P853">(P853)</a></strong><a class="headerlink" href="#period-period-p853" title="Link to this heading">#</a></h2>
<section id="use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog">
<h3>7.1 Use this CSV to obtain the FactGrid Q-ids for each period of each texts in the CDLI catalog<a class="headerlink" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://drive.google.com/file/d/1GCYneZi-SVA49iRfVMP_mH-0LFLRpIaQ/view?usp=share_link">https://drive.google.com/file/d/1GCYneZi-SVA49iRfVMP_mH-0LFLRpIaQ/view?usp=share_link</a></p>
<ul class="simple">
<li><p>note that this CSV contains Wikidata Q-ids, along with the begin / end of the other chronologies (high, low, middle, etc.)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/ancient-world-citation-analysis/CDLI2LoD/blob/main/data/Period%20-%20LOD%20Tablet%20Dictionary%20(FG%20Cuneiform).csv?raw=true&#39;</span>

<span class="c1"># read in the data</span>
<span class="c1"># note that we fill.na with 99999999 here so that we can edit the data type of years later</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">period_url</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># select only the columns we want</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[[</span><span class="s1">&#39;Factgrid-Q&#39;</span><span class="p">,</span> <span class="s1">&#39;cdli_period&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Wikidata_URI&#39;</span><span class="p">]]</span>
<span class="c1"># clean the column names</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Factgrid-Q&#39;</span><span class="p">:</span> <span class="s1">&#39;FG_qid&#39;</span><span class="p">})</span>
<span class="c1"># drop the first row that is empty</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:]</span>
<span class="c1"># use only rows with a QID</span>
<span class="n">period_reference</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">period_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e459aa14-858e-4b7d-ba3e-20e70a96e6bb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FG_qid</th>
      <th>cdli_period</th>
      <th>Wikidata_URI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q512118</td>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>Q114877825</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q512131</td>
      <td>Uruk V (ca. 3500-3350 BC)</td>
      <td>Q114877817</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q512132</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q114877809</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q512133</td>
      <td>Egyptian 0 (ca. 3300-3000 BC)</td>
      <td>Q187979</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q512134</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q114877803</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Q512135</td>
      <td>Proto-Elamite (ca. 3100-2900 BC)</td>
      <td>Q1196237</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Q512136</td>
      <td>Early Dynastic Period</td>
      <td>Q716742</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Q512137</td>
      <td>ED I</td>
      <td>Q99299898</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Q512137</td>
      <td>ED I-II (ca. 2900-2700 BC)</td>
      <td>Q99299898</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Q512139</td>
      <td>ED II</td>
      <td>Q99299906</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Q512140</td>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>Q110209550</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Q512141</td>
      <td>Old Elamite (c. 2600–1500 BC)</td>
      <td>Q29297301</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Q512142</td>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>Q110209565</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Q512143</td>
      <td>Ebla (ca. 2350-2250 BC)</td>
      <td>Q114867907</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Q512144</td>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>Q419594</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Q512145</td>
      <td>Linear Elamite (ca. 2200 BC)</td>
      <td>Q114868885</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Q512146</td>
      <td>Lagash II (ca. 2200-2100 BC)</td>
      <td>Q114868851</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Q512147</td>
      <td>Harappan (ca. 2200-1900 BC)</td>
      <td>Q114866998</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Q512148</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>Q109384761</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Q512149</td>
      <td>Isin-Larsa period</td>
      <td>Q13577667</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Q512150</td>
      <td>Early Old Babylonian (ca. 2000-1900 BC)</td>
      <td>Q114867465</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Q512151</td>
      <td>Old Assyrian (ca. 1950-1850 BC)</td>
      <td>Q15782728</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Q512152</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q114877765</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Q512153</td>
      <td>Middle Hittite (ca. 1500-1100 BC)</td>
      <td>Q114869008</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Q512154</td>
      <td>Middle Babylonian (ca. 1400-1100 BC)</td>
      <td>Q16530848</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Q512155</td>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>Q114868919</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Q512156</td>
      <td>Middle Elamite (ca. 1300-1000 BC)</td>
      <td>Q29297151</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Q512157</td>
      <td>Early Neo-Babylonian (ca. 1150-730 BC)</td>
      <td>Q114867342</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Q512158</td>
      <td>Neo-Assyrian (ca. 911-612 BC)</td>
      <td>Q114869081</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Q512159</td>
      <td>Late Babylonian</td>
      <td>Q22809362</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Q512160</td>
      <td>Neo-Elamite (ca. 770-539 BC)</td>
      <td>Q29297050</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Q512161</td>
      <td>Neo-Babylonian (ca. 626-539 BC)</td>
      <td>Q114869307</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Q512162</td>
      <td>Persian</td>
      <td>Q115667399</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Q512163</td>
      <td>Achaemenid (547-331 BC)</td>
      <td>Q114867307</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Q512164</td>
      <td>Hellenistic (323-63 BC)</td>
      <td>Q428995</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Q512165</td>
      <td>Selucid</td>
      <td>Q115664693</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Q512169</td>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>Q114877775</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Q512171</td>
      <td>Roman</td>
      <td>Q2277</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Q512170</td>
      <td>Sassanian (224-641 AD)</td>
      <td>Q114877788</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e459aa14-858e-4b7d-ba3e-20e70a96e6bb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e459aa14-858e-4b7d-ba3e-20e70a96e6bb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e459aa14-858e-4b7d-ba3e-20e70a96e6bb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-da7bcfff-c10c-40e1-8670-3e6fa81a8174">
  <button class="colab-df-quickchart" onclick="quickchart('df-da7bcfff-c10c-40e1-8670-3e6fa81a8174')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-da7bcfff-c10c-40e1-8670-3e6fa81a8174 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="cdli-periods">
<h3>7.2 CDLI Periods<a class="headerlink" href="#cdli-periods" title="Link to this heading">#</a></h3>
<p>####7.2.1 Match on the CDLI ‘period’ label to obtain the FactGrid Q-id.</p>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">period_df</span></code>, for all matches.</p>
<ul class="simple">
<li><p>if there’s a question mark in the CDLI for period, you can use the same method as the <code class="docutils literal notranslate"><span class="pre">language_df</span></code> above, by adding the following column:</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>period</p></th>
<th class="head"><p><a class="reference external" href="https://database.factgrid.de/wiki/Property:P155">(P155)</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘id_text’ in cdli_cat.csv</p></td>
<td><p>‘period’ in cdli_cat.csv</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a></p></td>
</tr>
</tbody>
</table>
<p>Make a separate data from of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_period_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;period_x&#39;</span><span class="p">]]</span>
<span class="n">period_df</span> <span class="o">=</span> <span class="n">period_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;period_x&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">})</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Uruk III (ca. 3200-3000 BC)&#39;, &#39;Uruk IV (ca. 3350-3200 BC)&#39;,
       &#39;ED I-II (ca. 2900-2700 BC)&#39;, &#39;Uruk V (ca. 3500-3350 BC)&#39;,
       &#39;Uruk V (ca. 3500-3350 BC) ?&#39;, &#39;ED IIIa (ca. 2600-2500 BC)&#39;,
       &#39;Proto-Elamite (ca. 3100-2900 BC)&#39;, &#39;uncertain&#39;,
       &#39;Pre-Uruk V (ca. 8500-3500 BC)&#39;,
       &#39;Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;ED I-II (ca. 2900-2700 BC) ?&#39;, &#39;ED IIIb (ca. 2500-2340 BC)&#39;,
       &#39;Ur III (ca. 2100-2000 BC)&#39;, &#39;Old Akkadian (ca. 2340-2200 BC)&#39;,
       &#39;Lagash II (ca. 2200-2100 BC)&#39;, &#39;Lagash II (ca. 2200-2100 BC) ?&#39;,
       &#39;Old Babylonian (ca. 1900-1600 BC) ?&#39;,
       &#39;Ur III (ca. 2100-2000 BC) ?&#39;,
       &#39;Early Old Babylonian (ca. 2000-1900 BC)&#39;,
       &#39;Old Akkadian (ca. 2340-2200 BC) ?&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC)&#39;,
       &#39;Early Old Babylonian (ca. 2000-1900 BC) ?&#39;,
       &#39;Old Assyrian (ca. 1950-1850 BC)&#39;, &#39;Achaemenid (547-331 BC)&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC) ?&#39;, &#39;Neo-Assyrian (ca. 911-612 BC)&#39;,
       &#39;Old Akkadian (ca. 2340-2200 BC); Middle Elamite (ca. 1300-1000 BC)&#39;,
       &#39;Middle Babylonian (ca. 1400-1100 BC) ?&#39;,
       &#39;Middle Babylonian (ca. 1400-1100 BC)&#39;,
       &#39;Old Akkadian (ca. 2340-2200 BC); Ur III (ca. 2100-2000 BC)&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC); Old Akkadian (ca. 2340-2200 BC)&#39;,
       &#39;ED IIIa (ca. 2600-2500 BC) ?&#39;, &#39;Ebla (ca. 2350-2250 BC)&#39;, nan,
       &#39;Neo-Assyrian (ca. 911-612 BC) ?&#39;,
       &#39;Early Neo-Babylonian (ca. 1150-730 BC)&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC) ?&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC); Ur III (ca. 2100-2000 BC)&#39;,
       &#39;Middle Assyrian (ca. 1400-1000 BC)&#39;, &#39;fake (modern) ?&#39;,
       &#39;Uruk III (ca. 3200-3000 BC) ?&#39;, &#39;Uruk IV (ca. 3350-3200 BC) ?&#39;,
       &#39;Neo-Babylonian (626-539 BC)&#39;, &#39;Hellenistic (323-63 BC)&#39;,
       &#39;Hellenistic (323-63 BC) ?&#39;, &#39;Linear Elamite (ca. 2200 BC)&#39;,
       &#39;Linear Elamite (ca. 2200 BC) ?&#39;,
       &#39;Middle Elamite (ca. 1300-1000 BC)&#39;,
       &#39;Neo-Elamite (ca. 770-539 BC)&#39;,
       &#39;Old Assyrian (ca. 1950-1850 BC) ?&#39;, &#39;Sassanian (224-641 AD)&#39;,
       &#39;Parthian (247 BC-224 AD)&#39;, &#39;Achaemenid (547-331 BC) ?&#39;,
       &#39;Middle Hittite (ca. 1500-1100 BC)&#39;, &#39;fake (modern)&#39;,
       &#39;Middle Assyrian (ca. 1400-1000 BC) ?&#39;, &#39;Achaemenid (547–331 BC)&#39;,
       &#39;Harappan (ca. 2200-1900 BC)&#39;, &#39;Parthian (247 BC - 224 AD)&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC) ? &#39;, &#39;fake (ancient) ?&#39;,
       &#39;Egyptian 0 (ca. 3300-3000 BC)&#39;,
       &#39;Ur III (ca. 2100-2000 BC); Early Old Babylonian (ca. 2000-1900 BC)&#39;,
       &#39;Middle Elamite (ca. 1300-1000 BC) ?&#39;, &#39;copy (modern)&#39;,
       &#39;Old Elamite (ca. 2700-1500 BC)&#39;,
       &#39;ED I-II (ca. 2900-2700 BC), Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;ED IIIa (ca. 2600-2500 BC); Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Ebla (ca. 2350-2250 BC) ?&#39;, &#39;Harappan (ca. 2200-1900 BC) ?&#39;,
       &#39;ED IIIb (ca. 2500-2340 BC) or Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Achaemenid?&#39;, &#39;Old Babylonian&#39;,
       &#39;Early Old Babylonian (ca. 1900-1600 BC)&#39;, &#39;modern? &#39;, &#39;modern?&#39;,
       &#39;modern&#39;, &#39;Early Dynastic IIIA (c. 2700-2500 BC)&#39;,
       &#39;Middle Assyrian (ca. 1400-1000 BC) &#39;,
       &#39;Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)&#39;,
       &#39;1200-700 BC&#39;, &#39;Middle Babylonian (ca. 1400-1100 BC))&#39;,
       &#39;Ur III (ca. 2100-2000 BC)?&#39;, &#39;Neo-Babylonian (ca. 626-539 BC).&#39;,
       &#39;Neo-Babylonian (ca. 626-539 BC) or Achaemenid (547–331 BC)&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Typically, we need to clean this first, but the period data looks pretty neat after manual inspection so we will skip for now. We dealt with some special cases according to this csv file: <a class="reference external" href="https://docs.google.com/spreadsheets/d/1ttueqlFrtNE4eaZDdDq80Ksc4Wg8pwxXeS8eCiiHjmQ/edit#gid=714968975">link</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_qid</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_wikidata_URI</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_period</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_possible_period</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple estimations of period</span>
<span class="n">no_match_indices_period</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">])):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first estimated period</span>
  <span class="n">first_p</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining estimations (if exist) away</span>
  <span class="n">other_possible_period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">P155_period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="n">first_p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and label for the first_p</span>

  <span class="c1"># deal with some typo first</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (626-539 BC)&#39;</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC).&#39;</span><span class="p">):</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Achaemenid (547–331 BC)&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Achaemenid (547-331 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Old Babylonian&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Old Babylonian (ca. 1900-1600 BC)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Parthian&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Parthian (247 BC - 224 AD)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Pre-Uruk V&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Pre-Writing (ca. 8500-3500 BC)&#39;</span>
    <span class="n">other_possible_period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Uruk V (ca. 3500-3350 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Uruk IV (ca. 3350-3200 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Early Dynastic Period of Egypt&#39;</span><span class="p">]</span>

  <span class="c1"># if the period has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_p</span> <span class="ow">in</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">period</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_p</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_p</span><span class="p">)</span>
    <span class="n">period_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">period_wikidata_URI</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;Wikidata_URI&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">period</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_qid</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_wikidata_URI</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_period</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;period_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_qid</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;period_wikidata_URI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_wikidata_URI</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;P155_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_period</span>
<span class="n">period_df</span><span class="p">[</span><span class="s1">&#39;other_possible_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_possible_period</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">period_df</span> <span class="o">=</span> <span class="n">period_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">})</span>

<span class="n">period_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1617f27d-5d9c-4965-84a3-7d1cf86d448b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>NaN</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1617f27d-5d9c-4965-84a3-7d1cf86d448b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1617f27d-5d9c-4965-84a3-7d1cf86d448b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1617f27d-5d9c-4965-84a3-7d1cf86d448b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f8dc39be-4ff7-4f5e-9cf3-ab42fd7dbef1">
  <button class="colab-df-quickchart" onclick="quickchart('df-f8dc39be-4ff7-4f5e-9cf3-ab42fd7dbef1')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f8dc39be-4ff7-4f5e-9cf3-ab42fd7dbef1 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="matched-period-df">
<h4>7.2.2 matched_period_df<a class="headerlink" href="#matched-period-df" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df</span> <span class="o">=</span> <span class="n">period_df</span><span class="p">[</span><span class="o">~</span><span class="n">period_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_period</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_df</span> <span class="o">=</span> <span class="n">matched_period_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;cdli_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_period_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5333d506-81fb-4884-9633-e5ef2da85b8d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdli_dump_id</th>
      <th>cdli_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>Q512134</td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>Q512132</td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>330118</th>
      <td>P532443</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330119</th>
      <td>P532444</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330120</th>
      <td>P532445</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330121</th>
      <td>P532446</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>330122</th>
      <td>P532447</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>Q512148</td>
      <td>Q109384761</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>330123 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5333d506-81fb-4884-9633-e5ef2da85b8d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5333d506-81fb-4884-9633-e5ef2da85b8d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5333d506-81fb-4884-9633-e5ef2da85b8d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e30b2362-3d0d-4598-a0d4-12329cd41d96">
  <button class="colab-df-quickchart" onclick="quickchart('df-e30b2362-3d0d-4598-a0d4-12329cd41d96')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e30b2362-3d0d-4598-a0d4-12329cd41d96 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(330123, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-match-period-df">
<h4>7.2.3 no_match_period_df<a class="headerlink" href="#no-match-period-df" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period</span><span class="p">]</span>
<span class="n">no_match_period_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4ea08b55-aa0d-47d1-9ee5-c439f342c46f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6917</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P009167</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>National Museum, Tehran, Iran</td>
      <td>NMI BK 03533</td>
      <td>Susa (mod. Shush)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7182</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P009446</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>unlocated</td>
      <td>unknown</td>
      <td>uncertain (mod. Hissar)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>68793</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P217673</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A05443</td>
      <td>Uruk (mod. Warka) ?</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mathematical</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Old Akkadian</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>mathematical</td>
      <td>word-problem</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A 05443</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>68794</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P217674</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>uncertain</td>
      <td>clay</td>
      <td>Oriental Institute, University of Chicago, Chi...</td>
      <td>OIM A05446</td>
      <td>uncertain (mod. uncertain)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mathematical</td>
      <td>NaN</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Old Akkadian</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>mathematical</td>
      <td>word-problem</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A 05446</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>70955</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P222233</td>
      <td>Sumerian</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>stone</td>
      <td>Arkeoloji Müzeleri, Istanbul, Turkey</td>
      <td>Ist —</td>
      <td>Girsu (mod. Tello)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical seal</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>Sumerian</td>
      <td>NaN</td>
      <td>seal (not impression)</td>
      <td>NaN</td>
      <td>Girsu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative</td>
      <td>physical seal</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Ist —</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ELA</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>babcity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4ea08b55-aa0d-47d1-9ee5-c439f342c46f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4ea08b55-aa0d-47d1-9ee5-c439f342c46f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4ea08b55-aa0d-47d1-9ee5-c439f342c46f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-95403579-aecf-43a5-a874-623fd1862437">
  <button class="colab-df-quickchart" onclick="quickchart('df-95403579-aecf-43a5-a874-623fd1862437')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-95403579-aecf-43a5-a874-623fd1862437 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(36793, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_period_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h4>Visualization<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<section id="distribution-of-matched-periods">
<h5>Distribution of matched periods<a class="headerlink" href="#distribution-of-matched-periods" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_period_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">matched_period_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">matched_period_counts</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span>
               <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-206e4a31-3642-46af-aa31-7700757835a2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>111285</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>66833</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Neo-Assyrian (ca. 911-612 BC)</td>
      <td>35661</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Neo-Babylonian (ca. 626-539 BC)</td>
      <td>17775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Middle Hittite (ca. 1500-1100 BC)</td>
      <td>14692</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Middle Babylonian (ca. 1400-1100 BC)</td>
      <td>12915</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>10200</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Early Old Babylonian (ca. 2000-1900 BC)</td>
      <td>8630</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ebla (ca. 2350-2250 BC)</td>
      <td>7112</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Old Assyrian (ca. 1950-1850 BC)</td>
      <td>6620</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Achaemenid (547-331 BC)</td>
      <td>6013</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>5090</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>4957</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Lagash II (ca. 2200-2100 BC)</td>
      <td>4664</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>4572</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Hellenistic (323-63 BC)</td>
      <td>3359</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>1900</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>1861</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Proto-Elamite (ca. 3100-2900 BC)</td>
      <td>1729</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ED I-II (ca. 2900-2700 BC)</td>
      <td>1201</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Neo-Elamite (ca. 770-539 BC)</td>
      <td>1033</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Middle Elamite (ca. 1300-1000 BC)</td>
      <td>841</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Uruk V (ca. 3500-3350 BC)</td>
      <td>418</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Early Neo-Babylonian (ca. 1150-730 BC)</td>
      <td>231</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>219</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Egyptian 0 (ca. 3300-3000 BC)</td>
      <td>186</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sassanian (224-641 AD)</td>
      <td>61</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Linear Elamite (ca. 2200 BC)</td>
      <td>41</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>21</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Harappan (ca. 2200-1900 BC)</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-206e4a31-3642-46af-aa31-7700757835a2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-206e4a31-3642-46af-aa31-7700757835a2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-206e4a31-3642-46af-aa31-7700757835a2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f7f6dcfb-0bbe-440f-98d5-5216a50ada0b">
  <button class="colab-df-quickchart" onclick="quickchart('df-f7f6dcfb-0bbe-440f-98d5-5216a50ada0b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f7f6dcfb-0bbe-440f-98d5-5216a50ada0b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Periods that Matched FactGrid Records, CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5241c78f6133e89f49bc2aeb98ae0e0e224f029d25606da184ece0da4fd51dd6.png" src="_images/5241c78f6133e89f49bc2aeb98ae0e0e224f029d25606da184ece0da4fd51dd6.png" />
</div>
</div>
</section>
<section id="distribution-of-matched-tablets-over-time">
<h5>Distribution of matched tablets over time<a class="headerlink" href="#distribution-of-matched-tablets-over-time" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_year_of_period</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_period_counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_period</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">]</span>
  <span class="c1"># only take what&#39;s between ()</span>
  <span class="n">year_range</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;\(([^\)]+)\)&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">current_period</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># remove &#39;ca.&#39; and space to prepare for string manipulation</span>
  <span class="n">year_range</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ca. &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

  <span class="k">if</span> <span class="s1">&#39;BC&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;AD&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this range crosses AD and BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#i.e., this is a normal range within BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># since this is a BC year, make it negative</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">))</span>

  <span class="k">else</span><span class="p">:</span> <span class="c1">#&#39;AD&#39; only years</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;AD&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span>

  <span class="n">start_year_of_period</span> <span class="o">+=</span> <span class="p">[</span><span class="n">start_year</span><span class="p">]</span>

<span class="n">matched_period_counts</span><span class="p">[</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_year_of_period</span>
<span class="c1"># order the df by start_year_of_period</span>
<span class="n">matched_period_counts</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">matched_period_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1aa65d35-8f00-493a-9a5e-c5fe41ac02b8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
      <th>start_year_of_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>219</td>
      <td>-8500</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Uruk V (ca. 3500-3350 BC)</td>
      <td>418</td>
      <td>-3500</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>1861</td>
      <td>-3350</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Egyptian 0 (ca. 3300-3000 BC)</td>
      <td>186</td>
      <td>-3300</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>4957</td>
      <td>-3200</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Proto-Elamite (ca. 3100-2900 BC)</td>
      <td>1729</td>
      <td>-3100</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ED I-II (ca. 2900-2700 BC)</td>
      <td>1201</td>
      <td>-2900</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ED IIIa (ca. 2600-2500 BC)</td>
      <td>1900</td>
      <td>-2600</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ED IIIb (ca. 2500-2340 BC)</td>
      <td>5090</td>
      <td>-2500</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ebla (ca. 2350-2250 BC)</td>
      <td>7112</td>
      <td>-2350</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Old Akkadian (ca. 2340-2200 BC)</td>
      <td>10200</td>
      <td>-2340</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Harappan (ca. 2200-1900 BC)</td>
      <td>3</td>
      <td>-2200</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Linear Elamite (ca. 2200 BC)</td>
      <td>41</td>
      <td>-2200</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Lagash II (ca. 2200-2100 BC)</td>
      <td>4664</td>
      <td>-2200</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Ur III (ca. 2100-2000 BC)</td>
      <td>111285</td>
      <td>-2100</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Early Old Babylonian (ca. 2000-1900 BC)</td>
      <td>8630</td>
      <td>-2000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Old Assyrian (ca. 1950-1850 BC)</td>
      <td>6620</td>
      <td>-1950</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>66833</td>
      <td>-1900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Middle Hittite (ca. 1500-1100 BC)</td>
      <td>14692</td>
      <td>-1500</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Middle Babylonian (ca. 1400-1100 BC)</td>
      <td>12915</td>
      <td>-1400</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Middle Assyrian (ca. 1400-1000 BC)</td>
      <td>4572</td>
      <td>-1400</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Middle Elamite (ca. 1300-1000 BC)</td>
      <td>841</td>
      <td>-1300</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Early Neo-Babylonian (ca. 1150-730 BC)</td>
      <td>231</td>
      <td>-1150</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Neo-Assyrian (ca. 911-612 BC)</td>
      <td>35661</td>
      <td>-911</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Neo-Elamite (ca. 770-539 BC)</td>
      <td>1033</td>
      <td>-770</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Neo-Babylonian (ca. 626-539 BC)</td>
      <td>17775</td>
      <td>-626</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Achaemenid (547-331 BC)</td>
      <td>6013</td>
      <td>-547</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Hellenistic (323-63 BC)</td>
      <td>3359</td>
      <td>-323</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>21</td>
      <td>-247</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sassanian (224-641 AD)</td>
      <td>61</td>
      <td>224</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1aa65d35-8f00-493a-9a5e-c5fe41ac02b8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1aa65d35-8f00-493a-9a5e-c5fe41ac02b8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1aa65d35-8f00-493a-9a5e-c5fe41ac02b8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a56e343a-5898-476a-bdde-20259b3219cb">
  <button class="colab-df-quickchart" onclick="quickchart('df-a56e343a-5898-476a-bdde-20259b3219cb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a56e343a-5898-476a-bdde-20259b3219cb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Over Time (of Periods that Matched FactGrid Records, CDLI)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3fc0c9e15ca8f475c2c9d92aa1a9ec374affc69a0a329e8ffd3f6af896551945.png" src="_images/3fc0c9e15ca8f475c2c9d92aa1a9ec374affc69a0a329e8ffd3f6af896551945.png" />
</div>
</div>
</section>
<section id="distribution-of-unmatched-periods">
<h5>Distribution of Unmatched Periods<a class="headerlink" href="#distribution-of-unmatched-periods" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">)[</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cdli_dump_period
1200-700 BC                                                               1
Achaemenid?                                                               4
Early Dynastic IIIA (c. 2700-2500 BC)                                     1
Early Old Babylonian (ca. 1900-1600 BC)                                   1
Middle Babylonian (ca. 1400-1100 BC))                                     1
Old Elamite (ca. 2700-1500 BC)                                            1
Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)      1
copy (modern)                                                             1
fake (ancient) ?                                                          1
fake (modern)                                                           114
fake (modern) ?                                                          69
modern                                                                    5
modern?                                                                   2
modern?                                                                   1
uncertain                                                               847
Name: cdli_dump_period, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_periods</span> <span class="o">=</span> <span class="n">period_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period</span><span class="p">][</span><span class="s1">&#39;cdli_dump_period&#39;</span><span class="p">]</span>
<span class="n">unmatched_periods_clean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">unmatched_periods</span><span class="p">:</span>
  <span class="n">p</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="k">if</span> <span class="s1">&#39;modern&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">unmatched_periods_clean</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;modern&#39;</span><span class="p">]</span>

  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-period statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_periods_clean</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_periods_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_periods_clean</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_periods_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;uncertain&#39;, &#39;nan&#39;, &#39;modern&#39;, &#39;fake (ancient)&#39;,
       &#39;Old Elamite (ca. 2700-1500 BC)&#39;, &#39;Achaemenid&#39;,
       &#39;Early Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Early Dynastic IIIA (c. 2700-2500 BC)&#39;,
       &#39;Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)&#39;,
       &#39;1200-700 BC&#39;, &#39;Middle Babylonian (ca. 1400-1100 BC))&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_periods_clean</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_p_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">unmatched_p_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-94872c1c-d72d-4db8-a2d9-1834de9a4d5d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>35743</td>
    </tr>
    <tr>
      <th>1</th>
      <td>uncertain</td>
      <td>847</td>
    </tr>
    <tr>
      <th>2</th>
      <td>modern</td>
      <td>192</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Achaemenid</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fake (ancient)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Old Elamite (ca. 2700-1500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Early Old Babylonian (ca. 1900-1600 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Early Dynastic IIIA (c. 2700-2500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Uruk III (ca. 3200-3000 BC) - Early Dynastic I...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1200-700 BC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Middle Babylonian (ca. 1400-1100 BC))</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-94872c1c-d72d-4db8-a2d9-1834de9a4d5d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-94872c1c-d72d-4db8-a2d9-1834de9a4d5d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-94872c1c-d72d-4db8-a2d9-1834de9a4d5d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1cab1146-cdbf-495b-b063-75c3ae863fbe">
  <button class="colab-df-quickchart" onclick="quickchart('df-1cab1146-cdbf-495b-b063-75c3ae863fbe')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1cab1146-cdbf-495b-b063-75c3ae863fbe button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Periods of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones), CDLI&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/960fd2c9e4eaa5c1b6a96d5b0bccafd9c67b66080af32ae86e378cd8c13ddaa9.png" src="_images/960fd2c9e4eaa5c1b6a96d5b0bccafd9c67b66080af32ae86e378cd8c13ddaa9.png" />
</div>
</div>
</section>
</section>
</section>
<section id="oracc-periods">
<h3>7.3 ORACC Periods<a class="headerlink" href="#oracc-periods" title="Link to this heading">#</a></h3>
<p>####7.3.1 Match on the ORACC ‘period’ label to obtain the FactGrid Q-id.</p>
<p>Make a data frame, called <code class="docutils literal notranslate"><span class="pre">period_df</span></code>, for all matches.</p>
<ul class="simple">
<li><p>if there’s a question mark in the CDLI for period, you can use the same method as the <code class="docutils literal notranslate"><span class="pre">language_df</span></code> above, by adding the following column:</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>id_text</p></th>
<th class="head"><p>period</p></th>
<th class="head"><p><a class="reference external" href="https://database.factgrid.de/wiki/Property:P155">(P155)</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘id_text’ in cdli_cat.csv</p></td>
<td><p>‘period’ in cdli_cat.csv</p></td>
<td><p><a class="reference external" href="https://database.factgrid.de/wiki/Item:Q22757">Q22757</a></p></td>
</tr>
</tbody>
</table>
<p>Make a separate data from of the texts which were not matched: <code class="docutils literal notranslate"><span class="pre">no_period_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;period_y&#39;</span><span class="p">]]</span>
<span class="n">period_df2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;period_y&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">})</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Uruk III&#39;, &#39;Uruk IV&#39;, &#39;ED I-II&#39;, nan, &#39;Early Dynastic IIIa&#39;,
       &#39;Early Dynastic I-II&#39;, &#39;Early Dynastic&#39;, &#39;ED IIIa&#39;,
       &#39;Old Babylonian&#39;, &#39;Early Dynastic IIIb&#39;, &#39;Ur III&#39;, &#39;Old Akkadian&#39;,
       &#39;ED IIIb&#39;, &#39;Lagash II&#39;, &#39;Early Old Babylonian&#39;, &#39;Lagaš II&#39;,
       &#39;Achaemenid&#39;, &#39;Neo-Babylonian&#39;, &#39;Middle Babylonian&#39;,
       &#39;Old Akkadian; Early Dynastic or Old Akkadian&#39;, &#39;Middle Assyrian&#39;,
       &#39;Old Akkadian; Ur III&#39;, &#39;Early Dynastic; Old Akkadian&#39;, &#39;Ebla&#39;,
       &#39;Neo-Assyrian&#39;, &#39;First Millennium&#39;, &#39;Hellenistic&#39;,
       &#39;Ur III; Old Akkadian&#39;, &#39;Early Dynastic; Ur III&#39;, &#39;uncertain&#39;,
       &#39;fake&#39;, &#39;Neo/Late Babylonian&#39;, &#39;Seleucid&#39;, &#39;Uncertain&#39;,
       &#39;Old Assyrian&#39;, &#39;unclear&#39;, &#39;Standard Babylonian&#39;, &#39;Middle Hittite&#39;,
       &#39;Pre-Uruk V&#39;, &#39;Late Babylonian&#39;, &#39;Pre-Writing&#39;, &#39;Hittite&#39;,
       &#39;Late Middle Assyrian or early Neo-Assyrian&#39;, &#39;Mitanni&#39;,
       &#39;Parthian&#39;, &#39;Archaic&#39;, &#39;Early Dynastic or Old Akkadian&#39;,
       &#39;Late Antique&#39;, &#39;ED IIIa; Old Babylonian&#39;,
       &#39;Urartian Eastern Anatolia&#39;, &#39;Early Dynastic or Ur III&#39;,
       &#39;Urartian&#39;, &#39;Unknown&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Typically, we need to clean this first, but the period data looks pretty neat after manual inspection so we will skip for now. We dealt with some special cases according to this csv file: <a class="reference external" href="https://docs.google.com/spreadsheets/d/1ttueqlFrtNE4eaZDdDq80Ksc4Wg8pwxXeS8eCiiHjmQ/edit#gid=714968975">link</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_qid2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">period_wikidata_URI2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P155_period2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there&#39;s a question mark</span>
<span class="n">other_possible_period2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># when there are multiple estimations of period</span>
<span class="n">no_match_indices_period2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># index of the row if there&#39;s no match</span>


<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">])):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
  <span class="c1"># split every entry by ;</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

  <span class="c1"># get the first estimated period</span>
  <span class="n">first_p</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

  <span class="c1"># store the remaining estimations (if exist) away</span>
  <span class="n">other_possible_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

  <span class="c1"># check for uncertainty</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">P155_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Q22757&#39;</span><span class="p">]</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="n">first_p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">P155_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


  <span class="c1"># add in qid and label for the first_p</span>

  <span class="c1"># deal with some typo first</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (626-539 BC)&#39;</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC).&#39;</span><span class="p">):</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Neo-Babylonian (ca. 626-539 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Achaemenid (547–331 BC)&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Achaemenid (547-331 BC)&#39;</span>
  <span class="k">elif</span> <span class="n">first_p</span> <span class="o">==</span> <span class="s1">&#39;Old Babylonian&#39;</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Old Babylonian (ca. 1900-1600 BC)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Parthian&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Parthian (247 BC - 224 AD)&#39;</span>
  <span class="k">elif</span> <span class="s1">&#39;Pre-Uruk V&#39;</span> <span class="ow">in</span> <span class="n">first_p</span><span class="p">:</span>
    <span class="n">first_p</span> <span class="o">=</span> <span class="s1">&#39;Pre-Writing (ca. 8500-3500 BC)&#39;</span>
    <span class="n">other_possible_period2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Uruk V (ca. 3500-3350 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Uruk IV (ca. 3350-3200 BC)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Early Dynastic Period of Egypt&#39;</span><span class="p">]</span>

  <span class="c1"># if the period has a QID in FactGrid</span>
  <span class="k">if</span> <span class="n">first_p</span> <span class="ow">in</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="c1"># record the period</span>
    <span class="n">period2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">first_p</span><span class="p">]</span>
    <span class="c1"># get the corresponding QID (FG_item) and Wikidata_URI</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;cdli_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_p</span><span class="p">)</span>
    <span class="n">period_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;FG_qid&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">period_wikidata_URI2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">period_reference</span><span class="p">[</span><span class="s1">&#39;Wikidata_URI&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

  <span class="c1"># if the period does not have a FactGrid QID, put &#39;&#39; for everything for now</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">period2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_qid2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">period_wikidata_URI2</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">no_match_indices_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c1"># append these columns to the dataframe</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;period_qid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_qid2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;period_wikidata_URI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">period_wikidata_URI2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;P155_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P155_period2</span>
<span class="n">period_df2</span><span class="p">[</span><span class="s1">&#39;other_possible_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_possible_period2</span>

<span class="c1"># update the names of columns to be clearer</span>
<span class="n">period_df2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oracc_period&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">})</span>

<span class="n">period_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1760acc1-76b7-4812-a477-4962416544fd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>oracc_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td>Unknown</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1760acc1-76b7-4812-a477-4962416544fd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1760acc1-76b7-4812-a477-4962416544fd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1760acc1-76b7-4812-a477-4962416544fd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c53f8517-b433-4f78-96af-235c9914a74d">
  <button class="colab-df-quickchart" onclick="quickchart('df-c53f8517-b433-4f78-96af-235c9914a74d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c53f8517-b433-4f78-96af-235c9914a74d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<section id="id14">
<h4>7.2.2 matched_period_df<a class="headerlink" href="#id14" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="p">[</span><span class="o">~</span><span class="n">period_df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">no_match_indices_period2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_df2</span> <span class="o">=</span> <span class="n">matched_period_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id_text&#39;</span><span class="p">:</span> <span class="s1">&#39;oracc_dump_id&#39;</span><span class="p">})</span>
<span class="n">matched_period_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a0967d57-83d5-4e0e-91e1-0aaef613b958" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>oracc_dump_id</th>
      <th>oracc_dump_period</th>
      <th>period</th>
      <th>period_qid</th>
      <th>period_wikidata_URI</th>
      <th>P155_period</th>
      <th>other_possible_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P010733</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P101741</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P142806</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P102551</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P102659</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16647</th>
      <td>X130506</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16648</th>
      <td>X130507</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16649</th>
      <td>X130519</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16650</th>
      <td>Q002229</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>16651</th>
      <td>Q009326</td>
      <td>Old Babylonian</td>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>Q512152</td>
      <td>Q114877765</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>16652 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a0967d57-83d5-4e0e-91e1-0aaef613b958')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a0967d57-83d5-4e0e-91e1-0aaef613b958 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a0967d57-83d5-4e0e-91e1-0aaef613b958');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d343a6fb-c497-450a-b72c-365ad2b7034a">
  <button class="colab-df-quickchart" onclick="quickchart('df-d343a6fb-c497-450a-b72c-365ad2b7034a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d343a6fb-c497-450a-b72c-365ad2b7034a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(16652, 7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h4>7.2.3 no_match_period_df<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df2</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period2</span><span class="p">]</span>
<span class="n">no_match_period_df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9a694362-311a-4e9d-a9cb-ca23030c9ae1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>composite_id_x</th>
      <th>id_text2</th>
      <th>id_text</th>
      <th>language_x</th>
      <th>object_type_x</th>
      <th>period_x</th>
      <th>material_x</th>
      <th>collection_x</th>
      <th>museum_no_x</th>
      <th>provenience_x</th>
      <th>excavation_no_x</th>
      <th>findspot_square_x</th>
      <th>date_of_origin_x</th>
      <th>dates_referenced_x</th>
      <th>genre_x</th>
      <th>subgenre_x</th>
      <th>translation_source_x</th>
      <th>id</th>
      <th>language_y</th>
      <th>material_y</th>
      <th>object_type_y</th>
      <th>period_y</th>
      <th>provenience_y</th>
      <th>excavation_no_y</th>
      <th>findspot_square_y</th>
      <th>dates_referenced_y</th>
      <th>genre_y</th>
      <th>subgenre_y</th>
      <th>translation_source_y</th>
      <th>archive</th>
      <th>collection_y</th>
      <th>museum-nos</th>
      <th>mus_no</th>
      <th>museum_no_y</th>
      <th>cdli_museum_no</th>
      <th>saa_cdli_museum</th>
      <th>Mus_no</th>
      <th>museum_number</th>
      <th>museum</th>
      <th>museum_URL</th>
      <th>date_of_origin_y</th>
      <th>dialect</th>
      <th>date</th>
      <th>supergenre</th>
      <th>xproject</th>
      <th>q_number</th>
      <th>ancient_year</th>
      <th>date_bce</th>
      <th>cdli_id</th>
      <th>OBJ_type</th>
      <th>Period_culture</th>
      <th>Script_type_1</th>
      <th>Genre</th>
      <th>Subgenre</th>
      <th>S_s_genre</th>
      <th>Language</th>
      <th>Full_no</th>
      <th>Tablet_number</th>
      <th>Q_no</th>
      <th>object</th>
      <th>composite_id_y</th>
      <th>project name</th>
      <th>id_text_int</th>
      <th>seal_id</th>
      <th>cdli_composite_id</th>
      <th>ancient_date</th>
      <th>bdtns_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000001</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 01533</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,a</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000002</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15263</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 06435,b</td>
      <td>M XVIII,?</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk III</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>P000003</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15253</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09123,d</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>Archaic Vocabulary (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000004</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15168</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09169,d</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q000002</td>
      <td>0.0</td>
      <td>P000005</td>
      <td>undetermined</td>
      <td>tablet</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>clay</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>VAT 15153</td>
      <td>Uruk (mod. Warka)</td>
      <td>W 09206,k</td>
      <td>Qa XVI,2</td>
      <td>00.00.00.00</td>
      <td>00.00.00.00</td>
      <td>Lexical</td>
      <td>Archaic Lu2 A (witness)</td>
      <td>no translation</td>
      <td>NaN</td>
      <td>undetermined</td>
      <td>clay</td>
      <td>tablet</td>
      <td>Uruk IV</td>
      <td>Warka (Uruk)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lexical</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LEX</td>
      <td>CDLI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>armep</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9a694362-311a-4e9d-a9cb-ca23030c9ae1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9a694362-311a-4e9d-a9cb-ca23030c9ae1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9a694362-311a-4e9d-a9cb-ca23030c9ae1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1ef7f88b-d294-4b97-9f00-49d4035f22d8">
  <button class="colab-df-quickchart" onclick="quickchart('df-1ef7f88b-d294-4b97-9f00-49d4035f22d8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1ef7f88b-d294-4b97-9f00-49d4035f22d8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">no_match_period_df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(350264, 67)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">no_match_period_df2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">metacatalogue</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h4>Visualization<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<section id="id17">
<h5>Distribution of matched periods<a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matched_period_counts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matched_period_df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">matched_period_counts2</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span>
               <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">matched_period_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-44282cd7-127d-4655-b61c-b64bb36afdb8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>16363</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Late Babylonian</td>
      <td>170</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>118</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-44282cd7-127d-4655-b61c-b64bb36afdb8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-44282cd7-127d-4655-b61c-b64bb36afdb8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-44282cd7-127d-4655-b61c-b64bb36afdb8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6266426c-69ac-4794-8cde-40bad3d6d455">
  <button class="colab-df-quickchart" onclick="quickchart('df-6266426c-69ac-4794-8cde-40bad3d6d455')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6266426c-69ac-4794-8cde-40bad3d6d455 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Periods that Matched FactGrid Records, ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7b98da681152e5d2797183f5d34dca32c4ae111659deb4e6f01c88a765dadc5.png" src="_images/e7b98da681152e5d2797183f5d34dca32c4ae111659deb4e6f01c88a765dadc5.png" />
</div>
</div>
</section>
<section id="id18">
<h5>Distribution of matched tablets over time<a class="headerlink" href="#id18" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_year_of_period2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">current_period</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">]</span>
  <span class="c1"># only take what&#39;s between ()</span>
  <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;\(([^\)]+)\)&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">current_period</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">year_range</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;\(([^\)]+)\)&#39;</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="n">current_period</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># remove &#39;ca.&#39; and space to prepare for string manipulation</span>
  <span class="n">year_range</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ca. &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

  <span class="k">if</span> <span class="s1">&#39;BC&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;AD&#39;</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this range crosses AD and BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;BC&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#i.e., this is a normal range within BC</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># since this is a BC year, make it negative</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">))</span>

  <span class="k">else</span><span class="p">:</span> <span class="c1">#&#39;AD&#39; only years</span>
    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">year_range</span><span class="p">:</span> <span class="c1"># i.e., this is not a range</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;AD&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">start_year</span> <span class="o">=</span> <span class="n">year_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span>

  <span class="n">start_year_of_period2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">start_year</span><span class="p">]</span>

<span class="n">matched_period_counts2</span><span class="p">[</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_year_of_period2</span>
<span class="c1"># order the df by start_year_of_period</span>
<span class="n">matched_period_counts2</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;start_year_of_period&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">matched_period_counts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e17e8e61-d8eb-42c6-b903-ac494729462e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
      <th>start_year_of_period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Pre-Writing (ca. 8500-3500 BC)</td>
      <td>1</td>
      <td>-8500</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Old Babylonian (ca. 1900-1600 BC)</td>
      <td>16363</td>
      <td>-1900</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Late Babylonian</td>
      <td>170</td>
      <td>-1900</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parthian (247 BC - 224 AD)</td>
      <td>118</td>
      <td>-247</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e17e8e61-d8eb-42c6-b903-ac494729462e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e17e8e61-d8eb-42c6-b903-ac494729462e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e17e8e61-d8eb-42c6-b903-ac494729462e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ab462541-a74d-4b86-8d66-a7965069a0ea">
  <button class="colab-df-quickchart" onclick="quickchart('df-ab462541-a74d-4b86-8d66-a7965069a0ea')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ab462541-a74d-4b86-8d66-a7965069a0ea button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">matched_period_counts2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">122000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period of Tablet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Tablet Over Time (of Periods that Matched FactGrid Records, ORACC)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1206ae971446a441745490592587392606ceb149f4eb67d4fac00a86a6595bd5.png" src="_images/1206ae971446a441745490592587392606ceb149f4eb67d4fac00a86a6595bd5.png" />
</div>
</div>
</section>
<section id="id19">
<h5>Distribution of Unmatched Periods<a class="headerlink" href="#id19" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">period_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">)[</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oracc_dump_period
Achaemenid                                        855
Archaic                                            14
ED I-II                                             9
ED IIIa                                           318
ED IIIa; Old Babylonian                             1
ED IIIb                                           210
Early Dynastic                                   1188
Early Dynastic I-II                                87
Early Dynastic IIIa                               826
Early Dynastic IIIb                              3457
Early Dynastic or Old Akkadian                      1
Early Dynastic or Ur III                            1
Early Dynastic; Old Akkadian                        2
Early Dynastic; Ur III                              1
Early Old Babylonian                             2699
Ebla                                              220
First Millennium                                  792
Hellenistic                                      1013
Hittite                                             1
Lagash II                                         699
Lagaš II                                         3755
Late Antique                                        1
Late Middle Assyrian or early Neo-Assyrian         21
Middle Assyrian                                  3479
Middle Babylonian                                1690
Middle Hittite                                      4
Mitanni                                             1
Neo-Assyrian                                    14447
Neo-Babylonian                                   3362
Neo/Late Babylonian                                66
Old Akkadian                                     6325
Old Akkadian; Early Dynastic or Old Akkadian        1
Old Akkadian; Ur III                                1
Old Assyrian                                      477
Pre-Writing                                         1
Seleucid                                          547
Standard Babylonian                                 6
Uncertain                                         140
Unknown                                            35
Ur III                                          82083
Ur III; Old Akkadian                                2
Urartian                                           69
Urartian Eastern Anatolia                         773
Uruk III                                          707
Uruk IV                                            13
fake                                                2
uncertain                                          28
unclear                                             5
Name: oracc_dump_period, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unmatched_periods2</span> <span class="o">=</span> <span class="n">period_df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">no_match_indices_period2</span><span class="p">][</span><span class="s1">&#39;oracc_dump_period&#39;</span><span class="p">]</span>
<span class="n">unmatched_periods_clean2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">unmatched_periods</span><span class="p">:</span>
  <span class="n">p</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="k">if</span> <span class="s1">&#39;modern&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">unmatched_periods_clean</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;modern&#39;</span><span class="p">]</span>

  <span class="c1"># we only consider the non-empty ones</span>
  <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># remove the unceratinty marks</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="c1"># make sure that all multiple entries are separated by ;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># split a multi-period statement, if yes</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>

    <span class="n">unmatched_periods_clean2</span> <span class="o">+=</span> <span class="n">lst</span>

<span class="c1"># remove the space attached to some entries which are resulted from splitting by ;</span>
<span class="n">unmatched_periods_clean2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unmatched_periods_clean2</span><span class="p">]</span>


<span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unmatched_periods_clean2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;uncertain&#39;, &#39;nan&#39;, &#39;fake (ancient)&#39;,
       &#39;Old Elamite (ca. 2700-1500 BC)&#39;, &#39;Achaemenid&#39;,
       &#39;Early Old Babylonian (ca. 1900-1600 BC)&#39;,
       &#39;Early Dynastic IIIA (c. 2700-2500 BC)&#39;,
       &#39;Uruk III (ca. 3200-3000 BC) - Early Dynastic I-II (ca. 2900-2700 BC)&#39;,
       &#39;1200-700 BC&#39;, &#39;Middle Babylonian (ca. 1400-1100 BC))&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the frequencies of elements in the list</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">unmatched_periods_clean2</span><span class="p">)</span>

<span class="c1"># turn the langs and their counts into a dataframe</span>
<span class="n">unmatched_p_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span>\
<span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>\
<span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
<span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">unmatched_p_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-46ac1ad5-97b2-4d01-8b49-9802065f5f13" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>35743</td>
    </tr>
    <tr>
      <th>1</th>
      <td>uncertain</td>
      <td>847</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Achaemenid</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fake (ancient)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Old Elamite (ca. 2700-1500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Early Old Babylonian (ca. 1900-1600 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Early Dynastic IIIA (c. 2700-2500 BC)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Uruk III (ca. 3200-3000 BC) - Early Dynastic I...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1200-700 BC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Middle Babylonian (ca. 1400-1100 BC))</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-46ac1ad5-97b2-4d01-8b49-9802065f5f13')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-46ac1ad5-97b2-4d01-8b49-9802065f5f13 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-46ac1ad5-97b2-4d01-8b49-9802065f5f13');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5a12c57a-4c19-494c-8374-2255f029b8c3">
  <button class="colab-df-quickchart" onclick="quickchart('df-5a12c57a-4c19-494c-8374-2255f029b8c3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5a12c57a-4c19-494c-8374-2255f029b8c3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">unmatched_p_df2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Period&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Periods of Tablets that Do Not Match FactGrid Labels</span><span class="se">\n</span><span class="s1">(excluding empty ones), ORACC&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/118258f448fafc102be29379562ba49482da0193ea91d99600f3230de887d8c5.png" src="_images/118258f448fafc102be29379562ba49482da0193ea91d99600f3230de887d8c5.png" />
</div>
</div>
</section>
</section>
<section id="merging-period-dfs-of-cdli-and-oracc">
<h4>Merging period dfs of CDLI and ORACC<a class="headerlink" href="#merging-period-dfs-of-cdli-and-oracc" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">periods_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">period_df</span><span class="p">,</span> <span class="n">period_df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">final_periods_df</span> <span class="o">=</span> <span class="n">periods_df</span><span class="p">[[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span><span class="s1">&#39;period_x&#39;</span><span class="p">,</span><span class="s1">&#39;period_y&#39;</span><span class="p">,</span><span class="s1">&#39;period_qid_x&#39;</span><span class="p">,</span><span class="s1">&#39;period_qid_y&#39;</span><span class="p">,</span><span class="s1">&#39;period_wikidata_URI_x&#39;</span><span class="p">,</span><span class="s1">&#39;period_wikidata_URI_y&#39;</span><span class="p">,</span><span class="s1">&#39;P155_period_x&#39;</span><span class="p">,</span><span class="s1">&#39;P155_period_y&#39;</span><span class="p">,</span><span class="s1">&#39;other_possible_period_x&#39;</span><span class="p">,</span><span class="s1">&#39;other_possible_period_y&#39;</span><span class="p">]]</span>
<span class="n">final_periods_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-28b50055-3417-4457-800f-4f32bded89b4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>period_qid_x</th>
      <th>period_qid_y</th>
      <th>period_wikidata_URI_x</th>
      <th>period_wikidata_URI_y</th>
      <th>P155_period_x</th>
      <th>P155_period_y</th>
      <th>other_possible_period_x</th>
      <th>other_possible_period_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td></td>
      <td>Q512134</td>
      <td></td>
      <td>Q114877803</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td></td>
      <td>Q512132</td>
      <td></td>
      <td>Q114877809</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>X096677</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366912</th>
      <td>X201001</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366913</th>
      <td>X201002</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366914</th>
      <td>X225104</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>366915</th>
      <td>X423597</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-28b50055-3417-4457-800f-4f32bded89b4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-28b50055-3417-4457-800f-4f32bded89b4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-28b50055-3417-4457-800f-4f32bded89b4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8fb55b44-67f3-44fe-9512-460f6e17282d">
  <button class="colab-df-quickchart" onclick="quickchart('df-8fb55b44-67f3-44fe-9512-460f6e17282d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8fb55b44-67f3-44fe-9512-460f6e17282d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_periods_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/categories/final_periods_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>#Preparing for Statements
Merging all final merged dfs, merge column values if same, title with QID.</p>
<p>CDLI = Q393513, ORACC = Q425152, header ‘qal131’</p>
<p>merge all of the final dataframes into one big dataframe as raw information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#import final dataframes</span>
<span class="n">final_languages_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_languages_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_materials_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_materials_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_collections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_collections_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_proveniences_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_proveniences_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_objects_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_objects_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_genres_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_genres_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_periods_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/ORACC_DFS/categories/final_periods_df.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">all_merged</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">]</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">final_languages_df</span><span class="p">,</span> <span class="n">final_materials_df</span><span class="p">,</span> <span class="n">final_collections_df</span><span class="p">,</span> <span class="n">final_proveniences_df</span><span class="p">,</span> <span class="n">final_objects_df</span><span class="p">,</span> <span class="n">final_genres_df</span><span class="p">,</span> <span class="n">final_periods_df</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)):</span>
  <span class="n">all_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_merged</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">all_merged</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(366916, 11) 366916
(366916, 13) 366916
(366916, 21) 366916
(366916, 15) 366916
(366916, 9) 366916
(366916, 11) 366916
(366916, 11) 366916
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#add the designation from metacatalogue</span>
<span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;designation_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;designation_x&#39;</span><span class="p">]</span>
<span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;designation_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metacatalogue</span><span class="p">[</span><span class="s1">&#39;designation_y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">all_merged</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">all_merged</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(366916, 87)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-118783ce-688c-4041-8e43-a730c0b029af" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>first_lang_x</th>
      <th>first_lang_y</th>
      <th>first_lang_qid_x</th>
      <th>first_lang_qid_y</th>
      <th>first_lang_parent_x</th>
      <th>first_lang_parent_y</th>
      <th>P155_lang_x</th>
      <th>P155_lang_y</th>
      <th>other_lang_x</th>
      <th>other_lang_y</th>
      <th>material_x</th>
      <th>material_y</th>
      <th>first_mat_x</th>
      <th>first_mat_y</th>
      <th>first_mat_label_x</th>
      <th>first_mat_label_y</th>
      <th>first_mat_qid_x</th>
      <th>first_mat_qid_y</th>
      <th>P155_mat_x</th>
      <th>P155_mat_y</th>
      <th>other_mat_x</th>
      <th>other_mat_y</th>
      <th>collection_x</th>
      <th>collection_y</th>
      <th>collection_qid_x</th>
      <th>collection_qid_y</th>
      <th>collection_wikidata_id_x</th>
      <th>collection_wikidata_id_y</th>
      <th>collection_name_x</th>
      <th>collection_name_y</th>
      <th>collection_name_native_x</th>
      <th>collection_name_native_y</th>
      <th>collection_url_x</th>
      <th>collection_url_y</th>
      <th>wiki_url_eng_x</th>
      <th>wiki_url_eng_y</th>
      <th>wiki_url_native_x</th>
      <th>wiki_url_native_y</th>
      <th>P155_collection_x</th>
      <th>P155_collection_y</th>
      <th>other_collection_x</th>
      <th>other_collection_y</th>
      <th>provenience_FG_qid_x</th>
      <th>provenience_FG_qid_y</th>
      <th>provenience_x</th>
      <th>provenience_y</th>
      <th>excavation_no_x</th>
      <th>excavation_no_y</th>
      <th>museum_no_x</th>
      <th>museum_no_y</th>
      <th>findspot_square_x</th>
      <th>findspot_square_y</th>
      <th>ancientplace_x</th>
      <th>ancientplace_y</th>
      <th>Len_x</th>
      <th>Len_y</th>
      <th>object_type_x</th>
      <th>object_type2_x</th>
      <th>object_type_y</th>
      <th>object_type2_y</th>
      <th>object_FG_qid_x</th>
      <th>object_FG_qid_y</th>
      <th>object_FG_Label_x</th>
      <th>object_FG_Label_y</th>
      <th>genre_x</th>
      <th>genre_y</th>
      <th>genre_qid_x</th>
      <th>genre_qid_y</th>
      <th>genre_current_count_x</th>
      <th>genre_current_count_y</th>
      <th>P155_genre_x</th>
      <th>P155_genre_y</th>
      <th>other_genre_x</th>
      <th>other_genre_y</th>
      <th>period_x</th>
      <th>period_y</th>
      <th>period_qid_x</th>
      <th>period_qid_y</th>
      <th>period_wikidata_URI_x</th>
      <th>period_wikidata_URI_y</th>
      <th>P155_period_x</th>
      <th>P155_period_y</th>
      <th>other_possible_period_x</th>
      <th>other_possible_period_y</th>
      <th>designation_x</th>
      <th>designation_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>VAT 01533</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>NaN</td>
      <td>Q512134</td>
      <td>NaN</td>
      <td>Q114877803</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI Lexical 000002, ex. 065</td>
      <td>W 06435,a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>VAT 15263</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uruk III (ca. 3200-3000 BC)</td>
      <td>NaN</td>
      <td>Q512134</td>
      <td>NaN</td>
      <td>Q114877803</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI Lexical 000002, ex. 066</td>
      <td>W 06435,b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>VAT 15253</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>NaN</td>
      <td>Q512132</td>
      <td>NaN</td>
      <td>Q114877809</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ATU 3, pl. 081, W 9123,d</td>
      <td>W 09123,d</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P000004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>VAT 15168</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>NaN</td>
      <td>Q512132</td>
      <td>NaN</td>
      <td>Q114877809</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI Lexical 000002, ex. 051</td>
      <td>W 09169,d</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P000005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>clay</td>
      <td>Q471153</td>
      <td>Q471153</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Vorderasiatisches Museum, Berlin, Germany</td>
      <td>Q510658</td>
      <td>Q510658</td>
      <td>Q542084</td>
      <td>Q542084</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>Vorderasiatisches Museum</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://www.smb.museum/museen-einrichtungen/vo...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://en.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>https://de.wikipedia.org/wiki/Vorderasiatische...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q390030</td>
      <td>NaN</td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>VAT 15153</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>https://database.factgrid.de/entity/Q390030</td>
      <td>NaN</td>
      <td>Warkāʼ</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>tablet</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td>Q512006</td>
      <td>Clay tablet</td>
      <td>Clay tablet</td>
      <td>Lexical</td>
      <td>Lexical</td>
      <td>Q537054</td>
      <td>Q537054</td>
      <td>8273</td>
      <td>8273</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uruk IV (ca. 3350-3200 BC)</td>
      <td>NaN</td>
      <td>Q512132</td>
      <td>NaN</td>
      <td>Q114877809</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDLI Lexical 000002, ex. 172</td>
      <td>W 09206,k</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-118783ce-688c-4041-8e43-a730c0b029af')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-118783ce-688c-4041-8e43-a730c0b029af button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-118783ce-688c-4041-8e43-a730c0b029af');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9d75ca77-13d9-4842-bd3d-1e4a3b952721">
  <button class="colab-df-quickchart" onclick="quickchart('df-9d75ca77-13d9-4842-bd3d-1e4a3b952721')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9d75ca77-13d9-4842-bd3d-1e4a3b952721 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">all_merged</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id_text&#39;, &#39;first_lang_x&#39;, &#39;first_lang_y&#39;, &#39;first_lang_qid_x&#39;,
       &#39;first_lang_qid_y&#39;, &#39;first_lang_parent_x&#39;, &#39;first_lang_parent_y&#39;,
       &#39;P155_lang_x&#39;, &#39;P155_lang_y&#39;, &#39;other_lang_x&#39;, &#39;other_lang_y&#39;,
       &#39;material_x&#39;, &#39;material_y&#39;, &#39;first_mat_x&#39;, &#39;first_mat_y&#39;,
       &#39;first_mat_label_x&#39;, &#39;first_mat_label_y&#39;, &#39;first_mat_qid_x&#39;,
       &#39;first_mat_qid_y&#39;, &#39;P155_mat_x&#39;, &#39;P155_mat_y&#39;, &#39;other_mat_x&#39;,
       &#39;other_mat_y&#39;, &#39;collection_x&#39;, &#39;collection_y&#39;, &#39;collection_qid_x&#39;,
       &#39;collection_qid_y&#39;, &#39;collection_wikidata_id_x&#39;,
       &#39;collection_wikidata_id_y&#39;, &#39;collection_name_x&#39;, &#39;collection_name_y&#39;,
       &#39;collection_name_native_x&#39;, &#39;collection_name_native_y&#39;,
       &#39;collection_url_x&#39;, &#39;collection_url_y&#39;, &#39;wiki_url_eng_x&#39;,
       &#39;wiki_url_eng_y&#39;, &#39;wiki_url_native_x&#39;, &#39;wiki_url_native_y&#39;,
       &#39;P155_collection_x&#39;, &#39;P155_collection_y&#39;, &#39;other_collection_x&#39;,
       &#39;other_collection_y&#39;, &#39;provenience_FG_qid_x&#39;, &#39;provenience_FG_qid_y&#39;,
       &#39;provenience_x&#39;, &#39;provenience_y&#39;, &#39;excavation_no_x&#39;, &#39;excavation_no_y&#39;,
       &#39;museum_no_x&#39;, &#39;museum_no_y&#39;, &#39;findspot_square_x&#39;, &#39;findspot_square_y&#39;,
       &#39;ancientplace_x&#39;, &#39;ancientplace_y&#39;, &#39;Len_x&#39;, &#39;Len_y&#39;, &#39;object_type_x&#39;,
       &#39;object_type2_x&#39;, &#39;object_type_y&#39;, &#39;object_type2_y&#39;, &#39;object_FG_qid_x&#39;,
       &#39;object_FG_qid_y&#39;, &#39;object_FG_Label_x&#39;, &#39;object_FG_Label_y&#39;, &#39;genre_x&#39;,
       &#39;genre_y&#39;, &#39;genre_qid_x&#39;, &#39;genre_qid_y&#39;, &#39;genre_current_count_x&#39;,
       &#39;genre_current_count_y&#39;, &#39;P155_genre_x&#39;, &#39;P155_genre_y&#39;,
       &#39;other_genre_x&#39;, &#39;other_genre_y&#39;, &#39;period_x&#39;, &#39;period_y&#39;,
       &#39;period_qid_x&#39;, &#39;period_qid_y&#39;, &#39;period_wikidata_URI_x&#39;,
       &#39;period_wikidata_URI_y&#39;, &#39;P155_period_x&#39;, &#39;P155_period_y&#39;,
       &#39;other_possible_period_x&#39;, &#39;other_possible_period_y&#39;, &#39;designation_x&#39;,
       &#39;designation_y&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="cdli-and-qualifier-is-oracc">
<h2>CDLI and Qualifier is ORACC<a class="headerlink" href="#cdli-and-qualifier-is-oracc" title="Link to this heading">#</a></h2>
<p>CDLI will always be the identifier and ORACC will always be the qualifier value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p18q</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1">#languages</span>
<span class="n">p401q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#materials</span>
<span class="n">p329q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#museum/collection</span>
<span class="n">p695q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#provenience, P804 for excavation_no and P425 for findspot_square qualifiers</span>
<span class="n">p804q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#excavation_no</span>
<span class="n">p425q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#findspot_square</span>
<span class="n">p2q</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1">#object_type</span>
<span class="n">p608q</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#genre</span>
<span class="n">p853q</span> <span class="o">=</span><span class="p">[]</span>   <span class="c1">#period</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">all_merged</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="c1">#LANGUAGE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>  <span class="c1">#if the languages for cdli and oracc are the same</span>
    <span class="n">p18q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>                                                           <span class="c1">#set the qualifier for that text to nothing [nothing to differentiate]</span>
  <span class="k">else</span><span class="p">:</span>                                                                       <span class="c1">#if they are different</span>
    <span class="n">p18q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>                            <span class="c1">#set qualifier to the oracc identification</span>

  <span class="c1">#MATERIAL</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p401q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p401q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#COLLECTION</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p329q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p329q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#PROVENIENCE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p695q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p695q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p804q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p804q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p425q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p425q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#OBJECT TYPE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;object_FG_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;object_FG_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p2q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p2q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;object_FG_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#GENRE</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p608q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p608q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

  <span class="c1">#PERIOD</span>
  <span class="k">if</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
    <span class="n">p853q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">p853q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tester_export</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;qid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">all_merged</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                         <span class="s1">&#39;P18&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_lang_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_18&#39;</span><span class="p">:</span> <span class="n">p18q</span><span class="p">,</span>
                         <span class="s1">&#39;P401&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;first_mat_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_401&#39;</span><span class="p">:</span> <span class="n">p401q</span><span class="p">,</span>
                         <span class="s1">&#39;P329&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;collection_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_329&#39;</span><span class="p">:</span> <span class="n">p329q</span><span class="p">,</span>
                         <span class="s1">&#39;P695&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;provenience_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_695&#39;</span><span class="p">:</span><span class="n">p695q</span><span class="p">,</span>
                         <span class="s1">&#39;P804&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;excavation_no_x&#39;</span><span class="p">],</span><span class="s1">&#39;qal131_804&#39;</span><span class="p">:</span><span class="n">p804q</span><span class="p">,</span>
                         <span class="s1">&#39;P425&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;findspot_square_x&#39;</span><span class="p">],</span><span class="s1">&#39;qal131_425&#39;</span><span class="p">:</span><span class="n">p425q</span><span class="p">,</span>
                         <span class="s1">&#39;P2&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;object_FG_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_2&#39;</span><span class="p">:</span> <span class="n">p2q</span><span class="p">,</span>
                         <span class="s1">&#39;P608&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;genre_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_608&#39;</span><span class="p">:</span> <span class="n">p608q</span><span class="p">,</span>
                         <span class="s1">&#39;P853&#39;</span><span class="p">:</span><span class="n">all_merged</span><span class="p">[</span><span class="s1">&#39;period_qid_x&#39;</span><span class="p">],</span> <span class="s1">&#39;qal131_853&#39;</span><span class="p">:</span> <span class="n">p853q</span>
                         <span class="p">})</span>
<span class="n">tester_export</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f2e28b5f-159c-4163-9112-42768ab71082" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>qid</th>
      <th>P18</th>
      <th>qal131_18</th>
      <th>P401</th>
      <th>qal131_401</th>
      <th>P329</th>
      <th>qal131_329</th>
      <th>P695</th>
      <th>qal131_695</th>
      <th>P804</th>
      <th>qal131_804</th>
      <th>P425</th>
      <th>qal131_425</th>
      <th>P2</th>
      <th>qal131_2</th>
      <th>P608</th>
      <th>qal131_608</th>
      <th>P853</th>
      <th>qal131_853</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.646808e-310</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,a</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512134</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.646801e-310</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 06435,b</td>
      <td>NaN</td>
      <td>M XVIII,?</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512134</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.646808e-310</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09123,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.646801e-310</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09169,d</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.900143e-310</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Q471153</td>
      <td></td>
      <td>Q510658</td>
      <td></td>
      <td>Uruk (mod. Warka)</td>
      <td>Warka (Uruk)</td>
      <td>W 09206,k</td>
      <td>NaN</td>
      <td>Qa XVI,2</td>
      <td>NaN</td>
      <td>Q512006</td>
      <td></td>
      <td>Q537054</td>
      <td></td>
      <td>Q512132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366911</th>
      <td>1.812781e-318</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366912</th>
      <td>1.812786e-318</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366913</th>
      <td>1.812791e-318</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366914</th>
      <td>1.812796e-318</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>366915</th>
      <td>1.812801e-318</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>366916 rows × 19 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f2e28b5f-159c-4163-9112-42768ab71082')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f2e28b5f-159c-4163-9112-42768ab71082 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f2e28b5f-159c-4163-9112-42768ab71082');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-846b7b97-1931-4c35-ae82-c053d0558fa2">
  <button class="colab-df-quickchart" onclick="quickchart('df-846b7b97-1931-4c35-ae82-c053d0558fa2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-846b7b97-1931-4c35-ae82-c053d0558fa2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">all_merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;ORACC_DFS/all_merged.csv&#39;</span><span class="p">)</span>
<span class="n">tester_export</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;ORACC_DFS/tester_export.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="7.1%20-%20Metacatalogue.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mount Google Drive folder + imports</p>
      </div>
    </a>
    <a class="right-next"
       href="7.3%20-%20Factgrid%20Quickstatement%20Processing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mount Google Drive folder + imports</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#language-language-p18-uncertainty-p155">1 Language = Language (P18) + uncertainty (P155)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-with-the-cdli-languages-we-can-match-unique-languages-to-their-fg-language-id">1.1 Starting with the CDLI languages, we can match unique languages to their FG language id</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-languages-dataframes">1.3 Combining CDLI and ORACC Languages dataframes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-material-composition-p401">2 Material = Material Composition (P401)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-only-add-the-most-basic-material-composition-to-a-data-frame-material-df-and-then-we-match-the-first-statement-to-the-corresponding-factgrid-q-id"><strong>2.1. We will only add the most basic material composition to a data frame, `material_df’, and then we match the first statement to the corresponding FactGrid Q-id.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.2. CDLI - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df">2.2.1 matched_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df">2.2.2 no_match_mat_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-cdli-materials">2.2.3 Visualization of CDLI Materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-materials">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-finer-categories-within-matched-materials">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-materials">Distribution of unmatched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-materials-are-tablets-that-have-languages-on-them-made-of">What materials are tablets that have languages on them made of?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-make-the-material-df-data-frame-for-material-composition-for-all-items-with-a-matching-material-composition-factgrid-q-id"><strong>2.3. ORACC - Make the <code class="docutils literal notranslate"><span class="pre">material_df</span></code> data frame for material_composition for all items with a matching material composition FactGrid Q-id.</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-mat-df2">2.3.1 matched_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-mat-df2">2.3.2 no_match_mat_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Distribution of matched first materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Distribution of finer categories within matched materials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Distribution of unmatched materials</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-cdli-and-oracc-material-dataframes"><strong>2.4 Combining CDLI and ORACC Material dataframes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#museum-collection-present-holding-p329">3 <strong>museum/collection = present holding (P329)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df">3.1.2 collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df">3.1.3 matched_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df">3.1.4 no_match_collection_df</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">3.1.5 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-first-collections">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries">Distribution of countries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-collections">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collection-df2">3.2.1 collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-collection-df2">3.2.2 matched_collection_df2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-collection-df2">3.2.3 no_match_collection_df2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.2.4 Visualization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Distribution of matched first collections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-countries-of-first-collections-that-matched">Distribution of countries of first collections that matched</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Distribution of unmatched collections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-collections-of-cdli-and-oracc">3.3 Merging collections of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#provenience-find-spot-p695">4 <strong>provenience = find spot (P695)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-two-columns-as-qualifiers">4.4 Add two columns as qualifiers:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#object-type-instance-of-p2">5 <strong>object_type = Instance of (P2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-objects">5.1 CDLI objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-objects">5.2 ORACC objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-object-dfs-of-cdli-and-oracc">Merging object dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#genre-field-of-knowledge-p608">6 <strong>genre = Field of Knowledge (P608)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-object-type-in-the-cdli-catalog">6.1 Use this CSV to obtain the FactGrid Q-ids for each object type in the CDLI catalog:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-genres">6.2 CDLI Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-cdli-label-genre-to-obtain-the-factgrid-q-id">6.2.1 Match on the cdli label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df">6.2.2 matched_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-genre-df">6.2.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">6.2.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-genre-for-tablets-that-have-text-on-them">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-genre">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-genres">6.3 ORACC Genres</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#match-on-the-oracc-label-genre-to-obtain-the-factgrid-q-id">6.3.1 Match on the oracc label ‘genre’ to obtain the FactGrid Q-id.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-genre-df2">6.3.2 matched_genre_df2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">6.3.3 no_match_genre_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">6.3.4 Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Distribution of matched genre</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Distribution of matched genre for tablets that have text on them</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Distribution of unmatched genre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-genre-dfs-of-cdli-and-oracc">Merging genre dfs of CDLI and ORACC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-period-p853">7 <strong>period = Period (P853)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-this-csv-to-obtain-the-factgrid-q-ids-for-each-period-of-each-texts-in-the-cdli-catalog">7.1 Use this CSV to obtain the FactGrid Q-ids for each period of each texts in the CDLI catalog</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-periods">7.2 CDLI Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matched-period-df">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#no-match-period-df">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-periods">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-matched-tablets-over-time">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-unmatched-periods">Distribution of Unmatched Periods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#oracc-periods">7.3 ORACC Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">7.2.2 matched_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">7.2.3 no_match_period_df</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Distribution of matched periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Distribution of matched tablets over time</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Distribution of Unmatched Periods</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-period-dfs-of-cdli-and-oracc">Merging period dfs of CDLI and ORACC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cdli-and-qualifier-is-oracc">CDLI and Qualifier is ORACC</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>